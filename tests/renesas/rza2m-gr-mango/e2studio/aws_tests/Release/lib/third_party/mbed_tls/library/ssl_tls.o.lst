   1              		.cpu cortex-a9
   2              		.eabi_attribute 28, 1
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 4
  10              		.eabi_attribute 34, 0
  11              		.eabi_attribute 18, 4
  12              		.file	"ssl_tls.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.section	.text.mbedtls_ssl_safer_memcmp,"ax",%progbits
  17              		.align	2
  18              		.syntax unified
  19              		.arm
  20              		.fpu neon
  22              	mbedtls_ssl_safer_memcmp:
  23              	.LFB20:
  24              		.file 1 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/ssl_i
   1:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /**
   2:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \file ssl_internal.h
   3:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
   4:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \brief Internal functions shared by the SSL modules
   5:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
   6:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
   7:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   8:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  SPDX-License-Identifier: Apache-2.0
   9:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
  10:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  11:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  not use this file except in compliance with the License.
  12:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  You may obtain a copy of the License at
  13:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
  14:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  15:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
  16:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  Unless required by applicable law or agreed to in writing, software
  17:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  18:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  19:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  See the License for the specific language governing permissions and
  20:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  limitations under the License.
  21:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
  22:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  23:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
  24:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #ifndef MBEDTLS_SSL_INTERNAL_H
  25:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_INTERNAL_H
  26:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  27:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "ssl.h"
  28:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "cipher.h"
  29:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  30:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_MD5_C)
  31:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "md5.h"
  32:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
  33:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  34:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SHA1_C)
  35:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "sha1.h"
  36:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
  37:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  38:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SHA256_C)
  39:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "sha256.h"
  40:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
  41:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  42:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
  43:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "sha512.h"
  44:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
  45:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  46:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
  47:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #include "ecjpake.h"
  48:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
  49:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  50:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  51:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     !defined(inline) && !defined(__cplusplus)
  52:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define inline __inline
  53:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
  54:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  55:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Determine minimum supported version */
  56:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_MAJOR_VERSION           MBEDTLS_SSL_MAJOR_VERSION_3
  57:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  58:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
  59:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_0
  60:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
  61:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1)
  62:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_1
  63:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
  64:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1)
  65:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_2
  66:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
  67:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
  68:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_3
  69:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
  70:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 */
  71:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1   */
  72:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3   */
  73:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  74:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_VALID_MINOR_VERSION MBEDTLS_SSL_MINOR_VERSION_1
  75:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION MBEDTLS_SSL_MAJOR_VERSION_3
  76:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  77:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Determine maximum supported version */
  78:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAX_MAJOR_VERSION           MBEDTLS_SSL_MAJOR_VERSION_3
  79:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  80:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
  81:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_3
  82:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
  83:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1)
  84:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_2
  85:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
  86:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1)
  87:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_1
  88:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
  89:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
  90:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAX_MINOR_VERSION           MBEDTLS_SSL_MINOR_VERSION_0
  91:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3   */
  92:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1   */
  93:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 */
  94:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
  95:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
  96:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_INITIAL_HANDSHAKE           0
  97:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS   1   /* In progress */
  98:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_DONE          2   /* Done or aborted */
  99:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RENEGOTIATION_PENDING       3   /* Requested (server only) */
 100:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 101:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 102:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * DTLS retransmission states, see RFC 6347 4.2.4
 103:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 104:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * The SENDING state is merged in PREPARING for initial sends,
 105:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * but is distinct for resends.
 106:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 107:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Note: initial state is wrong for server, but is not used anyway.
 108:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 109:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_PREPARING       0
 110:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_SENDING         1
 111:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_WAITING         2
 112:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_RETRANS_FINISHED        3
 113:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 114:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 115:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Allow extra bytes for record, authentication and encryption overhead:
 116:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * counter (8) + header (5) + IV(16) + MAC (16-48) + padding (0-256)
 117:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * and allow for a maximum of 1024 of compression expansion if
 118:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * enabled.
 119:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 120:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 121:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_COMPRESSION_ADD          1024
 122:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
 123:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_COMPRESSION_ADD             0
 124:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 125:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 126:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_MODE_CBC)
 127:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Ciphersuites using HMAC */
 128:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
 129:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 48  /* SHA-384 used for HMAC */
 130:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #elif defined(MBEDTLS_SHA256_C)
 131:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 32  /* SHA-256 used for HMAC */
 132:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
 133:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 20  /* SHA-1   used for HMAC */
 134:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 135:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
 136:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* AEAD ciphersuites: GCM and CCM use a 128 bits tag */
 137:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAC_ADD                 16
 138:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 139:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 140:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
 141:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_PADDING_ADD            256
 142:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
 143:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_PADDING_ADD              0
 144:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 145:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 146:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_PAYLOAD_OVERHEAD ( MBEDTLS_SSL_COMPRESSION_ADD +    \
 147:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                        MBEDTLS_MAX_IV_LENGTH +          \
 148:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                        MBEDTLS_SSL_MAC_ADD +            \
 149:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                        MBEDTLS_SSL_PADDING_ADD          \
 150:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                        )
 151:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 152:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_IN_PAYLOAD_LEN ( MBEDTLS_SSL_PAYLOAD_OVERHEAD + \
 153:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                      ( MBEDTLS_SSL_IN_CONTENT_LEN ) )
 154:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 155:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_OUT_PAYLOAD_LEN ( MBEDTLS_SSL_PAYLOAD_OVERHEAD + \
 156:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                       ( MBEDTLS_SSL_OUT_CONTENT_LEN ) )
 157:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 158:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* The maximum number of buffered handshake messages. */
 159:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_MAX_BUFFERED_HS 4
 160:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 161:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Maximum length we can advertise as our max content length for
 162:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****    RFC 6066 max_fragment_length extension negotiation purposes
 163:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****    (the lesser of both sizes, if they are unequal.)
 164:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 165:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_TLS_EXT_ADV_CONTENT_LEN (                            \
 166:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         (MBEDTLS_SSL_IN_CONTENT_LEN > MBEDTLS_SSL_OUT_CONTENT_LEN)   \
 167:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         ? ( MBEDTLS_SSL_OUT_CONTENT_LEN )                            \
 168:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         : ( MBEDTLS_SSL_IN_CONTENT_LEN )                             \
 169:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         )
 170:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 171:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 172:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Check that we obey the standard's message size bounds
 173:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 174:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 175:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if MBEDTLS_SSL_MAX_CONTENT_LEN > 16384
 176:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #error "Bad configuration - record content too large."
 177:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 178:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 179:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if MBEDTLS_SSL_IN_CONTENT_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN
 180:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #error "Bad configuration - incoming record content should not be larger than MBEDTLS_SSL_MAX_CONTE
 181:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 182:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 183:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if MBEDTLS_SSL_OUT_CONTENT_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN
 184:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #error "Bad configuration - outgoing record content should not be larger than MBEDTLS_SSL_MAX_CONTE
 185:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 186:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 187:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if MBEDTLS_SSL_IN_PAYLOAD_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN + 2048
 188:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #error "Bad configuration - incoming protected record payload too large."
 189:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 190:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 191:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if MBEDTLS_SSL_OUT_PAYLOAD_LEN > MBEDTLS_SSL_MAX_CONTENT_LEN + 2048
 192:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #error "Bad configuration - outgoing protected record payload too large."
 193:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 194:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 195:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Calculate buffer sizes */
 196:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 197:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Note: Even though the TLS record header is only 5 bytes
 198:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****    long, we're internally using 8 bytes to store the
 199:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****    implicit sequence number. */
 200:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_HEADER_LEN 13
 201:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 202:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_IN_BUFFER_LEN  \
 203:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     ( ( MBEDTLS_SSL_HEADER_LEN ) + ( MBEDTLS_SSL_IN_PAYLOAD_LEN ) )
 204:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 205:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_OUT_BUFFER_LEN  \
 206:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     ( ( MBEDTLS_SSL_HEADER_LEN ) + ( MBEDTLS_SSL_OUT_PAYLOAD_LEN ) )
 207:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 208:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #ifdef MBEDTLS_ZLIB_SUPPORT
 209:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Compression buffer holds both IN and OUT buffers, so should be size of the larger */
 210:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_SSL_COMPRESS_BUFFER_LEN (                               \
 211:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         ( MBEDTLS_SSL_IN_BUFFER_LEN > MBEDTLS_SSL_OUT_BUFFER_LEN )      \
 212:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         ? MBEDTLS_SSL_IN_BUFFER_LEN                                     \
 213:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         : MBEDTLS_SSL_OUT_BUFFER_LEN                                    \
 214:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         )
 215:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 216:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 217:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 218:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * TLS extension flags (for extensions with outgoing ServerHello content
 219:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * that need it (e.g. for RENEGOTIATION_INFO the server already knows because
 220:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * of state of the renegotiation flag, so no indicator is required)
 221:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 222:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_TLS_EXT_SUPPORTED_POINT_FORMATS_PRESENT (1 << 0)
 223:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #define MBEDTLS_TLS_EXT_ECJPAKE_KKPP_OK                 (1 << 1)
 224:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 225:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #ifdef __cplusplus
 226:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** extern "C" {
 227:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 228:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 229:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 230:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 231:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 232:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Abstraction for a grid of allowed signature-hash-algorithm pairs.
 233:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 234:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** struct mbedtls_ssl_sig_hash_set_t
 235:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 236:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /* At the moment, we only need to remember a single suitable
 237:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * hash algorithm per signature algorithm. As long as that's
 238:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * the case - and we don't need a general lookup function -
 239:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * we can implement the sig-hash-set as a map from signatures
 240:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * to hash algorithms. */
 241:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_md_type_t rsa;
 242:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_md_type_t ecdsa;
 243:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** };
 244:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 &&
 245:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 246:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 247:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 248:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * This structure contains the parameters only needed during handshake.
 249:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 250:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** struct mbedtls_ssl_handshake_params
 251:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 252:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /*
 253:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * Handshake specific crypto variables
 254:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      */
 255:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 256:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 257:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 258:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_sig_hash_set_t hash_algs;             /*!<  Set of suitable sig-hash pairs */
 259:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 260:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_DHM_C)
 261:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_dhm_context dhm_ctx;                /*!<  DHM key exchange        */
 262:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 263:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_ECDH_C)
 264:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ecdh_context ecdh_ctx;              /*!<  ECDH key exchange       */
 265:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 266:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 267:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ecjpake_context ecjpake_ctx;        /*!< EC J-PAKE key exchange */
 268:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_CLI_C)
 269:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char *ecjpake_cache;               /*!< Cache for ClientHello ext */
 270:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t ecjpake_cache_len;                   /*!< Length of cached data */
 271:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 272:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
 273:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
 274:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
 275:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     const mbedtls_ecp_curve_info **curves;      /*!<  Supported elliptic curves */
 276:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 277:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
 278:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char *psk;                 /*!<  PSK from the callback         */
 279:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t psk_len;                     /*!<  Length of PSK from callback   */
 280:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 281:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 282:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;     /*!< chosen key/cert pair (server)  */
 283:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
 284:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int sni_authmode;                   /*!< authmode from SNI callback     */
 285:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_key_cert *sni_key_cert; /*!< key/cert list from SNI         */
 286:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_x509_crt *sni_ca_chain;     /*!< trusted CAs from SNI callback  */
 287:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_x509_crl *sni_ca_crl;       /*!< trusted CAs CRLs from SNI      */
 288:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
 289:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 290:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 291:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 292:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned int out_msg_seq;           /*!<  Outgoing handshake sequence number */
 293:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned int in_msg_seq;            /*!<  Incoming handshake sequence number */
 294:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 295:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char *verify_cookie;       /*!<  Cli: HelloVerifyRequest cookie
 296:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                               Srv: unused                    */
 297:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char verify_cookie_len;    /*!<  Cli: cookie length
 298:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                               Srv: flag for sending a cookie */
 299:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 300:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     uint32_t retransmit_timeout;        /*!<  Current value of timeout       */
 301:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char retransmit_state;     /*!<  Retransmission state           */
 302:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_flight_item *flight;    /*!<  Current outgoing flight        */
 303:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_flight_item *cur_msg;   /*!<  Current message in flight      */
 304:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char *cur_msg_p;           /*!<  Position in current message    */
 305:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned int in_flight_start_seq;   /*!<  Minimum message sequence in the
 306:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                               flight being received          */
 307:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_transform *alt_transform_out;   /*!<  Alternative transform for
 308:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                               resending messages             */
 309:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char alt_out_ctr[8];       /*!<  Alternative record epoch/counter
 310:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                               for resending messages         */
 311:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 312:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     struct
 313:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     {
 314:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         size_t total_bytes_buffered; /*!< Cumulative size of heap allocated
 315:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                       *   buffers used for message buffering. */
 316:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 317:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         uint8_t seen_ccs;               /*!< Indicates if a CCS message has
 318:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                          *   been seen in the current flight. */
 319:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 320:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         struct mbedtls_ssl_hs_buffer
 321:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         {
 322:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             unsigned is_valid      : 1;
 323:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             unsigned is_fragmented : 1;
 324:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             unsigned is_complete   : 1;
 325:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             unsigned char *data;
 326:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             size_t data_len;
 327:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         } hs[MBEDTLS_SSL_MAX_BUFFERED_HS];
 328:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 329:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         struct
 330:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         {
 331:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             unsigned char *data;
 332:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             size_t len;
 333:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****             unsigned epoch;
 334:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         } future_record;
 335:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 336:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     } buffering;
 337:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 338:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     uint16_t mtu;                       /*!<  Handshake mtu, used to fragment outgoing messages */
 339:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 340:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 341:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /*
 342:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * Checksum contexts
 343:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      */
 344:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
 345:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
 346:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****        mbedtls_md5_context fin_md5;
 347:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****       mbedtls_sha1_context fin_sha1;
 348:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 349:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 350:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SHA256_C)
 351:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_sha256_context fin_sha256;
 352:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 353:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SHA512_C)
 354:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_sha512_context fin_sha512;
 355:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 356:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 357:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 358:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     void (*update_checksum)(mbedtls_ssl_context *, const unsigned char *, size_t);
 359:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     void (*calc_verify)(mbedtls_ssl_context *, unsigned char *);
 360:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     void (*calc_finished)(mbedtls_ssl_context *, unsigned char *, int);
 361:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int  (*tls_prf)(const unsigned char *, size_t, const char *,
 362:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                     const unsigned char *, size_t,
 363:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                     unsigned char *, size_t);
 364:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 365:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t pmslen;                      /*!<  premaster length        */
 366:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 367:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char randbytes[64];        /*!<  random bytes            */
 368:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char premaster[MBEDTLS_PREMASTER_SIZE];
 369:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                         /*!<  premaster secret        */
 370:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 371:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int resume;                         /*!<  session resume indicator*/
 372:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int max_major_ver;                  /*!< max. major version client*/
 373:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int max_minor_ver;                  /*!< max. minor version client*/
 374:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int cli_exts;                       /*!< client extension presence*/
 375:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 376:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 377:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int new_session_ticket;             /*!< use NewSessionTicket?    */
 378:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
 379:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
 380:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     int extended_ms;                    /*!< use Extended Master Secret? */
 381:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 382:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 383:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
 384:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned int async_in_progress : 1; /*!< an asynchronous operation is in progress */
 385:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
 386:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 387:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
 388:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /** Asynchronous operation context. This field is meant for use by the
 389:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * asynchronous operation callbacks (mbedtls_ssl_config::f_async_sign_start,
 390:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * mbedtls_ssl_config::f_async_decrypt_start,
 391:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * mbedtls_ssl_config::f_async_resume, mbedtls_ssl_config::f_async_cancel).
 392:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * The library does not use it internally. */
 393:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     void *user_async_ctx;
 394:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
 395:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** };
 396:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 397:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** typedef struct mbedtls_ssl_hs_buffer mbedtls_ssl_hs_buffer;
 398:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 399:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 400:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * This structure contains a full set of runtime transform parameters
 401:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * either in negotiation or active.
 402:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 403:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** struct mbedtls_ssl_transform
 404:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 405:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /*
 406:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * Session specific crypto layer
 407:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      */
 408:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info;
 409:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                         /*!<  Chosen cipersuite_info  */
 410:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned int keylen;                /*!<  symmetric key length (bytes)  */
 411:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t minlen;                      /*!<  min. ciphertext length  */
 412:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t ivlen;                       /*!<  IV length               */
 413:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t fixed_ivlen;                 /*!<  Fixed part of IV (AEAD) */
 414:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t maclen;                      /*!<  MAC length              */
 415:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 416:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char iv_enc[16];           /*!<  IV (encryption)         */
 417:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char iv_dec[16];           /*!<  IV (decryption)         */
 418:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 419:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 420:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /* Needed only for SSL v3.0 secret */
 421:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char mac_enc[20];          /*!<  SSL v3.0 secret (enc)   */
 422:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char mac_dec[20];          /*!<  SSL v3.0 secret (dec)   */
 423:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 424:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 425:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_md_context_t md_ctx_enc;            /*!<  MAC (encryption)        */
 426:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_md_context_t md_ctx_dec;            /*!<  MAC (decryption)        */
 427:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 428:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_cipher_context_t cipher_ctx_enc;    /*!<  encryption context      */
 429:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_cipher_context_t cipher_ctx_dec;    /*!<  decryption context      */
 430:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 431:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     /*
 432:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      * Session specific compression layer
 433:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****      */
 434:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_ZLIB_SUPPORT)
 435:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     z_stream ctx_deflate;               /*!<  compression context     */
 436:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     z_stream ctx_inflate;               /*!<  decompression context   */
 437:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 438:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** };
 439:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 440:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 441:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 442:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * List of certificate + private key pairs
 443:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 444:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** struct mbedtls_ssl_key_cert
 445:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 446:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_x509_crt *cert;                 /*!< cert                       */
 447:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_pk_context *key;                /*!< private key                */
 448:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_key_cert *next;             /*!< next key/cert pair         */
 449:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** };
 450:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 451:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 452:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 453:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 454:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * List of handshake messages kept around for resending
 455:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 456:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** struct mbedtls_ssl_flight_item
 457:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 458:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char *p;       /*!< message, including handshake headers   */
 459:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t len;             /*!< length of p                            */
 460:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     unsigned char type;     /*!< type of the message: handshake or CCS  */
 461:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_flight_item *next;  /*!< next handshake message(s)              */
 462:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** };
 463:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 464:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 465:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
 466:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 467:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 468:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Find an entry in a signature-hash set matching a given hash algorithm. */
 469:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** mbedtls_md_type_t mbedtls_ssl_sig_hash_set_find( mbedtls_ssl_sig_hash_set_t *set,
 470:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                                  mbedtls_pk_type_t sig_alg );
 471:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Add a signature-hash-pair to a signature-hash set */
 472:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_sig_hash_set_add( mbedtls_ssl_sig_hash_set_t *set,
 473:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                    mbedtls_pk_type_t sig_alg,
 474:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                    mbedtls_md_type_t md_alg );
 475:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Allow exactly one hash algorithm for each signature. */
 476:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_sig_hash_set_const_hash( mbedtls_ssl_sig_hash_set_t *set,
 477:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                           mbedtls_md_type_t md_alg );
 478:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 479:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Setup an empty signature-hash set */
 480:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** static inline void mbedtls_ssl_sig_hash_set_init( mbedtls_ssl_sig_hash_set_t *set )
 481:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 482:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_sig_hash_set_const_hash( set, MBEDTLS_MD_NONE );
 483:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 484:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 485:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2) &&
 486:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 487:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 488:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /**
 489:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \brief           Free referenced items in an SSL transform context and clear
 490:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                  memory
 491:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 492:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \param transform SSL transform context
 493:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 494:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_transform_free( mbedtls_ssl_transform *transform );
 495:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 496:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /**
 497:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \brief           Free referenced items in an SSL handshake context and clear
 498:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                  memory
 499:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 500:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \param ssl       SSL context
 501:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 502:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_handshake_free( mbedtls_ssl_context *ssl );
 503:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 504:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_handshake_client_step( mbedtls_ssl_context *ssl );
 505:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_handshake_server_step( mbedtls_ssl_context *ssl );
 506:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_handshake_wrapup( mbedtls_ssl_context *ssl );
 507:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 508:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_send_fatal_handshake_failure( mbedtls_ssl_context *ssl );
 509:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 510:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_reset_checksum( mbedtls_ssl_context *ssl );
 511:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_derive_keys( mbedtls_ssl_context *ssl );
 512:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 513:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_handle_message_type( mbedtls_ssl_context *ssl );
 514:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_prepare_handshake_record( mbedtls_ssl_context *ssl );
 515:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_update_handshake_status( mbedtls_ssl_context *ssl );
 516:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 517:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /**
 518:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \brief       Update record layer
 519:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 520:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              This function roughly separates the implementation
 521:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              of the logic of (D)TLS from the implementation
 522:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              of the secure transport.
 523:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 524:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \param  ssl              The SSL context to use.
 525:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \param  update_hs_digest This indicates if the handshake digest
 526:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                          should be automatically updated in case
 527:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                          a handshake message is found.
 528:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 529:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \return      0 or non-zero error code.
 530:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 531:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \note        A clarification on what is called 'record layer' here
 532:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              is in order, as many sensible definitions are possible:
 533:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 534:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              The record layer takes as input an untrusted underlying
 535:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              transport (stream or datagram) and transforms it into
 536:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              a serially multiplexed, secure transport, which
 537:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              conceptually provides the following:
 538:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 539:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              (1) Three datagram based, content-agnostic transports
 540:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                  for handshake, alert and CCS messages.
 541:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              (2) One stream- or datagram-based transport
 542:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                  for application data.
 543:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              (3) Functionality for changing the underlying transform
 544:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                  securing the contents.
 545:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 546:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              The interface to this functionality is given as follows:
 547:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 548:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              a Updating
 549:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                [Currently implemented by mbedtls_ssl_read_record]
 550:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 551:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                Check if and on which of the four 'ports' data is pending:
 552:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                Nothing, a controlling datagram of type (1), or application
 553:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                data (2). In any case data is present, internal buffers
 554:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                provide access to the data for the user to process it.
 555:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                Consumption of type (1) datagrams is done automatically
 556:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                on the next update, invalidating that the internal buffers
 557:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                for previous datagrams, while consumption of application
 558:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                data (2) is user-controlled.
 559:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 560:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              b Reading of application data
 561:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                [Currently manual adaption of ssl->in_offt pointer]
 562:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 563:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                As mentioned in the last paragraph, consumption of data
 564:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                is different from the automatic consumption of control
 565:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                datagrams (1) because application data is treated as a stream.
 566:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 567:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              c Tracking availability of application data
 568:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                [Currently manually through decreasing ssl->in_msglen]
 569:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 570:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                For efficiency and to retain datagram semantics for
 571:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                application data in case of DTLS, the record layer
 572:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                provides functionality for checking how much application
 573:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *                data is still available in the internal buffer.
 574:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 575:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              d Changing the transformation securing the communication.
 576:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 577:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              Given an opaque implementation of the record layer in the
 578:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              above sense, it should be possible to implement the logic
 579:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              of (D)TLS on top of it without the need to know anything
 580:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              about the record layer's internals. This is done e.g.
 581:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              in all the handshake handling functions, and in the
 582:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              application data reading function mbedtls_ssl_read.
 583:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 584:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * \note        The above tries to give a conceptual picture of the
 585:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              record layer, but the current implementation deviates
 586:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              from it in some places. For example, our implementation of
 587:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              the update functionality through mbedtls_ssl_read_record
 588:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              discards datagrams depending on the current state, which
 589:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              wouldn't fall under the record layer's responsibility
 590:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *              following the above definition.
 591:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 592:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 593:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_read_record( mbedtls_ssl_context *ssl,
 594:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                              unsigned update_hs_digest );
 595:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_fetch_input( mbedtls_ssl_context *ssl, size_t nb_want );
 596:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 597:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_write_handshake_msg( mbedtls_ssl_context *ssl );
 598:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_write_record( mbedtls_ssl_context *ssl, uint8_t force_flush );
 599:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_flush_output( mbedtls_ssl_context *ssl );
 600:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 601:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl );
 602:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl );
 603:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 604:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_parse_change_cipher_spec( mbedtls_ssl_context *ssl );
 605:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_write_change_cipher_spec( mbedtls_ssl_context *ssl );
 606:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 607:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_parse_finished( mbedtls_ssl_context *ssl );
 608:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_write_finished( mbedtls_ssl_context *ssl );
 609:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 610:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_optimize_checksum( mbedtls_ssl_context *ssl,
 611:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                             const mbedtls_ssl_ciphersuite_t *ciphersuite_info );
 612:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 613:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
 614:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_psk_derive_premaster( mbedtls_ssl_context *ssl, mbedtls_key_exchange_type_t key_ex 
 615:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 616:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 617:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_PK_C)
 618:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** unsigned char mbedtls_ssl_sig_from_pk( mbedtls_pk_context *pk );
 619:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** unsigned char mbedtls_ssl_sig_from_pk_alg( mbedtls_pk_type_t type );
 620:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** mbedtls_pk_type_t mbedtls_ssl_pk_alg_from_sig( unsigned char sig );
 621:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 622:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 623:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** mbedtls_md_type_t mbedtls_ssl_md_alg_from_hash( unsigned char hash );
 624:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** unsigned char mbedtls_ssl_hash_from_md_alg( int md );
 625:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_set_calc_verify_md( mbedtls_ssl_context *ssl, int md );
 626:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 627:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_ECP_C)
 628:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_check_curve( const mbedtls_ssl_context *ssl, mbedtls_ecp_group_id grp_id );
 629:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 630:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 631:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
 632:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_check_sig_hash( const mbedtls_ssl_context *ssl,
 633:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                                 mbedtls_md_type_t md );
 634:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 635:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 636:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 637:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** static inline mbedtls_pk_context *mbedtls_ssl_own_key( mbedtls_ssl_context *ssl )
 638:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 639:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;
 640:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 641:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     if( ssl->handshake != NULL && ssl->handshake->key_cert != NULL )
 642:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 643:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     else
 644:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         key_cert = ssl->conf->key_cert;
 645:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 646:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     return( key_cert == NULL ? NULL : key_cert->key );
 647:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 648:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 649:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** static inline mbedtls_x509_crt *mbedtls_ssl_own_cert( mbedtls_ssl_context *ssl )
 650:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 651:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     mbedtls_ssl_key_cert *key_cert;
 652:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 653:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     if( ssl->handshake != NULL && ssl->handshake->key_cert != NULL )
 654:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 655:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     else
 656:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         key_cert = ssl->conf->key_cert;
 657:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 658:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     return( key_cert == NULL ? NULL : key_cert->cert );
 659:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 660:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 661:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /*
 662:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Check usage of a certificate wrt extensions:
 663:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * keyUsage, extendedKeyUsage (later), and nSCertType (later).
 664:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 665:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Warning: cert_endpoint is the endpoint of the cert (ie, of our peer when we
 666:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * check a cert we received from them)!
 667:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  *
 668:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  * Return 0 if everything is OK, -1 if not.
 669:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****  */
 670:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_check_cert_usage( const mbedtls_x509_crt *cert,
 671:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                           const mbedtls_ssl_ciphersuite_t *ciphersuite,
 672:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                           int cert_endpoint,
 673:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                           uint32_t *flags );
 674:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 675:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 676:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_write_version( int major, int minor, int transport,
 677:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                         unsigned char ver[2] );
 678:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_read_version( int *major, int *minor, int transport,
 679:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****                        const unsigned char ver[2] );
 680:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 681:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** static inline size_t mbedtls_ssl_hdr_len( const mbedtls_ssl_context *ssl )
 682:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 683:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 684:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 685:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         return( 13 );
 686:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
 687:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     ((void) ssl);
 688:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 689:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     return( 5 );
 690:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 691:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 692:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** static inline size_t mbedtls_ssl_hs_hdr_len( const mbedtls_ssl_context *ssl )
 693:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
 694:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 695:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
 696:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         return( 12 );
 697:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #else
 698:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     ((void) ssl);
 699:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 700:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     return( 4 );
 701:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 702:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 703:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 704:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_send_flight_completed( mbedtls_ssl_context *ssl );
 705:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_recv_flight_completed( mbedtls_ssl_context *ssl );
 706:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_resend( mbedtls_ssl_context *ssl );
 707:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_flight_transmit( mbedtls_ssl_context *ssl );
 708:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 709:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 710:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* Visible for testing purposes only */
 711:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
 712:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** int mbedtls_ssl_dtls_replay_check( mbedtls_ssl_context *ssl );
 713:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** void mbedtls_ssl_dtls_replay_update( mbedtls_ssl_context *ssl );
 714:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** #endif
 715:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 716:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** /* constant-time buffer comparison */
 717:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** static inline int mbedtls_ssl_safer_memcmp( const void *a, const void *b, size_t n )
 718:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** {
  25              		.loc 1 718 0
  26              		.cfi_startproc
  27              		@ args = 0, pretend = 0, frame = 8
  28              		@ frame_needed = 0, uses_anonymous_args = 0
  29              	.LVL0:
 719:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t i;
 720:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     volatile const unsigned char *A = (volatile const unsigned char *) a;
 721:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     volatile const unsigned char *B = (volatile const unsigned char *) b;
 722:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     volatile unsigned char diff = 0;
  30              		.loc 1 722 0
  31 0000 0030A0E3 		mov	r3, #0
 718:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     size_t i;
  32              		.loc 1 718 0
  33 0004 13402DE9 		push	{r0, r1, r4, lr}
  34              		.cfi_def_cfa_offset 16
  35              		.cfi_offset 4, -8
  36              		.cfi_offset 14, -4
  37              		.loc 1 722 0
  38 0008 0730CDE5 		strb	r3, [sp, #7]
  39              	.LVL1:
  40              	.L2:
 723:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 724:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     for( i = 0; i < n; i++ )
  41              		.loc 1 724 0 discriminator 1
  42 000c 020053E1 		cmp	r3, r2
  43 0010 0200001A 		bne	.L3
 725:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     {
 726:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         /* Read volatile data in order before computing diff.
 727:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****          * This avoids IAR compiler warning:
 728:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****          * 'the order of volatile accesses is undefined ..' */
 729:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         unsigned char x = A[i], y = B[i];
 730:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         diff |= x ^ y;
 731:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     }
 732:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 733:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     return( diff );
  44              		.loc 1 733 0
  45 0014 0700DDE5 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
  46              	.LVL2:
 734:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
  47              		.loc 1 734 0
  48 0018 08D08DE2 		add	sp, sp, #8
  49              		.cfi_remember_state
  50              		.cfi_def_cfa_offset 8
  51              		@ sp needed
  52 001c 1080BDE8 		pop	{r4, pc}
  53              	.LVL3:
  54              	.L3:
  55              		.cfi_restore_state
  56              	.LBB77:
 729:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         diff |= x ^ y;
  57              		.loc 1 729 0 discriminator 3
  58 0020 03E0D0E7 		ldrb	lr, [r0, r3]	@ zero_extendqisi2
  59              	.LVL4:
  60 0024 0340D1E7 		ldrb	r4, [r1, r3]	@ zero_extendqisi2
  61              	.LVL5:
  62              	.LBE77:
 724:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     {
  63              		.loc 1 724 0 discriminator 3
  64 0028 013083E2 		add	r3, r3, #1
  65              	.LVL6:
  66              	.LBB78:
 730:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****     }
  67              		.loc 1 730 0 discriminator 3
  68 002c 07C0DDE5 		ldrb	ip, [sp, #7]	@ zero_extendqisi2
  69 0030 04E02EE0 		eor	lr, lr, r4
  70              	.LVL7:
  71 0034 0EC08CE1 		orr	ip, ip, lr
  72 0038 07C0CDE5 		strb	ip, [sp, #7]
  73 003c F2FFFFEA 		b	.L2
  74              	.LBE78:
  75              		.cfi_endproc
  76              	.LFE20:
  78              		.section	.text.ssl_set_timer,"ax",%progbits
  79              		.align	2
  80              		.syntax unified
  81              		.arm
  82              		.fpu neon
  84              	ssl_set_timer:
  85              	.LFB22:
  86              		.file 2 "D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library/ssl_tls.c"
   1:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
   2:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  SSLv3/TLSv1 shared functions
   3:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
   4:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
   7:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  not use this file except in compliance with the License.
   9:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  You may obtain a copy of the License at
  10:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
  11:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
  13:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  See the License for the specific language governing permissions and
  17:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  limitations under the License.
  18:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
  19:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
  21:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
  22:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  The SSL 3.0 specification was drafted by Netscape in 1996,
  23:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  and became an IETF standard in 1999.
  24:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
  25:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  http://wp.netscape.com/eng/ssl3/
  26:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  http://www.ietf.org/rfc/rfc2246.txt
  27:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  http://www.ietf.org/rfc/rfc4346.txt
  28:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
  29:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  30:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  31:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/config.h"
  32:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
  33:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include MBEDTLS_CONFIG_FILE
  34:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
  35:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  36:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_TLS_C)
  37:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  38:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_PLATFORM_C)
  39:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/platform.h"
  40:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
  41:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include <stdlib.h>
  42:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define mbedtls_calloc    calloc
  43:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define mbedtls_free      free
  44:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
  45:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  46:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/debug.h"
  47:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/ssl.h"
  48:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/ssl_internal.h"
  49:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/platform_util.h"
  50:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  51:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include <string.h>
  52:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  53:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
  54:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #include "mbedtls/oid.h"
  55:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
  56:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  57:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_reset_in_out_pointers( mbedtls_ssl_context *ssl );
  58:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static uint32_t ssl_get_hs_total_len( mbedtls_ssl_context const *ssl );
  59:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  60:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Length of the "epoch" field in the record header */
  61:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static inline size_t ssl_ep_len( const mbedtls_ssl_context *ssl )
  62:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
  63:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
  64:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
  65:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 2 );
  66:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
  67:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ssl);
  68:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
  69:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
  70:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
  71:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  72:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
  73:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Start a timer.
  74:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Passing millisecs = 0 cancels a running timer.
  75:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
  76:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_set_timer( mbedtls_ssl_context *ssl, uint32_t millisecs )
  77:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
  87              		.loc 2 77 0
  88              		.cfi_startproc
  89              		@ args = 0, pretend = 0, frame = 0
  90              		@ frame_needed = 0, uses_anonymous_args = 0
  91              		@ link register save eliminated.
  92              	.LVL8:
  78:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->f_set_timer == NULL )
  93              		.loc 2 78 0
  94 0000 483090E5 		ldr	r3, [r0, #72]
  77:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->f_set_timer == NULL )
  95              		.loc 2 77 0
  96 0004 0120A0E1 		mov	r2, r1
  97              		.loc 2 78 0
  98 0008 000053E3 		cmp	r3, #0
  99 000c 1EFF2F01 		bxeq	lr
  79:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
  80:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  81:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "set_timer to %d ms", (int) millisecs ) );
  82:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_set_timer( ssl->p_timer, millisecs / 4, millisecs );
 100              		.loc 2 82 0
 101 0010 2111A0E1 		lsr	r1, r1, #2
 102              	.LVL9:
 103 0014 440090E5 		ldr	r0, [r0, #68]
 104              	.LVL10:
 105 0018 13FF2FE1 		bx	r3	@ indirect register sibling call
 106              	.LVL11:
 107              		.cfi_endproc
 108              	.LFE22:
 110              		.section	.text.ssl_update_out_pointers,"ax",%progbits
 111              		.align	2
 112              		.syntax unified
 113              		.arm
 114              		.fpu neon
 116              	ssl_update_out_pointers:
 117              	.LFB66:
  83:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
  84:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  85:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
  86:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Return -1 is timer is expired, 0 if it isn't.
  87:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
  88:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_check_timer( mbedtls_ssl_context *ssl )
  89:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
  90:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->f_get_timer == NULL )
  91:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
  92:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  93:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->f_get_timer( ssl->p_timer ) == 2 )
  94:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
  95:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "timer expired" ) );
  96:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
  97:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
  98:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
  99:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
 100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_out_pointers( mbedtls_ssl_context *ssl,
 103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                      mbedtls_ssl_transform *transform );
 104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_in_pointers( mbedtls_ssl_context *ssl,
 105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     mbedtls_ssl_transform *transform );
 106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define SSL_DONT_FORCE_FLUSH 0
 108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define SSL_FORCE_FLUSH      1
 109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Forward declarations for functions related to message buffering. */
 113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_buffering_free( mbedtls_ssl_context *ssl );
 114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_buffering_free_slot( mbedtls_ssl_context *ssl,
 115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                      uint8_t slot );
 116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_free_buffered_record( mbedtls_ssl_context *ssl );
 117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_load_buffered_message( mbedtls_ssl_context *ssl );
 118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_load_buffered_record( mbedtls_ssl_context *ssl );
 119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_buffer_message( mbedtls_ssl_context *ssl );
 120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_buffer_future_record( mbedtls_ssl_context *ssl );
 121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_next_record_is_in_datagram( mbedtls_ssl_context *ssl );
 122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static size_t ssl_get_current_mtu( const mbedtls_ssl_context *ssl );
 124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static size_t ssl_get_maximum_datagram_size( mbedtls_ssl_context const *ssl )
 125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t mtu = ssl_get_current_mtu( ssl );
 127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mtu != 0 && mtu < MBEDTLS_SSL_OUT_BUFFER_LEN )
 129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( mtu );
 130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_SSL_OUT_BUFFER_LEN );
 132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_get_remaining_space_in_datagram( mbedtls_ssl_context const *ssl )
 135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t const bytes_written = ssl->out_left;
 137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t const mtu           = ssl_get_maximum_datagram_size( ssl );
 138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Double-check that the write-index hasn't gone
 140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * past what we can transmit in a single datagram. */
 141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( bytes_written > mtu )
 142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Should never happen... */
 144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( (int) ( mtu - bytes_written ) );
 148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_get_remaining_payload_in_datagram( mbedtls_ssl_context const *ssl )
 151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t remaining, expansion;
 154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t max_len = MBEDTLS_SSL_OUT_CONTENT_LEN;
 155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
 157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const size_t mfl = mbedtls_ssl_get_max_frag_len( ssl );
 158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( max_len > mfl )
 160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         max_len = mfl;
 161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* By the standard (RFC 6066 Sect. 4), the MFL extension
 163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * only limits the maximum record payload size, so in theory
 164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * we would be allowed to pack multiple records of payload size
 165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * MFL into a single datagram. However, this would mean that there's
 166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * no way to explicitly communicate MTU restrictions to the peer.
 167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
 168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * The following reduction of max_len makes sure that we never
 169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * write datagrams larger than MFL + Record Expansion Overhead.
 170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( max_len <= ssl->out_left )
 172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
 173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     max_len -= ssl->out_left;
 175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = ssl_get_remaining_space_in_datagram( ssl );
 178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret < 0 )
 179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     remaining = (size_t) ret;
 181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = mbedtls_ssl_get_record_expansion( ssl );
 183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret < 0 )
 184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     expansion = (size_t) ret;
 186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( remaining <= expansion )
 188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
 189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     remaining -= expansion;
 191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( remaining >= max_len )
 192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         remaining = max_len;
 193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( (int) remaining );
 195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
 198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Double the retransmit timeout value, within the allowed range,
 199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * returning -1 if the maximum value has already been reached.
 200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
 201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_double_retransmit_timeout( mbedtls_ssl_context *ssl )
 202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint32_t new_timeout;
 204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->retransmit_timeout >= ssl->conf->hs_timeout_max )
 206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
 207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Implement the final paragraph of RFC 6347 section 4.1.1.1
 209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * in the following way: after the initial transmission and a first
 210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * retransmission, back off to a temporary estimated MTU of 508 bytes.
 211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * This value is guaranteed to be deliverable (if not guaranteed to be
 212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * delivered) of any compliant IPv4 (and IPv6) network, and should work
 213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * on most non-IP stacks too. */
 214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->retransmit_timeout != ssl->conf->hs_timeout_min )
 215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->mtu = 508;
 217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "mtu autoreduction to %d bytes", ssl->handshake->mtu ) );
 218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_timeout = 2 * ssl->handshake->retransmit_timeout;
 221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Avoid arithmetic overflow and range overflow */
 223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( new_timeout < ssl->handshake->retransmit_timeout ||
 224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         new_timeout > ssl->conf->hs_timeout_max )
 225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         new_timeout = ssl->conf->hs_timeout_max;
 227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->retransmit_timeout = new_timeout;
 230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "update timeout value to %d millisecs",
 231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ssl->handshake->retransmit_timeout ) );
 232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
 234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_reset_retransmit_timeout( mbedtls_ssl_context *ssl )
 237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->retransmit_timeout = ssl->conf->hs_timeout_min;
 239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "update timeout value to %d millisecs",
 240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ssl->handshake->retransmit_timeout ) );
 241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
 243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
 245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
 246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Convert max_fragment_length codes to length.
 247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * RFC 6066 says:
 248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *    enum{
 249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *        2^9(1), 2^10(2), 2^11(3), 2^12(4), (255)
 250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *    } MaxFragmentLength;
 251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * and we add 0 -> extension unused
 252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
 253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static unsigned int ssl_mfl_code_to_length( int mfl )
 254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( mfl )
 256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_NONE:
 258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return ( MBEDTLS_TLS_EXT_ADV_CONTENT_LEN );
 259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_512:
 260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return 512;
 261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_1024:
 262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return 1024;
 263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_2048:
 264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return 2048;
 265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     case MBEDTLS_SSL_MAX_FRAG_LEN_4096:
 266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return 4096;
 267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     default:
 268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return ( MBEDTLS_TLS_EXT_ADV_CONTENT_LEN );
 269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
 272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
 274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_session_copy( mbedtls_ssl_session *dst, const mbedtls_ssl_session *src )
 275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session_free( dst );
 277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( dst, src, sizeof( mbedtls_ssl_session ) );
 278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
 280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( src->peer_cert != NULL )
 281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
 283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dst->peer_cert = mbedtls_calloc( 1, sizeof(mbedtls_x509_crt) );
 285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( dst->peer_cert == NULL )
 286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_x509_crt_init( dst->peer_cert );
 289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_x509_crt_parse_der( dst->peer_cert, src->peer_cert->raw.p,
 291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_free( dst->peer_cert );
 294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dst->peer_cert = NULL;
 295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
 296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS) && defined(MBEDTLS_SSL_CLI_C)
 301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( src->ticket != NULL )
 302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dst->ticket = mbedtls_calloc( 1, src->ticket_len );
 304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( dst->ticket == NULL )
 305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( dst->ticket, src->ticket, src->ticket_len );
 308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS && MBEDTLS_SSL_CLI_C */
 310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
 312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
 314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
 316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int (*mbedtls_ssl_hw_record_init)( mbedtls_ssl_context *ssl,
 317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *key_enc, const unsigned char *key_dec,
 318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      size_t keylen,
 319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *iv_enc,  const unsigned char *iv_dec,
 320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      size_t ivlen,
 321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *mac_enc, const unsigned char *mac_dec,
 322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      size_t maclen ) = NULL;
 323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int (*mbedtls_ssl_hw_record_activate)( mbedtls_ssl_context *ssl, int direction) = NULL;
 324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int (*mbedtls_ssl_hw_record_reset)( mbedtls_ssl_context *ssl ) = NULL;
 325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int (*mbedtls_ssl_hw_record_write)( mbedtls_ssl_context *ssl ) = NULL;
 326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int (*mbedtls_ssl_hw_record_read)( mbedtls_ssl_context *ssl ) = NULL;
 327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int (*mbedtls_ssl_hw_record_finish)( mbedtls_ssl_context *ssl ) = NULL;
 328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
 329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
 331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Key material generation
 332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
 333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl3_prf( const unsigned char *secret, size_t slen,
 335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const char *label,
 336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *random, size_t rlen,
 337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      unsigned char *dstbuf, size_t dlen )
 338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t i;
 341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_context md5;
 342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_context sha1;
 343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char padding[16];
 344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char sha1sum[20];
 345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void)label);
 346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_init(  &md5  );
 348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
 349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  SSLv3:
 352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *    block =
 353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( secret + SHA1( 'A'    + secret + random ) ) +
 354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( secret + SHA1( 'BB'   + secret + random ) ) +
 355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( secret + SHA1( 'CCC'  + secret + random ) ) +
 356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      ...
 357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( i = 0; i < dlen / 16; i++ )
 359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( padding, (unsigned char) ('A' + i), 1 + i );
 361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_sha1_starts_ret( &sha1 ) ) != 0 )
 363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_sha1_update_ret( &sha1, padding, 1 + i ) ) != 0 )
 365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_sha1_update_ret( &sha1, secret, slen ) ) != 0 )
 367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_sha1_update_ret( &sha1, random, rlen ) ) != 0 )
 369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_sha1_finish_ret( &sha1, sha1sum ) ) != 0 )
 371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_md5_starts_ret( &md5 ) ) != 0 )
 374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_md5_update_ret( &md5, secret, slen ) ) != 0 )
 376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_md5_update_ret( &md5, sha1sum, 20 ) ) != 0 )
 378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_md5_finish_ret( &md5, dstbuf + i * 16 ) ) != 0 )
 380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
 381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** exit:
 384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free(  &md5  );
 385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
 386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( padding, sizeof( padding ) );
 388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( sha1sum, sizeof( sha1sum ) );
 389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
 391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
 395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int tls1_prf( const unsigned char *secret, size_t slen,
 396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const char *label,
 397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *random, size_t rlen,
 398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      unsigned char *dstbuf, size_t dlen )
 399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t nb, hs;
 401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t i, j, k;
 402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const unsigned char *S1, *S2;
 403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char tmp[128];
 404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char h_i[20];
 405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_md_info_t *md_info;
 406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_context_t md_ctx;
 407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_init( &md_ctx );
 410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( sizeof( tmp ) < 20 + strlen( label ) + rlen )
 412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hs = ( slen + 1 ) / 2;
 415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     S1 = secret;
 416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     S2 = secret + slen - hs;
 417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     nb = strlen( label );
 419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp + 20, label, nb );
 420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp + 20 + nb, random, rlen );
 421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     nb += rlen;
 422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * First compute P_md5(secret,label+random)[0..dlen]
 425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( md_info = mbedtls_md_info_from_type( MBEDTLS_MD_MD5 ) ) == NULL )
 427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 1 ) ) != 0 )
 430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_starts( &md_ctx, S1, hs );
 433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + 20, nb );
 434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, 4 + tmp );
 435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( i = 0; i < dlen; i += 16 )
 437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, 4 + tmp, 16 + nb );
 440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, 4 + tmp, 16 );
 444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, 4 + tmp );
 445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         k = ( i + 16 > dlen ) ? dlen % 16 : 16;
 447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( j = 0; j < k; j++ )
 449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &md_ctx );
 453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * XOR out with P_sha1(secret,label+random)[0..dlen]
 456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( md_info = mbedtls_md_info_from_type( MBEDTLS_MD_SHA1 ) ) == NULL )
 458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_setup( &md_ctx, md_info, 1 ) ) != 0 )
 461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_starts( &md_ctx, S2, hs );
 464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + 20, nb );
 465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, tmp );
 466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( i = 0; i < dlen; i += 20 )
 468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, 20 + nb );
 471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, 20 );
 475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, tmp );
 476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         k = ( i + 20 > dlen ) ? dlen % 20 : 20;
 478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( j = 0; j < k; j++ )
 480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dstbuf[i + j] = (unsigned char)( dstbuf[i + j] ^ h_i[j] );
 481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &md_ctx );
 484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( h_i, sizeof( h_i ) );
 487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
 489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1) || MBEDTLS_SSL_PROTO_TLS1_1 */
 491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int tls_prf_generic( mbedtls_md_type_t md_type,
 494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             const unsigned char *secret, size_t slen,
 495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             const char *label,
 496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             const unsigned char *random, size_t rlen,
 497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             unsigned char *dstbuf, size_t dlen )
 498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t nb;
 500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t i, j, k, md_len;
 501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char tmp[128];
 502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char h_i[MBEDTLS_MD_MAX_SIZE];
 503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_md_info_t *md_info;
 504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_context_t md_ctx;
 505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_init( &md_ctx );
 508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( md_info = mbedtls_md_info_from_type( md_type ) ) == NULL )
 510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     md_len = mbedtls_md_get_size( md_info );
 513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( sizeof( tmp ) < md_len + strlen( label ) + rlen )
 515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     nb = strlen( label );
 518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp + md_len, label, nb );
 519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp + md_len + nb, random, rlen );
 520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     nb += rlen;
 521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Compute P_<hash>(secret, label + random)[0..dlen]
 524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if ( ( ret = mbedtls_md_setup( &md_ctx, md_info, 1 ) ) != 0 )
 526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_starts( &md_ctx, secret, slen );
 529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + md_len, nb );
 530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, tmp );
 531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( i = 0; i < dlen; i += md_len )
 533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len + nb );
 536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_reset ( &md_ctx );
 539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len );
 540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, tmp );
 541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         k = ( i + md_len > dlen ) ? dlen % md_len : md_len;
 543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( j = 0; j < k; j++ )
 545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &md_ctx );
 549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( h_i, sizeof( h_i ) );
 552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
 554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
 557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int tls_prf_sha256( const unsigned char *secret, size_t slen,
 558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const char *label,
 559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const unsigned char *random, size_t rlen,
 560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            unsigned char *dstbuf, size_t dlen )
 561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA256, secret, slen,
 563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              label, random, rlen, dstbuf, dlen ) );
 564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
 566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int tls_prf_sha384( const unsigned char *secret, size_t slen,
 569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const char *label,
 570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const unsigned char *random, size_t rlen,
 571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            unsigned char *dstbuf, size_t dlen )
 572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA384, secret, slen,
 574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              label, random, rlen, dstbuf, dlen ) );
 575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA512_C */
 577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_start( mbedtls_ssl_context *, const unsigned char *, size_t );
 580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
 582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
 583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_md5sha1( mbedtls_ssl_context *, const unsigned char *, size_t );
 584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_verify_ssl( mbedtls_ssl_context *, unsigned char * );
 588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_ssl( mbedtls_ssl_context *, unsigned char *, int );
 589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
 592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_verify_tls( mbedtls_ssl_context *, unsigned char * );
 593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_tls( mbedtls_ssl_context *, unsigned char *, int );
 594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
 598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_sha256( mbedtls_ssl_context *, const unsigned char *, size_t );
 599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_verify_tls_sha256( mbedtls_ssl_context *,unsigned char * );
 600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_tls_sha256( mbedtls_ssl_context *,unsigned char *, int );
 601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_sha384( mbedtls_ssl_context *, const unsigned char *, size_t );
 605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_verify_tls_sha384( mbedtls_ssl_context *, unsigned char * );
 606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_tls_sha384( mbedtls_ssl_context *, unsigned char *, int );
 607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_derive_keys( mbedtls_ssl_context *ssl )
 611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char tmp[64];
 614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char keyblk[256];
 615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *key1;
 616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *key2;
 617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *mac_enc;
 618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *mac_dec;
 619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t mac_key_len;
 620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t iv_copy_len;
 621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_cipher_info_t *cipher_info;
 622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_md_info_t *md_info;
 623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
 625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_transform *transform = ssl->transform_negotiate;
 626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params *handshake = ssl->handshake;
 627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> derive keys" ) );
 629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     cipher_info = mbedtls_cipher_info_from_type( transform->ciphersuite_info->cipher );
 631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cipher_info == NULL )
 632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "cipher info for %d not found",
 634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             transform->ciphersuite_info->cipher ) );
 635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     md_info = mbedtls_md_info_from_type( transform->ciphersuite_info->mac );
 639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( md_info == NULL )
 640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "mbedtls_md info for %d not found",
 642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             transform->ciphersuite_info->mac ) );
 643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Set appropriate PRF function and other SSL / TLS / TLS1.2 functions
 648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->tls_prf = ssl3_prf;
 653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_ssl;
 654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_ssl;
 655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
 659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_3 )
 660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->tls_prf = tls1_prf;
 662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls;
 663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls;
 664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 &&
 670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->ciphersuite_info->mac == MBEDTLS_MD_SHA384 )
 671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->tls_prf = tls_prf_sha384;
 673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls_sha384;
 674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls_sha384;
 675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
 679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->tls_prf = tls_prf_sha256;
 682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls_sha256;
 683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls_sha256;
 684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * SSLv3:
 695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   master =
 696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     MD5( premaster + SHA1( 'A'   + premaster + randbytes ) ) +
 697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     MD5( premaster + SHA1( 'BB'  + premaster + randbytes ) ) +
 698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     MD5( premaster + SHA1( 'CCC' + premaster + randbytes ) )
 699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
 700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * TLSv1+:
 701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   master = PRF( premaster, "master secret", randbytes )[0..47]
 702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( handshake->resume == 0 )
 704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 3, "premaster secret", handshake->premaster,
 706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        handshake->pmslen );
 707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
 709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->handshake->extended_ms == MBEDTLS_SSL_EXTENDED_MS_ENABLED )
 710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char session_hash[48];
 712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t hash_len;
 713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "using extended master secret" ) );
 715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->calc_verify( ssl, session_hash );
 717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
 719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
 722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->transform_negotiate->ciphersuite_info->mac ==
 723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_MD_SHA384 )
 724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
 725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     hash_len = 48;
 726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
 727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 else
 728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     hash_len = 32;
 730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
 732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
 733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 hash_len = 36;
 734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 3, "session hash", session_hash, hash_len );
 736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = handshake->tls_prf( handshake->premaster, handshake->pmslen,
 738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       "extended master secret",
 739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       session_hash, hash_len,
 740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       session->master, 48 );
 741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret != 0 )
 742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "prf", ret );
 744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
 745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
 749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = handshake->tls_prf( handshake->premaster, handshake->pmslen,
 751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   "master secret",
 752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   handshake->randbytes, 64,
 753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   session->master, 48 );
 754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != 0 )
 755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "prf", ret );
 757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
 758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( handshake->premaster,
 761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   sizeof(handshake->premaster) );
 762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "no premaster (session resumed)" ) );
 765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Swap the client and server random values.
 768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp, handshake->randbytes, 64 );
 770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( handshake->randbytes, tmp + 32, 32 );
 771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( handshake->randbytes + 32, tmp, 32 );
 772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  SSLv3:
 776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *    key block =
 777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( master + SHA1( 'A'    + master + randbytes ) ) +
 778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( master + SHA1( 'BB'   + master + randbytes ) ) +
 779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( master + SHA1( 'CCC'  + master + randbytes ) ) +
 780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( master + SHA1( 'DDDD' + master + randbytes ) ) +
 781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      ...
 782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
 783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  TLSv1:
 784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *    key block = PRF( master, "key expansion", randbytes )
 785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = handshake->tls_prf( session->master, 48, "key expansion",
 787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               handshake->randbytes, 64, keyblk, 256 );
 788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != 0 )
 789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "prf", ret );
 791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "ciphersuite = %s",
 795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    mbedtls_ssl_get_ciphersuite_name( session->ciphersuite ) ) );
 796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "master secret", session->master, 48 );
 797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "random bytes", handshake->randbytes, 64 );
 798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "key block", keyblk, 256 );
 799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( handshake->randbytes,
 801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               sizeof( handshake->randbytes ) );
 802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Determine the appropriate key, IV and MAC length.
 805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     transform->keylen = cipher_info->key_bitlen / 8;
 808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cipher_info->mode == MBEDTLS_MODE_GCM ||
 810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CCM ||
 811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t taglen, explicit_ivlen;
 814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->maclen = 0;
 816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_key_len = 0;
 817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* All modes haves 96-bit IVs;
 819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * GCM and CCM has 4 implicit and 8 explicit bytes
 820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * ChachaPoly has all 12 bytes implicit
 821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
 822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->ivlen = 12;
 823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->fixed_ivlen = 12;
 825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
 826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->fixed_ivlen = 4;
 827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* All modes have 128-bit tags, except CCM_8 (ciphersuite flag) */
 829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         taglen = transform->ciphersuite_info->flags &
 830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Minimum length of encrypted record */
 834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         explicit_ivlen = transform->ivlen - transform->fixed_ivlen;
 835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->minlen = explicit_ivlen + taglen;
 836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Initialize HMAC contexts */
 840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_md_setup( &transform->md_ctx_enc, md_info, 1 ) ) != 0 ||
 841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ret = mbedtls_md_setup( &transform->md_ctx_dec, md_info, 1 ) ) != 0 )
 842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_setup", ret );
 844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
 845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Get MAC length */
 848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_key_len = mbedtls_md_get_size( md_info );
 849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->maclen = mac_key_len;
 850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
 852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
 853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * If HMAC is to be truncated, we shall keep the leftmost bytes,
 854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * (rfc 6066 page 13 or rfc 2104 section 4),
 855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * so we only need to adjust the length here.
 856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
 857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( session->trunc_hmac == MBEDTLS_SSL_TRUNC_HMAC_ENABLED )
 858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->maclen = MBEDTLS_SSL_TRUNCATED_HMAC_LEN;
 860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC_COMPAT)
 862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Fall back to old, non-compliant version of the truncated
 863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * HMAC implementation which also truncates the key
 864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * (Mbed TLS versions from 1.3 to 2.6.0) */
 865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mac_key_len = transform->maclen;
 866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
 869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* IV length */
 871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->ivlen = cipher_info->iv_size;
 872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Minimum length */
 874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( cipher_info->mode == MBEDTLS_MODE_STREAM )
 875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->minlen = transform->maclen;
 876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
 877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
 879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * GenericBlockCipher:
 880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * 1. if EtM is in use: one block plus MAC
 881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *    otherwise: * first multiple of blocklen greater than maclen
 882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * 2. IV except for SSL3 and TLS 1.0
 883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
 884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
 885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( session->encrypt_then_mac == MBEDTLS_SSL_ETM_ENABLED )
 886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 transform->minlen = transform->maclen
 888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   + cipher_info->block_size;
 889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
 891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 transform->minlen = transform->maclen
 894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   + cipher_info->block_size
 895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   - transform->maclen % cipher_info->block_size;
 896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1)
 899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ||
 900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_1 )
 901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ; /* No need to adjust minlen */
 902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
 903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
 905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_2 ||
 906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 transform->minlen += transform->ivlen;
 909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
 911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "keylen: %d, minlen: %d, ivlen: %d, maclen: %d",
 920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    transform->keylen, transform->minlen, transform->ivlen,
 921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    transform->maclen ) );
 922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Finally setup the cipher contexts, IVs and MAC secrets.
 925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
 926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
 927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
 928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         key1 = keyblk + mac_key_len * 2;
 930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         key2 = keyblk + mac_key_len * 2 + transform->keylen;
 931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_enc = keyblk;
 933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_dec = keyblk + mac_key_len;
 934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
 936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * This is not used in TLS v1.1.
 937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
 938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         iv_copy_len = ( transform->fixed_ivlen ) ?
 939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             transform->fixed_ivlen : transform->ivlen;
 940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_enc, key2 + transform->keylen,  iv_copy_len );
 941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_dec, key2 + transform->keylen + iv_copy_len,
 942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv_copy_len );
 943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
 946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
 947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
 948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         key1 = keyblk + mac_key_len * 2 + transform->keylen;
 950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         key2 = keyblk + mac_key_len * 2;
 951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_enc = keyblk + mac_key_len;
 953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_dec = keyblk;
 954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
 956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * This is not used in TLS v1.1.
 957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
 958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         iv_copy_len = ( transform->fixed_ivlen ) ?
 959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             transform->fixed_ivlen : transform->ivlen;
 960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_dec, key1 + transform->keylen,  iv_copy_len );
 961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_enc, key1 + transform->keylen + iv_copy_len,
 962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv_copy_len );
 963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
 966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
 972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
 973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mac_key_len > sizeof transform->mac_enc )
 975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
 977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->mac_enc, mac_enc, mac_key_len );
 981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->mac_dec, mac_dec, mac_key_len );
 982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
 985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
 986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
 987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 )
 988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* For HMAC-based ciphersuites, initialize the HMAC transforms.
 990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****            For AEAD-based ciphersuites, there is nothing to do here. */
 991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mac_key_len != 0 )
 992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_starts( &transform->md_ctx_enc, mac_enc, mac_key_len );
 994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_starts( &transform->md_ctx_dec, mac_dec, mac_key_len );
 995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
1005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_init != NULL )
1006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret = 0;
1008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_init()" ) );
1010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_init( ssl, key1, key2, transform->keylen,
1012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         transform->iv_enc, transform->iv_dec,
1013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         iv_copy_len,
1014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         mac_enc, mac_dec,
1015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         mac_key_len ) ) != 0 )
1016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_init", ret );
1018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
1019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
1022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_EXPORT_KEYS)
1024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->f_export_keys != NULL )
1025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->f_export_keys( ssl->conf->p_export_keys,
1027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   session->master, keyblk,
1028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   mac_key_len, transform->keylen,
1029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   iv_copy_len );
1030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_cipher_setup( &transform->cipher_ctx_enc,
1034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  cipher_info ) ) != 0 )
1035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setup", ret );
1037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
1038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_cipher_setup( &transform->cipher_ctx_dec,
1041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  cipher_info ) ) != 0 )
1042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setup", ret );
1044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
1045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_cipher_setkey( &transform->cipher_ctx_enc, key1,
1048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                cipher_info->key_bitlen,
1049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_ENCRYPT ) ) != 0 )
1050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setkey", ret );
1052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
1053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_cipher_setkey( &transform->cipher_ctx_dec, key2,
1056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                cipher_info->key_bitlen,
1057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_DECRYPT ) ) != 0 )
1058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_setkey", ret );
1060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
1061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
1064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cipher_info->mode == MBEDTLS_MODE_CBC )
1065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_set_padding_mode( &transform->cipher_ctx_enc,
1067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                              MBEDTLS_PADDING_NONE ) ) != 0 )
1068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_set_padding_mode", ret );
1070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_set_padding_mode( &transform->cipher_ctx_dec,
1074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                              MBEDTLS_PADDING_NONE ) ) != 0 )
1075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_set_padding_mode", ret );
1077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_CIPHER_MODE_CBC */
1081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( keyblk, sizeof( keyblk ) );
1083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
1085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     // Initialize compression
1086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     //
1087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( session->compression == MBEDTLS_SSL_COMPRESS_DEFLATE )
1088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->compress_buf == NULL )
1090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "Allocating compression buffer" ) );
1092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->compress_buf = mbedtls_calloc( 1, MBEDTLS_SSL_COMPRESS_BUFFER_LEN );
1093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->compress_buf == NULL )
1094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
1095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed",
1096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_COMPRESS_BUFFER_LEN ) );
1097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
1098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
1099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "Initializing zlib states" ) );
1102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( &transform->ctx_deflate, 0, sizeof( transform->ctx_deflate ) );
1104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( &transform->ctx_inflate, 0, sizeof( transform->ctx_inflate ) );
1105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( deflateInit( &transform->ctx_deflate,
1107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          Z_DEFAULT_COMPRESSION )   != Z_OK ||
1108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             inflateInit( &transform->ctx_inflate ) != Z_OK )
1109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "Failed to initialize compression" ) );
1111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COMPRESSION_FAILED );
1112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ZLIB_SUPPORT */
1115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= derive keys" ) );
1117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
1119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
1122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void ssl_calc_verify_ssl( mbedtls_ssl_context *ssl, unsigned char hash[36] )
1123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_context md5;
1125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_context sha1;
1126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char pad_1[48];
1127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char pad_2[48];
1128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify ssl" ) );
1130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_init( &md5 );
1132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
1133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
1135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
1136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( pad_1, 0x36, 48 );
1138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( pad_2, 0x5C, 48 );
1139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, ssl->session_negotiate->master, 48 );
1141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, pad_1, 48 );
1142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, hash );
1143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_starts_ret( &md5 );
1145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, ssl->session_negotiate->master, 48 );
1146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, pad_2, 48 );
1147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, hash,  16 );
1148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, hash );
1149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, ssl->session_negotiate->master, 48 );
1151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, pad_1, 40 );
1152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, hash + 16 );
1153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_starts_ret( &sha1 );
1155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, ssl->session_negotiate->master, 48 );
1156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, pad_2, 40 );
1157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, hash + 16, 20 );
1158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, hash + 16 );
1159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 36 );
1161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free(  &md5  );
1164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
1165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return;
1167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
1169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
1171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void ssl_calc_verify_tls( mbedtls_ssl_context *ssl, unsigned char hash[36] )
1172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_context md5;
1174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_context sha1;
1175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify tls" ) );
1177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_init( &md5 );
1179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
1180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
1182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
1183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      mbedtls_md5_finish_ret( &md5,  hash );
1185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, hash + 16 );
1186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 36 );
1188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free(  &md5  );
1191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
1192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return;
1194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 */
1196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
1198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
1199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void ssl_calc_verify_tls_sha256( mbedtls_ssl_context *ssl, unsigned char hash[32] )
1200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_context sha256;
1202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_init( &sha256 );
1204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify sha256" ) );
1206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_clone( &sha256, &ssl->handshake->fin_sha256 );
1208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_finish_ret( &sha256, hash );
1209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 32 );
1211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_free( &sha256 );
1214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return;
1216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
1218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
1220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void ssl_calc_verify_tls_sha384( mbedtls_ssl_context *ssl, unsigned char hash[48] )
1221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_context sha512;
1223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_init( &sha512 );
1225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc verify sha384" ) );
1227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_clone( &sha512, &ssl->handshake->fin_sha512 );
1229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_finish_ret( &sha512, hash );
1230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calculated verify result", hash, 48 );
1232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc verify" ) );
1233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_free( &sha512 );
1235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return;
1237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA512_C */
1239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
1240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
1242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_psk_derive_premaster( mbedtls_ssl_context *ssl, mbedtls_key_exchange_type_t key_ex 
1243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *p = ssl->handshake->premaster;
1245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *end = p + sizeof( ssl->handshake->premaster );
1246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const unsigned char *psk = ssl->conf->psk;
1247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t psk_len = ssl->conf->psk_len;
1248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* If the psk callback was called, use its result */
1250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->psk != NULL )
1251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         psk = ssl->handshake->psk;
1253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         psk_len = ssl->handshake->psk_len;
1254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
1257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * PMS = struct {
1258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     opaque other_secret<0..2^16-1>;
1259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     opaque psk<0..2^16-1>;
1260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * };
1261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * with "other_secret" depending on the particular key exchange
1262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
1263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)
1264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_PSK )
1265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( end - p < 2 )
1267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *(p++) = (unsigned char)( psk_len >> 8 );
1270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *(p++) = (unsigned char)( psk_len      );
1271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( end < p || (size_t)( end - p ) < psk_len )
1273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( p, 0, psk_len );
1276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         p += psk_len;
1277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_PSK_ENABLED */
1280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
1281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
1282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * other_secret already set by the ClientKeyExchange message,
1285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * and is 48 bytes long
1286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( end - p < 2 )
1288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *p++ = 0;
1291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *p++ = 48;
1292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         p += 48;
1293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED */
1296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
1297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_DHE_PSK )
1298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t len;
1301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Write length only when we know the actual value */
1303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_dhm_calc_secret( &ssl->handshake->dhm_ctx,
1304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       p + 2, end - ( p + 2 ), &len,
1305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
1306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_dhm_calc_secret", ret );
1308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *(p++) = (unsigned char)( len >> 8 );
1311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *(p++) = (unsigned char)( len );
1312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         p += len;
1313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MPI( 3, "DHM: K ", &ssl->handshake->dhm_ctx.K  );
1315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
1318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
1319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( key_ex == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK )
1320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t zlen;
1323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ecdh_calc_secret( &ssl->handshake->ecdh_ctx, &zlen,
1325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        p + 2, end - ( p + 2 ),
1326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        ssl->conf->f_rng, ssl->conf->p_rng ) ) != 0 )
1327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ecdh_calc_secret", ret );
1329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *(p++) = (unsigned char)( zlen >> 8 );
1333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *(p++) = (unsigned char)( zlen      );
1334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         p += zlen;
1335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MPI( 3, "ECDH: z", &ssl->handshake->ecdh_ctx.z );
1337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED */
1340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* opaque psk<0..2^16-1>; */
1346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( end - p < 2 )
1347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     *(p++) = (unsigned char)( psk_len >> 8 );
1350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     *(p++) = (unsigned char)( psk_len      );
1351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( end < p || (size_t)( end - p ) < psk_len )
1353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
1354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( p, psk, psk_len );
1356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     p += psk_len;
1357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->pmslen = p - ssl->handshake->premaster;
1359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
1361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
1363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
1365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
1366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * SSLv3.0 MAC functions
1367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
1368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define SSL_MAC_MAX_BYTES   20  /* MD-5 or SHA-1 */
1369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_mac( mbedtls_md_context_t *md_ctx,
1370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *secret,
1371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *buf, size_t len,
1372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      const unsigned char *ctr, int type,
1373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      unsigned char out[SSL_MAC_MAX_BYTES] )
1374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char header[11];
1376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char padding[48];
1377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int padlen;
1378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int md_size = mbedtls_md_get_size( md_ctx->md_info );
1379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int md_type = mbedtls_md_get_type( md_ctx->md_info );
1380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Only MD5 and SHA-1 supported */
1382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( md_type == MBEDTLS_MD_MD5 )
1383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         padlen = 48;
1384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         padlen = 40;
1386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( header, ctr, 8 );
1388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     header[ 8] = (unsigned char)  type;
1389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     header[ 9] = (unsigned char)( len >> 8 );
1390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     header[10] = (unsigned char)( len      );
1391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( padding, 0x36, padlen );
1393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_starts( md_ctx );
1394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, secret,  md_size );
1395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, padding, padlen  );
1396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, header,  11      );
1397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, buf,     len     );
1398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_finish( md_ctx, out              );
1399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( padding, 0x5C, padlen );
1401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_starts( md_ctx );
1402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, secret,    md_size );
1403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, padding,   padlen  );
1404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_update( md_ctx, out,       md_size );
1405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_finish( md_ctx, out                );
1406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
1408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER) ||     \
1410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ( defined(MBEDTLS_CIPHER_MODE_CBC) &&                                  \
1411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****       ( defined(MBEDTLS_AES_C) || defined(MBEDTLS_CAMELLIA_C) || defined(MBEDTLS_ARIA_C)) )
1412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define SSL_SOME_MODES_USE_MAC
1413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* The function below is only used in the Lucky 13 counter-measure in
1416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * ssl_decrypt_buf(). These are the defines that guard the call site. */
1417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC) && \
1418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ( defined(MBEDTLS_SSL_PROTO_TLS1) || \
1419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****       defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
1420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****       defined(MBEDTLS_SSL_PROTO_TLS1_2) )
1421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* This function makes sure every byte in the memory region is accessed
1422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * (in ascending addresses order) */
1423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_read_memory( unsigned char *p, size_t len )
1424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char acc = 0;
1426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     volatile unsigned char force;
1427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( ; len != 0; p++, len-- )
1429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         acc ^= *p;
1430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     force = acc;
1432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     (void) force;
1433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* SSL_SOME_MODES_USE_MAC && ( TLS1 || TLS1_1 || TLS1_2 ) */
1435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
1437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Encryption/decryption functions
1438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
1439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_encrypt_buf( mbedtls_ssl_context *ssl )
1440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_mode_t mode;
1442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int auth_done = 0;
1443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> encrypt buf" ) );
1445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_out == NULL || ssl->transform_out == NULL )
1447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mode = mbedtls_cipher_get_cipher_mode( &ssl->transform_out->cipher_ctx_enc );
1453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "before encrypt: output payload",
1455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->out_msg, ssl->out_msglen );
1456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
1458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Add MAC before if needed
1459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
1460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC)
1461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_STREAM ||
1462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( mode == MBEDTLS_MODE_CBC
1463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           && ssl->session_out->encrypt_then_mac == MBEDTLS_SSL_ETM_DISABLED
1465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ) )
1467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
1469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
1470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char mac[SSL_MAC_MAX_BYTES];
1472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_mac( &ssl->transform_out->md_ctx_enc,
1474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->transform_out->mac_enc,
1475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->out_msg, ssl->out_msglen,
1476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->out_ctr, ssl->out_msgtype,
1477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       mac );
1478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_msg + ssl->out_msglen, mac, ssl->transform_out->maclen );
1480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
1482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
1484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         defined(MBEDTLS_SSL_PROTO_TLS1_2)
1485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 )
1486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char mac[MBEDTLS_SSL_MAC_ADD];
1488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_ctr, 8 );
1490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_hdr, 3 );
1491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_len, 2 );
1492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
1493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->out_msg, ssl->out_msglen );
1494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_out->md_ctx_enc, mac );
1495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_out->md_ctx_enc );
1496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_msg + ssl->out_msglen, mac, ssl->transform_out->maclen );
1498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
1500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "computed mac",
1507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->out_msg + ssl->out_msglen,
1508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->transform_out->maclen );
1509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msglen += ssl->transform_out->maclen;
1511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
1512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* AEAD not the only option */
1514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
1516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Encrypt
1517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
1518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER)
1519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_STREAM )
1520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t olen = 0;
1523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "before encrypt: msglen = %d, "
1525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             "including %d bytes of padding",
1526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->out_msglen, 0 ) );
1527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_out->cipher_ctx_enc,
1529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_out->iv_enc,
1530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_out->ivlen,
1531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->out_msg, ssl->out_msglen,
1532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->out_msg, &olen ) ) != 0 )
1533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
1535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->out_msglen != olen )
1539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ARC4_C || MBEDTLS_CIPHER_NULL_CIPHER */
1546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_GCM_C) || \
1547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_CCM_C) || \
1548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_CHACHAPOLY_C)
1549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_GCM ||
1550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mode == MBEDTLS_MODE_CCM ||
1551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mode == MBEDTLS_MODE_CHACHAPOLY )
1552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t enc_msglen, olen;
1555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char *enc_msg;
1556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char add_data[13];
1557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char iv[12];
1558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform *transform = ssl->transform_out;
1559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char taglen = transform->ciphersuite_info->flags &
1560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
1561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t explicit_ivlen = transform->ivlen - transform->fixed_ivlen;
1562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Prepare additional authenticated data
1565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( add_data, ssl->out_ctr, 8 );
1567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->out_msgtype;
1568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
1569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->conf->transport, add_data + 9 );
1570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[11] = ( ssl->out_msglen >> 8 ) & 0xFF;
1571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[12] = ssl->out_msglen & 0xFF;
1572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "additional data for AEAD", add_data, 13 );
1574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Generate IV
1577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( transform->ivlen == 12 && transform->fixed_ivlen == 4 )
1579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* GCM and CCM: fixed || explicit (=seqnum) */
1581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv, transform->iv_enc, transform->fixed_ivlen );
1582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv + transform->fixed_ivlen, ssl->out_ctr, 8 );
1583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_iv, ssl->out_ctr, 8 );
1584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else if( transform->ivlen == 12 && transform->fixed_ivlen == 12 )
1587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* ChachaPoly: fixed XOR sequence number */
1589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char i;
1590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv, transform->iv_enc, transform->fixed_ivlen );
1592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             for( i = 0; i < 8; i++ )
1594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv[i+4] ^= ssl->out_ctr[i];
1595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
1597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Reminder if we ever add an AEAD mode with a different size */
1599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "IV used (internal)",
1604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   iv, transform->ivlen );
1605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "IV used (transmitted)",
1606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->out_iv, explicit_ivlen );
1607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Fix message length with added IV
1610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         enc_msg = ssl->out_msg;
1612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         enc_msglen = ssl->out_msglen;
1613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msglen += explicit_ivlen;
1614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "before encrypt: msglen = %d, "
1616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     "including 0 bytes of padding",
1617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     ssl->out_msglen ) );
1618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Encrypt and authenticate
1621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_auth_encrypt( &transform->cipher_ctx_enc,
1623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
1624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          add_data, 13,
1625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          enc_msg, enc_msglen,
1626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          enc_msg, &olen,
1627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          enc_msg + enc_msglen, taglen ) ) != 0 )
1628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_auth_encrypt", ret );
1630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( olen != enc_msglen )
1634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msglen += taglen;
1640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
1641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "after encrypt: tag", enc_msg + enc_msglen, taglen );
1643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_GCM_C || MBEDTLS_CCM_C */
1646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_CIPHER_MODE_CBC) &&                                    \
1647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ( defined(MBEDTLS_AES_C) || defined(MBEDTLS_CAMELLIA_C) || defined(MBEDTLS_ARIA_C) )
1648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_CBC )
1649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char *enc_msg;
1652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t enc_msglen, padlen, olen = 0, i;
1653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         padlen = ssl->transform_out->ivlen - ( ssl->out_msglen + 1 ) %
1655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  ssl->transform_out->ivlen;
1656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( padlen == ssl->transform_out->ivlen )
1657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             padlen = 0;
1658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( i = 0; i <= padlen; i++ )
1660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[ssl->out_msglen + i] = (unsigned char) padlen;
1661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msglen += padlen + 1;
1663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         enc_msglen = ssl->out_msglen;
1665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         enc_msg = ssl->out_msg;
1666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
1668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Prepend per-record IV for block cipher in TLS v1.1 and up as per
1670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Method 1 (6.2.3.2. in RFC4346 and RFC5246)
1671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
1673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
1675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Generate IV
1676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
1677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = ssl->conf->f_rng( ssl->conf->p_rng, ssl->transform_out->iv_enc,
1678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->transform_out->ivlen );
1679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret != 0 )
1680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
1681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_iv, ssl->transform_out->iv_enc,
1683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_out->ivlen );
1684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
1686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Fix pointer positions and message length with added IV
1687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
1688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             enc_msg = ssl->out_msg;
1689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             enc_msglen = ssl->out_msglen;
1690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen += ssl->transform_out->ivlen;
1691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
1693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "before encrypt: msglen = %d, "
1695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             "including %d bytes of IV and %d bytes of padding",
1696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             ssl->out_msglen, ssl->transform_out->ivlen,
1697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             padlen + 1 ) );
1698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_out->cipher_ctx_enc,
1700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_out->iv_enc,
1701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_out->ivlen,
1702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    enc_msg, enc_msglen,
1703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    enc_msg, &olen ) ) != 0 )
1704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
1706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( enc_msglen != olen )
1710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1)
1716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_2 )
1717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
1719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Save IV in SSL3 and TLS1
1720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
1721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->transform_out->iv_enc,
1722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_out->cipher_ctx_enc.iv,
1723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_out->ivlen );
1724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( auth_done == 0 )
1729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char mac[MBEDTLS_SSL_MAC_ADD];
1731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
1733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * MAC(MAC_write_key, seq_num +
1734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *     TLSCipherText.type +
1735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *     TLSCipherText.version +
1736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *     length_of( (IV +) ENC(...) ) +
1737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *     IV + // except for TLS 1.0
1738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *     ENC(content + padding + padding_length));
1739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
1740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char pseudo_hdr[13];
1741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "using encrypt then mac" ) );
1743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  0, ssl->out_ctr, 8 );
1745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->out_hdr, 3 );
1746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[11] = (unsigned char)( ( ssl->out_msglen >> 8 ) & 0xFF );
1747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->out_msglen      ) & 0xFF );
1748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "MAC'd meta-data", pseudo_hdr, 13 );
1750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, pseudo_hdr, 13 );
1752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
1753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->out_iv, ssl->out_msglen );
1754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_out->md_ctx_enc, mac );
1755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_out->md_ctx_enc );
1756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_iv + ssl->out_msglen, mac,
1758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_out->maclen );
1759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen += ssl->transform_out->maclen;
1761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done++;
1762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
1764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_CIPHER_MODE_CBC &&
1767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           ( MBEDTLS_AES_C || MBEDTLS_CAMELLIA_C || MBEDTLS_ARIA_C ) */
1768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Make extra sure authentication was performed, exactly once */
1774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( auth_done != 1 )
1775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= encrypt buf" ) );
1781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
1783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
1784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_decrypt_buf( mbedtls_ssl_context *ssl )
1786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
1787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_mode_t mode;
1788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int auth_done = 0;
1789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC)
1790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t padlen = 0, correct = 1;
1791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> decrypt buf" ) );
1794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_in == NULL || ssl->transform_in == NULL )
1796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mode = mbedtls_cipher_get_cipher_mode( &ssl->transform_in->cipher_ctx_dec );
1802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen < ssl->transform_in->minlen )
1804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "in_msglen (%d) < minlen (%d)",
1806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->in_msglen, ssl->transform_in->minlen ) );
1807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_MAC );
1808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER)
1811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_STREAM )
1812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t olen = 0;
1815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         padlen = 0;
1817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_in->cipher_ctx_dec,
1819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_in->iv_dec,
1820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_in->ivlen,
1821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->in_msg, ssl->in_msglen,
1822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->in_msg, &olen ) ) != 0 )
1823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
1825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen != olen )
1829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ARC4_C || MBEDTLS_CIPHER_NULL_CIPHER */
1836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_GCM_C) || \
1837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_CCM_C) || \
1838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_CHACHAPOLY_C)
1839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_GCM ||
1840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mode == MBEDTLS_MODE_CCM ||
1841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mode == MBEDTLS_MODE_CHACHAPOLY )
1842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t dec_msglen, olen;
1845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char *dec_msg;
1846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char *dec_msg_result;
1847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char add_data[13];
1848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char iv[12];
1849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform *transform = ssl->transform_in;
1850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char taglen = transform->ciphersuite_info->flags &
1851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
1852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t explicit_iv_len = transform->ivlen - transform->fixed_ivlen;
1853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Compute and update sizes
1856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen < explicit_iv_len + taglen )
1858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) < explicit_iv_len (%d) "
1860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 "+ taglen (%d)", ssl->in_msglen,
1861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 explicit_iv_len, taglen ) );
1862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
1863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msglen = ssl->in_msglen - explicit_iv_len - taglen;
1865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msg = ssl->in_msg;
1867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msg_result = ssl->in_msg;
1868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msglen = dec_msglen;
1869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Prepare additional authenticated data
1872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( add_data, ssl->in_ctr, 8 );
1874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->in_msgtype;
1875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
1876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->conf->transport, add_data + 9 );
1877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[11] = ( ssl->in_msglen >> 8 ) & 0xFF;
1878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[12] = ssl->in_msglen & 0xFF;
1879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "additional data for AEAD", add_data, 13 );
1881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Prepare IV
1884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( transform->ivlen == 12 && transform->fixed_ivlen == 4 )
1886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* GCM and CCM: fixed || explicit (transmitted) */
1888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv, transform->iv_dec, transform->fixed_ivlen );
1889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv + transform->fixed_ivlen, ssl->in_iv, 8 );
1890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else if( transform->ivlen == 12 && transform->fixed_ivlen == 12 )
1893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* ChachaPoly: fixed XOR sequence number */
1895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char i;
1896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv, transform->iv_dec, transform->fixed_ivlen );
1898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             for( i = 0; i < 8; i++ )
1900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv[i+4] ^= ssl->in_ctr[i];
1901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
1903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Reminder if we ever add an AEAD mode with a different size */
1905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "IV used", iv, transform->ivlen );
1910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "TAG used", dec_msg + dec_msglen, taglen );
1911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Decrypt and authenticate
1914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_auth_decrypt( &ssl->transform_in->cipher_ctx_dec,
1916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
1917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          add_data, 13,
1918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          dec_msg, dec_msglen,
1919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          dec_msg_result, &olen,
1920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          dec_msg + dec_msglen, taglen ) ) != 0 )
1921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_auth_decrypt", ret );
1923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_CIPHER_AUTH_FAILED )
1925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INVALID_MAC );
1926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
1928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
1930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( olen != dec_msglen )
1932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
1934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
1935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
1937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
1938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_GCM_C || MBEDTLS_CCM_C */
1939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_CIPHER_MODE_CBC) &&                                    \
1940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ( defined(MBEDTLS_AES_C) || defined(MBEDTLS_CAMELLIA_C) || defined(MBEDTLS_ARIA_C) )
1941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mode == MBEDTLS_MODE_CBC )
1942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
1943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Decrypt and check the padding
1945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
1947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char *dec_msg;
1948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char *dec_msg_result;
1949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t dec_msglen;
1950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t minlen = 0;
1951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t olen = 0;
1952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Check immediate ciphertext sanity
1955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
1957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
1958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             minlen += ssl->transform_in->ivlen;
1959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
1960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen < minlen + ssl->transform_in->ivlen ||
1962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen < minlen + ssl->transform_in->maclen + 1 )
1963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) < max( ivlen(%d), maclen (%d) "
1965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 "+ 1 ) ( + expl IV )", ssl->in_msglen,
1966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->transform_in->ivlen,
1967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->transform_in->maclen ) );
1968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
1969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
1970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msglen = ssl->in_msglen;
1972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msg = ssl->in_msg;
1973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msg_result = ssl->in_msg;
1974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
1976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Authenticate before decrypt if enabled
1977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
1978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
1979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->session_in->encrypt_then_mac == MBEDTLS_SSL_ETM_ENABLED )
1980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
1981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char mac_expect[MBEDTLS_SSL_MAC_ADD];
1982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char pseudo_hdr[13];
1983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "using encrypt then mac" ) );
1985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dec_msglen -= ssl->transform_in->maclen;
1987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen -= ssl->transform_in->maclen;
1988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  0, ssl->in_ctr, 8 );
1990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->in_hdr, 3 );
1991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[11] = (unsigned char)( ( ssl->in_msglen >> 8 ) & 0xFF );
1992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->in_msglen      ) & 0xFF );
1993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "MAC'd meta-data", pseudo_hdr, 13 );
1995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
1996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, pseudo_hdr, 13 );
1997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec,
1998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->in_iv, ssl->in_msglen );
1999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_in->md_ctx_dec, mac_expect );
2000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_in->md_ctx_dec );
2001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "message  mac", ssl->in_iv + ssl->in_msglen,
2003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                               ssl->transform_in->maclen );
2004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "expected mac", mac_expect,
2005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                               ssl->transform_in->maclen );
2006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( mbedtls_ssl_safer_memcmp( ssl->in_iv + ssl->in_msglen, mac_expect,
2008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                           ssl->transform_in->maclen ) != 0 )
2009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "message mac does not match" ) );
2011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INVALID_MAC );
2013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done++;
2015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_ENCRYPT_THEN_MAC */
2017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Check length sanity
2020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen % ssl->transform_in->ivlen != 0 )
2022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) %% ivlen (%d) != 0",
2024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->in_msglen, ssl->transform_in->ivlen ) );
2025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
2026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
2029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Initialize for prepended IV for block cipher in TLS v1.1 and up
2031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
2033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned char i;
2035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dec_msglen -= ssl->transform_in->ivlen;
2036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen -= ssl->transform_in->ivlen;
2037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             for( i = 0; i < ssl->transform_in->ivlen; i++ )
2039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
2040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
2042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_cipher_crypt( &ssl->transform_in->cipher_ctx_dec,
2044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_in->iv_dec,
2045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_in->ivlen,
2046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    dec_msg, dec_msglen,
2047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    dec_msg_result, &olen ) ) != 0 )
2048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_cipher_crypt", ret );
2050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
2051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( dec_msglen != olen )
2054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1)
2060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_2 )
2061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
2063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Save IV in SSL3 and TLS1
2064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
2065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->transform_in->iv_dec,
2066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_in->cipher_ctx_dec.iv,
2067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_in->ivlen );
2068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         padlen = 1 + ssl->in_msg[ssl->in_msglen - 1];
2072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen < ssl->transform_in->maclen + padlen &&
2074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done == 0 )
2075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "msglen (%d) < maclen (%d) + padlen (%d)",
2078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ssl->in_msglen, ssl->transform_in->maclen, padlen ) );
2079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             padlen = 0;
2081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct = 0;
2082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
2085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
2086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( padlen > ssl->transform_in->ivlen )
2088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad padding length: is %d, "
2091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     "should be no more than %d",
2092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                padlen, ssl->transform_in->ivlen ) );
2093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 correct = 0;
2095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
2098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
2099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
2100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
2101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver > MBEDTLS_SSL_MINOR_VERSION_0 )
2102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
2104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * TLSv1+: always check the padding up to the first failure
2105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * and fake check up to 256 bytes of padding
2106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
2107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t pad_count = 0, real_count = 1;
2108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t padding_idx = ssl->in_msglen - padlen;
2109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t i;
2110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
2112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Padding is guaranteed to be incorrect if:
2113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   1. padlen > ssl->in_msglen
2114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   2. padding_idx > MBEDTLS_SSL_IN_CONTENT_LEN +
2116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *                     ssl->transform_in->maclen
2117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * In both cases we reset padding_idx to a safe value (0) to
2119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * prevent out-of-buffer reads.
2120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
2121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct &= ( padlen <= ssl->in_msglen );
2122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct &= ( padding_idx <= MBEDTLS_SSL_IN_CONTENT_LEN +
2123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        ssl->transform_in->maclen );
2124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             padding_idx *= correct;
2126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             for( i = 0; i < 256; i++ )
2128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 real_count &= ( i < padlen );
2130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 pad_count += real_count *
2131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ( ssl->in_msg[padding_idx + i] == padlen - 1 );
2132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct &= ( pad_count == padlen ); /* Only 1 on correct padding */
2135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( padlen > 0 && correct == 0 )
2138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad padding byte detected" ) );
2139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             padlen &= correct * 0x1FF;
2141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
2143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
2144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
2145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msglen -= padlen;
2151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
2153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_CIPHER_MODE_CBC &&
2154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           ( MBEDTLS_AES_C || MBEDTLS_CAMELLIA_C || MBEDTLS_ARIA_C ) */
2155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "raw buffer after decryption",
2162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->in_msg, ssl->in_msglen );
2163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
2166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Authenticate if not done yet.
2167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Compute the MAC regardless of the padding result (RFC4346, CBCTIME).
2168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
2169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(SSL_SOME_MODES_USE_MAC)
2170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( auth_done == 0 )
2171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char mac_expect[MBEDTLS_SSL_MAC_ADD];
2173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msglen -= ssl->transform_in->maclen;
2175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len[0] = (unsigned char)( ssl->in_msglen >> 8 );
2177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len[1] = (unsigned char)( ssl->in_msglen      );
2178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
2180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
2181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_mac( &ssl->transform_in->md_ctx_dec,
2183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->transform_in->mac_dec,
2184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->in_msg, ssl->in_msglen,
2185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->in_ctr, ssl->in_msgtype,
2186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       mac_expect );
2187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
2189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
2190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
2191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         defined(MBEDTLS_SSL_PROTO_TLS1_2)
2192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver > MBEDTLS_SSL_MINOR_VERSION_0 )
2193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
2195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Process MAC and always update for padlen afterwards to make
2196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * total time independent of padlen.
2197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Known timing attacks:
2199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *  - Lucky Thirteen (http://www.isg.rhul.ac.uk/tls/TLStiming.pdf)
2200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * To compensate for different timings for the MAC calculation
2202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * depending on how much padding was removed (which is determined
2203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * by padlen), process extra_run more blocks through the hash
2204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * function.
2205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * The formula in the paper is
2207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   extra_run = ceil( (L1-55) / 64 ) - ceil( (L2-55) / 64 )
2208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * where L1 is the size of the header plus the decrypted message
2209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * plus CBC padding and L2 is the size of the header plus the
2210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * decrypted message. This is for an underlying hash function
2211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * with 64-byte blocks.
2212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * We use ( (Lx+8) / 64 ) to handle 'negative Lx' values
2213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * correctly. We round down instead of up, so -56 is the correct
2214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * value for our calculations instead of -55.
2215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Repeat the formula rather than defining a block_size variable.
2217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * This avoids requiring division by a variable at runtime
2218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * (which would be marginally less efficient and would require
2219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * linking an extra division function in some builds).
2220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
2221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t j, extra_run = 0;
2222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
2224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * The next two sizes are the minimum and maximum values of
2225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * in_msglen over all padlen values.
2226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * They're independent of padlen, since we previously did
2228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * in_msglen -= padlen.
2229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *
2230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Note that max_len + maclen is never more than the buffer
2231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * length, as we previously did in_msglen -= maclen too.
2232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
2233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t max_len = ssl->in_msglen + padlen;
2234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t min_len = ( max_len > 256 ) ? max_len - 256 : 0;
2235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             switch( ssl->transform_in->ciphersuite_info->mac )
2237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_MD5_C) || defined(MBEDTLS_SHA1_C) || \
2239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SHA256_C)
2240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 case MBEDTLS_MD_MD5:
2241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 case MBEDTLS_MD_SHA1:
2242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 case MBEDTLS_MD_SHA256:
2243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     /* 8 bytes of message size, 64-byte compression blocks */
2244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     extra_run = ( 13 + ssl->in_msglen + padlen + 8 ) / 64 -
2245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 8 ) / 64;
2246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     break;
2247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
2249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 case MBEDTLS_MD_SHA384:
2250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     /* 16 bytes of message size, 128-byte compression blocks */
2251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     extra_run = ( 13 + ssl->in_msglen + padlen + 16 ) / 128 -
2252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 16 ) / 128;
2253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     break;
2254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 default:
2256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             extra_run &= correct * 0xFF;
2261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_ctr, 8 );
2263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_hdr, 3 );
2264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_len, 2 );
2265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_msg,
2266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->in_msglen );
2267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Make sure we access everything even when padlen > 0. This
2268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * makes the synchronisation requirements for just-in-time
2269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Prime+Probe attacks much tighter and hopefully impractical. */
2270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_read_memory( ssl->in_msg + ssl->in_msglen, padlen );
2271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_in->md_ctx_dec, mac_expect );
2272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Call mbedtls_md_process at least once due to cache attacks
2274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * that observe whether md_process() was called of not */
2275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             for( j = 0; j < extra_run + 1; j++ )
2276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
2277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_in->md_ctx_dec );
2279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Make sure we access all the memory that could contain the MAC,
2281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * before we check it in the next code block. This makes the
2282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * synchronisation requirements for just-in-time Prime+Probe
2283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * attacks much tighter and hopefully impractical. */
2284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_read_memory( ssl->in_msg + min_len,
2285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
2286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
2288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
2289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               MBEDTLS_SSL_PROTO_TLS1_2 */
2290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "expected mac", mac_expect, ssl->transform_in->maclen );
2297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "message  mac", ssl->in_msg + ssl->in_msglen,
2298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                ssl->transform_in->maclen );
2299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mbedtls_ssl_safer_memcmp( ssl->in_msg + ssl->in_msglen, mac_expect,
2302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
2303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DEBUG_ALL)
2305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "message mac does not match" ) );
2306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct = 0;
2308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
2310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Finally check the correct flag
2313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( correct == 0 )
2315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
2316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* SSL_SOME_MODES_USE_MAC */
2318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Make extra sure authentication was performed, exactly once */
2320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( auth_done != 1 )
2321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen == 0 )
2327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
2329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3
2330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             && ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
2331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* TLS v1.2 explicitly disallows zero-length messages which are not application data */
2333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid zero-length message type: %d", ssl->in_msgtype ) )
2334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
2335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
2337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->nb_zero++;
2339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Three or more empty messages may be a DoS attack
2342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * (excessive CPU consumption).
2343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->nb_zero > 3 )
2345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "received four consecutive empty "
2347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 "messages, possible DoS attack" ) );
2348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
2349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
2352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->nb_zero = 0;
2353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ; /* in_ctr read from peer, not maintained internally */
2358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
2360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char i;
2363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( i = 8; i > ssl_ep_len( ssl ); i-- )
2364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
2365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
2366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* The loop goes to its end iff the counter is wrapping */
2368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( i == ssl_ep_len( ssl ) )
2369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "incoming message counter would wrap" ) );
2371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
2372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= decrypt buf" ) );
2376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
2378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #undef MAC_NONE
2381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #undef MAC_PLAINTEXT
2382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #undef MAC_CIPHERTEXT
2383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
2385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Compression/decompression functions
2387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_compress_buf( mbedtls_ssl_context *ssl )
2389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
2391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *msg_post = ssl->out_msg;
2392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ptrdiff_t bytes_written = ssl->out_msg - ssl->out_buf;
2393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t len_pre = ssl->out_msglen;
2394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *msg_pre = ssl->compress_buf;
2395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> compress buf" ) );
2397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( len_pre == 0 )
2399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
2400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( msg_pre, ssl->out_msg, len_pre );
2402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "before compression: msglen = %d, ",
2404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->out_msglen ) );
2405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "before compression: output payload",
2407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->out_msg, ssl->out_msglen );
2408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out->ctx_deflate.next_in = msg_pre;
2410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out->ctx_deflate.avail_in = len_pre;
2411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out->ctx_deflate.next_out = msg_post;
2412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out->ctx_deflate.avail_out = MBEDTLS_SSL_OUT_BUFFER_LEN - bytes_written;
2413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = deflate( &ssl->transform_out->ctx_deflate, Z_SYNC_FLUSH );
2415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != Z_OK )
2416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "failed to perform compression (%d)", ret ) );
2418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_COMPRESSION_FAILED );
2419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen = MBEDTLS_SSL_OUT_BUFFER_LEN -
2422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->transform_out->ctx_deflate.avail_out - bytes_written;
2423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "after compression: msglen = %d, ",
2425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->out_msglen ) );
2426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "after compression: output payload",
2428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->out_msg, ssl->out_msglen );
2429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= compress buf" ) );
2431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
2433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_decompress_buf( mbedtls_ssl_context *ssl )
2436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
2438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *msg_post = ssl->in_msg;
2439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ptrdiff_t header_bytes = ssl->in_msg - ssl->in_buf;
2440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t len_pre = ssl->in_msglen;
2441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *msg_pre = ssl->compress_buf;
2442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> decompress buf" ) );
2444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( len_pre == 0 )
2446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
2447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( msg_pre, ssl->in_msg, len_pre );
2449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "before decompression: msglen = %d, ",
2451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->in_msglen ) );
2452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "before decompression: input payload",
2454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->in_msg, ssl->in_msglen );
2455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_in->ctx_inflate.next_in = msg_pre;
2457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_in->ctx_inflate.avail_in = len_pre;
2458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_in->ctx_inflate.next_out = msg_post;
2459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_in->ctx_inflate.avail_out = MBEDTLS_SSL_IN_BUFFER_LEN -
2460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                header_bytes;
2461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = inflate( &ssl->transform_in->ctx_inflate, Z_SYNC_FLUSH );
2463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != Z_OK )
2464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "failed to perform decompression (%d)", ret ) );
2466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_COMPRESSION_FAILED );
2467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen = MBEDTLS_SSL_IN_BUFFER_LEN -
2470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      ssl->transform_in->ctx_inflate.avail_out - header_bytes;
2471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "after decompression: msglen = %d, ",
2473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->in_msglen ) );
2474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "after decompression: input payload",
2476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->in_msg, ssl->in_msglen );
2477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= decompress buf" ) );
2479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
2481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ZLIB_SUPPORT */
2483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_RENEGOTIATION)
2485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_write_hello_request( mbedtls_ssl_context *ssl );
2486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_resend_hello_request( mbedtls_ssl_context *ssl )
2489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* If renegotiation is not enforced, retransmit until we would reach max
2491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * timeout if we were using the usual handshake doubling scheme */
2492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->renego_max_records < 0 )
2493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         uint32_t ratio = ssl->conf->hs_timeout_max / ssl->conf->hs_timeout_min + 1;
2495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char doublings = 1;
2496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         while( ratio != 0 )
2498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ++doublings;
2500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ratio >>= 1;
2501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ++ssl->renego_records_seen > doublings )
2504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "no longer retransmitting hello request" ) );
2506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
2507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_write_hello_request( ssl ) );
2511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C && MBEDTLS_SSL_RENEGOTIATION */
2514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Fill the input message buffer by appending data to it.
2517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * The amount of data already fetched is in ssl->in_left.
2518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
2519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * If we return 0, is it guaranteed that (at least) nb_want bytes are
2520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * available (from this read and/or a previous one). Otherwise, an error code
2521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * is returned (possibly EOF or WANT_READ).
2522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
2523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * With stream transport (TLS) on success ssl->in_left == nb_want, but
2524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * with datagram transport (DTLS) on success ssl->in_left >= nb_want,
2525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * since we always read a whole datagram at once.
2526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
2527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * For DTLS, it is up to the caller to set ssl->next_record_offset when
2528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * they're done reading a record.
2529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_fetch_input( mbedtls_ssl_context *ssl, size_t nb_want )
2531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
2533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t len;
2534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> fetch input" ) );
2536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->f_recv == NULL && ssl->f_recv_timeout == NULL )
2538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Bad usage of mbedtls_ssl_set_bio() "
2540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             "or mbedtls_ssl_set_bio()" ) );
2541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
2542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( nb_want > MBEDTLS_SSL_IN_BUFFER_LEN - (size_t)( ssl->in_hdr - ssl->in_buf ) )
2545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "requesting more data than fits" ) );
2547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
2548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         uint32_t timeout;
2554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Just to be sure */
2556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->f_set_timer == NULL || ssl->f_get_timer == NULL )
2557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "You must use "
2559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         "mbedtls_ssl_set_timer_cb() for DTLS" ) );
2560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
2561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * The point is, we need to always read a full datagram at once, so we
2565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * sometimes read more then requested, and handle the additional data.
2566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * It could be the rest of the current record (while fetching the
2567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * header) and/or some other records in the same datagram.
2568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Move to the next record in the already read datagram if applicable
2572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->next_record_offset != 0 )
2574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->in_left < ssl->next_record_offset )
2576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_left -= ssl->next_record_offset;
2582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->in_left != 0 )
2584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "next record in same datagram, offset: %d",
2586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     ssl->next_record_offset ) );
2587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 memmove( ssl->in_hdr,
2588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          ssl->in_hdr + ssl->next_record_offset,
2589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          ssl->in_left );
2590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->next_record_offset = 0;
2593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "in_left: %d, nb_want: %d",
2596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->in_left, nb_want ) );
2597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Done if we already have enough data.
2600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( nb_want <= ssl->in_left)
2602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= fetch input" ) );
2604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
2605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * A record can't be split accross datagrams. If we need to read but
2609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * are not at the beginning of a new record, the caller did something
2610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * wrong.
2611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_left != 0 )
2613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
2615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
2619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Don't even try to read if time's out already.
2620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * This avoids by-passing the timer when repeatedly receiving messages
2621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * that will end up being dropped.
2622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
2623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl_check_timer( ssl ) != 0 )
2624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "timer has expired" ) );
2626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = MBEDTLS_ERR_SSL_TIMEOUT;
2627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
2629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             len = MBEDTLS_SSL_IN_BUFFER_LEN - ( ssl->in_hdr - ssl->in_buf );
2631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
2633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 timeout = ssl->handshake->retransmit_timeout;
2634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
2635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 timeout = ssl->conf->read_timeout;
2636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "f_recv_timeout: %u ms", timeout ) );
2638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->f_recv_timeout != NULL )
2640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = ssl->f_recv_timeout( ssl->p_bio, ssl->in_hdr, len,
2641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                                     timeout );
2642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
2643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = ssl->f_recv( ssl->p_bio, ssl->in_hdr, len );
2644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 2, "ssl->f_recv(_timeout)", ret );
2646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == 0 )
2648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONN_EOF );
2649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret == MBEDTLS_ERR_SSL_TIMEOUT )
2652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "timeout" ) );
2654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_set_timer( ssl, 0 );
2655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
2657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl_double_retransmit_timeout( ssl ) != 0 )
2659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
2660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake timeout" ) );
2661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_TIMEOUT );
2662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
2663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ( ret = mbedtls_ssl_resend( ssl ) ) != 0 )
2665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
2666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_resend", ret );
2667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
2668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
2669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_WANT_READ );
2671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_RENEGOTIATION)
2673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
2674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
2675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ( ret = ssl_resend_hello_request( ssl ) ) != 0 )
2677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
2678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "ssl_resend_hello_request", ret );
2679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
2680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
2681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_WANT_READ );
2683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C && MBEDTLS_SSL_RENEGOTIATION */
2685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret < 0 )
2688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
2689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_left = ret;
2691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
2693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "in_left: %d, nb_want: %d",
2696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->in_left, nb_want ) );
2697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         while( ssl->in_left < nb_want )
2699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             len = nb_want - ssl->in_left;
2701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl_check_timer( ssl ) != 0 )
2703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_TIMEOUT;
2704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
2705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->f_recv_timeout != NULL )
2707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
2708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret = ssl->f_recv_timeout( ssl->p_bio,
2709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
2710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                ssl->conf->read_timeout );
2711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
2712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 else
2713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
2714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret = ssl->f_recv( ssl->p_bio,
2715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        ssl->in_hdr + ssl->in_left, len );
2716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
2717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "in_left: %d, nb_want: %d",
2720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         ssl->in_left, nb_want ) );
2721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 2, "ssl->f_recv(_timeout)", ret );
2722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == 0 )
2724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONN_EOF );
2725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret < 0 )
2727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
2728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if ( (size_t)ret > len || ( INT_MAX > SIZE_MAX && ret > SIZE_MAX ) )
2730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1,
2732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ( "f_recv returned %d bytes but only %lu were requested",
2733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret, (unsigned long)len ) );
2734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
2736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_left += ret;
2738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= fetch input" ) );
2742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
2744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Flush any data not yet written
2748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_flush_output( mbedtls_ssl_context *ssl )
2750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
2752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *buf;
2753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> flush output" ) );
2755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->f_send == NULL )
2757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Bad usage of mbedtls_ssl_set_bio() "
2759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             "or mbedtls_ssl_set_bio()" ) );
2760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
2761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Avoid incrementing counter if data is flushed */
2764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_left == 0 )
2765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= flush output" ) );
2767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
2768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( ssl->out_left > 0 )
2771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "message length: %d, out_left: %d",
2773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        mbedtls_ssl_hdr_len( ssl ) + ssl->out_msglen, ssl->out_left ) );
2774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         buf = ssl->out_hdr - ssl->out_left;
2776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = ssl->f_send( ssl->p_bio, buf, ssl->out_left );
2777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 2, "ssl->f_send", ret );
2779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret <= 0 )
2781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
2782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( (size_t)ret > ssl->out_left || ( INT_MAX > SIZE_MAX && ret > SIZE_MAX ) )
2784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1,
2786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ( "f_send returned %d bytes but only %lu bytes were sent",
2787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret, (unsigned long)ssl->out_left ) );
2788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
2789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_left -= ret;
2792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
2796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr = ssl->out_buf;
2798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
2800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr = ssl->out_buf + 8;
2803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_out_pointers( ssl, ssl->transform_out );
2805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= flush output" ) );
2807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
2809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Functions to handle the DTLS retransmission state machine
2813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
2815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Append current handshake message to current outgoing flight
2817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_flight_append( mbedtls_ssl_context *ssl )
2819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_flight_item *msg;
2821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_flight_append" ) );
2822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "message appended to flight",
2823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->out_msg, ssl->out_msglen );
2824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Allocate space for current message */
2826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( msg = mbedtls_calloc( 1, sizeof(  mbedtls_ssl_flight_item ) ) ) == NULL )
2827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc %d bytes failed",
2829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             sizeof( mbedtls_ssl_flight_item ) ) );
2830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
2831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( msg->p = mbedtls_calloc( 1, ssl->out_msglen ) ) == NULL )
2834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc %d bytes failed", ssl->out_msglen ) );
2836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( msg );
2837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
2838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Copy current handshake message with headers */
2841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( msg->p, ssl->out_msg, ssl->out_msglen );
2842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     msg->len = ssl->out_msglen;
2843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     msg->type = ssl->out_msgtype;
2844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     msg->next = NULL;
2845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Append to the current flight */
2847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->flight == NULL )
2848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->flight = msg;
2849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
2850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_flight_item *cur = ssl->handshake->flight;
2852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         while( cur->next != NULL )
2853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             cur = cur->next;
2854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cur->next = msg;
2855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_flight_append" ) );
2858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
2859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Free the current flight of handshake messages
2863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_flight_free( mbedtls_ssl_flight_item *flight )
2865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_flight_item *cur = flight;
2867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_flight_item *next;
2868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( cur != NULL )
2870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         next = cur->next;
2872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( cur->p );
2874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( cur );
2875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cur = next;
2877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
2881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_dtls_replay_reset( mbedtls_ssl_context *ssl );
2882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Swap transform_out and out_ctr with the alternative ones
2886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_swap_epochs( mbedtls_ssl_context *ssl )
2888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_transform *tmp_transform;
2890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char tmp_out_ctr[8];
2891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform_out == ssl->handshake->alt_transform_out )
2893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "skip swap epochs" ) );
2895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
2896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "swap epochs" ) );
2899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Swap transforms */
2901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     tmp_transform                     = ssl->transform_out;
2902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out                = ssl->handshake->alt_transform_out;
2903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->alt_transform_out = tmp_transform;
2904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Swap epoch + sequence_number */
2906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp_out_ctr,                 ssl->cur_out_ctr,            8 );
2907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( ssl->cur_out_ctr,            ssl->handshake->alt_out_ctr, 8 );
2908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( ssl->handshake->alt_out_ctr, tmp_out_ctr,                 8 );
2909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Adjust to the newly activated transform */
2911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_out_pointers( ssl, ssl->transform_out );
2912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
2914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_activate != NULL )
2915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_activate( ssl, MBEDTLS_SSL_CHANNEL_OUTBOUND ) ) != 0 )
2917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_activate", ret );
2919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
2920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
2923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Retransmit the current flight of messages.
2927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_resend( mbedtls_ssl_context *ssl )
2929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
2931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> mbedtls_ssl_resend" ) );
2933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = mbedtls_ssl_flight_transmit( ssl );
2935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= mbedtls_ssl_resend" ) );
2937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
2939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
2940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
2942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Transmit or retransmit the current flight of messages.
2943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
2944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Need to remember the current message in case flush_output returns
2945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * WANT_WRITE, causing us to exit this function and come back later.
2946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * This function must be called until state is no longer SENDING.
2947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
2948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_flight_transmit( mbedtls_ssl_context *ssl )
2949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
2950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
2951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> mbedtls_ssl_flight_transmit" ) );
2952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->retransmit_state != MBEDTLS_SSL_RETRANS_SENDING )
2954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "initialise flight transmission" ) );
2956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->cur_msg = ssl->handshake->flight;
2958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->cur_msg_p = ssl->handshake->flight->p + 12;
2959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_swap_epochs( ssl );
2960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_SENDING;
2962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
2963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( ssl->handshake->cur_msg != NULL )
2965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
2966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t max_frag_len;
2967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         const mbedtls_ssl_flight_item * const cur = ssl->handshake->cur_msg;
2968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int const is_finished =
2970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( cur->type == MBEDTLS_SSL_MSG_HANDSHAKE &&
2971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               cur->p[0] == MBEDTLS_SSL_HS_FINISHED );
2972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         uint8_t const force_flush = ssl->disable_datagram_packing == 1 ?
2974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             SSL_FORCE_FLUSH : SSL_DONT_FORCE_FLUSH;
2975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Swap epochs before sending Finished: we can't do it after
2977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * sending ChangeCipherSpec, in case write returns WANT_READ.
2978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Must be done before copying, may change out_msg pointer */
2979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( is_finished && ssl->handshake->cur_msg_p == ( cur->p + 12 ) )
2980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "swap epochs to send finished message" ) );
2982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_swap_epochs( ssl );
2983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
2984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = ssl_get_remaining_payload_in_datagram( ssl );
2986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret < 0 )
2987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
2988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         max_frag_len = (size_t) ret;
2989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* CCS is copied as is, while HS messages may need fragmentation */
2991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( cur->type == MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
2992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
2993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( max_frag_len == 0 )
2994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
2995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
2996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
2997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
2998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 continue;
2999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_msg, cur->p, cur->len );
3002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen  = cur->len;
3003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msgtype = cur->type;
3004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Update position inside current message */
3006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->cur_msg_p += cur->len;
3007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
3009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const unsigned char * const p = ssl->handshake->cur_msg_p;
3011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t hs_len = cur->len - 12;
3012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t frag_off = p - ( cur->p + 12 );
3013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t rem_len = hs_len - frag_off;
3014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t cur_hs_frag_len, max_hs_frag_len;
3015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ( max_frag_len < 12 ) || ( max_frag_len == 12 && hs_len != 0 ) )
3017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( is_finished )
3019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl_swap_epochs( ssl );
3020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
3022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
3023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 continue;
3025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             max_hs_frag_len = max_frag_len - 12;
3027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             cur_hs_frag_len = rem_len > max_hs_frag_len ?
3029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 max_hs_frag_len : rem_len;
3030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( frag_off == 0 && cur_hs_frag_len != hs_len )
3032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "fragmenting handshake message (%u > %u)",
3034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             (unsigned) cur_hs_frag_len,
3035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             (unsigned) max_hs_frag_len ) );
3036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Messages are stored with handshake headers as if not fragmented,
3039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * copy beginning of headers then fill fragmentation fields.
3040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Handshake headers: type(1) len(3) seq(2) f_off(3) f_len(3) */
3041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_msg, cur->p, 6 );
3042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[6] = ( ( frag_off >> 16 ) & 0xff );
3044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[7] = ( ( frag_off >>  8 ) & 0xff );
3045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[8] = ( ( frag_off       ) & 0xff );
3046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[ 9] = ( ( cur_hs_frag_len >> 16 ) & 0xff );
3048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[10] = ( ( cur_hs_frag_len >>  8 ) & 0xff );
3049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[11] = ( ( cur_hs_frag_len       ) & 0xff );
3050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 3, "handshake header", ssl->out_msg, 12 );
3052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Copy the handshake message content and set records fields */
3054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_msg + 12, p, cur_hs_frag_len );
3055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen = cur_hs_frag_len + 12;
3056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msgtype = cur->type;
3057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Update position inside current message */
3059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->cur_msg_p += cur_hs_frag_len;
3060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* If done with the current message move to the next one if any */
3063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->handshake->cur_msg_p >= cur->p + cur->len )
3064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( cur->next != NULL )
3066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->handshake->cur_msg = cur->next;
3068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->handshake->cur_msg_p = cur->next->p + 12;
3069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
3071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->handshake->cur_msg = NULL;
3073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->handshake->cur_msg_p = NULL;
3074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Actually send the message out */
3078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_write_record( ssl, force_flush ) ) != 0 )
3079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_record", ret );
3081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
3082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
3086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
3087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Update state and set timer */
3089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER )
3090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_FINISHED;
3091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
3092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_WAITING;
3094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_set_timer( ssl, ssl->handshake->retransmit_timeout );
3095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= mbedtls_ssl_flight_transmit" ) );
3098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * To be called when the last message of an incoming flight is received.
3104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_recv_flight_completed( mbedtls_ssl_context *ssl )
3106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* We won't need to resend that one any more */
3108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_flight_free( ssl->handshake->flight );
3109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->flight = NULL;
3110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->cur_msg = NULL;
3111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* The next incoming flight will start with this msg_seq */
3113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->in_flight_start_seq = ssl->handshake->in_msg_seq;
3114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* We don't want to remember CCS's across flight boundaries. */
3116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->buffering.seen_ccs = 0;
3117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Clear future message buffering structure. */
3119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_buffering_free( ssl );
3120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Cancel timer */
3122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_set_timer( ssl, 0 );
3123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
3125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msg[0] == MBEDTLS_SSL_HS_FINISHED )
3126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_FINISHED;
3128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
3130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_PREPARING;
3131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * To be called when the last message of an outgoing flight is send.
3135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_send_flight_completed( mbedtls_ssl_context *ssl )
3137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_reset_retransmit_timeout( ssl );
3139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_set_timer( ssl, ssl->handshake->retransmit_timeout );
3140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
3142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msg[0] == MBEDTLS_SSL_HS_FINISHED )
3143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_FINISHED;
3145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
3147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_WAITING;
3148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Handshake layer functions
3153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Write (DTLS: or queue) current handshake (including CCS) message.
3157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - fill in handshake headers
3159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - update handshake checksum
3160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - DTLS: save message for resending
3161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - then pass to the record layer
3162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * DTLS: except for HelloRequest, messages are only queued, and will only be
3164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * actually sent when calling flight_transmit() or resend().
3165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Inputs:
3167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - ssl->out_msglen: 4 + actual handshake message len
3168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *      (4 is the size of handshake headers for TLS)
3169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - ssl->out_msg[0]: the handshake type (ClientHello, ServerHello, etc)
3170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - ssl->out_msg + 4: the handshake message body
3171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Outputs, ie state before passing to flight_append() or write_record():
3173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   - ssl->out_msglen: the length of the record contents
3174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *      (including handshake headers but excluding record headers)
3175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   - ssl->out_msg: the record contents (handshake headers + content)
3176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write_handshake_msg( mbedtls_ssl_context *ssl )
3178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
3180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const size_t hs_len = ssl->out_msglen - 4;
3181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const unsigned char hs_type = ssl->out_msg[0];
3182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write handshake message" ) );
3184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
3186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Sanity checks
3187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
3188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE          &&
3189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
3190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* In SSLv3, the client might send a NoCertificate alert. */
3192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) && defined(MBEDTLS_SSL_CLI_C)
3193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ! ( ssl->minor_ver      == MBEDTLS_SSL_MINOR_VERSION_0 &&
3194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->out_msgtype    == MBEDTLS_SSL_MSG_ALERT       &&
3195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT ) )
3196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 && MBEDTLS_SSL_SRV_C */
3197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
3204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST &&
3205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake == NULL )
3206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake != NULL &&
3214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->retransmit_state == MBEDTLS_SSL_RETRANS_SENDING )
3215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
3217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
3220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Double-check that we did not exceed the bounds
3222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * of the outgoing record buffer.
3223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * This should never fail as the various message
3224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * writing functions must obey the bounds of the
3225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * outgoing record buffer, but better be safe.
3226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Note: We deliberately do not check for the MTU or MFL here.
3228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
3229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_msglen > MBEDTLS_SSL_OUT_CONTENT_LEN )
3230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "Record too large: "
3232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     "size %u, maximum %u",
3233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     (unsigned) ssl->out_msglen,
3234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     (unsigned) MBEDTLS_SSL_OUT_CONTENT_LEN ) );
3235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
3239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Fill handshake headers
3240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
3241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE )
3242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[1] = (unsigned char)( hs_len >> 16 );
3244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[2] = (unsigned char)( hs_len >>  8 );
3245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[3] = (unsigned char)( hs_len       );
3246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
3248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * DTLS has additional fields in the Handshake layer,
3249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * between the length field and the actual payload:
3250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *      uint16 message_seq;
3251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *      uint24 fragment_offset;
3252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *      uint24 fragment_length;
3253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
3254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
3256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Make room for the additional DTLS fields */
3258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( MBEDTLS_SSL_OUT_CONTENT_LEN - ssl->out_msglen < 8 )
3259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "DTLS handshake message too large: "
3261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               "size %u, maximum %u",
3262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                (unsigned) ( hs_len ),
3263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                (unsigned) ( MBEDTLS_SSL_OUT_CONTENT_LEN - 12 ) ) );
3264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
3265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memmove( ssl->out_msg + 12, ssl->out_msg + 4, hs_len );
3268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen += 8;
3269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Write message_seq and update it, except for HelloRequest */
3271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST )
3272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->out_msg[4] = ( ssl->handshake->out_msg_seq >> 8 ) & 0xFF;
3274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->out_msg[5] = ( ssl->handshake->out_msg_seq      ) & 0xFF;
3275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ++( ssl->handshake->out_msg_seq );
3276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
3278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->out_msg[4] = 0;
3280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->out_msg[5] = 0;
3281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Handshake hashes are computed without fragmentation,
3284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * so set frag_offset = 0 and frag_len = hs_len for now */
3285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memset( ssl->out_msg + 6, 0x00, 3 );
3286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_msg + 9, ssl->out_msg + 1, 3 );
3287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Update running hashes of handshake messages seen */
3291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST )
3292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->update_checksum( ssl, ssl->out_msg, ssl->out_msglen );
3293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Either send now, or just save to be sent (and resent) later */
3296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ssl->out_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE ||
3299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST ) )
3300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_flight_append( ssl ) ) != 0 )
3302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_flight_append", ret );
3304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
3305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
3308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
3309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_write_record( ssl, SSL_FORCE_FLUSH ) ) != 0 )
3311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_write_record", ret );
3313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
3314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write handshake message" ) );
3318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Record layer functions
3324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Write current record.
3328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Uses:
3330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - ssl->out_msgtype: type of the message (AppData, Handshake, Alert, CCS)
3331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - ssl->out_msglen: length of the record content (excl headers)
3332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *  - ssl->out_msg: record content
3333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write_record( mbedtls_ssl_context *ssl, uint8_t force_flush )
3335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, done = 0;
3337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t len = ssl->out_msglen;
3338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint8_t flush = force_flush;
3339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write record" ) );
3341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
3343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform_out != NULL &&
3344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_out->compression == MBEDTLS_SSL_COMPRESS_DEFLATE )
3345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_compress_buf( ssl ) ) != 0 )
3347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_compress_buf", ret );
3349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
3350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         len = ssl->out_msglen;
3353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /*MBEDTLS_ZLIB_SUPPORT */
3355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
3357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_write != NULL )
3358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_write()" ) );
3360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_hw_record_write( ssl );
3362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != 0 && ret != MBEDTLS_ERR_SSL_HW_ACCEL_FALLTHROUGH )
3363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_write", ret );
3365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
3366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret == 0 )
3369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             done = 1;
3370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
3372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !done )
3373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned i;
3375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t protected_record_size;
3376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr[0] = (unsigned char) ssl->out_msgtype;
3378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
3379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->conf->transport, ssl->out_hdr + 1 );
3380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->out_ctr, ssl->cur_out_ctr, 8 );
3382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len[0] = (unsigned char)( len >> 8 );
3383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len[1] = (unsigned char)( len      );
3384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->transform_out != NULL )
3386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ( ret = ssl_encrypt_buf( ssl ) ) != 0 )
3388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "ssl_encrypt_buf", ret );
3390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
3391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             len = ssl->out_msglen;
3394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_len[0] = (unsigned char)( len >> 8 );
3395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_len[1] = (unsigned char)( len      );
3396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         protected_record_size = len + mbedtls_ssl_hdr_len( ssl );
3399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* In case of DTLS, double-check that we don't exceed
3402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * the remaining space in the datagram. */
3403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
3404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = ssl_get_remaining_space_in_datagram( ssl );
3406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret < 0 )
3407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
3408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( protected_record_size > (size_t) ret )
3410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Should never happen */
3412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "output record: msgtype = %d, "
3418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     "version = [%d:%d], msglen = %d",
3419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     ssl->out_hdr[0], ssl->out_hdr[1],
3420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     ssl->out_hdr[2], len ) );
3421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "output record sent to network",
3423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                ssl->out_hdr, protected_record_size );
3424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_left += protected_record_size;
3426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr  += protected_record_size;
3427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_update_out_pointers( ssl, ssl->transform_out );
3428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( i = 8; i > ssl_ep_len( ssl ); i-- )
3430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
3431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
3432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* The loop goes to its end iff the counter is wrapping */
3434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( i == ssl_ep_len( ssl ) )
3435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "outgoing message counter would wrap" ) );
3437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
3438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         flush == SSL_DONT_FORCE_FLUSH )
3444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t remaining;
3446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = ssl_get_remaining_payload_in_datagram( ssl );
3447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret < 0 )
3448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_get_remaining_payload_in_datagram",
3450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ret );
3451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
3452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         remaining = (size_t) ret;
3455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( remaining == 0 )
3456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             flush = SSL_FORCE_FLUSH;
3458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
3460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Still %u bytes available in current datagram", (unsigned) 
3462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( flush == SSL_FORCE_FLUSH ) &&
3467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
3468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flush_output", ret );
3470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
3471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write record" ) );
3474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_hs_is_proper_fragment( mbedtls_ssl_context *ssl )
3481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen < ssl->in_hslen ||
3483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcmp( ssl->in_msg + 6, "\0\0\0",        3 ) != 0 ||
3484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcmp( ssl->in_msg + 9, ssl->in_msg + 1, 3 ) != 0 )
3485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
3487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static uint32_t ssl_get_hs_frag_len( mbedtls_ssl_context const *ssl )
3492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ( ssl->in_msg[9] << 16  ) |
3494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ssl->in_msg[10] << 8  ) |
3495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ssl->in_msg[11] );
3496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static uint32_t ssl_get_hs_frag_off( mbedtls_ssl_context const *ssl )
3499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ( ssl->in_msg[6] << 16 ) |
3501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ssl->in_msg[7] << 8  ) |
3502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ssl->in_msg[8] );
3503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_check_hs_header( mbedtls_ssl_context const *ssl )
3506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint32_t msg_len, frag_off, frag_len;
3508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     msg_len  = ssl_get_hs_total_len( ssl );
3510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     frag_off = ssl_get_hs_frag_off( ssl );
3511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     frag_len = ssl_get_hs_frag_len( ssl );
3512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( frag_off > msg_len )
3514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
3515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( frag_len > msg_len - frag_off )
3517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
3518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( frag_len + 12 > ssl->in_msglen )
3520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
3521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Mark bits in bitmask (used for DTLS HS reassembly)
3527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_bitmask_set( unsigned char *mask, size_t offset, size_t len )
3529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned int start_bits, end_bits;
3531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     start_bits = 8 - ( offset % 8 );
3533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( start_bits != 8 )
3534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t first_byte_idx = offset / 8;
3536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Special case */
3538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( len <= start_bits )
3539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             for( ; len != 0; len-- )
3541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mask[first_byte_idx] |= 1 << ( start_bits - len );
3542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Avoid potential issues with offset or len becoming invalid */
3544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return;
3545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         offset += start_bits; /* Now offset % 8 == 0 */
3548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         len -= start_bits;
3549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( ; start_bits != 0; start_bits-- )
3551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mask[first_byte_idx] |= 1 << ( start_bits - 1 );
3552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     end_bits = len % 8;
3555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( end_bits != 0 )
3556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t last_byte_idx = ( offset + len ) / 8;
3558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         len -= end_bits; /* Now len % 8 == 0 */
3560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( ; end_bits != 0; end_bits-- )
3562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mask[last_byte_idx] |= 1 << ( 8 - end_bits );
3563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( mask + offset / 8, 0xFF, len / 8 );
3566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Check that bitmask is full
3570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_bitmask_check( unsigned char *mask, size_t len )
3572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t i;
3574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( i = 0; i < len / 8; i++ )
3576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mask[i] != 0xFF )
3577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( -1 );
3578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( i = 0; i < len % 8; i++ )
3580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( mask[len / 8] & ( 1 << ( 7 - i ) ) ) == 0 )
3581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( -1 );
3582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* msg_len does not include the handshake header */
3587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static size_t ssl_get_reassembly_buffer_size( size_t msg_len,
3588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                               unsigned add_bitmap )
3589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t alloc_len;
3591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     alloc_len  = 12;                                 /* Handshake header */
3593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     alloc_len += msg_len;                            /* Content buffer   */
3594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( add_bitmap )
3596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         alloc_len += msg_len / 8 + ( msg_len % 8 != 0 ); /* Bitmap       */
3597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( alloc_len );
3599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static uint32_t ssl_get_hs_total_len( mbedtls_ssl_context const *ssl )
3604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ( ssl->in_msg[1] << 16 ) |
3606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ssl->in_msg[2] << 8  ) |
3607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ssl->in_msg[3] );
3608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_prepare_handshake_record( mbedtls_ssl_context *ssl )
3611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen < mbedtls_ssl_hs_hdr_len( ssl ) )
3613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake message too short: %d",
3615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             ssl->in_msglen ) );
3616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
3617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_hslen = mbedtls_ssl_hs_hdr_len( ssl ) + ssl_get_hs_total_len( ssl );
3620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "handshake message: msglen ="
3622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         " %d, type = %d, hslen = %d",
3623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ssl->in_msglen, ssl->in_msg[0], ssl->in_hslen ) );
3624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
3627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int ret;
3629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned int recv_msg_seq = ( ssl->in_msg[4] << 8 ) | ssl->in_msg[5];
3630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl_check_hs_header( ssl ) != 0 )
3632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid handshake header" ) );
3634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
3635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->handshake != NULL &&
3638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ( ssl->state   != MBEDTLS_SSL_HANDSHAKE_OVER &&
3639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 recv_msg_seq != ssl->handshake->in_msg_seq ) ||
3640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ( ssl->state  == MBEDTLS_SSL_HANDSHAKE_OVER &&
3641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_msg[0] != MBEDTLS_SSL_HS_CLIENT_HELLO ) ) )
3642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( recv_msg_seq > ssl->handshake->in_msg_seq )
3644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "received future handshake message of sequence number %
3646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             recv_msg_seq,
3647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             ssl->handshake->in_msg_seq ) );
3648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
3649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Retransmit only on last message from previous flight, to avoid
3652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * too many retransmissions.
3653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Besides, No sane server ever retransmits HelloVerifyRequest */
3654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( recv_msg_seq == ssl->handshake->in_flight_start_seq - 1 &&
3655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_VERIFY_REQUEST )
3656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "received message from last flight, "
3658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     "message_seq = %d, start_of_flight = %d",
3659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     recv_msg_seq,
3660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     ssl->handshake->in_flight_start_seq ) );
3661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ( ret = mbedtls_ssl_resend( ssl ) ) != 0 )
3663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
3664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_resend", ret );
3665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
3666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
3667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
3669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
3670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "dropping out-of-sequence message: "
3671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     "message_seq = %d, expected = %d",
3672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     recv_msg_seq,
3673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     ssl->handshake->in_msg_seq ) );
3674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
3675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CONTINUE_PROCESSING );
3677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Wait until message completion to increment in_msg_seq */
3679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Message reassembly is handled alongside buffering of future
3681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * messages; the commonality is that both handshake fragments and
3682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * future messages cannot be forwarded immediately to the
3683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * handshake logic layer. */
3684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl_hs_is_proper_fragment( ssl ) == 1 )
3685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "found fragmented DTLS handshake message" ) );
3687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
3688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
3691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
3692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* With TLS we don't handle fragmentation (for now) */
3693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen < ssl->in_hslen )
3694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "TLS handshake fragmentation not supported" ) );
3696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
3697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_update_handshake_status( mbedtls_ssl_context *ssl )
3703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
3705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER && hs != NULL )
3707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->update_checksum( ssl, ssl->in_msg, ssl->in_hslen );
3709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Handshake message is complete, increment counter */
3712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
3713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
3714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake != NULL )
3715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned offset;
3717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_hs_buffer *hs_buf;
3718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Increment handshake sequence number */
3720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs->in_msg_seq++;
3721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
3723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Clear up handshake buffering and reassembly structure.
3724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
3725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Free first entry */
3727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_buffering_free_slot( ssl, 0 );
3728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Shift all other entries */
3730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( offset = 0, hs_buf = &hs->buffering.hs[0];
3731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              offset + 1 < MBEDTLS_SSL_MAX_BUFFERED_HS;
3732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              offset++, hs_buf++ )
3733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             *hs_buf = *(hs_buf + 1);
3735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Create a fresh last entry */
3738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( hs_buf, 0, sizeof( mbedtls_ssl_hs_buffer ) );
3739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
3741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * DTLS anti-replay: RFC 6347 4.1.2.6
3745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * in_window is a field of bits numbered from 0 (lsb) to 63 (msb).
3747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Bit n is set iff record number in_window_top - n has been seen.
3748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Usually, in_window_top is the last record number seen and the lsb of
3750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * in_window is set. The only exception is the initial state (record number 0
3751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * not seen yet).
3752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
3754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_dtls_replay_reset( mbedtls_ssl_context *ssl )
3755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_window_top = 0;
3757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_window = 0;
3758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static inline uint64_t ssl_load_six_bytes( unsigned char *buf )
3761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ( (uint64_t) buf[0] << 40 ) |
3763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( (uint64_t) buf[1] << 32 ) |
3764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( (uint64_t) buf[2] << 24 ) |
3765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( (uint64_t) buf[3] << 16 ) |
3766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( (uint64_t) buf[4] <<  8 ) |
3767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( (uint64_t) buf[5]       ) );
3768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Return 0 if sequence number is acceptable, -1 otherwise
3772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_dtls_replay_check( mbedtls_ssl_context *ssl )
3774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint64_t rec_seqnum = ssl_load_six_bytes( ssl->in_ctr + 2 );
3776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint64_t bit;
3777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->anti_replay == MBEDTLS_SSL_ANTI_REPLAY_DISABLED )
3779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
3780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( rec_seqnum > ssl->in_window_top )
3782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
3783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     bit = ssl->in_window_top - rec_seqnum;
3785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( bit >= 64 )
3787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
3788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ssl->in_window & ( (uint64_t) 1 << bit ) ) != 0 )
3790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
3791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
3793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Update replay window on new validated record
3797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_dtls_replay_update( mbedtls_ssl_context *ssl )
3799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint64_t rec_seqnum = ssl_load_six_bytes( ssl->in_ctr + 2 );
3801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->anti_replay == MBEDTLS_SSL_ANTI_REPLAY_DISABLED )
3803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
3804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( rec_seqnum > ssl->in_window_top )
3806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Update window_top and the contents of the window */
3808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         uint64_t shift = rec_seqnum - ssl->in_window_top;
3809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( shift >= 64 )
3811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_window = 1;
3812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
3813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
3814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_window <<= shift;
3815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_window |= 1;
3816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
3817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_window_top = rec_seqnum;
3819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
3821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Mark that number as seen in the current window */
3823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         uint64_t bit = ssl->in_window_top - rec_seqnum;
3824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( bit < 64 ) /* Always true, but be extra sure */
3826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_window |= (uint64_t) 1 << bit;
3827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_ANTI_REPLAY */
3830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) && defined(MBEDTLS_SSL_SRV_C)
3832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Forward declaration */
3833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_session_reset_int( mbedtls_ssl_context *ssl, int partial );
3834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Without any SSL context, check if a datagram looks like a ClientHello with
3837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * a valid cookie, and if it doesn't, generate a HelloVerifyRequest message.
3838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Both input and output include full DTLS headers.
3839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - if cookie is valid, return 0
3841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - if ClientHello looks superficially valid but cookie is not,
3842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   fill obuf and set olen, then
3843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   return MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED
3844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - otherwise return a specific error code
3845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_check_dtls_clihlo_cookie(
3847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            mbedtls_ssl_cookie_write_t *f_cookie_write,
3848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            mbedtls_ssl_cookie_check_t *f_cookie_check,
3849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            void *p_cookie,
3850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const unsigned char *cli_id, size_t cli_id_len,
3851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const unsigned char *in, size_t in_len,
3852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            unsigned char *obuf, size_t buf_len, size_t *olen )
3853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t sid_len, cookie_len;
3855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char *p;
3856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( f_cookie_write == NULL || f_cookie_check == NULL )
3858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
3859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
3861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Structure of ClientHello with record and handshake headers,
3862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * and expected values. We don't need to check a lot, more checks will be
3863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * done when actually parsing the ClientHello - skipping those checks
3864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * avoids code duplication and does not make cookie forging any easier.
3865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  0-0  ContentType type;                  copied, must be handshake
3867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  1-2  ProtocolVersion version;           copied
3868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  3-4  uint16 epoch;                      copied, must be 0
3869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  5-10 uint48 sequence_number;            copied
3870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 11-12 uint16 length;                     (ignored)
3871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 13-13 HandshakeType msg_type;            (ignored)
3873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 14-16 uint24 length;                     (ignored)
3874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 17-18 uint16 message_seq;                copied
3875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 19-21 uint24 fragment_offset;            copied, must be 0
3876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 22-24 uint24 fragment_length;            (ignored)
3877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 25-26 ProtocolVersion client_version;    (ignored)
3879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 27-58 Random random;                     (ignored)
3880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 59-xx SessionID session_id;              1 byte len + sid_len content
3881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 60+   opaque cookie<0..2^8-1>;           1 byte len + content
3882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *       ...
3883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Minimum length is 61 bytes.
3885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
3886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( in_len < 61 ||
3887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         in[0] != MBEDTLS_SSL_MSG_HANDSHAKE ||
3888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         in[3] != 0 || in[4] != 0 ||
3889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         in[19] != 0 || in[20] != 0 || in[21] != 0 )
3890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_HELLO );
3892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     sid_len = in[59];
3895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( sid_len > in_len - 61 )
3896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_HELLO );
3897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     cookie_len = in[60 + sid_len];
3899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cookie_len > in_len - 60 )
3900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_HELLO );
3901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( f_cookie_check( p_cookie, in + sid_len + 61, cookie_len,
3903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         cli_id, cli_id_len ) == 0 )
3904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Valid cookie */
3906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
3907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
3910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * If we get here, we've got an invalid cookie, let's prepare HVR.
3911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  0-0  ContentType type;                  copied
3913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  1-2  ProtocolVersion version;           copied
3914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  3-4  uint16 epoch;                      copied
3915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  5-10 uint48 sequence_number;            copied
3916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 11-12 uint16 length;                     olen - 13
3917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 13-13 HandshakeType msg_type;            hello_verify_request
3919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 14-16 uint24 length;                     olen - 25
3920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 17-18 uint16 message_seq;                copied
3921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 19-21 uint24 fragment_offset;            copied
3922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 22-24 uint24 fragment_length;            olen - 25
3923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 25-26 ProtocolVersion server_version;    0xfe 0xff
3925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * 27-27 opaque cookie<0..2^8-1>;           cookie_len = olen - 27, cookie
3926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
3927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Minimum length is 28.
3928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
3929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( buf_len < 28 )
3930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL );
3931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Copy most fields and adapt others */
3933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( obuf, in, 25 );
3934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[13] = MBEDTLS_SSL_HS_HELLO_VERIFY_REQUEST;
3935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[25] = 0xfe;
3936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[26] = 0xff;
3937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Generate and write actual cookie */
3939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     p = obuf + 28;
3940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( f_cookie_write( p_cookie,
3941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         &p, obuf + buf_len, cli_id, cli_id_len ) != 0 )
3942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
3944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
3945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     *olen = p - obuf;
3947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Go back and fill length fields */
3949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[27] = (unsigned char)( *olen - 28 );
3950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[14] = obuf[22] = (unsigned char)( ( *olen - 25 ) >> 16 );
3952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[15] = obuf[23] = (unsigned char)( ( *olen - 25 ) >>  8 );
3953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[16] = obuf[24] = (unsigned char)( ( *olen - 25 )       );
3954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[11] = (unsigned char)( ( *olen - 13 ) >>  8 );
3956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     obuf[12] = (unsigned char)( ( *olen - 13 )       );
3957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED );
3959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
3960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
3962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Handle possible client reconnect with the same UDP quadruplet
3963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * (RFC 6347 Section 4.2.8).
3964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Called by ssl_parse_record_header() in case we receive an epoch 0 record
3966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * that looks like a ClientHello.
3967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - if the input looks like a ClientHello without cookies,
3969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   send back HelloVerifyRequest, then
3970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   return MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED
3971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - if the input looks like a ClientHello with a valid cookie,
3972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   reset the session of the current context, and
3973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   return MBEDTLS_ERR_SSL_CLIENT_RECONNECT
3974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - if anything goes wrong, return a specific error code
3975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
3976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * mbedtls_ssl_read_record() will ignore the record if anything else than
3977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * MBEDTLS_ERR_SSL_CLIENT_RECONNECT or 0 is returned, although this function
3978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * cannot not return 0.
3979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
3980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_handle_possible_reconnect( mbedtls_ssl_context *ssl )
3981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
3982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
3983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t len;
3984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = ssl_check_dtls_clihlo_cookie(
3986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->conf->f_cookie_write,
3987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->conf->f_cookie_check,
3988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->conf->p_cookie,
3989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->cli_id, ssl->cli_id_len,
3990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_buf, ssl->in_left,
3991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_buf, MBEDTLS_SSL_OUT_CONTENT_LEN, &len );
3992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_RET( 2, "ssl_check_dtls_clihlo_cookie", ret );
3994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
3995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret == MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED )
3996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
3997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Don't check write errors as we can't do anything here.
3998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * If the error is permanent we'll catch it later,
3999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * if it's not, then hopefully it'll work next time. */
4000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         (void) ssl->f_send( ssl->p_bio, ssl->out_buf, len );
4001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_HELLO_VERIFY_REQUIRED );
4003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret == 0 )
4006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Got a valid cookie, partially reset context */
4008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_session_reset_int( ssl, 1 ) ) != 0 )
4009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "reset", ret );
4011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
4012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_CLIENT_RECONNECT );
4015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
4018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE && MBEDTLS_SSL_SRV_C */
4020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
4022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * ContentType type;
4023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * ProtocolVersion version;
4024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * uint16 epoch;            // DTLS only
4025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * uint48 sequence_number;  // DTLS only
4026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * uint16 length;
4027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
4028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Return 0 if header looks sane (and, for DTLS, the record is expected)
4029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * MBEDTLS_ERR_SSL_INVALID_RECORD if the header looks bad,
4030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * MBEDTLS_ERR_SSL_UNEXPECTED_RECORD (DTLS only) if sane but unexpected.
4031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
4032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * With DTLS, mbedtls_ssl_read_record() will:
4033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * 1. proceed with the record if this function returns 0
4034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * 2. drop only the current record if this function returns UNEXPECTED_RECORD
4035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * 3. return CLIENT_RECONNECT if this function return that value
4036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * 4. drop the whole datagram if this function returns anything else.
4037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Point 2 is needed when the peer is resending, and we have already received
4038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * the first record from a datagram but are still waiting for the others.
4039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
4040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_parse_record_header( mbedtls_ssl_context *ssl )
4041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int major_ver, minor_ver;
4043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "input record header", ssl->in_hdr, mbedtls_ssl_hdr_len( ssl ) );
4045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msgtype =  ssl->in_hdr[0];
4047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen = ( ssl->in_len[0] << 8 ) | ssl->in_len[1];
4048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, ssl->in_hdr + 1 );
4049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "input record: msgtype = %d, "
4051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         "version = [%d:%d], msglen = %d",
4052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ssl->in_msgtype,
4053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         major_ver, minor_ver, ssl->in_msglen ) );
4054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check record type */
4056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE &&
4057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_ALERT &&
4058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC &&
4059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
4060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "unknown record type" ) );
4062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Silently ignore invalid DTLS records as recommended by RFC 6347
4065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Section 4.1.2.7 */
4066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport != MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
4069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
4070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check version */
4075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( major_ver != ssl->major_ver )
4076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "major version mismatch" ) );
4078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( minor_ver > ssl->conf->max_minor_ver )
4082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "minor version mismatch" ) );
4084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check length against the size of our buffer */
4088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen > MBEDTLS_SSL_IN_BUFFER_LEN
4089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          - (size_t)( ssl->in_msg - ssl->in_buf ) )
4090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
4096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * DTLS-related tests.
4097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Check epoch before checking length constraint because
4098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * the latter varies with the epoch. E.g., if a ChangeCipherSpec
4099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * message gets duplicated before the corresponding Finished message,
4100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * the second ChangeCipherSpec should be discarded because it belongs
4101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * to an old epoch, but not because its length is shorter than
4102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * the minimum record length for packets using the new record transform.
4103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Note that these two kinds of failures are handled differently,
4104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * as an unexpected record is silently skipped but an invalid
4105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * record leads to the entire datagram being dropped.
4106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
4107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned int rec_epoch = ( ssl->in_ctr[0] << 8 ) | ssl->in_ctr[1];
4111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Check epoch (and sequence number) with DTLS */
4113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( rec_epoch != ssl->in_epoch )
4114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "record from another epoch: "
4116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         "expected %d, received %d",
4117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         ssl->in_epoch, rec_epoch ) );
4118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) && defined(MBEDTLS_SSL_SRV_C)
4120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
4121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Check for an epoch 0 ClientHello. We can't use in_msg here to
4122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * access the first byte of record content (handshake type), as we
4123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * have an active transform (possibly iv_len != 0), so use the
4124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * fact that the record header len is 13 instead.
4125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
4126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
4127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER &&
4128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 rec_epoch == 0 &&
4129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
4130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_left > 13 &&
4131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_buf[13] == MBEDTLS_SSL_HS_CLIENT_HELLO )
4132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "possible client reconnect "
4134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             "from the same port" ) );
4135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ssl_handle_possible_reconnect( ssl ) );
4136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
4138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE && MBEDTLS_SSL_SRV_C */
4139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Consider buffering the record. */
4141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( rec_epoch == (unsigned int) ssl->in_epoch + 1 )
4142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Consider record for buffering" ) );
4144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
4145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
4148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
4152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Replay detection only works for the current epoch */
4153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( rec_epoch == ssl->in_epoch &&
4154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_dtls_replay_check( ssl ) != 0 )
4155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "replayed record" ) );
4157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
4158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
4160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Drop unexpected ApplicationData records,
4162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * except at the beginning of renegotiations */
4163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA &&
4164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER
4165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
4166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             && ! ( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS &&
4167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->state == MBEDTLS_SSL_SERVER_HELLO )
4168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
4169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             )
4170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "dropping unexpected ApplicationData" ) );
4172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
4173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check length against bounds of the current transform and version */
4179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform_in == NULL )
4180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen < 1 ||
4182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen > MBEDTLS_SSL_IN_CONTENT_LEN )
4183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
4189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen < ssl->transform_in->minlen )
4191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
4197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 &&
4198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen + MBEDTLS_SSL_IN_CONTENT_LEN )
4199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
4204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
4205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
4206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
4207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * TLS encrypted messages can have up to 256 bytes of padding
4208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
4209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 &&
4210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen +
4211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              MBEDTLS_SSL_IN_CONTENT_LEN + 256 )
4212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
4217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
4223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * If applicable, decrypt (and decompress) record content
4224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
4225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_prepare_record_content( mbedtls_ssl_context *ssl )
4226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, done = 0;
4228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "input record from network",
4230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->in_hdr, mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen );
4231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
4233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_read != NULL )
4234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_read()" ) );
4236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_hw_record_read( ssl );
4238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != 0 && ret != MBEDTLS_ERR_SSL_HW_ACCEL_FALLTHROUGH )
4239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_read", ret );
4241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
4242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret == 0 )
4245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             done = 1;
4246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_HW_RECORD_ACCEL */
4248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !done && ssl->transform_in != NULL )
4249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_decrypt_buf( ssl ) ) != 0 )
4251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_decrypt_buf", ret );
4253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
4254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 4, "input payload after decrypt",
4257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->in_msg, ssl->in_msglen );
4258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen > MBEDTLS_SSL_IN_CONTENT_LEN )
4260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad message length" ) );
4262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
4263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
4267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform_in != NULL &&
4268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_in->compression == MBEDTLS_SSL_COMPRESS_DEFLATE )
4269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_decompress_buf( ssl ) ) != 0 )
4271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_decompress_buf", ret );
4273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
4274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ZLIB_SUPPORT */
4277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
4279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_dtls_replay_update( ssl );
4282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
4284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_handshake_wrapup_free_hs_transform( mbedtls_ssl_context *ssl );
4289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
4291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Read a record.
4292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
4293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Silently ignore non-fatal alert (and for DTLS, invalid records as well,
4294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * RFC 6347 4.1.2.7) and continue reading until a valid record is found.
4295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
4296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
4297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Helper functions for mbedtls_ssl_read_record(). */
4299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_consume_current_message( mbedtls_ssl_context *ssl );
4300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_get_next_record( mbedtls_ssl_context *ssl );
4301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_record_is_in_progress( mbedtls_ssl_context *ssl );
4302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_read_record( mbedtls_ssl_context *ssl,
4304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              unsigned update_hs_digest )
4305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
4307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> read record" ) );
4309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->keep_current_message == 0 )
4311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         do {
4313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = ssl_consume_current_message( ssl );
4315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret != 0 )
4316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
4317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl_record_is_in_progress( ssl ) == 0 )
4319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 int have_buffered = 0;
4322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* We only check for buffered messages if the
4324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * current datagram is fully consumed. */
4325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
4326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl_next_record_is_in_datagram( ssl ) == 0 )
4327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( ssl_load_buffered_message( ssl ) == 0 )
4329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         have_buffered = 1;
4330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( have_buffered == 0 )
4333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret = ssl_get_next_record( ssl );
4336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( ret == MBEDTLS_ERR_SSL_CONTINUE_PROCESSING )
4337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         continue;
4338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( ret != 0 )
4340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     {
4341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_RET( 1, ( "ssl_get_next_record" ), ret );
4342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         return( ret );
4343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     }
4344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = mbedtls_ssl_handle_message_type( ssl );
4348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_EARLY_MESSAGE )
4351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Buffer future message */
4353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = ssl_buffer_message( ssl );
4354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ret != 0 )
4355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
4356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_CONTINUE_PROCESSING;
4358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         } while( MBEDTLS_ERR_SSL_NON_FATAL           == ret  ||
4362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  MBEDTLS_ERR_SSL_CONTINUE_PROCESSING == ret );
4363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( 0 != ret )
4365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, ( "mbedtls_ssl_handle_message_type" ), ret );
4367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
4368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE &&
4371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             update_hs_digest == 1 )
4372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_update_handshake_status( ssl );
4374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
4377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "reuse previously read message" ) );
4379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->keep_current_message = 0;
4380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= read record" ) );
4383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_next_record_is_in_datagram( mbedtls_ssl_context *ssl )
4389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_left > ssl->next_record_offset )
4391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
4392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_load_buffered_message( mbedtls_ssl_context *ssl )
4397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_hs_buffer * hs_buf;
4400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
4401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs == NULL )
4403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
4404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_load_buffered_messsage" ) );
4406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state == MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC ||
4408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state == MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC )
4409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Check if we have seen a ChangeCipherSpec before.
4411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * If yes, synthesize a CCS record. */
4412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( !hs->buffering.seen_ccs )
4413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "CCS not seen in the current flight" ) );
4415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = -1;
4416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto exit;
4417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Injecting buffered CCS message" ) );
4420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype = MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC;
4421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msglen = 1;
4422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msg[0] = 1;
4423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* As long as they are equal, the exact value doesn't matter. */
4425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_left            = 0;
4426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->next_record_offset = 0;
4427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs->buffering.seen_ccs = 0;
4429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
4430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DEBUG_C)
4433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Debug only */
4434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned offset;
4436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( offset = 1; offset < MBEDTLS_SSL_MAX_BUFFERED_HS; offset++ )
4437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             hs_buf = &hs->buffering.hs[offset];
4439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( hs_buf->is_valid == 1 )
4440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "Future message with sequence number %u %s buffered.",
4442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             hs->in_msg_seq + offset,
4443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             hs_buf->is_complete ? "fully" : "partially" ) );
4444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_DEBUG_C */
4448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check if we have buffered and/or fully reassembled the
4450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * next handshake message. */
4451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hs_buf = &hs->buffering.hs[0];
4452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( hs_buf->is_valid == 1 ) && ( hs_buf->is_complete == 1 ) )
4453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Synthesize a record containing the buffered HS message. */
4455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         size_t msg_len = ( hs_buf->data[1] << 16 ) |
4456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          ( hs_buf->data[2] << 8  ) |
4457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            hs_buf->data[3];
4458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Double-check that we haven't accidentally buffered
4460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * a message that doesn't fit into the input buffer. */
4461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( msg_len + 12 > MBEDTLS_SSL_IN_CONTENT_LEN )
4462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Next handshake message has been buffered - load" ) );
4468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_BUF( 3, "Buffered handshake message (incl. header)",
4469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                hs_buf->data, msg_len + 12 );
4470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
4472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen   = msg_len + 12;
4473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msglen  = msg_len + 12;
4474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->in_msg, hs_buf->data, ssl->in_hslen );
4475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = 0;
4477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
4478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
4480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Next handshake message %u not or only partially bufffered",
4482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     hs->in_msg_seq ) );
4483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = -1;
4486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** exit:
4488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_load_buffered_message" ) );
4490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
4491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_buffer_make_space( mbedtls_ssl_context *ssl,
4494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   size_t desired )
4495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int offset;
4497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Attempt to free buffered messages to have %u bytes available",
4499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 (unsigned) desired ) );
4500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Get rid of future records epoch first, if such exist. */
4502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_free_buffered_record( ssl );
4503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check if we have enough space available now. */
4505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( desired <= ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      hs->buffering.total_bytes_buffered ) )
4507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Enough space available after freeing future epoch record" ) );
4509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* We don't have enough space to buffer the next expected handshake
4513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * message. Remove buffers used for future messages to gain space,
4514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * starting with the most distant one. */
4515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( offset = MBEDTLS_SSL_MAX_BUFFERED_HS - 1;
4516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          offset >= 0; offset-- )
4517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Free buffering slot %d to make space for reassembly of next ha
4519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     offset ) );
4520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_buffering_free_slot( ssl, (uint8_t) offset );
4522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Check if we have enough space available now. */
4524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( desired <= ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          hs->buffering.total_bytes_buffered ) )
4526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Enough space available after freeing buffered HS messages"
4528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
4529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( -1 );
4533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_buffer_message( mbedtls_ssl_context *ssl )
4536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
4538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs == NULL )
4541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_buffer_message" ) );
4544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( ssl->in_msgtype )
4546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC:
4548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Remember CCS message" ) );
4549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             hs->buffering.seen_ccs = 1;
4551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
4552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_MSG_HANDSHAKE:
4554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned recv_msg_seq_offset;
4556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             unsigned recv_msg_seq = ( ssl->in_msg[4] << 8 ) | ssl->in_msg[5];
4557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_hs_buffer *hs_buf;
4558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t msg_len = ssl->in_hslen - 12;
4559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* We should never receive an old handshake
4561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * message - double-check nonetheless. */
4562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( recv_msg_seq < ssl->handshake->in_msg_seq )
4563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             recv_msg_seq_offset = recv_msg_seq - ssl->handshake->in_msg_seq;
4569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( recv_msg_seq_offset >= MBEDTLS_SSL_MAX_BUFFERED_HS )
4570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Silently ignore -- message too far in the future */
4572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2,
4573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  ( "Ignore future HS message with sequence number %u, "
4574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    "buffering window %u - %u",
4575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    recv_msg_seq, ssl->handshake->in_msg_seq,
4576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    ssl->handshake->in_msg_seq + MBEDTLS_SSL_MAX_BUFFERED_HS - 1 ) );
4577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 goto exit;
4579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering HS message with sequence number %u, offset %u ",
4582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         recv_msg_seq, recv_msg_seq_offset ) );
4583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             hs_buf = &hs->buffering.hs[ recv_msg_seq_offset ];
4585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Check if the buffering for this seq nr has already commenced. */
4587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( !hs_buf->is_valid )
4588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 size_t reassembly_buf_sz;
4590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 hs_buf->is_fragmented =
4592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ( ssl_hs_is_proper_fragment( ssl ) == 1 );
4593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* We copy the message back into the input buffer
4595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * after reassembly, so check that it's not too large.
4596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * This is an implementation-specific limitation
4597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * and not one from the standard, hence it is not
4598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * checked in ssl_check_hs_header(). */
4599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( msg_len + 12 > MBEDTLS_SSL_IN_CONTENT_LEN )
4600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     /* Ignore message */
4602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     goto exit;
4603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Check if we have enough space to buffer the message. */
4606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( hs->buffering.total_bytes_buffered >
4607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DTLS_MAX_BUFFERING )
4608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 reassembly_buf_sz = ssl_get_reassembly_buffer_size( msg_len,
4614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                        hs_buf->is_fragmented );
4615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( reassembly_buf_sz > ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                           hs->buffering.total_bytes_buffered ) )
4618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( recv_msg_seq_offset > 0 )
4620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     {
4621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         /* If we can't buffer a future message because
4622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          * of space limitations -- ignore. */
4623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering of future message of size %u would e
4624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) msg_len, MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) hs->buffering.total_bytes_buffered ) );
4626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         goto exit;
4627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     }
4628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     else
4629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     {
4630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering of future message of size %u would e
4631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) msg_len, MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) hs->buffering.total_bytes_buffered ) );
4633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     }
4634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( ssl_buffer_make_space( ssl, reassembly_buf_sz ) != 0 )
4636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     {
4637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Reassembly of next message of size %u (%u with
4638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) msg_len,
4639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) reassembly_buf_sz,
4640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              (unsigned) hs->buffering.total_bytes_buffered ) );
4642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ret = MBEDTLS_ERR_SSL_BUFFER_TOO_SMALL;
4643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         goto exit;
4644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     }
4645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "initialize reassembly, total length = %d",
4648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             msg_len ) );
4649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 hs_buf->data = mbedtls_calloc( 1, reassembly_buf_sz );
4651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( hs_buf->data == NULL )
4652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret = MBEDTLS_ERR_SSL_ALLOC_FAILED;
4654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     goto exit;
4655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 hs_buf->data_len = reassembly_buf_sz;
4657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Prepare final header: copy msg_type, length and message_seq,
4659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * then add standardised fragment_offset and fragment_length */
4660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 memcpy( hs_buf->data, ssl->in_msg, 6 );
4661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 memset( hs_buf->data + 6, 0, 3 );
4662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 memcpy( hs_buf->data + 9, hs_buf->data + 1, 3 );
4663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 hs_buf->is_valid = 1;
4665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 hs->buffering.total_bytes_buffered += reassembly_buf_sz;
4667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
4669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Make sure msg_type and length are consistent */
4671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( memcmp( hs_buf->data, ssl->in_msg, 4 ) != 0 )
4672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "Fragment header mismatch - ignore" ) );
4674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     /* Ignore */
4675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     goto exit;
4676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( !hs_buf->is_complete )
4680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 size_t frag_len, frag_off;
4682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 unsigned char * const msg = hs_buf->data + 12;
4683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /*
4685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * Check and copy current fragment
4686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  */
4687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Validation of header fields already done in
4689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * mbedtls_ssl_prepare_handshake_record(). */
4690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 frag_off = ssl_get_hs_frag_off( ssl );
4691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 frag_len = ssl_get_hs_frag_len( ssl );
4692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "adding fragment, offset = %d, length = %d",
4694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             frag_off, frag_len ) );
4695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 memcpy( msg + frag_off, ssl->in_msg + 12, frag_len );
4696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( hs_buf->is_fragmented )
4698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     unsigned char * const bitmask = msg + msg_len;
4700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl_bitmask_set( bitmask, frag_off, frag_len );
4701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     hs_buf->is_complete = ( ssl_bitmask_check( bitmask,
4702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                                msg_len ) == 0 );
4703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 else
4705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
4706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     hs_buf->is_complete = 1;
4707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
4708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 2, ( "message %scomplete",
4710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    hs_buf->is_complete ? "" : "not yet " ) );
4711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
4714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
4717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* We don't buffer other types of messages. */
4718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
4719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** exit:
4722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_buffer_message" ) );
4724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
4725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_consume_current_message( mbedtls_ssl_context *ssl )
4729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
4731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Consume last content-layer message and potentially
4732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * update in_msglen which keeps track of the contents'
4733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * consumption state.
4734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
4735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * (1) Handshake messages:
4736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     Remove last handshake message, move content
4737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     and adapt in_msglen.
4738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
4739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * (2) Alert messages:
4740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     Consume whole record content, in_msglen = 0.
4741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
4742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * (3) Change cipher spec:
4743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     Consume whole record content, in_msglen = 0.
4744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
4745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * (4) Application data:
4746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     Don't do anything - the record layer provides
4747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     the application data as a stream transport
4748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     and consumes through mbedtls_ssl_read only.
4749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
4750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
4751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Case (1): Handshake messages */
4753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_hslen != 0 )
4754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Hard assertion to be sure that no application data
4756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * is in flight, as corrupting ssl->in_msglen during
4757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * ssl->in_offt != NULL is fatal. */
4758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_offt != NULL )
4759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
4765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Get next Handshake message in the current record
4766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
4767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Notes:
4769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * (1) in_hslen is not necessarily the size of the
4770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     current handshake content: If DTLS handshake
4771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     fragmentation is used, that's the fragment
4772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     size instead. Using the total handshake message
4773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     size here is faulty and should be changed at
4774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     some point.
4775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * (2) While it doesn't seem to cause problems, one
4776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     has to be very careful not to assume that in_hslen
4777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     is always <= in_msglen in a sensible communication.
4778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     Again, it's wrong for DTLS handshake fragmentation.
4779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     The following check is therefore mandatory, and
4780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     should not be treated as a silently corrected assertion.
4781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     Additionally, ssl->in_hslen might be arbitrarily out of
4782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     bounds after handling a DTLS message with an unexpected
4783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          *     sequence number, see mbedtls_ssl_prepare_handshake_record.
4784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
4785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_hslen < ssl->in_msglen )
4786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen -= ssl->in_hslen;
4788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memmove( ssl->in_msg, ssl->in_msg + ssl->in_hslen,
4789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      ssl->in_msglen );
4790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_BUF( 4, "remaining content in record",
4792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->in_msg, ssl->in_msglen );
4793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
4795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen = 0;
4797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
4798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen   = 0;
4800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Case (4): Application data */
4802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else if( ssl->in_offt != NULL )
4803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Everything else (CCS & Alerts) */
4807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
4808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msglen = 0;
4810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_record_is_in_progress( mbedtls_ssl_context *ssl )
4816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen > 0 )
4818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
4819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_free_buffered_record( mbedtls_ssl_context *ssl )
4826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs == NULL )
4829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
4830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs->buffering.future_record.data != NULL )
4832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs->buffering.total_bytes_buffered -=
4834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             hs->buffering.future_record.len;
4835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( hs->buffering.future_record.data );
4837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs->buffering.future_record.data = NULL;
4838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_load_buffered_record( mbedtls_ssl_context *ssl )
4842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char * rec;
4845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t rec_len;
4846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned rec_epoch;
4847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport != MBEDTLS_SSL_TRANSPORT_DATAGRAM )
4849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs == NULL )
4852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     rec       = hs->buffering.future_record.data;
4855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     rec_len   = hs->buffering.future_record.len;
4856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     rec_epoch = hs->buffering.future_record.epoch;
4857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( rec == NULL )
4859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Only consider loading future records if the
4862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * input buffer is empty. */
4863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl_next_record_is_in_datagram( ssl ) == 1 )
4864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> ssl_load_buffered_record" ) );
4867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( rec_epoch != ssl->in_epoch )
4869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffered record not from current epoch." ) );
4871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
4872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Found buffered record from current epoch - load" ) );
4875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Double-check that the record is not too large */
4877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( rec_len > MBEDTLS_SSL_IN_BUFFER_LEN -
4878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         (size_t)( ssl->in_hdr - ssl->in_buf ) )
4879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
4881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
4882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( ssl->in_hdr, rec, rec_len );
4885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_left = rec_len;
4886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->next_record_offset = 0;
4887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_free_buffered_record( ssl );
4889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** exit:
4891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= ssl_load_buffered_record" ) );
4892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_buffer_future_record( mbedtls_ssl_context *ssl )
4896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
4898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t const rec_hdr_len = 13;
4899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t const total_buf_sz = rec_hdr_len + ssl->in_msglen;
4900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Don't buffer future records outside handshakes. */
4902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs == NULL )
4903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Only buffer handshake records (we are only interested
4906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * in Finished messages). */
4907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
4908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Don't buffer more than one future epoch record. */
4911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs->buffering.future_record.data != NULL )
4912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Don't buffer record if there's not enough buffering space remaining. */
4915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( total_buf_sz > ( MBEDTLS_SSL_DTLS_MAX_BUFFERING -
4916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          hs->buffering.total_bytes_buffered ) )
4917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffering of future epoch record of size %u would exceed the c
4919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         (unsigned) total_buf_sz, MBEDTLS_SSL_DTLS_MAX_BUFFERING,
4920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         (unsigned) hs->buffering.total_bytes_buffered ) );
4921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Buffer record */
4925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "Buffer record from epoch %u",
4926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->in_epoch + 1 ) );
4927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "Buffered record", ssl->in_hdr,
4928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            rec_hdr_len + ssl->in_msglen );
4929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* ssl_parse_record_header() only considers records
4931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * of the next epoch as candidates for buffering. */
4932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hs->buffering.future_record.epoch = ssl->in_epoch + 1;
4933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hs->buffering.future_record.len   = total_buf_sz;
4934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hs->buffering.future_record.data =
4936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_calloc( 1, hs->buffering.future_record.len );
4937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs->buffering.future_record.data == NULL )
4938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* If we run out of RAM trying to buffer a
4940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * record from the next epoch, just ignore. */
4941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
4942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( hs->buffering.future_record.data, ssl->in_hdr, total_buf_sz );
4945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hs->buffering.total_bytes_buffered += total_buf_sz;
4947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
4948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
4949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_get_next_record( mbedtls_ssl_context *ssl )
4953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
4954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
4955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* We might have buffered a future record; if so,
4958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * and if the epoch matches now, load it.
4959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * On success, this call will set ssl->in_left to
4960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * the length of the buffered record, so that
4961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * the calls to ssl_fetch_input() below will
4962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * essentially be no-ops. */
4963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = ssl_load_buffered_record( ssl );
4964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != 0 )
4965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
4966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
4967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_fetch_input( ssl, mbedtls_ssl_hdr_len( ssl ) ) ) != 0 )
4969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_fetch_input", ret );
4971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
4972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
4973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_parse_record_header( ssl ) ) != 0 )
4975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
4976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
4977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
4978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret != MBEDTLS_ERR_SSL_CLIENT_RECONNECT )
4979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
4980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_EARLY_MESSAGE )
4981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = ssl_buffer_future_record( ssl );
4983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ret != 0 )
4984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
4985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Fall through to handling of unexpected records */
4987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_UNEXPECTED_RECORD;
4988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_UNEXPECTED_RECORD )
4991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
4992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Skip unexpected record (but not whole datagram) */
4993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->next_record_offset = ssl->in_msglen
4994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         + mbedtls_ssl_hdr_len( ssl );
4995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
4996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "discarding unexpected record "
4997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             "(header)" ) );
4998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
4999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
5000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
5001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Skip invalid record and the rest of the datagram */
5002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->next_record_offset = 0;
5003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_left = 0;
5004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "discarding invalid record "
5006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             "(header)" ) );
5007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
5008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Get next record */
5010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CONTINUE_PROCESSING );
5011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Read and optionally decrypt the message contents
5018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_fetch_input( ssl,
5020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen ) ) != 0 )
5021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_fetch_input", ret );
5023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Done reading this record, get ready for the next one */
5027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
5029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->next_record_offset = ssl->in_msglen + mbedtls_ssl_hdr_len( ssl );
5031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->next_record_offset < ssl->in_left )
5032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "more than one record within datagram" ) );
5034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
5037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_left = 0;
5039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_prepare_record_content( ssl ) ) != 0 )
5041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
5044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Silently discard invalid records */
5046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_INVALID_RECORD ||
5047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret == MBEDTLS_ERR_SSL_INVALID_MAC )
5048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
5049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* Except when waiting for Finished as a bad mac here
5050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * probably means something went wrong in the handshake
5051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * (eg wrong psk used, mitm downgrade attempt, etc.) */
5052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->state == MBEDTLS_SSL_CLIENT_FINISHED ||
5053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->state == MBEDTLS_SSL_SERVER_FINISHED )
5054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
5055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ALL_ALERT_MESSAGES)
5056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( ret == MBEDTLS_ERR_SSL_INVALID_MAC )
5057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     {
5058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         mbedtls_ssl_send_alert_message( ssl,
5059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 MBEDTLS_SSL_ALERT_MSG_BAD_RECORD_MAC );
5061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     }
5062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
5064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
5065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_BADMAC_LIMIT)
5067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->conf->badmac_limit != 0 &&
5068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ++ssl->badmac_seen >= ssl->conf->badmac_limit )
5069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
5070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "too many records with bad MAC" ) );
5071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INVALID_MAC );
5072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
5073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* As above, invalid records cause
5076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * dismissal of the whole datagram. */
5077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->next_record_offset = 0;
5079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_left = 0;
5080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "discarding invalid record (mac)" ) );
5082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONTINUE_PROCESSING );
5083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
5084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
5086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
5088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Error out (and send alert) on invalid records */
5091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ALL_ALERT_MESSAGES)
5092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_INVALID_MAC )
5093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
5094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_send_alert_message( ssl,
5095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_ALERT_MSG_BAD_RECORD_MAC );
5097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
5098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
5100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
5104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_handle_message_type( mbedtls_ssl_context *ssl )
5107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
5109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Handle particular types of records
5112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE )
5114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_prepare_handshake_record( ssl ) ) != 0 )
5116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
5118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
5122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen != 1 )
5124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid CCS message, len: %d",
5126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->in_msglen ) );
5127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
5128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msg[0] != 1 )
5131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid CCS message, content: %02x",
5133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         ssl->in_msg[0] ) );
5134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
5135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
5139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state != MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC    &&
5140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state != MBEDTLS_SSL_SERVER_CHANGE_CIPHER_SPEC )
5141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->handshake == NULL )
5143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
5144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "dropping ChangeCipherSpec outside handshake" ) );
5145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_RECORD );
5146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
5147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "received out-of-order ChangeCipherSpec - remember" ) );
5149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_EARLY_MESSAGE );
5150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype == MBEDTLS_SSL_MSG_ALERT )
5155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen != 2 )
5157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Note: Standard allows for more than one 2 byte alert
5159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                to be packed in a single message, but Mbed TLS doesn't
5160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                currently support this. */
5161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "invalid alert message, len: %d",
5162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->in_msglen ) );
5163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_RECORD );
5164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "got an alert message, type: [%d:%d]",
5167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        ssl->in_msg[0], ssl->in_msg[1] ) );
5168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
5170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Ignore non-fatal alerts, except close_notify and no_renegotiation
5171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
5172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_FATAL )
5173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "is a fatal alert message (msg %d)",
5175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->in_msg[1] ) );
5176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_FATAL_ALERT_MESSAGE );
5177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_WARNING &&
5180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY )
5181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "is a close notify message" ) );
5183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_PEER_CLOSE_NOTIFY );
5184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION_ENABLED)
5187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_WARNING &&
5188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_NO_RENEGOTIATION )
5189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "is a SSLv3 no renegotiation alert" ) );
5191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Will be handled when trying to parse ServerHello */
5192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
5193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) && defined(MBEDTLS_SSL_SRV_C)
5197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 &&
5198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
5199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[0] == MBEDTLS_SSL_ALERT_LEVEL_WARNING &&
5200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_NO_CERT )
5201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "is a SSLv3 no_cert" ) );
5203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Will be handled in mbedtls_ssl_parse_certificate() */
5204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
5205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 && MBEDTLS_SSL_SRV_C */
5207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Silently ignore: fetch new message */
5209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return MBEDTLS_ERR_SSL_NON_FATAL;
5210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
5214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake != NULL &&
5215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER  )
5216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_handshake_wrapup_free_hs_transform( ssl );
5218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
5222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_send_fatal_handshake_failure( mbedtls_ssl_context *ssl )
5225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
5227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_send_alert_message( ssl,
5229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_ALERT_MSG_HANDSHAKE_FAILURE ) ) != 0 )
5231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
5236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_send_alert_message( mbedtls_ssl_context *ssl,
5239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             unsigned char level,
5240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             unsigned char message )
5241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
5243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
5245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
5246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> send alert message" ) );
5248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "send alert level=%u message=%u", level, message ));
5249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_ALERT;
5251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen = 2;
5252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0] = level;
5253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[1] = message;
5254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_record( ssl, SSL_FORCE_FLUSH ) ) != 0 )
5256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_record", ret );
5258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= send alert message" ) );
5261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
5263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
5266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Handshake functions
5267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
5268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)         && \
5269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)     && \
5270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)     && \
5271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)   && \
5272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED) && \
5273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)    && \
5274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
5275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* No certificate support -> dummy functions */
5276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl )
5277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
5279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write certificate" ) );
5281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
5283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
5284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
5285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
5286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate" ) );
5288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
5289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
5290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
5293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
5294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl )
5297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
5299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse certificate" ) );
5301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
5303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
5304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
5305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
5306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
5309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
5310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
5313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
5314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
5317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Some certificate support -> implement write and parse */
5318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write_certificate( mbedtls_ssl_context *ssl )
5320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
5322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t i, n;
5323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_x509_crt *crt;
5324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
5325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write certificate" ) );
5327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
5329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
5330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
5331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
5332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate" ) );
5334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
5335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
5336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
5339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
5340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->client_auth == 0 )
5342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip write certificate" ) );
5344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state++;
5345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
5346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
5349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
5350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * If using SSLv3 and got no cert, send an Alert message
5351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * (otherwise an empty Certificate message will be sent).
5352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
5353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mbedtls_ssl_own_cert( ssl )  == NULL &&
5354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
5355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen  = 2;
5357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msgtype = MBEDTLS_SSL_MSG_ALERT;
5358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[0]  = MBEDTLS_SSL_ALERT_LEVEL_WARNING;
5359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[1]  = MBEDTLS_SSL_ALERT_MSG_NO_CERT;
5360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "got no certificate to send" ) );
5362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto write_msg;
5363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
5365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
5367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
5369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mbedtls_ssl_own_cert( ssl ) == NULL )
5371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "got no certificate to send" ) );
5373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CERTIFICATE_REQUIRED );
5374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_CRT( 3, "own certificate", mbedtls_ssl_own_cert( ssl ) );
5379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     0  .  0    handshake type
5382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     1  .  3    handshake length
5383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     4  .  6    length of all certs
5384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     7  .  9    length of cert. 1
5385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *    10  . n-1   peer certificate
5386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     n  . n+2   length of cert. 2
5387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *    n+3 . ...   upper level cert, etc.
5388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     i = 7;
5390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     crt = mbedtls_ssl_own_cert( ssl );
5391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( crt != NULL )
5393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         n = crt->raw.len;
5395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( n > MBEDTLS_SSL_OUT_CONTENT_LEN - 3 - i )
5396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "certificate too large, %d > %d",
5398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            i + 3 + n, MBEDTLS_SSL_OUT_CONTENT_LEN ) );
5399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_CERTIFICATE_TOO_LARGE );
5400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[i    ] = (unsigned char)( n >> 16 );
5403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[i + 1] = (unsigned char)( n >>  8 );
5404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[i + 2] = (unsigned char)( n       );
5405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += 3; memcpy( ssl->out_msg + i, crt->raw.p, n );
5407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += n; crt = crt->next;
5408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[4]  = (unsigned char)( ( i - 7 ) >> 16 );
5411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[5]  = (unsigned char)( ( i - 7 ) >>  8 );
5412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[6]  = (unsigned char)( ( i - 7 )       );
5413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen  = i;
5415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
5416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_CERTIFICATE;
5417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) && defined(MBEDTLS_SSL_CLI_C)
5419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** write_msg:
5420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state++;
5423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
5425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
5427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write certificate" ) );
5431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
5433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_parse_certificate( mbedtls_ssl_context *ssl )
5436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
5438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t i, n;
5439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ssl_ciphersuite_t *ciphersuite_info = ssl->transform_negotiate->ciphersuite_info;
5440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int authmode = ssl->conf->authmode;
5441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint8_t alert;
5442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse certificate" ) );
5444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_PSK ||
5446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
5447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
5448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
5449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
5452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
5453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
5457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_RSA_PSK )
5458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
5461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
5462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
5465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->sni_authmode != MBEDTLS_SSL_VERIFY_UNSET )
5466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         authmode = ssl->handshake->sni_authmode;
5467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
5470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         authmode == MBEDTLS_SSL_VERIFY_NONE )
5471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate->verify_result = MBEDTLS_X509_BADCERT_SKIP_VERIFY;
5473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= skip parse certificate" ) );
5474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
5475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
5476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
5480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* mbedtls_ssl_read_record may have sent an alert already. We
5482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****            let it decide whether to alert. */
5483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
5484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state++;
5488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
5490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
5491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Check if the client sent an empty certificate
5493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint  == MBEDTLS_SSL_IS_SERVER &&
5495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
5496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen  == 2                        &&
5498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_ALERT            &&
5499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[0]  == MBEDTLS_SSL_ALERT_LEVEL_WARNING  &&
5500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[1]  == MBEDTLS_SSL_ALERT_MSG_NO_CERT )
5501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "SSLv3 client has no certificate" ) );
5503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* The client was asked for a certificate but didn't send
5505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                one. The client should know what's going on, so we
5506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                don't send an alert. */
5507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->session_negotiate->verify_result = MBEDTLS_X509_BADCERT_MISSING;
5508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( authmode == MBEDTLS_SSL_VERIFY_OPTIONAL )
5509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( 0 );
5510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
5511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_NO_CLIENT_CERTIFICATE );
5512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
5515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
5517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
5518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint  == MBEDTLS_SSL_IS_SERVER &&
5519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver != MBEDTLS_SSL_MINOR_VERSION_0 )
5520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_hslen   == 3 + mbedtls_ssl_hs_hdr_len( ssl ) &&
5522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE    &&
5523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[0]  == MBEDTLS_SSL_HS_CERTIFICATE   &&
5524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcmp( ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl ), "\0\0\0", 3 ) == 0 )
5525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "TLSv1 client has no certificate" ) );
5527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* The client was asked for a certificate but didn't send
5529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                one. The client should know what's going on, so we
5530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                don't send an alert. */
5531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->session_negotiate->verify_result = MBEDTLS_X509_BADCERT_MISSING;
5532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( authmode == MBEDTLS_SSL_VERIFY_OPTIONAL )
5533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( 0 );
5534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
5535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_NO_CLIENT_CERTIFICATE );
5536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 || \
5539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
5540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
5541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
5543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
5547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
5548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msg[0] != MBEDTLS_SSL_HS_CERTIFICATE ||
5551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen < mbedtls_ssl_hs_hdr_len( ssl ) + 3 + 3 )
5552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     i = mbedtls_ssl_hs_hdr_len( ssl );
5560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Same message structure as in mbedtls_ssl_write_certificate()
5563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     n = ( ssl->in_msg[i+1] << 8 ) | ssl->in_msg[i+2];
5565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msg[i] != 0 ||
5567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen != n + 3 + mbedtls_ssl_hs_hdr_len( ssl ) )
5568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* In case we tried to reuse a session but it failed */
5576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_negotiate->peer_cert != NULL )
5577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_x509_crt_free( ssl->session_negotiate->peer_cert );
5579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session_negotiate->peer_cert );
5580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ssl->session_negotiate->peer_cert = mbedtls_calloc( 1,
5583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     sizeof( mbedtls_x509_crt ) ) ) == NULL )
5584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed",
5586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        sizeof( mbedtls_x509_crt ) ) );
5587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
5589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
5590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_x509_crt_init( ssl->session_negotiate->peer_cert );
5593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     i += 3;
5595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( i < ssl->in_hslen )
5597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if ( i + 3 > ssl->in_hslen ) {
5599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                            MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msg[i] != 0 )
5605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         n = ( (unsigned int) ssl->in_msg[i + 1] << 8 )
5613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             | (unsigned int) ssl->in_msg[i + 2];
5614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += 3;
5615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( n < 128 || i + n > ssl->in_hslen )
5617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
5619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
5621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_x509_crt_parse_der( ssl->session_negotiate->peer_cert,
5625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->in_msg + i, n );
5626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         switch( ret )
5627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case 0: /*ok*/
5629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_ERR_X509_UNKNOWN_SIG_ALG + MBEDTLS_ERR_OID_NOT_FOUND:
5630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Ignore certificate with an unknown algorithm: maybe a
5631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                prior certificate was already trusted. */
5632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
5633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_ERR_X509_ALLOC_FAILED:
5635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             alert = MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR;
5636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto crt_parse_der_failed;
5637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_ERR_X509_UNKNOWN_VERSION:
5639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
5640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto crt_parse_der_failed;
5641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
5643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             alert = MBEDTLS_SSL_ALERT_MSG_BAD_CERT;
5644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         crt_parse_der_failed:
5645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL, alert );
5646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, " mbedtls_x509_crt_parse_der", ret );
5647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
5648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += n;
5651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_CRT( 3, "peer certificate", ssl->session_negotiate->peer_cert );
5654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * On client, make sure the server cert doesn't change during renego to
5657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * avoid "triple handshake" attack: https://secure-resumption.com/
5658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION) && defined(MBEDTLS_SSL_CLI_C)
5660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT &&
5661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
5662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->session->peer_cert == NULL )
5664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "new server cert during renegotiation" ) );
5666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED );
5668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->session->peer_cert->raw.len !=
5672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->session_negotiate->peer_cert->raw.len ||
5673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcmp( ssl->session->peer_cert->raw.p,
5674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->session_negotiate->peer_cert->raw.p,
5675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->session->peer_cert->raw.len ) != 0 )
5676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "server cert changed during renegotiation" ) );
5678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED );
5680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE );
5681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION && MBEDTLS_SSL_CLI_C */
5684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( authmode != MBEDTLS_SSL_VERIFY_NONE )
5686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_x509_crt *ca_chain;
5688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_x509_crl *ca_crl;
5689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
5691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->handshake->sni_ca_chain != NULL )
5692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ca_chain = ssl->handshake->sni_ca_chain;
5694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ca_crl   = ssl->handshake->sni_ca_crl;
5695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
5697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ca_chain = ssl->conf->ca_chain;
5700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ca_crl   = ssl->conf->ca_crl;
5701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
5704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Main check: verify certificate
5705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
5706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_x509_crt_verify_with_profile(
5707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
5708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ca_chain, ca_crl,
5709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->conf->cert_profile,
5710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->hostname,
5711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                &ssl->session_negotiate->verify_result,
5712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->conf->f_vrfy, ssl->conf->p_vrfy );
5713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != 0 )
5715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "x509_verify_cert", ret );
5717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
5720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Secondary checks: always done, but change 'ret' only if it was 0
5721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
5722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
5724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const mbedtls_pk_context *pk = &ssl->session_negotiate->peer_cert->pk;
5726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* If certificate uses an EC key, make sure the curve is OK */
5728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( mbedtls_pk_can_do( pk, MBEDTLS_PK_ECKEY ) &&
5729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_check_curve( ssl, mbedtls_pk_ec( *pk )->grp.id ) != 0 )
5730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
5731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->session_negotiate->verify_result |= MBEDTLS_X509_BADCERT_BAD_KEY;
5732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate (EC key curve)" ) );
5734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ret == 0 )
5735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret = MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE;
5736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
5737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
5739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mbedtls_ssl_check_cert_usage( ssl->session_negotiate->peer_cert,
5741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  ciphersuite_info,
5742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  ! ssl->conf->endpoint,
5743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  &ssl->session_negotiate->verify_result ) != 0 )
5744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate (usage extensions)" ) );
5746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == 0 )
5747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE;
5748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* mbedtls_x509_crt_verify_with_profile is supposed to report a
5751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * verification failure through MBEDTLS_ERR_X509_CERT_VERIFY_FAILED,
5752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * with details encoded in the verification flags. All other kinds
5753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * of error codes, including those from the user provided f_vrfy
5754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * functions, are treated as fatal and lead to a failure of
5755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * ssl_parse_certificate even if verification was optional. */
5756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( authmode == MBEDTLS_SSL_VERIFY_OPTIONAL &&
5757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ret == MBEDTLS_ERR_X509_CERT_VERIFY_FAILED ||
5758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ret == MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE ) )
5759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = 0;
5761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ca_chain == NULL && authmode == MBEDTLS_SSL_VERIFY_REQUIRED )
5764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "got no CA chain" ) );
5766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret = MBEDTLS_ERR_SSL_CA_CHAIN_REQUIRED;
5767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != 0 )
5770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* The certificate may have been rejected for several reasons.
5772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                Pick one and send the corresponding alert. Which alert to send
5773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                may be a subject of debate in some cases. */
5774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_OTHER )
5775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED;
5776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_CN_MISMATCH )
5777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_BAD_CERT;
5778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_KEY_USAGE )
5779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
5780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_EXT_KEY_USAGE )
5781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
5782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_NS_CERT_TYPE )
5783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
5784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_BAD_PK )
5785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
5786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_BAD_KEY )
5787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
5788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_EXPIRED )
5789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_EXPIRED;
5790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_REVOKED )
5791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_REVOKED;
5792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_NOT_TRUSTED )
5793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNKNOWN_CA;
5794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
5795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_UNKNOWN;
5796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             alert );
5798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DEBUG_C)
5801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->session_negotiate->verify_result != 0 )
5802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "! Certificate verification flags %x",
5804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         ssl->session_negotiate->verify_result ) );
5805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
5807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 3, ( "Certificate verification flags clear" ) );
5809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_DEBUG_C */
5811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse certificate" ) );
5814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
5816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* !MBEDTLS_KEY_EXCHANGE_RSA_ENABLED
5818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED
5819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED
5820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED
5821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED
5822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED
5823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           !MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
5824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write_change_cipher_spec( mbedtls_ssl_context *ssl )
5826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
5828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write change cipher spec" ) );
5830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC;
5832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen  = 1;
5833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = 1;
5834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state++;
5836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
5838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
5840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write change cipher spec" ) );
5844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
5846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_parse_change_cipher_spec( mbedtls_ssl_context *ssl )
5849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
5851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse change cipher spec" ) );
5853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
5855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
5857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
5858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
5861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad change cipher spec message" ) );
5863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
5865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
5866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* CCS records are only accepted if they have length 1 and content '1',
5869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * so we don't need to check this here. */
5870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
5872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Switch to our negotiated transform and session parameters for inbound
5873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * data.
5874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
5875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "switching to new transform spec for inbound data" ) );
5876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_in = ssl->transform_negotiate;
5877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_in = ssl->session_negotiate;
5878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
5880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
5881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
5883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_dtls_replay_reset( ssl );
5884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Increment epoch */
5887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ++ssl->in_epoch == 0 )
5888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "DTLS epoch would wrap" ) );
5890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* This is highly unlikely to happen for legitimate reasons, so
5891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                treat it as an attack and don't send an alert. */
5892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
5893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
5896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
5897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl->in_ctr, 0, 8 );
5898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_in_pointers( ssl, ssl->transform_negotiate );
5900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
5902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_activate != NULL )
5903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_activate( ssl, MBEDTLS_SSL_CHANNEL_INBOUND ) ) != 0 )
5905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
5906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_activate", ret );
5907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
5908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
5909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
5910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
5911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state++;
5915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse change cipher spec" ) );
5917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
5919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_optimize_checksum( mbedtls_ssl_context *ssl,
5922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             const mbedtls_ssl_ciphersuite_t *ciphersuite_info )
5923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ciphersuite_info);
5925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
5927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
5928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver < MBEDTLS_SSL_MINOR_VERSION_3 )
5929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_md5sha1;
5930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
5931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
5933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
5934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ciphersuite_info->mac == MBEDTLS_MD_SHA384 )
5935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_sha384;
5936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
5937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
5939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ciphersuite_info->mac != MBEDTLS_MD_SHA384 )
5940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_sha256;
5941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
5942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
5944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
5945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
5946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
5947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
5948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_reset_checksum( mbedtls_ssl_context *ssl )
5951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
5953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
5954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      mbedtls_md5_starts_ret( &ssl->handshake->fin_md5  );
5955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_starts_ret( &ssl->handshake->fin_sha1 );
5956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
5958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
5959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_starts_ret( &ssl->handshake->fin_sha256, 0 );
5960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
5962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_starts_ret( &ssl->handshake->fin_sha512, 1 );
5963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
5965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_start( mbedtls_ssl_context *ssl,
5968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        const unsigned char *buf, size_t len )
5969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
5971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
5972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      mbedtls_md5_update_ret( &ssl->handshake->fin_md5 , buf, len );
5973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &ssl->handshake->fin_sha1, buf, len );
5974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
5976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
5977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_update_ret( &ssl->handshake->fin_sha256, buf, len );
5978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
5980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_update_ret( &ssl->handshake->fin_sha512, buf, len );
5981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
5983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
5986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
5987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_md5sha1( mbedtls_ssl_context *ssl,
5988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          const unsigned char *buf, size_t len )
5989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
5990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      mbedtls_md5_update_ret( &ssl->handshake->fin_md5 , buf, len );
5991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &ssl->handshake->fin_sha1, buf, len );
5992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
5993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
5994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
5995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
5996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
5997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_sha256( mbedtls_ssl_context *ssl,
5998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         const unsigned char *buf, size_t len )
5999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_update_ret( &ssl->handshake->fin_sha256, buf, len );
6001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_checksum_sha384( mbedtls_ssl_context *ssl,
6006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         const unsigned char *buf, size_t len )
6007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_update_ret( &ssl->handshake->fin_sha512, buf, len );
6009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
6014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_ssl(
6015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const char *sender;
6018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_context  md5;
6019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_context sha1;
6020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char padbuf[48];
6022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char md5sum[16];
6023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char sha1sum[20];
6024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !session )
6027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session = ssl->session;
6028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished ssl" ) );
6030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_init( &md5 );
6032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
6033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
6035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
6036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * SSLv3:
6039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   hash =
6040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *      MD5( master + pad2 +
6041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *          MD5( handshake + sender + master + pad1 ) )
6042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   + SHA1( master + pad2 +
6043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *         SHA1( handshake + sender + master + pad1 ) )
6044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_MD5_ALT)
6047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished  md5 state", (unsigned char *)
6048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     md5.state, sizeof(  md5.state ) );
6049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SHA1_ALT)
6052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha1 state", (unsigned char *)
6053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    sha1.state, sizeof( sha1.state ) );
6054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT ) ? "CLNT"
6057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        : "SRVR";
6058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( padbuf, 0x36, 48 );
6060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, (const unsigned char *) sender, 4 );
6062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, session->master, 48 );
6063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, padbuf, 48 );
6064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, md5sum );
6065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, (const unsigned char *) sender, 4 );
6067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, session->master, 48 );
6068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, padbuf, 40 );
6069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, sha1sum );
6070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( padbuf, 0x5C, 48 );
6072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_starts_ret( &md5 );
6074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, session->master, 48 );
6075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, padbuf, 48 );
6076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_update_ret( &md5, md5sum, 16 );
6077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_finish_ret( &md5, buf );
6078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_starts_ret( &sha1 );
6080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, session->master, 48 );
6081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, padbuf , 40 );
6082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_update_ret( &sha1, sha1sum, 20 );
6083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, buf + 16 );
6084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, 36 );
6086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free(  &md5  );
6088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
6089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof(  padbuf ) );
6091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize(  md5sum, sizeof(  md5sum ) );
6092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( sha1sum, sizeof( sha1sum ) );
6093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
6097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
6099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_tls(
6100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int len = 12;
6103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const char *sender;
6104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_context  md5;
6105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_context sha1;
6106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char padbuf[36];
6107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !session )
6110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session = ssl->session;
6111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished tls" ) );
6113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_init( &md5 );
6115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init( &sha1 );
6116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_clone( &md5, &ssl->handshake->fin_md5 );
6118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_clone( &sha1, &ssl->handshake->fin_sha1 );
6119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * TLSv1:
6122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   hash = PRF( master, finished_label,
6123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *               MD5( handshake ) + SHA1( handshake ) )[0..11]
6124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_MD5_ALT)
6127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished  md5 state", (unsigned char *)
6128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     md5.state, sizeof(  md5.state ) );
6129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SHA1_ALT)
6132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha1 state", (unsigned char *)
6133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    sha1.state, sizeof( sha1.state ) );
6134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT )
6137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              ? "client finished"
6138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              : "server finished";
6139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_finish_ret(  &md5, padbuf );
6141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_finish_ret( &sha1, padbuf + 16 );
6142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->tls_prf( session->master, 48, sender,
6144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              padbuf, 36, buf, len );
6145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, len );
6147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free(  &md5  );
6149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free( &sha1 );
6150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof(  padbuf ) );
6152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 */
6156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_tls_sha256(
6160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int len = 12;
6163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const char *sender;
6164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_context sha256;
6165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char padbuf[32];
6166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !session )
6169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session = ssl->session;
6170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_init( &sha256 );
6172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished tls sha256" ) );
6174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_clone( &sha256, &ssl->handshake->fin_sha256 );
6176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * TLSv1.2:
6179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   hash = PRF( master, finished_label,
6180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *               Hash( handshake ) )[0.11]
6181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SHA256_ALT)
6184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha2 state", (unsigned char *)
6185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    sha256.state, sizeof( sha256.state ) );
6186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT )
6189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              ? "client finished"
6190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              : "server finished";
6191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_finish_ret( &sha256, padbuf );
6193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->tls_prf( session->master, 48, sender,
6195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              padbuf, 32, buf, len );
6196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, len );
6198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_free( &sha256 );
6200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof(  padbuf ) );
6202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
6206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_calc_finished_tls_sha384(
6209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_context *ssl, unsigned char *buf, int from )
6210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int len = 12;
6212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const char *sender;
6213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_context sha512;
6214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char padbuf[48];
6215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session *session = ssl->session_negotiate;
6217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !session )
6218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session = ssl->session;
6219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_init( &sha512 );
6221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> calc  finished tls sha384" ) );
6223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_clone( &sha512, &ssl->handshake->fin_sha512 );
6225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * TLSv1.2:
6228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *   hash = PRF( master, finished_label,
6229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *               Hash( handshake ) )[0.11]
6230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SHA512_ALT)
6233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 4, "finished sha512 state", (unsigned char *)
6234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                    sha512.state, sizeof( sha512.state ) );
6235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     sender = ( from == MBEDTLS_SSL_IS_CLIENT )
6238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              ? "client finished"
6239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              : "server finished";
6240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_finish_ret( &sha512, padbuf );
6242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->tls_prf( session->master, 48, sender,
6244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              padbuf, 48, buf, len );
6245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_BUF( 3, "calc finished result", buf, len );
6247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_free( &sha512 );
6249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize(  padbuf, sizeof( padbuf ) );
6251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= calc  finished" ) );
6253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA512_C */
6255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_handshake_wrapup_free_hs_transform( mbedtls_ssl_context *ssl )
6258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "=> handshake wrapup: final free" ) );
6260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Free our handshake params
6263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_free( ssl );
6265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( ssl->handshake );
6266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake = NULL;
6267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Free the previous transform and swith in the current one
6270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform )
6272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform );
6274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform );
6275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform = ssl->transform_negotiate;
6277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_negotiate = NULL;
6278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "<= handshake wrapup: final free" ) );
6280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_handshake_wrapup( mbedtls_ssl_context *ssl )
6283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int resume = ssl->handshake->resume;
6285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "=> handshake wrapup" ) );
6287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
6290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->renego_status =  MBEDTLS_SSL_RENEGOTIATION_DONE;
6292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->renego_records_seen = 0;
6293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Free the previous session and switch in the current one
6298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session )
6300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
6302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* RFC 7366 3.1: keep the EtM state */
6303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate->encrypt_then_mac =
6304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   ssl->session->encrypt_then_mac;
6305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session );
6308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session );
6309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session = ssl->session_negotiate;
6311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_negotiate = NULL;
6312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Add cache entry
6315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->f_set_cache != NULL &&
6317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session->id_len != 0 &&
6318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         resume == 0 )
6319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->f_set_cache( ssl->conf->p_cache, ssl->session ) != 0 )
6321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "cache did not store session" ) );
6322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
6326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->flight != NULL )
6327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Cancel handshake timer */
6329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_set_timer( ssl, 0 );
6330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Keep last flight around in case we need to resend it:
6332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * we need the handshake and transform structures for that */
6333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "skip freeing handshake and transform" ) );
6334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_handshake_wrapup_free_hs_transform( ssl );
6338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state++;
6340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "<= handshake wrapup" ) );
6342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write_finished( mbedtls_ssl_context *ssl )
6345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, hash_len;
6347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write finished" ) );
6349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_out_pointers( ssl, ssl->transform_negotiate );
6351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->calc_finished( ssl, ssl->out_msg + 4, ssl->conf->endpoint );
6353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * RFC 5246 7.4.9 (Page 63) says 12 is the default length and ciphersuites
6356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * may define some other value. Currently (early 2016), no defined
6357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * ciphersuite does this (and this is unlikely to change as activity has
6358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * moved to TLS 1.3 now) so we can keep the hardcoded 12 here.
6359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     hash_len = ( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 ) ? 36 : 12;
6361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->verify_data_len = hash_len;
6364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( ssl->own_verify_data, ssl->out_msg + 4, hash_len );
6365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen  = 4 + hash_len;
6368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
6369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_FINISHED;
6370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * In case of session resuming, invert the client and server
6373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * ChangeCipherSpec messages order.
6374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->resume != 0 )
6376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
6378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
6379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
6380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
6382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
6383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC;
6384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
6388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Switch to our negotiated transform and session parameters for outbound
6391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * data.
6392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "switching to new transform spec for outbound data" ) );
6394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char i;
6399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Remember current epoch settings for resending */
6401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->alt_transform_out = ssl->transform_out;
6402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->handshake->alt_out_ctr, ssl->cur_out_ctr, 8 );
6403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Set sequence_number to zero */
6405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( ssl->cur_out_ctr + 2, 0, 6 );
6406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Increment epoch */
6408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         for( i = 2; i > 0; i-- )
6409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
6410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
6411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* The loop goes to its end iff the counter is wrapping */
6413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( i == 0 )
6414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
6415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "DTLS epoch would wrap" ) );
6416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_COUNTER_WRAPPING );
6417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
6418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
6421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl->cur_out_ctr, 0, 8 );
6422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out = ssl->transform_negotiate;
6424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_out = ssl->session_negotiate;
6425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
6427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_activate != NULL )
6428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_activate( ssl, MBEDTLS_SSL_CHANNEL_OUTBOUND ) ) != 0 )
6430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
6431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_activate", ret );
6432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
6433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
6434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_flight_completed( ssl );
6440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
6443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
6445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
6446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
6450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_ssl_flight_transmit( ssl ) ) != 0 )
6451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flight_transmit", ret );
6453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
6454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write finished" ) );
6458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
6460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
6463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define SSL_MAX_HASH_LEN 36
6464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
6465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #define SSL_MAX_HASH_LEN 12
6466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_parse_finished( mbedtls_ssl_context *ssl )
6469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
6471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned int hash_len;
6472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned char buf[SSL_MAX_HASH_LEN];
6473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> parse finished" ) );
6475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->calc_finished( ssl, buf, ssl->conf->endpoint ^ 1 );
6477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
6479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
6481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
6482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msgtype != MBEDTLS_SSL_MSG_HANDSHAKE )
6485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad finished message" ) );
6487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
6488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
6489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
6490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* There is currently no ciphersuite using another length with TLS 1.2 */
6493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
6494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
6495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hash_len = 36;
6496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hash_len = 12;
6499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msg[0] != MBEDTLS_SSL_HS_FINISHED ||
6501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) + hash_len )
6502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad finished message" ) );
6504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
6505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
6506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_FINISHED );
6507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_safer_memcmp( ssl->in_msg + mbedtls_ssl_hs_hdr_len( ssl ),
6510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       buf, hash_len ) != 0 )
6511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad finished message" ) );
6513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
6514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
6515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_HS_FINISHED );
6516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->verify_data_len = hash_len;
6520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( ssl->peer_verify_data, buf, hash_len );
6521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->resume != 0 )
6524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
6526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
6527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC;
6528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
6530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
6531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
6532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->state++;
6536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_recv_flight_completed( ssl );
6540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= parse finished" ) );
6543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
6545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_handshake_params_init( mbedtls_ssl_handshake_params *handshake )
6548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( handshake, 0, sizeof( mbedtls_ssl_handshake_params ) );
6550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
6552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
6553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      mbedtls_md5_init(   &handshake->fin_md5  );
6554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init(   &handshake->fin_sha1 );
6555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      mbedtls_md5_starts_ret( &handshake->fin_md5  );
6556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_starts_ret( &handshake->fin_sha1 );
6557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
6559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
6560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_init(   &handshake->fin_sha256    );
6561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_starts_ret( &handshake->fin_sha256, 0 );
6562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
6564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_init(   &handshake->fin_sha512    );
6565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_starts_ret( &handshake->fin_sha512, 1 );
6566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
6568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     handshake->update_checksum = ssl_update_checksum_start;
6570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
6572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
6573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_sig_hash_set_init( &handshake->hash_algs );
6574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
6577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_dhm_init( &handshake->dhm_ctx );
6578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECDH_C)
6580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ecdh_init( &handshake->ecdh_ctx );
6581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
6583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ecjpake_init( &handshake->ecjpake_ctx );
6584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
6585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     handshake->ecjpake_cache = NULL;
6586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     handshake->ecjpake_cache_len = 0;
6587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
6591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     handshake->sni_authmode = MBEDTLS_SSL_VERIFY_UNSET;
6592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_transform_init( mbedtls_ssl_transform *transform )
6596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( transform, 0, sizeof(mbedtls_ssl_transform) );
6598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_init( &transform->cipher_ctx_enc );
6600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_init( &transform->cipher_ctx_dec );
6601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_init( &transform->md_ctx_enc );
6603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_init( &transform->md_ctx_dec );
6604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_session_init( mbedtls_ssl_session *session )
6607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( session, 0, sizeof(mbedtls_ssl_session) );
6609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_handshake_init( mbedtls_ssl_context *ssl )
6612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Clear old handshake information if present */
6614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform_negotiate )
6615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform_negotiate );
6616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_negotiate )
6617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session_negotiate );
6618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake )
6619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_handshake_free( ssl );
6620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Either the pointers are now NULL or cleared properly and can be freed.
6623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Now allocate missing structures.
6624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform_negotiate == NULL )
6626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate = mbedtls_calloc( 1, sizeof(mbedtls_ssl_transform) );
6628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_negotiate == NULL )
6631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate = mbedtls_calloc( 1, sizeof(mbedtls_ssl_session) );
6633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake == NULL )
6636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake = mbedtls_calloc( 1, sizeof(mbedtls_ssl_handshake_params) );
6638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* All pointers should exist and can be directly freed without issue */
6641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake == NULL ||
6642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate == NULL ||
6643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate == NULL )
6644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc() of ssl sub-contexts failed" ) );
6646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->handshake );
6648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform_negotiate );
6649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session_negotiate );
6650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake = NULL;
6652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate = NULL;
6653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate = NULL;
6654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
6656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Initialize structures */
6659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session_init( ssl->session_negotiate );
6660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_transform_init( ssl->transform_negotiate );
6661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_handshake_params_init( ssl->handshake );
6662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->alt_transform_out = ssl->transform_out;
6667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
6669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_PREPARING;
6670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
6671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->retransmit_state = MBEDTLS_SSL_RETRANS_WAITING;
6672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_set_timer( ssl, 0 );
6674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
6678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
6681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Dummy cookie callbacks for defaults */
6682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_cookie_write_dummy( void *ctx,
6683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       unsigned char **p, unsigned char *end,
6684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       const unsigned char *cli_id, size_t cli_id_len )
6685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ctx);
6687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) p);
6688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) end);
6689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cli_id);
6690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cli_id_len);
6691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
6693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_cookie_check_dummy( void *ctx,
6696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       const unsigned char *cookie, size_t cookie_len,
6697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       const unsigned char *cli_id, size_t cli_id_len )
6698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ctx);
6700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cookie);
6701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cookie_len);
6702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cli_id);
6703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cli_id_len);
6704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
6706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_HELLO_VERIFY && MBEDTLS_SSL_SRV_C */
6708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Once ssl->out_hdr as the address of the beginning of the
6710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * next outgoing record is set, deduce the other pointers.
6711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
6712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Note: For TLS, we save the implicit record sequence number
6713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *       (entering MAC computation) in the 8 bytes before ssl->out_hdr,
6714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *       and the caller has to make sure there's space for this.
6715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
6716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_out_pointers( mbedtls_ssl_context *ssl,
6718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                      mbedtls_ssl_transform *transform )
6719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 118              		.loc 2 6719 0
 119              		.cfi_startproc
 120              		@ args = 0, pretend = 0, frame = 0
 121              		@ frame_needed = 0, uses_anonymous_args = 0
 122              		@ link register save eliminated.
 123              	.LVL12:
6720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_ctr = ssl->out_hdr +  3;
6724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 11;
6725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_iv  = ssl->out_hdr + 13;
6726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_ctr = ssl->out_hdr - 8;
 124              		.loc 2 6730 0
 125 0000 8C3090E5 		ldr	r3, [r0, #140]
6731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 3;
6732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_iv  = ssl->out_hdr + 5;
6733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Adjust out_msg to make space for explicit IV, if used. */
6736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transform != NULL &&
 126              		.loc 2 6736 0
 127 0004 000051E3 		cmp	r1, #0
6730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 3;
 128              		.loc 2 6730 0
 129 0008 082043E2 		sub	r2, r3, #8
 130 000c 882080E5 		str	r2, [r0, #136]
6731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 3;
 131              		.loc 2 6731 0
 132 0010 032083E2 		add	r2, r3, #3
6732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 133              		.loc 2 6732 0
 134 0014 053083E2 		add	r3, r3, #5
6731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len = ssl->out_hdr + 3;
 135              		.loc 2 6731 0
 136 0018 902080E5 		str	r2, [r0, #144]
6732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 137              		.loc 2 6732 0
 138 001c 943080E5 		str	r3, [r0, #148]
 139              		.loc 2 6736 0
 140 0020 0500000A 		beq	.L8
 141              		.loc 2 6736 0 is_stmt 0 discriminator 1
 142 0024 0C2090E5 		ldr	r2, [r0, #12]
 143 0028 010052E3 		cmp	r2, #1
6737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
6738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg = ssl->out_iv + transform->ivlen - transform->fixed_ivlen;
 144              		.loc 2 6739 0 is_stmt 1 discriminator 1
 145 002c 0C2091C5 		ldrgt	r2, [r1, #12]
 146 0030 101091C5 		ldrgt	r1, [r1, #16]
 147              	.LVL13:
 148 0034 012042C0 		subgt	r2, r2, r1
 149 0038 023083C0 		addgt	r3, r3, r2
 150              	.L8:
6740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg = ssl->out_iv;
 151              		.loc 2 6742 0
 152 003c 983080E5 		str	r3, [r0, #152]
 153 0040 1EFF2FE1 		bx	lr
 154              		.cfi_endproc
 155              	.LFE66:
 157              		.section	.text.ssl_calc_finished_tls_sha256,"ax",%progbits
 158              		.align	2
 159              		.syntax unified
 160              		.arm
 161              		.fpu neon
 163              	ssl_calc_finished_tls_sha256:
 164              	.LFB57:
6161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int len = 12;
 165              		.loc 2 6161 0
 166              		.cfi_startproc
 167              		@ args = 0, pretend = 0, frame = 144
 168              		@ frame_needed = 0, uses_anonymous_args = 0
 169              	.LVL14:
 170 0000 F0412DE9 		push	{r4, r5, r6, r7, r8, lr}
 171              		.cfi_def_cfa_offset 24
 172              		.cfi_offset 4, -24
 173              		.cfi_offset 5, -20
 174              		.cfi_offset 6, -16
 175              		.cfi_offset 7, -12
 176              		.cfi_offset 8, -8
 177              		.cfi_offset 14, -4
 178 0004 A0D04DE2 		sub	sp, sp, #160
 179              		.cfi_def_cfa_offset 184
6167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( !session )
 180              		.loc 2 6167 0
 181 0008 2C5090E5 		ldr	r5, [r0, #44]
 182              	.LVL15:
6161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int len = 12;
 183              		.loc 2 6161 0
 184 000c 0040A0E1 		mov	r4, r0
 185 0010 0280A0E1 		mov	r8, r2
 186 0014 0170A0E1 		mov	r7, r1
6188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              ? "client finished"
 187              		.loc 2 6188 0
 188 0018 80609FE5 		ldr	r6, .L18
6168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session = ssl->session;
 189              		.loc 2 6168 0
 190 001c 000055E3 		cmp	r5, #0
6169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 191              		.loc 2 6169 0
 192 0020 28509005 		ldreq	r5, [r0, #40]
 193              	.LVL16:
6171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 194              		.loc 2 6171 0
 195 0024 34008DE2 		add	r0, sp, #52
 196              	.LVL17:
 197 0028 FEFFFFEB 		bl	mbedtls_sha256_init
 198              	.LVL18:
6175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 199              		.loc 2 6175 0
 200 002c 301094E5 		ldr	r1, [r4, #48]
 201 0030 34008DE2 		add	r0, sp, #52
 202 0034 151E81E2 		add	r1, r1, #336
 203 0038 FEFFFFEB 		bl	mbedtls_sha256_clone
 204              	.LVL19:
6188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              ? "client finished"
 205              		.loc 2 6188 0
 206 003c 60309FE5 		ldr	r3, .L18+4
 207 0040 000058E3 		cmp	r8, #0
6192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 208              		.loc 2 6192 0
 209 0044 14108DE2 		add	r1, sp, #20
 210 0048 34008DE2 		add	r0, sp, #52
6188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              ? "client finished"
 211              		.loc 2 6188 0
 212 004c 0360A011 		movne	r6, r3
 213              	.LVL20:
6192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 214              		.loc 2 6192 0
 215 0050 FEFFFFEB 		bl	mbedtls_sha256_finish_ret
 216              	.LVL21:
6194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              padbuf, 32, buf, len );
 217              		.loc 2 6194 0
 218 0054 303094E5 		ldr	r3, [r4, #48]
 219 0058 0C20A0E3 		mov	r2, #12
 220 005c 2040A0E3 		mov	r4, #32
 221              	.LVL22:
 222 0060 08208DE5 		str	r2, [sp, #8]
 223 0064 04708DE5 		str	r7, [sp, #4]
 224 0068 0620A0E1 		mov	r2, r6
 225 006c 00408DE5 		str	r4, [sp]
 226 0070 3010A0E3 		mov	r1, #48
 227 0074 C87193E5 		ldr	r7, [r3, #456]
 228              	.LVL23:
 229 0078 2C0085E2 		add	r0, r5, #44
 230 007c 14308DE2 		add	r3, sp, #20
 231 0080 37FF2FE1 		blx	r7
 232              	.LVL24:
6199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 233              		.loc 2 6199 0
 234 0084 34008DE2 		add	r0, sp, #52
 235 0088 FEFFFFEB 		bl	mbedtls_sha256_free
 236              	.LVL25:
6201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 237              		.loc 2 6201 0
 238 008c 0410A0E1 		mov	r1, r4
 239 0090 14008DE2 		add	r0, sp, #20
 240 0094 FEFFFFEB 		bl	mbedtls_platform_zeroize
 241              	.LVL26:
6204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
 242              		.loc 2 6204 0
 243 0098 A0D08DE2 		add	sp, sp, #160
 244              		.cfi_def_cfa_offset 24
 245              		@ sp needed
 246 009c F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 247              	.LVL27:
 248              	.L19:
 249              		.align	2
 250              	.L18:
 251 00a0 00000000 		.word	.LC0
 252 00a4 10000000 		.word	.LC1
 253              		.cfi_endproc
 254              	.LFE57:
 256              		.section	.text.ssl_calc_verify_tls_sha256,"ax",%progbits
 257              		.align	2
 258              		.syntax unified
 259              		.arm
 260              		.fpu neon
 262              	ssl_calc_verify_tls_sha256:
 263              	.LFB29:
1200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_context sha256;
 264              		.loc 2 1200 0
 265              		.cfi_startproc
 266              		@ args = 0, pretend = 0, frame = 112
 267              		@ frame_needed = 0, uses_anonymous_args = 0
 268              	.LVL28:
 269 0000 30402DE9 		push	{r4, r5, lr}
 270              		.cfi_def_cfa_offset 12
 271              		.cfi_offset 4, -12
 272              		.cfi_offset 5, -8
 273              		.cfi_offset 14, -4
 274 0004 74D04DE2 		sub	sp, sp, #116
 275              		.cfi_def_cfa_offset 128
1200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_context sha256;
 276              		.loc 2 1200 0
 277 0008 0050A0E1 		mov	r5, r0
1203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 278              		.loc 2 1203 0
 279 000c 04008DE2 		add	r0, sp, #4
 280              	.LVL29:
1200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_context sha256;
 281              		.loc 2 1200 0
 282 0010 0140A0E1 		mov	r4, r1
1203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 283              		.loc 2 1203 0
 284 0014 FEFFFFEB 		bl	mbedtls_sha256_init
 285              	.LVL30:
1207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_finish_ret( &sha256, hash );
 286              		.loc 2 1207 0
 287 0018 301095E5 		ldr	r1, [r5, #48]
 288 001c 04008DE2 		add	r0, sp, #4
 289 0020 151E81E2 		add	r1, r1, #336
 290 0024 FEFFFFEB 		bl	mbedtls_sha256_clone
 291              	.LVL31:
1208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 292              		.loc 2 1208 0
 293 0028 0410A0E1 		mov	r1, r4
 294 002c 04008DE2 		add	r0, sp, #4
 295 0030 FEFFFFEB 		bl	mbedtls_sha256_finish_ret
 296              	.LVL32:
1213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 297              		.loc 2 1213 0
 298 0034 04008DE2 		add	r0, sp, #4
 299 0038 FEFFFFEB 		bl	mbedtls_sha256_free
 300              	.LVL33:
1216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
 301              		.loc 2 1216 0
 302 003c 74D08DE2 		add	sp, sp, #116
 303              		.cfi_def_cfa_offset 12
 304              		@ sp needed
 305 0040 3080BDE8 		pop	{r4, r5, pc}
 306              		.cfi_endproc
 307              	.LFE29:
 309              		.section	.text.ssl_append_key_cert,"ax",%progbits
 310              		.align	2
 311              		.syntax unified
 312              		.arm
 313              		.fpu neon
 315              	ssl_append_key_cert:
 316              	.LFB86:
6743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Once ssl->in_hdr as the address of the beginning of the
6746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * next incoming record is set, deduce the other pointers.
6747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
6748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Note: For TLS, we save the implicit record sequence number
6749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *       (entering MAC computation) in the 8 bytes before ssl->in_hdr,
6750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *       and the caller has to make sure there's space for this.
6751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
6752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_update_in_pointers( mbedtls_ssl_context *ssl,
6754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     mbedtls_ssl_transform *transform )
6755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_ctr = ssl->in_hdr +  3;
6760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 11;
6761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 13;
6762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_ctr = ssl->in_hdr - 8;
6767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 3;
6768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 5;
6769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Offset in_msg from in_iv to allow space for explicit IV, if used. */
6772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transform != NULL &&
6773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
6774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msg = ssl->in_iv + transform->ivlen - transform->fixed_ivlen;
6776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msg = ssl->in_iv;
6779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
6782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Initialize an SSL context
6783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
6784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_init( mbedtls_ssl_context *ssl )
6785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl, 0, sizeof( mbedtls_ssl_context ) );
6787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
6790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Setup an SSL context
6791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
6792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_reset_in_out_pointers( mbedtls_ssl_context *ssl )
6794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Set the incoming and outgoing record pointers. */
6796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
6798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr = ssl->out_buf;
6800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hdr  = ssl->in_buf;
6801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
6803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
6804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr = ssl->out_buf + 8;
6806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hdr  = ssl->in_buf  + 8;
6807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Derive other internal pointers. */
6810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_out_pointers( ssl, NULL /* no transform enabled */ );
6811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_in_pointers ( ssl, NULL /* no transform enabled */ );
6812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_setup( mbedtls_ssl_context *ssl,
6815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        const mbedtls_ssl_config *conf )
6816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
6818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->conf = conf;
6820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
6822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Prepare base structures
6823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
6824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Set to NULL in case of an error condition */
6826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_buf = NULL;
6827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_buf = mbedtls_calloc( 1, MBEDTLS_SSL_IN_BUFFER_LEN );
6829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_buf == NULL )
6830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed", MBEDTLS_SSL_IN_BUFFER_LEN) );
6832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = MBEDTLS_ERR_SSL_ALLOC_FAILED;
6833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto error;
6834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_buf = mbedtls_calloc( 1, MBEDTLS_SSL_OUT_BUFFER_LEN );
6837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_buf == NULL )
6838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 1, ( "alloc(%d bytes) failed", MBEDTLS_SSL_OUT_BUFFER_LEN) );
6840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = MBEDTLS_ERR_SSL_ALLOC_FAILED;
6841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto error;
6842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_reset_in_out_pointers( ssl );
6845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_handshake_init( ssl ) ) != 0 )
6847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto error;
6848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
6850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** error:
6852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( ssl->in_buf );
6853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( ssl->out_buf );
6854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->conf = NULL;
6856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_buf = NULL;
6858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_buf = NULL;
6859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_hdr = NULL;
6861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_ctr = NULL;
6862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_len = NULL;
6863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_iv = NULL;
6864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msg = NULL;
6865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_hdr = NULL;
6867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_ctr = NULL;
6868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_len = NULL;
6869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_iv = NULL;
6870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg = NULL;
6871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
6873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
6876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Reset an initialized and used SSL context for re-use while retaining
6877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * all application-set variables, function pointers and data.
6878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
6879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * If partial is non-zero, keep data in the input buffer and client ID.
6880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * (Use when a DTLS client reconnects from the same port.)
6881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
6882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_session_reset_int( mbedtls_ssl_context *ssl, int partial )
6883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
6884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
6885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) ||     \
6887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_SSL_SRV_C)
6888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) partial);
6889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state = MBEDTLS_SSL_HELLO_REQUEST;
6892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Cancel any possibly running timer */
6894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_set_timer( ssl, 0 );
6895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
6897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->renego_status = MBEDTLS_SSL_INITIAL_HANDSHAKE;
6898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->renego_records_seen = 0;
6899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->verify_data_len = 0;
6901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl->own_verify_data, 0, MBEDTLS_SSL_VERIFY_DATA_MAX_LEN );
6902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl->peer_verify_data, 0, MBEDTLS_SSL_VERIFY_DATA_MAX_LEN );
6903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->secure_renegotiation = MBEDTLS_SSL_LEGACY_RENEGOTIATION;
6905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_offt = NULL;
6907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_reset_in_out_pointers( ssl );
6908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msgtype = 0;
6910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen = 0;
6911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
6912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->next_record_offset = 0;
6913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_epoch = 0;
6914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
6916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_dtls_replay_reset( ssl );
6917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_hslen = 0;
6920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->nb_zero = 0;
6921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->keep_current_message = 0;
6923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = 0;
6925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen = 0;
6926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_left = 0;
6927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
6928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->split_done != MBEDTLS_SSL_CBC_RECORD_SPLITTING_DISABLED )
6929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->split_done = 0;
6930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl->cur_out_ctr, 0, sizeof( ssl->cur_out_ctr ) );
6933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_in = NULL;
6935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out = NULL;
6936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_in = NULL;
6938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_out = NULL;
6939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl->out_buf, 0, MBEDTLS_SSL_OUT_BUFFER_LEN );
6941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE) && defined(MBEDTLS_SSL_SRV_C)
6943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( partial == 0 )
6944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE && MBEDTLS_SSL_SRV_C */
6945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_left = 0;
6947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( ssl->in_buf, 0, MBEDTLS_SSL_IN_BUFFER_LEN );
6948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
6951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_reset != NULL )
6952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_reset()" ) );
6954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_hw_record_reset( ssl ) ) != 0 )
6955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
6956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_hw_record_reset", ret );
6957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_HW_ACCEL_FAILED );
6958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
6959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform )
6963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform );
6965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform );
6966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform = NULL;
6967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session )
6970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session );
6972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session );
6973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session = NULL;
6974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ALPN)
6977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->alpn_chosen = NULL;
6978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
6981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE)
6982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( partial == 0 )
6983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
6985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->cli_id );
6986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->cli_id = NULL;
6987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->cli_id_len = 0;
6988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
6989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
6990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_handshake_init( ssl ) ) != 0 )
6992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
6993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
6995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
6996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
6997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
6998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Reset an initialized and used SSL context for re-use while retaining
6999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * all application-set variables, function pointers and data.
7000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_session_reset( mbedtls_ssl_context *ssl )
7002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_session_reset_int( ssl, 0 ) );
7004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * SSL set accessors
7008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_endpoint( mbedtls_ssl_config *conf, int endpoint )
7010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->endpoint   = endpoint;
7012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_transport( mbedtls_ssl_config *conf, int transport )
7015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->transport = transport;
7017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
7020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_dtls_anti_replay( mbedtls_ssl_config *conf, char mode )
7021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->anti_replay = mode;
7023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_BADMAC_LIMIT)
7027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_dtls_badmac_limit( mbedtls_ssl_config *conf, unsigned limit )
7028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->badmac_limit = limit;
7030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_datagram_packing( mbedtls_ssl_context *ssl,
7036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        unsigned allow_packing )
7037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->disable_datagram_packing = !allow_packing;
7039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_handshake_timeout( mbedtls_ssl_config *conf,
7042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          uint32_t min, uint32_t max )
7043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->hs_timeout_min = min;
7045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->hs_timeout_max = max;
7046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_authmode( mbedtls_ssl_config *conf, int authmode )
7050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->authmode   = authmode;
7052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_verify( mbedtls_ssl_config *conf,
7056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      int (*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *),
7057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      void *p_vrfy )
7058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_vrfy      = f_vrfy;
7060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_vrfy      = p_vrfy;
7061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_rng( mbedtls_ssl_config *conf,
7065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   int (*f_rng)(void *, unsigned char *, size_t),
7066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   void *p_rng )
7067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_rng      = f_rng;
7069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_rng      = p_rng;
7070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_dbg( mbedtls_ssl_config *conf,
7073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   void (*f_dbg)(void *, int, const char *, int, const char *),
7074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   void  *p_dbg )
7075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_dbg      = f_dbg;
7077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_dbg      = p_dbg;
7078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_bio( mbedtls_ssl_context *ssl,
7081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         void *p_bio,
7082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_t *f_send,
7083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_recv_t *f_recv,
7084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_recv_timeout_t *f_recv_timeout )
7085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->p_bio          = p_bio;
7087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_send         = f_send;
7088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_recv         = f_recv;
7089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_recv_timeout = f_recv_timeout;
7090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_mtu( mbedtls_ssl_context *ssl, uint16_t mtu )
7094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->mtu = mtu;
7096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_read_timeout( mbedtls_ssl_config *conf, uint32_t timeout )
7100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->read_timeout   = timeout;
7102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_timer_cb( mbedtls_ssl_context *ssl,
7105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                void *p_timer,
7106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                mbedtls_ssl_set_timer_t *f_set_timer,
7107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                mbedtls_ssl_get_timer_t *f_get_timer )
7108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->p_timer        = p_timer;
7110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_set_timer    = f_set_timer;
7111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_get_timer    = f_get_timer;
7112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Make sure we start with no timer running */
7114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_set_timer( ssl, 0 );
7115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
7118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_session_cache( mbedtls_ssl_config *conf,
7119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         void *p_cache,
7120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int (*f_get_cache)(void *, mbedtls_ssl_session *),
7121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         int (*f_set_cache)(void *, const mbedtls_ssl_session *) )
7122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_cache = p_cache;
7124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_get_cache = f_get_cache;
7125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_set_cache = f_set_cache;
7126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
7128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
7130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_set_session( mbedtls_ssl_context *ssl, const mbedtls_ssl_session *session )
7131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
7133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL ||
7135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session == NULL ||
7136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate == NULL ||
7137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
7138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_session_copy( ssl->session_negotiate, session ) ) != 0 )
7143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
7144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->resume = 1;
7146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
7150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_ciphersuites( mbedtls_ssl_config *conf,
7152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    const int *ciphersuites )
7153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] = ciphersuites;
7155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] = ciphersuites;
7156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] = ciphersuites;
7157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] = ciphersuites;
7158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_ciphersuites_for_version( mbedtls_ssl_config *conf,
7161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        const int *ciphersuites,
7162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        int major, int minor )
7163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( major != MBEDTLS_SSL_MAJOR_VERSION_3 )
7165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
7166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( minor < MBEDTLS_SSL_MINOR_VERSION_0 || minor > MBEDTLS_SSL_MINOR_VERSION_3 )
7168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
7169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[minor] = ciphersuites;
7171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_cert_profile( mbedtls_ssl_config *conf,
7175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     const mbedtls_x509_crt_profile *profile )
7176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->cert_profile = profile;
7178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Append a new keycert entry to a (possibly empty) list */
7181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_append_key_cert( mbedtls_ssl_key_cert **head,
7182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 mbedtls_x509_crt *cert,
7183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 mbedtls_pk_context *key )
7184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 317              		.loc 2 7184 0
 318              		.cfi_startproc
 319              		@ args = 0, pretend = 0, frame = 0
 320              		@ frame_needed = 0, uses_anonymous_args = 0
 321              	.LVL34:
 322 0000 70402DE9 		push	{r4, r5, r6, lr}
 323              		.cfi_def_cfa_offset 16
 324              		.cfi_offset 4, -16
 325              		.cfi_offset 5, -12
 326              		.cfi_offset 6, -8
 327              		.cfi_offset 14, -4
 328              		.loc 2 7184 0
 329 0004 0040A0E1 		mov	r4, r0
 330 0008 0160A0E1 		mov	r6, r1
7185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_key_cert *new_cert;
7186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_cert = mbedtls_calloc( 1, sizeof( mbedtls_ssl_key_cert ) );
 331              		.loc 2 7187 0
 332 000c 0100A0E3 		mov	r0, #1
 333              	.LVL35:
 334 0010 0C10A0E3 		mov	r1, #12
 335              	.LVL36:
7184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_key_cert *new_cert;
 336              		.loc 2 7184 0
 337 0014 0250A0E1 		mov	r5, r2
 338              		.loc 2 7187 0
 339 0018 FEFFFFEB 		bl	mbedtls_calloc
 340              	.LVL37:
7188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( new_cert == NULL )
 341              		.loc 2 7188 0
 342 001c 001050E2 		subs	r1, r0, #0
 343 0020 0F00000A 		beq	.L26
7189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
7190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_cert->cert = cert;
7192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_cert->key  = key;
7193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_cert->next = NULL;
 344              		.loc 2 7193 0
 345 0024 0030A0E3 		mov	r3, #0
7191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_cert->key  = key;
 346              		.loc 2 7191 0
 347 0028 006081E5 		str	r6, [r1]
 348              		.loc 2 7193 0
 349 002c 083081E5 		str	r3, [r1, #8]
7194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Update head is the list was null, else add to the end */
7196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( *head == NULL )
 350              		.loc 2 7196 0
 351 0030 003094E5 		ldr	r3, [r4]
7192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     new_cert->next = NULL;
 352              		.loc 2 7192 0
 353 0034 045081E5 		str	r5, [r1, #4]
 354              		.loc 2 7196 0
 355 0038 000053E3 		cmp	r3, #0
 356 003c 0300001A 		bne	.L25
7197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *head = new_cert;
 357              		.loc 2 7198 0
 358 0040 001084E5 		str	r1, [r4]
7199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
7201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_key_cert *cur = *head;
7203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         while( cur->next != NULL )
7204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             cur = cur->next;
7205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cur->next = new_cert;
7206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
 359              		.loc 2 7208 0
 360 0044 0300A0E1 		mov	r0, r3
 361              	.LVL38:
 362 0048 7080BDE8 		pop	{r4, r5, r6, pc}
 363              	.LVL39:
 364              	.L27:
 365              	.LBB79:
 366 004c 0030A0E1 		mov	r3, r0
 367              	.LVL40:
 368              	.L25:
7203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             cur = cur->next;
 369              		.loc 2 7203 0
 370 0050 080093E5 		ldr	r0, [r3, #8]
 371 0054 000050E3 		cmp	r0, #0
 372 0058 FBFFFF1A 		bne	.L27
7205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 373              		.loc 2 7205 0
 374 005c 081083E5 		str	r1, [r3, #8]
 375 0060 7080BDE8 		pop	{r4, r5, r6, pc}
 376              	.LVL41:
 377              	.L26:
 378              	.LBE79:
7189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 379              		.loc 2 7189 0
 380 0064 00009FE5 		ldr	r0, .L29
 381              	.LVL42:
7209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 382              		.loc 2 7209 0
 383 0068 7080BDE8 		pop	{r4, r5, r6, pc}
 384              	.L30:
 385              		.align	2
 386              	.L29:
 387 006c 0081FFFF 		.word	-32512
 388              		.cfi_endproc
 389              	.LFE86:
 391              		.section	.text.ssl_update_checksum_sha256,"ax",%progbits
 392              		.align	2
 393              		.syntax unified
 394              		.arm
 395              		.fpu neon
 397              	ssl_update_checksum_sha256:
 398              	.LFB56:
5999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_update_ret( &ssl->handshake->fin_sha256, buf, len );
 399              		.loc 2 5999 0
 400              		.cfi_startproc
 401              		@ args = 0, pretend = 0, frame = 0
 402              		@ frame_needed = 0, uses_anonymous_args = 0
 403              		@ link register save eliminated.
 404              	.LVL43:
6000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 405              		.loc 2 6000 0
 406 0000 300090E5 		ldr	r0, [r0, #48]
 407              	.LVL44:
 408 0004 150E80E2 		add	r0, r0, #336
 409 0008 FEFFFFEA 		b	mbedtls_sha256_update_ret
 410              	.LVL45:
 411              		.cfi_endproc
 412              	.LFE56:
 414              		.section	.text.ssl_update_checksum_start,"ax",%progbits
 415              		.align	2
 416              		.syntax unified
 417              		.arm
 418              		.fpu neon
 420              	ssl_update_checksum_start:
 421              	.LFB155:
 422              		.cfi_startproc
 423              		@ args = 0, pretend = 0, frame = 0
 424              		@ frame_needed = 0, uses_anonymous_args = 0
 425              		@ link register save eliminated.
 426 0000 FEFFFFEA 		b	ssl_update_checksum_sha256
 427              		.cfi_endproc
 428              	.LFE155:
 430              		.global	__aeabi_uidivmod
 431              		.section	.text.tls_prf_sha256,"ax",%progbits
 432              		.align	2
 433              		.syntax unified
 434              		.arm
 435              		.fpu neon
 437              	tls_prf_sha256:
 438              	.LFB27:
 561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA256, secret, slen,
 439              		.loc 2 561 0
 440              		.cfi_startproc
 441              		@ args = 12, pretend = 0, frame = 184
 442              		@ frame_needed = 0, uses_anonymous_args = 0
 443              	.LVL46:
 561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA256, secret, slen,
 444              		.loc 2 561 0
 445 0000 F04F2DE9 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 446              		.cfi_def_cfa_offset 36
 447              		.cfi_offset 4, -36
 448              		.cfi_offset 5, -32
 449              		.cfi_offset 6, -28
 450              		.cfi_offset 7, -24
 451              		.cfi_offset 8, -20
 452              		.cfi_offset 9, -16
 453              		.cfi_offset 10, -12
 454              		.cfi_offset 11, -8
 455              		.cfi_offset 14, -4
 456 0004 BCD04DE2 		sub	sp, sp, #188
 457              		.cfi_def_cfa_offset 224
 561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA256, secret, slen,
 458              		.loc 2 561 0
 459 0008 0080A0E1 		mov	r8, r0
 460              	.LVL47:
 461              	.LBB82:
 462              	.LBB83:
 507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 463              		.loc 2 507 0
 464 000c 0C008DE2 		add	r0, sp, #12
 465              	.LVL48:
 466              	.LBE83:
 467              	.LBE82:
 561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( tls_prf_generic( MBEDTLS_MD_SHA256, secret, slen,
 468              		.loc 2 561 0
 469 0010 0270A0E1 		mov	r7, r2
 470 0014 0190A0E1 		mov	r9, r1
 471              	.LVL49:
 472 0018 03B0A0E1 		mov	fp, r3
 473              	.LVL50:
 474              	.LBB86:
 475              	.LBB84:
 507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 476              		.loc 2 507 0
 477 001c FEFFFFEB 		bl	mbedtls_md_init
 478              	.LVL51:
 509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 479              		.loc 2 509 0
 480 0020 0600A0E3 		mov	r0, #6
 481 0024 FEFFFFEB 		bl	mbedtls_md_info_from_type
 482              	.LVL52:
 483 0028 00A050E2 		subs	r10, r0, #0
 510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 484              		.loc 2 510 0
 485 002c 78719F05 		ldreq	r7, .L44
 486              	.LVL53:
 509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
 487              		.loc 2 509 0
 488 0030 3800000A 		beq	.L33
 512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 489              		.loc 2 512 0
 490 0034 FEFFFFEB 		bl	mbedtls_md_get_size
 491              	.LVL54:
 492 0038 0050A0E1 		mov	r5, r0
 493              	.LVL55:
 514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 494              		.loc 2 514 0
 495 003c 0700A0E1 		mov	r0, r7
 496              	.LVL56:
 497 0040 FEFFFFEB 		bl	strlen
 498              	.LVL57:
 499 0044 E0209DE5 		ldr	r2, [sp, #224]
 500 0048 003085E0 		add	r3, r5, r0
 501 004c 0040A0E1 		mov	r4, r0
 502 0050 04308DE5 		str	r3, [sp, #4]
 503 0054 032082E0 		add	r2, r2, r3
 504 0058 800052E3 		cmp	r2, #128
 515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 505              		.loc 2 515 0
 506 005c 4C719F85 		ldrhi	r7, .L44+4
 514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 507              		.loc 2 514 0
 508 0060 2C00008A 		bhi	.L33
 509              	.LVL58:
 518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( tmp + md_len + nb, random, rlen );
 510              		.loc 2 518 0
 511 0064 38308DE2 		add	r3, sp, #56
 512 0068 0020A0E1 		mov	r2, r0
 513 006c 056083E0 		add	r6, r3, r5
 514 0070 0710A0E1 		mov	r1, r7
 515 0074 0600A0E1 		mov	r0, r6
 516              	.LVL59:
 517 0078 FEFFFFEB 		bl	memcpy
 518              	.LVL60:
 519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     nb += rlen;
 519              		.loc 2 519 0
 520 007c 04309DE5 		ldr	r3, [sp, #4]
 521 0080 38008DE2 		add	r0, sp, #56
 522 0084 E0209DE5 		ldr	r2, [sp, #224]
 523 0088 0B10A0E1 		mov	r1, fp
 524 008c 030080E0 		add	r0, r0, r3
 525 0090 FEFFFFEB 		bl	memcpy
 526              	.LVL61:
 525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 527              		.loc 2 525 0
 528 0094 0120A0E3 		mov	r2, #1
 529 0098 0A10A0E1 		mov	r1, r10
 530 009c 0C008DE2 		add	r0, sp, #12
 531 00a0 FEFFFFEB 		bl	mbedtls_md_setup
 532              	.LVL62:
 533 00a4 007050E2 		subs	r7, r0, #0
 534 00a8 1A00001A 		bne	.L33
 520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 535              		.loc 2 520 0
 536 00ac E0309DE5 		ldr	r3, [sp, #224]
 528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + md_len, nb );
 537              		.loc 2 528 0
 538 00b0 0810A0E1 		mov	r1, r8
 539 00b4 0920A0E1 		mov	r2, r9
 540 00b8 0C008DE2 		add	r0, sp, #12
 541              	.LVL63:
 542 00bc 18808DE2 		add	r8, sp, #24
 543              	.LVL64:
 520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 544              		.loc 2 520 0
 545 00c0 044083E0 		add	r4, r3, r4
 546              	.LVL65:
 528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_update( &md_ctx, tmp + md_len, nb );
 547              		.loc 2 528 0
 548 00c4 FEFFFFEB 		bl	mbedtls_md_hmac_starts
 549              	.LVL66:
 529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, tmp );
 550              		.loc 2 529 0
 551 00c8 0420A0E1 		mov	r2, r4
 552 00cc 0610A0E1 		mov	r1, r6
 553 00d0 0C008DE2 		add	r0, sp, #12
 532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 554              		.loc 2 532 0
 555 00d4 0760A0E1 		mov	r6, r7
 535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 556              		.loc 2 535 0
 557 00d8 044085E0 		add	r4, r5, r4
 529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_hmac_finish( &md_ctx, tmp );
 558              		.loc 2 529 0
 559 00dc FEFFFFEB 		bl	mbedtls_md_hmac_update
 560              	.LVL67:
 530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 561              		.loc 2 530 0
 562 00e0 38108DE2 		add	r1, sp, #56
 563 00e4 0C008DE2 		add	r0, sp, #12
 564 00e8 FEFFFFEB 		bl	mbedtls_md_hmac_finish
 565              	.LVL68:
 566              	.L35:
 532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 567              		.loc 2 532 0
 568 00ec E8309DE5 		ldr	r3, [sp, #232]
 534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len + nb );
 569              		.loc 2 534 0
 570 00f0 0C008DE2 		add	r0, sp, #12
 532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 571              		.loc 2 532 0
 572 00f4 060053E1 		cmp	r3, r6
 573 00f8 0900008A 		bhi	.L39
 548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 574              		.loc 2 548 0
 575 00fc FEFFFFEB 		bl	mbedtls_md_free
 576              	.LVL69:
 550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( h_i, sizeof( h_i ) );
 577              		.loc 2 550 0
 578 0100 8010A0E3 		mov	r1, #128
 579 0104 38008DE2 		add	r0, sp, #56
 580 0108 FEFFFFEB 		bl	mbedtls_platform_zeroize
 581              	.LVL70:
 551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 582              		.loc 2 551 0
 583 010c 2010A0E3 		mov	r1, #32
 584 0110 0800A0E1 		mov	r0, r8
 585 0114 FEFFFFEB 		bl	mbedtls_platform_zeroize
 586              	.LVL71:
 587              	.L33:
 588              	.LBE84:
 589              	.LBE86:
 564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SHA256_C */
 590              		.loc 2 564 0
 591 0118 0700A0E1 		mov	r0, r7
 592 011c BCD08DE2 		add	sp, sp, #188
 593              		.cfi_remember_state
 594              		.cfi_def_cfa_offset 36
 595              		@ sp needed
 596 0120 F08FBDE8 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 597              	.LVL72:
 598              	.L39:
 599              		.cfi_restore_state
 600              	.LBB87:
 601              	.LBB85:
 534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len + nb );
 602              		.loc 2 534 0
 603 0124 FEFFFFEB 		bl	mbedtls_md_hmac_reset
 604              	.LVL73:
 535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 605              		.loc 2 535 0
 606 0128 0420A0E1 		mov	r2, r4
 607 012c 38108DE2 		add	r1, sp, #56
 608 0130 0C008DE2 		add	r0, sp, #12
 542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 609              		.loc 2 542 0
 610 0134 069085E0 		add	r9, r5, r6
 535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, h_i );
 611              		.loc 2 535 0
 612 0138 FEFFFFEB 		bl	mbedtls_md_hmac_update
 613              	.LVL74:
 536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 614              		.loc 2 536 0
 615 013c 0810A0E1 		mov	r1, r8
 616 0140 0C008DE2 		add	r0, sp, #12
 617 0144 FEFFFFEB 		bl	mbedtls_md_hmac_finish
 618              	.LVL75:
 538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_update( &md_ctx, tmp, md_len );
 619              		.loc 2 538 0
 620 0148 0C008DE2 		add	r0, sp, #12
 621 014c FEFFFFEB 		bl	mbedtls_md_hmac_reset
 622              	.LVL76:
 539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_md_hmac_finish( &md_ctx, tmp );
 623              		.loc 2 539 0
 624 0150 0520A0E1 		mov	r2, r5
 625 0154 38108DE2 		add	r1, sp, #56
 626 0158 0C008DE2 		add	r0, sp, #12
 627 015c FEFFFFEB 		bl	mbedtls_md_hmac_update
 628              	.LVL77:
 540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 629              		.loc 2 540 0
 630 0160 38108DE2 		add	r1, sp, #56
 631 0164 0C008DE2 		add	r0, sp, #12
 632 0168 FEFFFFEB 		bl	mbedtls_md_hmac_finish
 633              	.LVL78:
 542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 634              		.loc 2 542 0
 635 016c E8309DE5 		ldr	r3, [sp, #232]
 636 0170 0510A0E1 		mov	r1, r5
 637 0174 090053E1 		cmp	r3, r9
 638 0178 0100002A 		bcs	.L36
 639              	.LVL79:
 640 017c 0300A0E1 		mov	r0, r3
 641 0180 FEFFFFEB 		bl	__aeabi_uidivmod
 642              	.LVL80:
 643              	.L36:
 545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 644              		.loc 2 545 0
 645 0184 E4209DE5 		ldr	r2, [sp, #228]
 544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 646              		.loc 2 544 0
 647 0188 0030A0E3 		mov	r3, #0
 545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 648              		.loc 2 545 0
 649 018c 066082E0 		add	r6, r2, r6
 650              	.LVL81:
 651              	.L37:
 544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 652              		.loc 2 544 0
 653 0190 010053E1 		cmp	r3, r1
 542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 654              		.loc 2 542 0
 655 0194 0960A001 		moveq	r6, r9
 656 0198 D3FFFF0A 		beq	.L35
 657              	.L38:
 545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 658              		.loc 2 545 0
 659 019c 0320D8E7 		ldrb	r2, [r8, r3]	@ zero_extendqisi2
 660 01a0 0320C6E7 		strb	r2, [r6, r3]
 544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dstbuf[i + j]  = h_i[j];
 661              		.loc 2 544 0
 662 01a4 013083E2 		add	r3, r3, #1
 663              	.LVL82:
 664 01a8 F8FFFFEA 		b	.L37
 665              	.L45:
 666              		.align	2
 667              	.L44:
 668 01ac 0094FFFF 		.word	-27648
 669 01b0 008FFFFF 		.word	-28928
 670              	.LBE85:
 671              	.LBE87:
 672              		.cfi_endproc
 673              	.LFE27:
 675              		.section	.text.ssl_reset_in_out_pointers,"ax",%progbits
 676              		.align	2
 677              		.syntax unified
 678              		.arm
 679              		.fpu neon
 681              	ssl_reset_in_out_pointers:
 682              	.LFB69:
6794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Set the incoming and outgoing record pointers. */
 683              		.loc 2 6794 0
 684              		.cfi_startproc
 685              		@ args = 0, pretend = 0, frame = 0
 686              		@ frame_needed = 0, uses_anonymous_args = 0
 687              	.LVL83:
6805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hdr  = ssl->in_buf  + 8;
 688              		.loc 2 6805 0
 689 0000 843090E5 		ldr	r3, [r0, #132]
6810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_in_pointers ( ssl, NULL /* no transform enabled */ );
 690              		.loc 2 6810 0
 691 0004 0010A0E3 		mov	r1, #0
6794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Set the incoming and outgoing record pointers. */
 692              		.loc 2 6794 0
 693 0008 10402DE9 		push	{r4, lr}
 694              		.cfi_def_cfa_offset 8
 695              		.cfi_offset 4, -8
 696              		.cfi_offset 14, -4
6794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Set the incoming and outgoing record pointers. */
 697              		.loc 2 6794 0
 698 000c 0040A0E1 		mov	r4, r0
6805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hdr  = ssl->in_buf  + 8;
 699              		.loc 2 6805 0
 700 0010 083083E2 		add	r3, r3, #8
 701 0014 8C3080E5 		str	r3, [r0, #140]
6806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 702              		.loc 2 6806 0
 703 0018 503090E5 		ldr	r3, [r0, #80]
 704 001c 083083E2 		add	r3, r3, #8
 705 0020 583080E5 		str	r3, [r0, #88]
6810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_update_in_pointers ( ssl, NULL /* no transform enabled */ );
 706              		.loc 2 6810 0
 707 0024 FEFFFFEB 		bl	ssl_update_out_pointers
 708              	.LVL84:
 709              	.LBB90:
 710              	.LBB91:
6766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 3;
 711              		.loc 2 6766 0
 712 0028 583090E5 		ldr	r3, [r0, #88]
 713 002c 082043E2 		sub	r2, r3, #8
 714 0030 542080E5 		str	r2, [r0, #84]
6767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 5;
 715              		.loc 2 6767 0
 716 0034 032083E2 		add	r2, r3, #3
6768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 717              		.loc 2 6768 0
 718 0038 053083E2 		add	r3, r3, #5
6767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 5;
 719              		.loc 2 6767 0
 720 003c 5C2080E5 		str	r2, [r0, #92]
6768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 721              		.loc 2 6768 0
 722 0040 603080E5 		str	r3, [r0, #96]
6778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 723              		.loc 2 6778 0
 724 0044 643080E5 		str	r3, [r0, #100]
 725              	.LVL85:
 726 0048 1080BDE8 		pop	{r4, pc}
 727              	.LBE91:
 728              	.LBE90:
 729              		.cfi_endproc
 730              	.LFE69:
 732              		.section	.text.mbedtls_ssl_derive_keys,"ax",%progbits
 733              		.align	2
 734              		.global	mbedtls_ssl_derive_keys
 735              		.syntax unified
 736              		.arm
 737              		.fpu neon
 739              	mbedtls_ssl_derive_keys:
 740              	.LFB28:
 611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 741              		.loc 2 611 0
 742              		.cfi_startproc
 743              		@ args = 0, pretend = 0, frame = 336
 744              		@ frame_needed = 0, uses_anonymous_args = 0
 745              	.LVL86:
 746 0000 F04F2DE9 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 747              		.cfi_def_cfa_offset 36
 748              		.cfi_offset 4, -36
 749              		.cfi_offset 5, -32
 750              		.cfi_offset 6, -28
 751              		.cfi_offset 7, -24
 752              		.cfi_offset 8, -20
 753              		.cfi_offset 9, -16
 754              		.cfi_offset 10, -12
 755              		.cfi_offset 11, -8
 756              		.cfi_offset 14, -4
 757 0004 59DF4DE2 		sub	sp, sp, #356
 758              		.cfi_def_cfa_offset 392
 624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_transform *transform = ssl->transform_negotiate;
 759              		.loc 2 624 0
 760 0008 2C3090E5 		ldr	r3, [r0, #44]
 611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 761              		.loc 2 611 0
 762 000c 0070A0E1 		mov	r7, r0
 625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params *handshake = ssl->handshake;
 763              		.loc 2 625 0
 764 0010 404090E5 		ldr	r4, [r0, #64]
 624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_transform *transform = ssl->transform_negotiate;
 765              		.loc 2 624 0
 766 0014 1C308DE5 		str	r3, [sp, #28]
 767              	.LVL87:
 626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 768              		.loc 2 626 0
 769 0018 305090E5 		ldr	r5, [r0, #48]
 770              	.LVL88:
 630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cipher_info == NULL )
 771              		.loc 2 630 0
 772 001c 003094E5 		ldr	r3, [r4]
 773              	.LVL89:
 774 0020 0800D3E5 		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 775              	.LVL90:
 776 0024 FEFFFFEB 		bl	mbedtls_cipher_info_from_type
 777              	.LVL91:
 631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 778              		.loc 2 631 0
 779 0028 006050E2 		subs	r6, r0, #0
 780 002c 0300001A 		bne	.L49
 781              	.LVL92:
 782              	.L51:
 635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 783              		.loc 2 635 0
 784 0030 CCB39FE5 		ldr	fp, .L90
 785              	.LVL93:
 786              	.L48:
1119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 787              		.loc 2 1119 0
 788 0034 0B00A0E1 		mov	r0, fp
 789 0038 59DF8DE2 		add	sp, sp, #356
 790              		.cfi_remember_state
 791              		.cfi_def_cfa_offset 36
 792              		@ sp needed
 793 003c F08FBDE8 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 794              	.LVL94:
 795              	.L49:
 796              		.cfi_restore_state
 638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( md_info == NULL )
 797              		.loc 2 638 0
 798 0040 003094E5 		ldr	r3, [r4]
 799 0044 0900D3E5 		ldrb	r0, [r3, #9]	@ zero_extendqisi2
 800              	.LVL95:
 801 0048 FEFFFFEB 		bl	mbedtls_md_info_from_type
 802              	.LVL96:
 639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 803              		.loc 2 639 0
 804 004c 003050E2 		subs	r3, r0, #0
 805 0050 14308DE5 		str	r3, [sp, #20]
 806 0054 F5FFFF0A 		beq	.L51
 679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 807              		.loc 2 679 0
 808 0058 0C3097E5 		ldr	r3, [r7, #12]
 809 005c 030053E3 		cmp	r3, #3
 810 0060 0100000A 		beq	.L52
 811              	.LVL97:
 812              	.L66:
 690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 813              		.loc 2 690 0
 814 0064 9CB39FE5 		ldr	fp, .L90+4
 815 0068 F1FFFFEA 		b	.L48
 816              	.LVL98:
 817              	.L52:
 681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_verify = ssl_calc_verify_tls_sha256;
 818              		.loc 2 681 0
 819 006c 98339FE5 		ldr	r3, .L90+8
 820 0070 C83185E5 		str	r3, [r5, #456]
 682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->calc_finished = ssl_calc_finished_tls_sha256;
 821              		.loc 2 682 0
 822 0074 94339FE5 		ldr	r3, .L90+12
 823 0078 C03185E5 		str	r3, [r5, #448]
 683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 824              		.loc 2 683 0
 825 007c 90339FE5 		ldr	r3, .L90+16
 826 0080 C43185E5 		str	r3, [r5, #452]
 703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 827              		.loc 2 703 0
 828 0084 543295E5 		ldr	r3, [r5, #596]
 829 0088 000053E3 		cmp	r3, #0
 830 008c 1C309DE5 		ldr	r3, [sp, #28]
 831 0090 2C3083E2 		add	r3, r3, #44
 832 0094 18308DE5 		str	r3, [sp, #24]
 833 0098 1C00001A 		bne	.L53
 709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 834              		.loc 2 709 0
 835 009c 303097E5 		ldr	r3, [r7, #48]
 836 00a0 218E85E2 		add	r8, r5, #528
 837 00a4 642293E5 		ldr	r2, [r3, #612]
 838 00a8 010052E3 		cmp	r2, #1
 839 00ac 9400001A 		bne	.L54
 840              	.LBB92:
 716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 841              		.loc 2 716 0
 842 00b0 C03193E5 		ldr	r3, [r3, #448]
 843 00b4 60108DE2 		add	r1, sp, #96
 844 00b8 0700A0E1 		mov	r0, r7
 845              	.LVL99:
 846 00bc 33FF2FE1 		blx	r3
 847              	.LVL100:
 719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 848              		.loc 2 719 0
 849 00c0 0C3097E5 		ldr	r3, [r7, #12]
 737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       "extended master secret",
 850              		.loc 2 737 0
 851 00c4 3020A0E3 		mov	r2, #48
 852 00c8 08208DE5 		str	r2, [sp, #8]
 853 00cc 0800A0E1 		mov	r0, r8
 854 00d0 18209DE5 		ldr	r2, [sp, #24]
 733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 855              		.loc 2 733 0
 856 00d4 030053E3 		cmp	r3, #3
 857 00d8 2030A003 		moveq	r3, #32
 858 00dc 2430A013 		movne	r3, #36
 859              	.LVL101:
 737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       "extended master secret",
 860              		.loc 2 737 0
 861 00e0 04208DE5 		str	r2, [sp, #4]
 862 00e4 00308DE5 		str	r3, [sp]
 863 00e8 60308DE2 		add	r3, sp, #96
 864              	.LVL102:
 865 00ec C89195E5 		ldr	r9, [r5, #456]
 866 00f0 20239FE5 		ldr	r2, .L90+20
 867 00f4 CC1195E5 		ldr	r1, [r5, #460]
 868 00f8 39FF2FE1 		blx	r9
 869              	.LVL103:
 870              	.L87:
 871              	.LBE92:
 754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 872              		.loc 2 754 0
 873 00fc 00B050E2 		subs	fp, r0, #0
 874 0100 CBFFFF1A 		bne	.L48
 875              	.LVL104:
 760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   sizeof(handshake->premaster) );
 876              		.loc 2 760 0
 877 0104 4210A0E3 		mov	r1, #66
 878 0108 0800A0E1 		mov	r0, r8
 879 010c FEFFFFEB 		bl	mbedtls_platform_zeroize
 880              	.LVL105:
 881              	.L53:
 769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( handshake->randbytes, tmp + 32, 32 );
 882              		.loc 2 769 0
 883 0110 1D9E85E2 		add	r9, r5, #464
 884 0114 40A0A0E3 		mov	r10, #64
 885 0118 0A20A0E1 		mov	r2, r10
 886 011c 0910A0E1 		mov	r1, r9
 887 0120 20008DE2 		add	r0, sp, #32
 786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               handshake->randbytes, 64, keyblk, 256 );
 888              		.loc 2 786 0
 889 0124 60808DE2 		add	r8, sp, #96
 769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( handshake->randbytes, tmp + 32, 32 );
 890              		.loc 2 769 0
 891 0128 FEFFFFEB 		bl	memcpy
 892              	.LVL106:
 770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( handshake->randbytes + 32, tmp, 32 );
 893              		.loc 2 770 0
 894 012c 2020A0E3 		mov	r2, #32
 895 0130 0A108DE0 		add	r1, sp, r10
 896 0134 0900A0E1 		mov	r0, r9
 897 0138 FEFFFFEB 		bl	memcpy
 898              	.LVL107:
 771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( tmp, sizeof( tmp ) );
 899              		.loc 2 771 0
 900 013c 2020A0E3 		mov	r2, #32
 901 0140 1F0E85E2 		add	r0, r5, #496
 902 0144 02108DE0 		add	r1, sp, r2
 903 0148 FEFFFFEB 		bl	memcpy
 904              	.LVL108:
 772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 905              		.loc 2 772 0
 906 014c 0A10A0E1 		mov	r1, r10
 907 0150 20008DE2 		add	r0, sp, #32
 908 0154 FEFFFFEB 		bl	mbedtls_platform_zeroize
 909              	.LVL109:
 786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               handshake->randbytes, 64, keyblk, 256 );
 910              		.loc 2 786 0
 911 0158 013CA0E3 		mov	r3, #256
 912 015c 04808DE5 		str	r8, [sp, #4]
 913 0160 08308DE5 		str	r3, [sp, #8]
 914 0164 3010A0E3 		mov	r1, #48
 915 0168 00A08DE5 		str	r10, [sp]
 916 016c 0930A0E1 		mov	r3, r9
 917 0170 C85195E5 		ldr	r5, [r5, #456]
 918              	.LVL110:
 919 0174 A0229FE5 		ldr	r2, .L90+24
 920 0178 18009DE5 		ldr	r0, [sp, #24]
 921 017c 35FF2FE1 		blx	r5
 922              	.LVL111:
 788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 923              		.loc 2 788 0
 924 0180 00B050E2 		subs	fp, r0, #0
 925 0184 AAFFFF1A 		bne	.L48
 800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               sizeof( handshake->randbytes ) );
 926              		.loc 2 800 0
 927 0188 0A10A0E1 		mov	r1, r10
 928 018c 0900A0E1 		mov	r0, r9
 929              	.LVL112:
 930 0190 FEFFFFEB 		bl	mbedtls_platform_zeroize
 931              	.LVL113:
 807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 932              		.loc 2 807 0
 933 0194 042096E5 		ldr	r2, [r6, #4]
 934 0198 A221A0E1 		lsr	r2, r2, #3
 935 019c 042084E5 		str	r2, [r4, #4]
 809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CCM ||
 936              		.loc 2 809 0
 937 01a0 0120D6E5 		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 938 01a4 FD1002E2 		and	r1, r2, #253
 810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 939              		.loc 2 810 0
 940 01a8 060052E3 		cmp	r2, #6
 941 01ac 08005113 		cmpne	r1, #8
 942 01b0 5F00001A 		bne	.L58
 943              	.LBB93:
 822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 944              		.loc 2 822 0
 945 01b4 0C30A0E3 		mov	r3, #12
 823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->fixed_ivlen = 12;
 946              		.loc 2 823 0
 947 01b8 0A0052E3 		cmp	r2, #10
 822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( cipher_info->mode == MBEDTLS_MODE_CHACHAPOLY )
 948              		.loc 2 822 0
 949 01bc 0C3084E5 		str	r3, [r4, #12]
 826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 950              		.loc 2 826 0
 951 01c0 0430A013 		movne	r3, #4
 952 01c4 103084E5 		str	r3, [r4, #16]
 816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 953              		.loc 2 816 0
 954 01c8 0050A0E3 		mov	r5, #0
 829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 955              		.loc 2 829 0
 956 01cc 003094E5 		ldr	r3, [r4]
 815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mac_key_len = 0;
 957              		.loc 2 815 0
 958 01d0 14B084E5 		str	fp, [r4, #20]
 959              	.LVL114:
 830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 960              		.loc 2 830 0
 961 01d4 1C30D3E5 		ldrb	r3, [r3, #28]	@ zero_extendqisi2
 962 01d8 020013E3 		tst	r3, #2
 834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->minlen = explicit_ivlen + taglen;
 963              		.loc 2 834 0
 964 01dc 103094E5 		ldr	r3, [r4, #16]
 830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 965              		.loc 2 830 0
 966 01e0 0820A013 		movne	r2, #8
 967 01e4 1020A003 		moveq	r2, #16
 968              	.LVL115:
 834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->minlen = explicit_ivlen + taglen;
 969              		.loc 2 834 0
 970 01e8 0C3063E2 		rsb	r3, r3, #12
 971              	.LVL116:
 835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 972              		.loc 2 835 0
 973 01ec 023083E0 		add	r3, r3, r2
 974              	.LVL117:
 975 01f0 083084E5 		str	r3, [r4, #8]
 976              	.LVL118:
 977              	.L62:
 978              	.LBE93:
 927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 979              		.loc 2 927 0
 980 01f4 003097E5 		ldr	r3, [r7]
 981 01f8 6030D3E5 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 982 01fc 010013E3 		tst	r3, #1
 983 0200 97FFFF1A 		bne	.L66
 938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             transform->fixed_ivlen : transform->ivlen;
 984              		.loc 2 938 0
 985 0204 103094E5 		ldr	r3, [r4, #16]
 929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         key2 = keyblk + mac_key_len * 2 + transform->keylen;
 986              		.loc 2 929 0
 987 0208 85A0A0E1 		lsl	r10, r5, #1
 988              	.LVL119:
 930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 989              		.loc 2 930 0
 990 020c 04B094E5 		ldr	fp, [r4, #4]
 991              	.LVL120:
 940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_dec, key2 + transform->keylen + iv_copy_len,
 992              		.loc 2 940 0
 993 0210 180084E2 		add	r0, r4, #24
 939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_enc, key2 + transform->keylen,  iv_copy_len );
 994              		.loc 2 939 0
 995 0214 000053E3 		cmp	r3, #0
 996 0218 0C309405 		ldreq	r3, [r4, #12]
 930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 997              		.loc 2 930 0
 998 021c 0B908AE0 		add	r9, r10, fp
 999 0220 099088E0 		add	r9, r8, r9
 1000              	.LVL121:
 940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( transform->iv_dec, key2 + transform->keylen + iv_copy_len,
 1001              		.loc 2 940 0
 1002 0224 0B1089E0 		add	r1, r9, fp
 1003 0228 0320A0E1 		mov	r2, r3
 1004 022c 14308DE5 		str	r3, [sp, #20]
 1005              	.LVL122:
 1006 0230 FEFFFFEB 		bl	memcpy
 1007              	.LVL123:
 941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv_copy_len );
 1008              		.loc 2 941 0
 1009 0234 14309DE5 		ldr	r3, [sp, #20]
 1010 0238 280084E2 		add	r0, r4, #40
 1011 023c 0B1083E0 		add	r1, r3, fp
 1012 0240 0320A0E1 		mov	r2, r3
 1013 0244 011089E0 		add	r1, r9, r1
 1014 0248 FEFFFFEB 		bl	memcpy
 1015              	.LVL124:
 987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1016              		.loc 2 987 0
 1017 024c 0C3097E5 		ldr	r3, [r7, #12]
 1018 0250 000053E3 		cmp	r3, #0
 1019 0254 82FFFFDA 		ble	.L66
 991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1020              		.loc 2 991 0
 1021 0258 000055E3 		cmp	r5, #0
 1022 025c 0700000A 		beq	.L68
 993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_starts( &transform->md_ctx_dec, mac_dec, mac_key_len );
 1023              		.loc 2 993 0
 1024 0260 0520A0E1 		mov	r2, r5
 1025 0264 0810A0E1 		mov	r1, r8
 1026 0268 380084E2 		add	r0, r4, #56
 1027 026c FEFFFFEB 		bl	mbedtls_md_hmac_starts
 1028              	.LVL125:
 994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1029              		.loc 2 994 0
 1030 0270 0520A0E1 		mov	r2, r5
 1031 0274 051088E0 		add	r1, r8, r5
 1032 0278 440084E2 		add	r0, r4, #68
 1033 027c FEFFFFEB 		bl	mbedtls_md_hmac_starts
 1034              	.LVL126:
 1035              	.L68:
1033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  cipher_info ) ) != 0 )
 1036              		.loc 2 1033 0
 1037 0280 505084E2 		add	r5, r4, #80
 1038              	.LVL127:
 1039 0284 0610A0E1 		mov	r1, r6
 1040 0288 0500A0E1 		mov	r0, r5
 1041 028c FEFFFFEB 		bl	mbedtls_cipher_setup
 1042              	.LVL128:
 1043 0290 00B050E2 		subs	fp, r0, #0
 1044 0294 66FFFF1A 		bne	.L48
1040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  cipher_info ) ) != 0 )
 1045              		.loc 2 1040 0
 1046 0298 904084E2 		add	r4, r4, #144
 1047              	.LVL129:
 1048 029c 0610A0E1 		mov	r1, r6
 1049 02a0 0400A0E1 		mov	r0, r4
 1050              	.LVL130:
 1051 02a4 FEFFFFEB 		bl	mbedtls_cipher_setup
 1052              	.LVL131:
 1053 02a8 00B050E2 		subs	fp, r0, #0
 1054 02ac 60FFFF1A 		bne	.L48
1047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                cipher_info->key_bitlen,
 1055              		.loc 2 1047 0
 1056 02b0 0130A0E3 		mov	r3, #1
 1057 02b4 042096E5 		ldr	r2, [r6, #4]
 1058 02b8 0A1088E0 		add	r1, r8, r10
 1059 02bc 0500A0E1 		mov	r0, r5
 1060              	.LVL132:
 1061 02c0 FEFFFFEB 		bl	mbedtls_cipher_setkey
 1062              	.LVL133:
 1063 02c4 00B050E2 		subs	fp, r0, #0
 1064 02c8 59FFFF1A 		bne	.L48
1055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                cipher_info->key_bitlen,
 1065              		.loc 2 1055 0
 1066 02cc 0B30A0E1 		mov	r3, fp
 1067 02d0 042096E5 		ldr	r2, [r6, #4]
 1068 02d4 0910A0E1 		mov	r1, r9
 1069 02d8 0400A0E1 		mov	r0, r4
 1070              	.LVL134:
 1071 02dc FEFFFFEB 		bl	mbedtls_cipher_setkey
 1072              	.LVL135:
 1073 02e0 00B050E2 		subs	fp, r0, #0
 1074 02e4 52FFFF1A 		bne	.L48
1064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1075              		.loc 2 1064 0
 1076 02e8 0120D6E5 		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 1077 02ec 020052E3 		cmp	r2, #2
 1078 02f0 3700000A 		beq	.L69
 1079              	.L70:
1082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1080              		.loc 2 1082 0
 1081 02f4 011CA0E3 		mov	r1, #256
 1082 02f8 0800A0E1 		mov	r0, r8
 1083              	.LVL136:
 1084 02fc FEFFFFEB 		bl	mbedtls_platform_zeroize
 1085              	.LVL137:
1118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 1086              		.loc 2 1118 0
 1087 0300 4BFFFFEA 		b	.L48
 1088              	.LVL138:
 1089              	.L54:
 750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   "master secret",
 1090              		.loc 2 750 0
 1091 0304 3030A0E3 		mov	r3, #48
 1092 0308 10219FE5 		ldr	r2, .L90+28
 1093 030c 08308DE5 		str	r3, [sp, #8]
 1094 0310 0800A0E1 		mov	r0, r8
 1095              	.LVL139:
 1096 0314 18309DE5 		ldr	r3, [sp, #24]
 1097 0318 04308DE5 		str	r3, [sp, #4]
 1098 031c 4030A0E3 		mov	r3, #64
 1099 0320 00308DE5 		str	r3, [sp]
 1100 0324 1D3E85E2 		add	r3, r5, #464
 1101 0328 CC1195E5 		ldr	r1, [r5, #460]
 1102 032c FEFFFFEB 		bl	tls_prf_sha256
 1103              	.LVL140:
 1104 0330 71FFFFEA 		b	.L87
 1105              	.LVL141:
 1106              	.L58:
 840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ret = mbedtls_md_setup( &transform->md_ctx_dec, md_info, 1 ) ) != 0 )
 1107              		.loc 2 840 0
 1108 0334 0120A0E3 		mov	r2, #1
 1109 0338 14109DE5 		ldr	r1, [sp, #20]
 1110 033c 380084E2 		add	r0, r4, #56
 1111 0340 FEFFFFEB 		bl	mbedtls_md_setup
 1112              	.LVL142:
 1113 0344 00B050E2 		subs	fp, r0, #0
 1114 0348 39FFFF1A 		bne	.L48
 840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ret = mbedtls_md_setup( &transform->md_ctx_dec, md_info, 1 ) ) != 0 )
 1115              		.loc 2 840 0 is_stmt 0 discriminator 1
 1116 034c 0120A0E3 		mov	r2, #1
 1117 0350 14109DE5 		ldr	r1, [sp, #20]
 1118 0354 440084E2 		add	r0, r4, #68
 1119              	.LVL143:
 1120 0358 FEFFFFEB 		bl	mbedtls_md_setup
 1121              	.LVL144:
 1122 035c 00B050E2 		subs	fp, r0, #0
 1123 0360 33FFFF1A 		bne	.L48
 848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->maclen = mac_key_len;
 1124              		.loc 2 848 0 is_stmt 1
 1125 0364 14009DE5 		ldr	r0, [sp, #20]
 1126              	.LVL145:
 1127 0368 FEFFFFEB 		bl	mbedtls_md_get_size
 1128              	.LVL146:
 874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->minlen = transform->maclen;
 1129              		.loc 2 874 0
 1130 036c 0130D6E5 		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         transform->maclen = mac_key_len;
 1131              		.loc 2 848 0
 1132 0370 0050A0E1 		mov	r5, r0
 1133              	.LVL147:
 871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1134              		.loc 2 871 0
 1135 0374 0C9096E5 		ldr	r9, [r6, #12]
 1136              	.LVL148:
 849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1137              		.loc 2 849 0
 1138 0378 140084E5 		str	r0, [r4, #20]
 874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->minlen = transform->maclen;
 1139              		.loc 2 874 0
 1140 037c 070053E3 		cmp	r3, #7
 871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1141              		.loc 2 871 0
 1142 0380 0C9084E5 		str	r9, [r4, #12]
 875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
 1143              		.loc 2 875 0
 1144 0384 08008405 		streq	r0, [r4, #8]
 874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform->minlen = transform->maclen;
 1145              		.loc 2 874 0
 1146 0388 99FFFF0A 		beq	.L62
 885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 1147              		.loc 2 885 0
 1148 038c 1C309DE5 		ldr	r3, [sp, #28]
 1149 0390 141096E5 		ldr	r1, [r6, #20]
 1150 0394 683093E5 		ldr	r3, [r3, #104]
 1151 0398 010053E3 		cmp	r3, #1
 888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 1152              		.loc 2 888 0
 1153 039c 00108100 		addeq	r1, r1, r0
 885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 1154              		.loc 2 885 0
 1155 03a0 0200000A 		beq	.L89
 894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   - transform->maclen % cipher_info->block_size;
 1156              		.loc 2 894 0
 1157 03a4 01A080E0 		add	r10, r0, r1
 895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 1158              		.loc 2 895 0
 1159 03a8 FEFFFFEB 		bl	__aeabi_uidivmod
 1160              	.LVL149:
 1161 03ac 01104AE0 		sub	r1, r10, r1
 1162              	.L89:
 905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 1163              		.loc 2 905 0
 1164 03b0 0C3097E5 		ldr	r3, [r7, #12]
 893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   + cipher_info->block_size
 1165              		.loc 2 893 0
 1166 03b4 081084E5 		str	r1, [r4, #8]
 905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_3 )
 1167              		.loc 2 905 0
 1168 03b8 023043E2 		sub	r3, r3, #2
 1169 03bc 010053E3 		cmp	r3, #1
 1170 03c0 27FFFF8A 		bhi	.L66
 908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 1171              		.loc 2 908 0
 1172 03c4 083094E5 		ldr	r3, [r4, #8]
 1173 03c8 093083E0 		add	r3, r3, r9
 1174 03cc 083084E5 		str	r3, [r4, #8]
 1175 03d0 87FFFFEA 		b	.L62
 1176              	.LVL150:
 1177              	.L69:
1066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                              MBEDTLS_PADDING_NONE ) ) != 0 )
 1178              		.loc 2 1066 0
 1179 03d4 0410A0E3 		mov	r1, #4
 1180 03d8 0500A0E1 		mov	r0, r5
 1181              	.LVL151:
 1182 03dc FEFFFFEB 		bl	mbedtls_cipher_set_padding_mode
 1183              	.LVL152:
 1184 03e0 000050E3 		cmp	r0, #0
 1185 03e4 0400001A 		bne	.L73
1073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                              MBEDTLS_PADDING_NONE ) ) != 0 )
 1186              		.loc 2 1073 0
 1187 03e8 0410A0E3 		mov	r1, #4
 1188 03ec 0400A0E1 		mov	r0, r4
 1189              	.LVL153:
 1190 03f0 FEFFFFEB 		bl	mbedtls_cipher_set_padding_mode
 1191              	.LVL154:
 1192 03f4 000050E3 		cmp	r0, #0
 1193 03f8 BDFFFF0A 		beq	.L70
 1194              	.L73:
 1195 03fc 00B0A0E1 		mov	fp, r0
 1196 0400 0BFFFFEA 		b	.L48
 1197              	.L91:
 1198              		.align	2
 1199              	.L90:
 1200 0404 008FFFFF 		.word	-28928
 1201 0408 0094FFFF 		.word	-27648
 1202 040c 00000000 		.word	tls_prf_sha256
 1203 0410 00000000 		.word	ssl_calc_verify_tls_sha256
 1204 0414 00000000 		.word	ssl_calc_finished_tls_sha256
 1205 0418 00000000 		.word	.LC2
 1206 041c 25000000 		.word	.LC4
 1207 0420 17000000 		.word	.LC3
 1208              		.cfi_endproc
 1209              	.LFE28:
 1211              		.section	.text.mbedtls_ssl_fetch_input,"ax",%progbits
 1212              		.align	2
 1213              		.global	mbedtls_ssl_fetch_input
 1214              		.syntax unified
 1215              		.arm
 1216              		.fpu neon
 1218              	mbedtls_ssl_fetch_input:
 1219              	.LFB33:
2531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 1220              		.loc 2 2531 0
 1221              		.cfi_startproc
 1222              		@ args = 0, pretend = 0, frame = 0
 1223              		@ frame_needed = 0, uses_anonymous_args = 0
 1224              	.LVL155:
2537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1225              		.loc 2 2537 0
 1226 0000 143090E5 		ldr	r3, [r0, #20]
 1227 0004 000053E3 		cmp	r3, #0
 1228 0008 0200001A 		bne	.L93
2537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1229              		.loc 2 2537 0 is_stmt 0 discriminator 1
 1230 000c 183090E5 		ldr	r3, [r0, #24]
 1231 0010 000053E3 		cmp	r3, #0
 1232 0014 2800000A 		beq	.L101
 1233              	.L93:
2544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1234              		.loc 2 2544 0 is_stmt 1
 1235 0018 583090E5 		ldr	r3, [r0, #88]
 1236 001c 502090E5 		ldr	r2, [r0, #80]
2531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 1237              		.loc 2 2531 0
 1238 0020 F0412DE9 		push	{r4, r5, r6, r7, r8, lr}
 1239              		.cfi_def_cfa_offset 24
 1240              		.cfi_offset 4, -24
 1241              		.cfi_offset 5, -20
 1242              		.cfi_offset 6, -16
 1243              		.cfi_offset 7, -12
 1244              		.cfi_offset 8, -8
 1245              		.cfi_offset 14, -4
 1246 0024 0160A0E1 		mov	r6, r1
 1247 0028 0040A0E1 		mov	r4, r0
2544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1248              		.loc 2 2544 0
 1249 002c 023043E0 		sub	r3, r3, r2
 1250 0030 213C63E2 		rsb	r3, r3, #8448
 1251 0034 3D3083E2 		add	r3, r3, #61
 1252 0038 010053E1 		cmp	r3, r1
 1253 003c 1900002A 		bcs	.L95
2541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1254              		.loc 2 2541 0
 1255 0040 B8009FE5 		ldr	r0, .L113
 1256              	.LVL156:
 1257 0044 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 1258              	.LVL157:
 1259              	.L98:
 1260              	.LBB98:
 1261              	.LBB99:
 1262              	.LBB100:
 1263              	.LBB101:
  90:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
 1264              		.loc 2 90 0
 1265 0048 4C3094E5 		ldr	r3, [r4, #76]
 1266              	.LBE101:
 1267              	.LBE100:
2700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1268              		.loc 2 2700 0
 1269 004c 055046E0 		sub	r5, r6, r5
 1270              	.LVL158:
 1271              	.LBB103:
 1272              	.LBB102:
  90:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
 1273              		.loc 2 90 0
 1274 0050 000053E3 		cmp	r3, #0
 1275 0054 1E00000A 		beq	.L96
  93:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1276              		.loc 2 93 0
 1277 0058 440094E5 		ldr	r0, [r4, #68]
 1278 005c 33FF2FE1 		blx	r3
 1279              	.LVL159:
 1280 0060 020050E3 		cmp	r0, #2
 1281 0064 1A00001A 		bne	.L96
 1282              	.LBE102:
 1283              	.LBE103:
2703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
 1284              		.loc 2 2703 0
 1285 0068 94009FE5 		ldr	r0, .L113+4
 1286 006c F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 1287              	.LVL160:
 1288              	.L99:
2708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                ssl->in_hdr + ssl->in_left, len,
 1289              		.loc 2 2708 0
 1290 0070 003094E5 		ldr	r3, [r4]
 1291 0074 001081E0 		add	r1, r1, r0
 1292 0078 0520A0E1 		mov	r2, r5
 1293 007c 1C0094E5 		ldr	r0, [r4, #28]
 1294 0080 583093E5 		ldr	r3, [r3, #88]
 1295 0084 37FF2FE1 		blx	r7
 1296              	.LVL161:
 1297              	.L97:
2723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_CONN_EOF );
 1298              		.loc 2 2723 0
 1299 0088 000050E3 		cmp	r0, #0
 1300 008c 0C00000A 		beq	.L104
2726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
 1301              		.loc 2 2726 0
 1302 0090 F081BDB8 		poplt	{r4, r5, r6, r7, r8, pc}
2729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 1303              		.loc 2 2729 0
 1304 0094 000055E1 		cmp	r5, r0
 1305 0098 0B00003A 		bcc	.L105
2737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1306              		.loc 2 2737 0
 1307 009c 743094E5 		ldr	r3, [r4, #116]
 1308 00a0 000083E0 		add	r0, r3, r0
 1309              	.LVL162:
 1310 00a4 740084E5 		str	r0, [r4, #116]
 1311              	.LVL163:
 1312              	.L95:
2698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1313              		.loc 2 2698 0
 1314 00a8 745094E5 		ldr	r5, [r4, #116]
 1315 00ac 050056E1 		cmp	r6, r5
 1316 00b0 E4FFFF8A 		bhi	.L98
2743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 1317              		.loc 2 2743 0
 1318 00b4 0000A0E3 		mov	r0, #0
 1319 00b8 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 1320              	.LVL164:
 1321              	.L101:
 1322              		.cfi_def_cfa_offset 0
 1323              		.cfi_restore 4
 1324              		.cfi_restore 5
 1325              		.cfi_restore 6
 1326              		.cfi_restore 7
 1327              		.cfi_restore 8
 1328              		.cfi_restore 14
 1329              	.LBE99:
 1330              	.LBE98:
2541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1331              		.loc 2 2541 0
 1332 00bc 3C009FE5 		ldr	r0, .L113
 1333              	.LVL165:
 1334 00c0 1EFF2FE1 		bx	lr
 1335              	.LVL166:
 1336              	.L104:
 1337              		.cfi_def_cfa_offset 24
 1338              		.cfi_offset 4, -24
 1339              		.cfi_offset 5, -20
 1340              		.cfi_offset 6, -16
 1341              		.cfi_offset 7, -12
 1342              		.cfi_offset 8, -8
 1343              		.cfi_offset 14, -4
 1344              	.LBB105:
 1345              	.LBB104:
2724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1346              		.loc 2 2724 0
 1347 00c4 3C009FE5 		ldr	r0, .L113+8
 1348              	.LVL167:
 1349 00c8 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 1350              	.LVL168:
 1351              	.L105:
2734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 1352              		.loc 2 2734 0
 1353 00cc 38009FE5 		ldr	r0, .L113+12
 1354              	.LVL169:
 1355 00d0 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 1356              	.LVL170:
 1357              	.L96:
2706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
 1358              		.loc 2 2706 0
 1359 00d4 187094E5 		ldr	r7, [r4, #24]
 1360 00d8 581094E5 		ldr	r1, [r4, #88]
 1361 00dc 740094E5 		ldr	r0, [r4, #116]
 1362 00e0 000057E3 		cmp	r7, #0
 1363 00e4 E1FFFF1A 		bne	.L99
2714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        ssl->in_hdr + ssl->in_left, len );
 1364              		.loc 2 2714 0
 1365 00e8 001081E0 		add	r1, r1, r0
 1366 00ec 143094E5 		ldr	r3, [r4, #20]
 1367 00f0 0520A0E1 		mov	r2, r5
 1368 00f4 1C0094E5 		ldr	r0, [r4, #28]
 1369 00f8 33FF2FE1 		blx	r3
 1370              	.LVL171:
 1371 00fc E1FFFFEA 		b	.L97
 1372              	.L114:
 1373              		.align	2
 1374              	.L113:
 1375 0100 008FFFFF 		.word	-28928
 1376 0104 0098FFFF 		.word	-26624
 1377 0108 808DFFFF 		.word	-29312
 1378 010c 0094FFFF 		.word	-27648
 1379              	.LBE104:
 1380              	.LBE105:
 1381              		.cfi_endproc
 1382              	.LFE33:
 1384              		.section	.text.mbedtls_ssl_flush_output,"ax",%progbits
 1385              		.align	2
 1386              		.global	mbedtls_ssl_flush_output
 1387              		.syntax unified
 1388              		.arm
 1389              		.fpu neon
 1391              	mbedtls_ssl_flush_output:
 1392              	.LFB34:
2750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 1393              		.loc 2 2750 0
 1394              		.cfi_startproc
 1395              		@ args = 0, pretend = 0, frame = 0
 1396              		@ frame_needed = 0, uses_anonymous_args = 0
 1397              	.LVL172:
2756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1398              		.loc 2 2756 0
 1399 0000 103090E5 		ldr	r3, [r0, #16]
 1400 0004 000053E3 		cmp	r3, #0
 1401 0008 1D00000A 		beq	.L119
2750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 1402              		.loc 2 2750 0
 1403 000c 70402DE9 		push	{r4, r5, r6, lr}
 1404              		.cfi_def_cfa_offset 16
 1405              		.cfi_offset 4, -16
 1406              		.cfi_offset 5, -12
 1407              		.cfi_offset 6, -8
 1408              		.cfi_offset 14, -4
 1409 0010 0050A0E1 		mov	r5, r0
2764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1410              		.loc 2 2764 0
 1411 0014 A40090E5 		ldr	r0, [r0, #164]
 1412              	.LVL173:
 1413 0018 000050E3 		cmp	r0, #0
 1414 001c 0D00001A 		bne	.L117
 1415 0020 7080BDE8 		pop	{r4, r5, r6, pc}
 1416              	.L118:
 1417              	.LVL174:
2775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = ssl->f_send( ssl->p_bio, buf, ssl->out_left );
 1418              		.loc 2 2775 0
 1419 0024 8C1095E5 		ldr	r1, [r5, #140]
2776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1420              		.loc 2 2776 0
 1421 0028 0420A0E1 		mov	r2, r4
 1422 002c 103095E5 		ldr	r3, [r5, #16]
 1423 0030 1C0095E5 		ldr	r0, [r5, #28]
 1424 0034 041041E0 		sub	r1, r1, r4
 1425              	.LVL175:
 1426 0038 33FF2FE1 		blx	r3
 1427              	.LVL176:
2780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
 1428              		.loc 2 2780 0
 1429 003c 000050E3 		cmp	r0, #0
 1430 0040 7080BDD8 		pople	{r4, r5, r6, pc}
2783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1431              		.loc 2 2783 0
 1432 0044 A42095E5 		ldr	r2, [r5, #164]
 1433 0048 000052E1 		cmp	r2, r0
 1434 004c 0E00003A 		bcc	.L121
2791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1435              		.loc 2 2791 0
 1436 0050 000042E0 		sub	r0, r2, r0
 1437              	.LVL177:
 1438 0054 A40085E5 		str	r0, [r5, #164]
 1439              	.L117:
2770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1440              		.loc 2 2770 0
 1441 0058 A44095E5 		ldr	r4, [r5, #164]
 1442 005c 000054E3 		cmp	r4, #0
 1443 0060 EFFFFF1A 		bne	.L118
 1444              	.LVL178:
 1445              	.LBB108:
 1446              	.LBB109:
2802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1447              		.loc 2 2802 0
 1448 0064 843095E5 		ldr	r3, [r5, #132]
2804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1449              		.loc 2 2804 0
 1450 0068 0500A0E1 		mov	r0, r5
 1451 006c 381095E5 		ldr	r1, [r5, #56]
2802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1452              		.loc 2 2802 0
 1453 0070 083083E2 		add	r3, r3, #8
 1454 0074 8C3085E5 		str	r3, [r5, #140]
2804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1455              		.loc 2 2804 0
 1456 0078 FEFFFFEB 		bl	ssl_update_out_pointers
 1457              	.LVL179:
 1458 007c 0400A0E1 		mov	r0, r4
 1459 0080 7080BDE8 		pop	{r4, r5, r6, pc}
 1460              	.LVL180:
 1461              	.L119:
 1462              		.cfi_def_cfa_offset 0
 1463              		.cfi_restore 4
 1464              		.cfi_restore 5
 1465              		.cfi_restore 6
 1466              		.cfi_restore 14
 1467              	.LBE109:
 1468              	.LBE108:
2760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1469              		.loc 2 2760 0
 1470 0084 08009FE5 		ldr	r0, .L126
 1471              	.LVL181:
 1472 0088 1EFF2FE1 		bx	lr
 1473              	.LVL182:
 1474              	.L121:
 1475              		.cfi_def_cfa_offset 16
 1476              		.cfi_offset 4, -16
 1477              		.cfi_offset 5, -12
 1478              		.cfi_offset 6, -8
 1479              		.cfi_offset 14, -4
2788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1480              		.loc 2 2788 0
 1481 008c 04009FE5 		ldr	r0, .L126+4
 1482              	.LVL183:
2809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1483              		.loc 2 2809 0
 1484 0090 7080BDE8 		pop	{r4, r5, r6, pc}
 1485              	.L127:
 1486              		.align	2
 1487              	.L126:
 1488 0094 008FFFFF 		.word	-28928
 1489 0098 0094FFFF 		.word	-27648
 1490              		.cfi_endproc
 1491              	.LFE34:
 1493              		.section	.text.mbedtls_ssl_write_record,"ax",%progbits
 1494              		.align	2
 1495              		.global	mbedtls_ssl_write_record
 1496              		.syntax unified
 1497              		.arm
 1498              		.fpu neon
 1500              	mbedtls_ssl_write_record:
 1501              	.LFB36:
3335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, done = 0;
 1502              		.loc 2 3335 0
 1503              		.cfi_startproc
 1504              		@ args = 0, pretend = 0, frame = 56
 1505              		@ frame_needed = 0, uses_anonymous_args = 0
 1506              	.LVL184:
 1507              	.LBB124:
3377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 1508              		.loc 2 3377 0
 1509 0000 8C3090E5 		ldr	r3, [r0, #140]
 1510 0004 9C2090E5 		ldr	r2, [r0, #156]
 1511              	.LBE124:
3335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, done = 0;
 1512              		.loc 2 3335 0
 1513 0008 F04F2DE9 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1514              		.cfi_def_cfa_offset 36
 1515              		.cfi_offset 4, -36
 1516              		.cfi_offset 5, -32
 1517              		.cfi_offset 6, -28
 1518              		.cfi_offset 7, -24
 1519              		.cfi_offset 8, -20
 1520              		.cfi_offset 9, -16
 1521              		.cfi_offset 10, -12
 1522              		.cfi_offset 11, -8
 1523              		.cfi_offset 14, -4
 1524 000c 0180A0E1 		mov	r8, r1
3337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint8_t flush = force_flush;
 1525              		.loc 2 3337 0
 1526 0010 A05090E5 		ldr	r5, [r0, #160]
 1527              	.LVL185:
3335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, done = 0;
 1528              		.loc 2 3335 0
 1529 0014 0040A0E1 		mov	r4, r0
 1530 0018 5CD04DE2 		sub	sp, sp, #92
 1531              		.cfi_def_cfa_offset 128
 1532              	.LBB150:
3377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 1533              		.loc 2 3377 0
 1534 001c 0020C3E5 		strb	r2, [r3]
3378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->conf->transport, ssl->out_hdr + 1 );
 1535              		.loc 2 3378 0
 1536 0020 0C2090E5 		ldr	r2, [r0, #12]
3379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1537              		.loc 2 3379 0
 1538 0024 8C3090E5 		ldr	r3, [r0, #140]
 1539              	.LVL186:
 1540              	.LBB125:
 1541              	.LBB126:
7210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_own_cert( mbedtls_ssl_config *conf,
7212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               mbedtls_x509_crt *own_cert,
7213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               mbedtls_pk_context *pk_key )
7214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_append_key_cert( &conf->key_cert, own_cert, pk_key ) );
7216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_ca_chain( mbedtls_ssl_config *conf,
7219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                mbedtls_x509_crt *ca_chain,
7220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                mbedtls_x509_crl *ca_crl )
7221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ca_chain   = ca_chain;
7223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ca_crl     = ca_crl;
7224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
7228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_set_hs_own_cert( mbedtls_ssl_context *ssl,
7229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  mbedtls_x509_crt *own_cert,
7230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  mbedtls_pk_context *pk_key )
7231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_append_key_cert( &ssl->handshake->sni_key_cert,
7233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  own_cert, pk_key ) );
7234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_hs_ca_chain( mbedtls_ssl_context *ssl,
7237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   mbedtls_x509_crt *ca_chain,
7238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   mbedtls_x509_crl *ca_crl )
7239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->sni_ca_chain   = ca_chain;
7241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->sni_ca_crl     = ca_crl;
7242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_hs_authmode( mbedtls_ssl_context *ssl,
7245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   int authmode )
7246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->sni_authmode = authmode;
7248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
7250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
7252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Set EC J-PAKE password for current handshake
7254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_set_hs_ecjpake_password( mbedtls_ssl_context *ssl,
7256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          const unsigned char *pw,
7257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          size_t pw_len )
7258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ecjpake_role role;
7260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake == NULL || ssl->conf == NULL )
7262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
7265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         role = MBEDTLS_ECJPAKE_SERVER;
7266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
7267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         role = MBEDTLS_ECJPAKE_CLIENT;
7268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( mbedtls_ecjpake_setup( &ssl->handshake->ecjpake_ctx,
7270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    role,
7271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    MBEDTLS_MD_SHA256,
7272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    MBEDTLS_ECP_DP_SECP256R1,
7273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    pw, pw_len ) );
7274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
7276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
7278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_psk( mbedtls_ssl_config *conf,
7279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 const unsigned char *psk, size_t psk_len,
7280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 const unsigned char *psk_identity, size_t psk_identity_len )
7281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( psk == NULL || psk_identity == NULL )
7283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( psk_len > MBEDTLS_PSK_MAX_LEN )
7286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Identity len will be encoded on two bytes */
7289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( psk_identity_len >> 16 ) != 0 ||
7290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         psk_identity_len > MBEDTLS_SSL_OUT_CONTENT_LEN )
7291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( conf->psk != NULL )
7296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( conf->psk, conf->psk_len );
7298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( conf->psk );
7300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk = NULL;
7301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_len = 0;
7302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( conf->psk_identity != NULL )
7304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( conf->psk_identity );
7306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_identity = NULL;
7307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_identity_len = 0;
7308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( conf->psk = mbedtls_calloc( 1, psk_len ) ) == NULL ||
7311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( conf->psk_identity = mbedtls_calloc( 1, psk_identity_len ) ) == NULL )
7312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( conf->psk );
7314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( conf->psk_identity );
7315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk = NULL;
7316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_identity = NULL;
7317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
7318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->psk_len = psk_len;
7321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->psk_identity_len = psk_identity_len;
7322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( conf->psk, psk, conf->psk_len );
7324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( conf->psk_identity, psk_identity, conf->psk_identity_len );
7325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_set_hs_psk( mbedtls_ssl_context *ssl,
7330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             const unsigned char *psk, size_t psk_len )
7331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( psk == NULL || ssl->handshake == NULL )
7333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( psk_len > MBEDTLS_PSK_MAX_LEN )
7336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake->psk != NULL )
7339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( ssl->handshake->psk,
7341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->handshake->psk_len );
7342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->handshake->psk );
7343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->psk_len = 0;
7344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ssl->handshake->psk = mbedtls_calloc( 1, psk_len ) ) == NULL )
7347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
7348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->psk_len = psk_len;
7350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( ssl->handshake->psk, psk, ssl->handshake->psk_len );
7351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_psk_cb( mbedtls_ssl_config *conf,
7356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      int (*f_psk)(void *, mbedtls_ssl_context *, const unsigned char *,
7357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      size_t),
7358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      void *p_psk )
7359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_psk = f_psk;
7361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_psk = p_psk;
7362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
7364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
7366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_DEPRECATED_REMOVED)
7368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_dh_param( mbedtls_ssl_config *conf, const char *dhm_P, const char *dhm_G )
7369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
7371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_mpi_read_string( &conf->dhm_P, 16, dhm_P ) ) != 0 ||
7373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_mpi_read_string( &conf->dhm_G, 16, dhm_G ) ) != 0 )
7374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_P );
7376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_G );
7377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
7378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_DEPRECATED_REMOVED */
7383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_dh_param_bin( mbedtls_ssl_config *conf,
7385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    const unsigned char *dhm_P, size_t P_len,
7386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    const unsigned char *dhm_G, size_t G_len )
7387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
7389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_mpi_read_binary( &conf->dhm_P, dhm_P, P_len ) ) != 0 ||
7391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_mpi_read_binary( &conf->dhm_G, dhm_G, G_len ) ) != 0 )
7392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_P );
7394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_G );
7395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
7396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_dh_param_ctx( mbedtls_ssl_config *conf, mbedtls_dhm_context *dhm_ctx )
7402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
7404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_mpi_copy( &conf->dhm_P, &dhm_ctx->P ) ) != 0 ||
7406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_mpi_copy( &conf->dhm_G, &dhm_ctx->G ) ) != 0 )
7407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_P );
7409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_mpi_free( &conf->dhm_G );
7410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
7411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_DHM_C && MBEDTLS_SSL_SRV_C */
7416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_CLI_C)
7418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Set the minimum length for Diffie-Hellman parameters
7420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_dhm_min_bitlen( mbedtls_ssl_config *conf,
7422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       unsigned int bitlen )
7423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->dhm_min_bitlen = bitlen;
7425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_DHM_C && MBEDTLS_SSL_CLI_C */
7427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
7429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Set allowed/preferred hashes for handshake signatures
7431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_sig_hashes( mbedtls_ssl_config *conf,
7433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   const int *hashes )
7434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->sig_hashes = hashes;
7436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
7438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
7440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Set the allowed elliptic curves
7442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_curves( mbedtls_ssl_config *conf,
7444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              const mbedtls_ecp_group_id *curve_list )
7445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->curve_list = curve_list;
7447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
7449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_set_hostname( mbedtls_ssl_context *ssl, const char *hostname )
7452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Initialize to suppress unnecessary compiler warning */
7454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t hostname_len = 0;
7455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check if new hostname is valid before
7457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * making any change to current one */
7458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hostname != NULL )
7459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hostname_len = strlen( hostname );
7461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( hostname_len > MBEDTLS_SSL_MAX_HOST_NAME_LEN )
7463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Now it's clear that we will overwrite the old hostname,
7467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * so we can free it safely */
7468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->hostname != NULL )
7470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( ssl->hostname, strlen( ssl->hostname ) );
7472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->hostname );
7473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Passing NULL as hostname shall clear the old one */
7476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hostname == NULL )
7478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->hostname = NULL;
7480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
7482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->hostname = mbedtls_calloc( 1, hostname_len + 1 );
7484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->hostname == NULL )
7485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
7486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->hostname, hostname, hostname_len );
7488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->hostname[hostname_len] = '\0';
7490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
7497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_sni( mbedtls_ssl_config *conf,
7498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   int (*f_sni)(void *, mbedtls_ssl_context *,
7499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 const unsigned char *, size_t),
7500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   void *p_sni )
7501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_sni = f_sni;
7503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_sni = p_sni;
7504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SERVER_NAME_INDICATION */
7506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ALPN)
7508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_alpn_protocols( mbedtls_ssl_config *conf, const char **protos )
7509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t cur_len, tot_len;
7511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const char **p;
7512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * RFC 7301 3.1: "Empty strings MUST NOT be included and byte strings
7515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * MUST NOT be truncated."
7516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * We check lengths now rather than later.
7517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     tot_len = 0;
7519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( p = protos; *p != NULL; p++ )
7520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cur_len = strlen( *p );
7522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         tot_len += cur_len;
7523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( cur_len == 0 || cur_len > 255 || tot_len > 65535 )
7525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->alpn_list = protos;
7529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** const char *mbedtls_ssl_get_alpn_protocol( const mbedtls_ssl_context *ssl )
7534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl->alpn_chosen );
7536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_ALPN */
7538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_max_version( mbedtls_ssl_config *conf, int major, int minor )
7540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->max_major_ver = major;
7542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->max_minor_ver = minor;
7543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_min_version( mbedtls_ssl_config *conf, int major, int minor )
7546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->min_major_ver = major;
7548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->min_minor_ver = minor;
7549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_FALLBACK_SCSV) && defined(MBEDTLS_SSL_CLI_C)
7552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_fallback( mbedtls_ssl_config *conf, char fallback )
7553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->fallback = fallback;
7555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
7559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_cert_req_ca_list( mbedtls_ssl_config *conf,
7560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                           char cert_req_ca_list )
7561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->cert_req_ca_list = cert_req_ca_list;
7563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
7567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_encrypt_then_mac( mbedtls_ssl_config *conf, char etm )
7568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->encrypt_then_mac = etm;
7570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
7574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_extended_master_secret( mbedtls_ssl_config *conf, char ems )
7575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->extended_ms = ems;
7577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ARC4_C)
7581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_arc4_support( mbedtls_ssl_config *conf, char arc4 )
7582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->arc4_disabled = arc4;
7584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
7588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_conf_max_frag_len( mbedtls_ssl_config *conf, unsigned char mfl_code )
7589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mfl_code >= MBEDTLS_SSL_MAX_FRAG_LEN_INVALID ||
7591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( mfl_code ) > MBEDTLS_TLS_EXT_ADV_CONTENT_LEN )
7592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->mfl_code = mfl_code;
7597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
7601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_TRUNCATED_HMAC)
7603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_truncated_hmac( mbedtls_ssl_config *conf, int truncate )
7604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->trunc_hmac = truncate;
7606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_TRUNCATED_HMAC */
7608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
7610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_cbc_record_splitting( mbedtls_ssl_config *conf, char split )
7611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->cbc_record_splitting = split;
7613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_legacy_renegotiation( mbedtls_ssl_config *conf, int allow_legacy )
7617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->allow_legacy_renegotiation = allow_legacy;
7619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
7622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_renegotiation( mbedtls_ssl_config *conf, int renegotiation )
7623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->disable_renegotiation = renegotiation;
7625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_renegotiation_enforced( mbedtls_ssl_config *conf, int max_records )
7628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->renego_max_records = max_records;
7630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_renegotiation_period( mbedtls_ssl_config *conf,
7633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    const unsigned char period[8] )
7634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( conf->renego_period, period, 8 );
7636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
7638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
7640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
7641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_session_tickets( mbedtls_ssl_config *conf, int use_tickets )
7642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->session_tickets = use_tickets;
7644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
7648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_session_tickets_cb( mbedtls_ssl_config *conf,
7649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_ticket_write_t *f_ticket_write,
7650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_ticket_parse_t *f_ticket_parse,
7651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         void *p_ticket )
7652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_ticket_write = f_ticket_write;
7654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_ticket_parse = f_ticket_parse;
7655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_ticket       = p_ticket;
7656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SESSION_TICKETS */
7659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_EXPORT_KEYS)
7661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_export_keys_cb( mbedtls_ssl_config *conf,
7662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_export_keys_t *f_export_keys,
7663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         void *p_export_keys )
7664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_export_keys = f_export_keys;
7666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_export_keys = p_export_keys;
7667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
7671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_conf_async_private_cb(
7672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_config *conf,
7673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_async_sign_t *f_async_sign,
7674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_async_decrypt_t *f_async_decrypt,
7675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_async_resume_t *f_async_resume,
7676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_async_cancel_t *f_async_cancel,
7677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     void *async_config_data )
7678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_async_sign_start = f_async_sign;
7680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_async_decrypt_start = f_async_decrypt;
7681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_async_resume = f_async_resume;
7682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_async_cancel = f_async_cancel;
7683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_async_config_data = async_config_data;
7684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void *mbedtls_ssl_conf_get_async_config_data( const mbedtls_ssl_config *conf )
7687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( conf->p_async_config_data );
7689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void *mbedtls_ssl_get_async_operation_data( const mbedtls_ssl_context *ssl )
7692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake == NULL )
7694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
7695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
7696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->handshake->user_async_ctx );
7697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_set_async_operation_data( mbedtls_ssl_context *ssl,
7700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  void *ctx )
7701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake != NULL )
7703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->user_async_ctx = ctx;
7704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
7706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * SSL get accessors
7709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
7710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** size_t mbedtls_ssl_get_bytes_avail( const mbedtls_ssl_context *ssl )
7711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl->in_offt == NULL ? 0 : ssl->in_msglen );
7713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_check_pending( const mbedtls_ssl_context *ssl )
7716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Case A: We're currently holding back
7719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * a message for further processing.
7720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->keep_current_message == 1 )
7723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: record held back for processing" ) );
7725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
7726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Case B: Further records are pending in the current datagram.
7730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
7734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_left > ssl->next_record_offset )
7735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: more records within current datagram" ) );
7737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
7738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
7740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Case C: A handshake message is being processed.
7743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_hslen > 0 && ssl->in_hslen < ssl->in_msglen )
7746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: more handshake messages within current reco
7748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
7749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Case D: An application data message is being processed
7753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_offt != NULL )
7755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: application data record is being processed"
7757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
7758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * In all other cases, the rest of the message can be dropped.
7762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * As in ssl_get_next_record, this needs to be adapted if
7763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * we implement support for multiple alerts in single records.
7764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 3, ( "ssl_check_pending: nothing pending" ) );
7767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
7768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** uint32_t mbedtls_ssl_get_verify_result( const mbedtls_ssl_context *ssl )
7771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session != NULL )
7773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->session->verify_result );
7774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_negotiate != NULL )
7776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->session_negotiate->verify_result );
7777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0xFFFFFFFF );
7779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** const char *mbedtls_ssl_get_ciphersuite( const mbedtls_ssl_context *ssl )
7782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->session == NULL )
7784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
7785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return mbedtls_ssl_get_ciphersuite_name( ssl->session->ciphersuite );
7787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** const char *mbedtls_ssl_get_version( const mbedtls_ssl_context *ssl )
7790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
7793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         switch( ssl->minor_ver )
7795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
7796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_SSL_MINOR_VERSION_2:
7797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( "DTLSv1.0" );
7798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_SSL_MINOR_VERSION_3:
7800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( "DTLSv1.2" );
7801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             default:
7803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( "unknown (DTLS)" );
7804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
7805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( ssl->minor_ver )
7809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_0:
7811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( "SSLv3.0" );
7812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_1:
7814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( "TLSv1.0" );
7815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_2:
7817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( "TLSv1.1" );
7818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_MINOR_VERSION_3:
7820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( "TLSv1.2" );
7821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
7823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( "unknown" );
7824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_get_record_expansion( const mbedtls_ssl_context *ssl )
7828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t transform_expansion = 0;
7830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ssl_transform *transform = ssl->transform_out;
7831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned block_size;
7832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transform == NULL )
7834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( (int) mbedtls_ssl_hdr_len( ssl ) );
7835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
7837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_out->compression != MBEDTLS_SSL_COMPRESS_NULL )
7838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
7839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( mbedtls_cipher_get_cipher_mode( &transform->cipher_ctx_enc ) )
7842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MODE_GCM:
7844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MODE_CCM:
7845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MODE_CHACHAPOLY:
7846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MODE_STREAM:
7847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform_expansion = transform->minlen;
7848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
7849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MODE_CBC:
7851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             block_size = mbedtls_cipher_get_block_size(
7853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 &transform->cipher_ctx_enc );
7854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Expansion due to the addition of the MAC. */
7856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform_expansion += transform->maclen;
7857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Expansion due to the addition of CBC padding;
7859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * Theoretically up to 256 bytes, but we never use
7860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * more than the block size of the underlying cipher. */
7861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             transform_expansion += block_size;
7862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* For TLS 1.1 or higher, an explicit IV is added
7864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * after the record header. */
7865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_1) || defined(MBEDTLS_SSL_PROTO_TLS1_2)
7866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
7867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 transform_expansion += block_size;
7868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
7869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
7871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
7873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
7874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
7875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( (int)( mbedtls_ssl_hdr_len( ssl ) + transform_expansion ) );
7878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
7881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** size_t mbedtls_ssl_get_max_frag_len( const mbedtls_ssl_context *ssl )
7882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t max_len;
7884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
7886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Assume mfl_code is correct since it was checked when set
7887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
7888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     max_len = ssl_mfl_code_to_length( ssl->conf->mfl_code );
7889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Check if a smaller max length was negotiated */
7891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_out != NULL &&
7892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_out->mfl_code ) < max_len )
7893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         max_len = ssl_mfl_code_to_length( ssl->session_out->mfl_code );
7895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* During a handshake, use the value being negotiated */
7898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_negotiate != NULL &&
7899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_negotiate->mfl_code ) < max_len )
7900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         max_len = ssl_mfl_code_to_length( ssl->session_negotiate->mfl_code );
7902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( max_len );
7905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
7907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static size_t ssl_get_current_mtu( const mbedtls_ssl_context *ssl )
7910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Return unlimited mtu for client hello messages to avoid fragmentation. */
7912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT &&
7913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ssl->state == MBEDTLS_SSL_CLIENT_HELLO ||
7914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           ssl->state == MBEDTLS_SSL_SERVER_HELLO ) )
7915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return ( 0 );
7916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake == NULL || ssl->handshake->mtu == 0 )
7918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->mtu );
7919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->mtu == 0 )
7921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->handshake->mtu );
7922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl->mtu < ssl->handshake->mtu ?
7924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->mtu : ssl->handshake->mtu );
7925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
7927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_get_max_out_record_payload( const mbedtls_ssl_context *ssl )
7929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t max_len = MBEDTLS_SSL_OUT_CONTENT_LEN;
7931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH) && \
7933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_SSL_PROTO_DTLS)
7934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     (void) ssl;
7935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH)
7938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const size_t mfl = mbedtls_ssl_get_max_frag_len( ssl );
7939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( max_len > mfl )
7941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         max_len = mfl;
7942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
7945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl_get_current_mtu( ssl ) != 0 )
7946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         const size_t mtu = ssl_get_current_mtu( ssl );
7948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         const int ret = mbedtls_ssl_get_record_expansion( ssl );
7949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         const size_t overhead = (size_t) ret;
7950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret < 0 )
7952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
7953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( mtu <= overhead )
7955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
7956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "MTU too low for record expansion" ) );
7957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE );
7958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
7959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( max_len > mtu - overhead )
7961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             max_len = mtu - overhead;
7962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
7964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_SSL_MAX_FRAGMENT_LENGTH) &&        \
7966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_SSL_PROTO_DTLS)
7967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ssl);
7968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
7969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( (int) max_len );
7971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
7974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** const mbedtls_x509_crt *mbedtls_ssl_get_peer_cert( const mbedtls_ssl_context *ssl )
7975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->session == NULL )
7977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
7978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl->session->peer_cert );
7980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
7982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
7984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_get_session( const mbedtls_ssl_context *ssl, mbedtls_ssl_session *dst )
7985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
7986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL ||
7987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dst == NULL ||
7988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session == NULL ||
7989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
7990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
7991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
7992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
7993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_session_copy( dst, ssl->session ) );
7995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
7996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
7997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
7998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
7999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Perform a single step of the SSL handshake
8000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_handshake_step( mbedtls_ssl_context *ssl )
8002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
8004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
8006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
8010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_handshake_client_step( ssl );
8011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
8014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_handshake_server_step( ssl );
8015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
8018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Perform the SSL handshake
8022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_handshake( mbedtls_ssl_context *ssl )
8024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
8026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
8028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> handshake" ) );
8031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_handshake_step( ssl );
8035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != 0 )
8037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
8038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= handshake" ) );
8041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
8043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Write HelloRequest to request renegotiation on server
8049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_write_hello_request( mbedtls_ssl_context *ssl )
8051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
8053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write hello request" ) );
8055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen  = 4;
8057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
8058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_HELLO_REQUEST;
8059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_write_handshake_msg( ssl ) ) != 0 )
8061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_handshake_msg", ret );
8063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write hello request" ) );
8067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
8069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
8071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Actually renegotiate current connection, triggered by either:
8074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - any side: calling mbedtls_ssl_renegotiate(),
8075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - client: receiving a HelloRequest during mbedtls_ssl_read(),
8076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * - server: receiving any handshake message on server during mbedtls_ssl_read() after
8077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *   the initial handshake is completed.
8078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * If the handshake doesn't complete due to waiting for I/O, it will continue
8079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * during the next calls to mbedtls_ssl_renegotiate() or mbedtls_ssl_read() respectively.
8080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_start_renegotiation( mbedtls_ssl_context *ssl )
8082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
8084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> renegotiate" ) );
8086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_handshake_init( ssl ) ) != 0 )
8088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* RFC 6347 4.2.2: "[...] the HelloRequest will have message_seq = 0 and
8091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * the ServerHello will have message_seq = 1" */
8092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
8094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
8095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
8097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->out_msg_seq = 1;
8098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
8099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->in_msg_seq = 1;
8100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->state = MBEDTLS_SSL_HELLO_REQUEST;
8104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->renego_status = MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS;
8105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_ssl_handshake( ssl ) ) != 0 )
8107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= renegotiate" ) );
8113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
8115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Renegotiate current connection on client,
8119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * or request renegotiation on server
8120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_renegotiate( mbedtls_ssl_context *ssl )
8122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
8124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
8126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* On server, just send the request */
8130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER )
8131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->renego_status = MBEDTLS_SSL_RENEGOTIATION_PENDING;
8136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Did we already try/start sending HelloRequest? */
8138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->out_left != 0 )
8139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( mbedtls_ssl_flush_output( ssl ) );
8140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl_write_hello_request( ssl ) );
8142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
8144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
8147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * On client, either start the renegotiation process or,
8148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * if already in progress, continue the handshake
8149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
8150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->renego_status != MBEDTLS_SSL_RENEGOTIATION_IN_PROGRESS )
8151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_start_renegotiation( ssl ) ) != 0 )
8156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "ssl_start_renegotiation", ret );
8158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
8162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_handshake( ssl ) ) != 0 )
8164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
8170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
8172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Check record counters and renegotiate if they're above the limit.
8176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_check_ctr_renegotiate( mbedtls_ssl_context *ssl )
8178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t ep_len = ssl_ep_len( ssl );
8180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int in_ctr_cmp;
8181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int out_ctr_cmp;
8182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER ||
8184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING ||
8185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->disable_renegotiation == MBEDTLS_SSL_RENEGOTIATION_DISABLED )
8186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
8188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     in_ctr_cmp = memcmp( ssl->in_ctr + ep_len,
8191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         ssl->conf->renego_period + ep_len, 8 - ep_len );
8192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     out_ctr_cmp = memcmp( ssl->cur_out_ctr + ep_len,
8193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                           ssl->conf->renego_period + ep_len, 8 - ep_len );
8194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( in_ctr_cmp <= 0 && out_ctr_cmp <= 0 )
8196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
8198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 1, ( "record counter limit reached: renegotiate" ) );
8201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( mbedtls_ssl_renegotiate( ssl ) );
8202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
8204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Receive application data decrypted from the SSL layer
8207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_read( mbedtls_ssl_context *ssl, unsigned char *buf, size_t len )
8209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
8211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t n;
8212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
8214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> read" ) );
8217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
8222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->handshake != NULL &&
8225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->retransmit_state == MBEDTLS_SSL_RETRANS_SENDING )
8226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ( ret = mbedtls_ssl_flight_transmit( ssl ) ) != 0 )
8228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
8229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
8234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Check if renegotiation is necessary and/or handshake is
8235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * in process. If yes, perform/continue, and fall through
8236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * if an unexpected packet is received while the client
8237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * is waiting for the ServerHello.
8238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
8239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * (There is no equivalent to the last condition on
8240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  the server-side as it is not treated as within
8241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  a handshake while waiting for the ClientHello
8242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *  after a renegotiation request.)
8243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
8244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = ssl_check_ctr_renegotiate( ssl );
8247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
8248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret != 0 )
8249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "ssl_check_ctr_renegotiate", ret );
8251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_handshake( ssl );
8258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
8259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret != 0 )
8260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Loop as long as no application data record is available */
8267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( ssl->in_offt == NULL )
8268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Start timer if not already running */
8270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->f_get_timer != NULL &&
8271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->f_get_timer( ssl->p_timer ) == -1 )
8272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_set_timer( ssl, ssl->conf->read_timeout );
8274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
8277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ret == MBEDTLS_ERR_SSL_CONN_EOF )
8279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( 0 );
8280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
8282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msglen  == 0 &&
8286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA )
8287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
8289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * OpenSSL sends empty messages to randomize the IV
8290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
8291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ( ret = mbedtls_ssl_read_record( ssl, 1 ) ) != 0 )
8292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ret == MBEDTLS_ERR_SSL_CONN_EOF )
8294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( 0 );
8295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_read_record", ret );
8297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
8298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_HANDSHAKE )
8302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "received handshake message" ) );
8304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /*
8306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * - For client-side, expect SERVER_HELLO_REQUEST.
8307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * - For server-side, expect CLIENT_HELLO.
8308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * - Fail (TLS) or silently drop record (DTLS) in other cases.
8309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
8310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT &&
8313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ( ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_REQUEST ||
8314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) ) )
8315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake received (not HelloRequest)" ) );
8317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* With DTLS, drop the packet (probably from last handshake) */
8319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     continue;
8323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
8328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
8330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
8331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->in_msg[0] != MBEDTLS_SSL_HS_CLIENT_HELLO )
8332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 1, ( "handshake received (not ClientHello)" ) );
8334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* With DTLS, drop the packet (probably from last handshake) */
8336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     continue;
8340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C */
8345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Determine whether renegotiation attempt should be accepted */
8348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ! ( ssl->conf->disable_renegotiation == MBEDTLS_SSL_RENEGOTIATION_DISABLED ||
8349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ( ssl->secure_renegotiation == MBEDTLS_SSL_LEGACY_RENEGOTIATION &&
8350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       ssl->conf->allow_legacy_renegotiation ==
8351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                    MBEDTLS_SSL_LEGACY_NO_RENEGOTIATION ) ) )
8352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /*
8354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * Accept renegotiation request
8355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  */
8356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /* DTLS clients need to know renego is server-initiated */
8358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM &&
8360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->conf->endpoint == MBEDTLS_SSL_IS_CLIENT )
8361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->renego_status = MBEDTLS_SSL_RENEGOTIATION_PENDING;
8363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = ssl_start_renegotiation( ssl );
8366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
8367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ret != 0 )
8368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_RET( 1, "ssl_start_renegotiation", ret );
8370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
8371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else
8374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
8375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 /*
8377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  * Refuse renegotiation
8378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  */
8379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_MSG( 3, ( "refusing renegotiation, sending alert" ) );
8381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3)
8383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->minor_ver == MBEDTLS_SSL_MINOR_VERSION_0 )
8384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     /* SSLv3 does not have a "no_renegotiation" warning, so
8386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        we send a fatal alert and abort the connection. */
8387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
8388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                     MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
8389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 else
8392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 */
8393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
8394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
8395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_1 )
8396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     if( ( ret = mbedtls_ssl_send_alert_message( ssl,
8398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_LEVEL_WARNING,
8399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_MSG_NO_RENEGOTIATION ) ) != 0 )
8400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     {
8401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         return( ret );
8402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     }
8403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 else
8405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 ||
8406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_2 */
8407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "should never happen" ) );
8409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
8410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* At this point, we don't know whether the renegotiation has been
8414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * completed or not. The cases to consider are the following:
8415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * 1) The renegotiation is complete. In this case, no new record
8416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *    has been read yet.
8417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * 2) The renegotiation is incomplete because the client received
8418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *    an application data record while awaiting the ServerHello.
8419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * 3) The renegotiation is incomplete because the client received
8420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *    a non-handshake, non-application data message while awaiting
8421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *    the ServerHello.
8422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * In each of these case, looping will be the proper action:
8423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * - For 1), the next iteration will read a new record and check
8424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   if it's application data.
8425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * - For 2), the loop condition isn't satisfied as application data
8426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   is present, hence continue is the same as break
8427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              * - For 3), the loop condition is satisfied and read_record
8428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   will re-deliver the message that was held back by the client
8429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              *   when expecting the ServerHello.
8430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****              */
8431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             continue;
8432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else if( ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
8435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ssl->conf->renego_max_records >= 0 )
8437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if( ++ssl->renego_records_seen > ssl->conf->renego_max_records )
8439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
8440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_DEBUG_MSG( 1, ( "renegotiation requested, "
8441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         "but not honored by client" ) );
8442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
8444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_RENEGOTIATION */
8447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Fatal and closure alerts handled by mbedtls_ssl_read_record() */
8449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msgtype == MBEDTLS_SSL_MSG_ALERT )
8450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 2, ( "ignoring non-fatal non-closure alert" ) );
8452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_WANT_READ );
8453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
8456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad application data message" ) );
8458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_UNEXPECTED_MESSAGE );
8459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_offt = ssl->in_msg;
8462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* We're going to return something now, cancel timer,
8464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * except if handshake (renegotiation) is in progress */
8465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER )
8466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_set_timer( ssl, 0 );
8467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* If we requested renego but received AppData, resend HelloRequest.
8470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Do it now, after setting in_offt, to avoid taking this branch
8471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * again if ssl_write_hello_request() returns WANT_WRITE */
8472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C) && defined(MBEDTLS_SSL_RENEGOTIATION)
8473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->endpoint == MBEDTLS_SSL_IS_SERVER &&
8474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->renego_status == MBEDTLS_SSL_RENEGOTIATION_PENDING )
8475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ( ret = ssl_resend_hello_request( ssl ) ) != 0 )
8477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
8478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 MBEDTLS_SSL_DEBUG_RET( 1, "ssl_resend_hello_request", ret );
8479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
8480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
8481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_SRV_C && MBEDTLS_SSL_RENEGOTIATION */
8483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
8484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     n = ( len < ssl->in_msglen )
8487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ? len : ssl->in_msglen;
8488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( buf, ssl->in_offt, n );
8490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen -= n;
8491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen == 0 )
8493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* all bytes consumed */
8495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_offt = NULL;
8496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->keep_current_message = 0;
8497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
8499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* more data available */
8501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_offt += n;
8502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= read" ) );
8505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( (int) n );
8507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Send application data to be encrypted by the SSL layer, taking care of max
8511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * fragment length and buffer size.
8512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
8513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * According to RFC 5246 Section 6.2.1:
8514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
8515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *      Zero-length fragments of Application data MAY be sent as they are
8516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *      potentially useful as a traffic analysis countermeasure.
8517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
8518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Therefore, it is possible that the input message length is 0 and the
8519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * corresponding return code is 0 on success.
8520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_write_real( mbedtls_ssl_context *ssl,
8522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            const unsigned char *buf, size_t len )
8523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = mbedtls_ssl_get_max_out_record_payload( ssl );
8525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const size_t max_len = (size_t) ret;
8526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret < 0 )
8528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_get_max_out_record_payload", ret );
8530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( len > max_len )
8534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->conf->transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
8537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "fragment larger than the (negotiated) "
8539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 "maximum fragment length: %d > %d",
8540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 len, max_len ) );
8541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         else
8544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             len = max_len;
8546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_left != 0 )
8549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
8551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * The user has previously tried to send the data and
8552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * MBEDTLS_ERR_SSL_WANT_WRITE or the message was only partially
8553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * written. In this case, we expect the high-level write function
8554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * (e.g. mbedtls_ssl_write()) to be called with the same parameters
8555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
8556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
8557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_flush_output", ret );
8559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
8563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
8565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * The user is trying to send a message the first time, so we need to
8566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * copy the data into the internal buffers and setup the data structure
8567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * to keep track of partial writes
8568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
8569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msglen  = len;
8570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msgtype = MBEDTLS_SSL_MSG_APPLICATION_DATA;
8571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->out_msg, buf, len );
8572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_write_record( ssl, SSL_FORCE_FLUSH ) ) != 0 )
8574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_write_record", ret );
8576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( (int) len );
8581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Write application data, doing 1/n-1 splitting if necessary.
8585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
8586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * With non-blocking I/O, ssl_write_real() may return WANT_WRITE,
8587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * then the caller will call us again with the same arguments, so
8588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * remember whether we already did the split or not.
8589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
8591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_write_split( mbedtls_ssl_context *ssl,
8592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                             const unsigned char *buf, size_t len )
8593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
8595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->cbc_record_splitting ==
8597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_CBC_RECORD_SPLITTING_DISABLED ||
8598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         len <= 1 ||
8599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver > MBEDTLS_SSL_MINOR_VERSION_1 ||
8600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_cipher_get_cipher_mode( &ssl->transform_out->cipher_ctx_enc )
8601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 != MBEDTLS_MODE_CBC )
8602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl_write_real( ssl, buf, len ) );
8604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->split_done == 0 )
8607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = ssl_write_real( ssl, buf, 1 ) ) <= 0 )
8609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->split_done = 1;
8611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_write_real( ssl, buf + 1, len - 1 ) ) <= 0 )
8614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->split_done = 0;
8616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret + 1 );
8618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CBC_RECORD_SPLITTING */
8620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Write application data (public-facing wrapper)
8623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_write( mbedtls_ssl_context *ssl, const unsigned char *buf, size_t len )
8625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
8627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write" ) );
8629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
8631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
8634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = ssl_check_ctr_renegotiate( ssl ) ) != 0 )
8635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "ssl_check_ctr_renegotiate", ret );
8637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
8638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state != MBEDTLS_SSL_HANDSHAKE_OVER )
8642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_handshake( ssl ) ) != 0 )
8644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_handshake", ret );
8646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
8651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = ssl_write_split( ssl, buf, len );
8652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
8653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ret = ssl_write_real( ssl, buf, len );
8654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write" ) );
8657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
8659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Notify the peer that the connection is being closed
8663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_close_notify( mbedtls_ssl_context *ssl )
8665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
8667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->conf == NULL )
8669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
8670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> write close notify" ) );
8672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_left != 0 )
8674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( mbedtls_ssl_flush_output( ssl ) );
8675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->state == MBEDTLS_SSL_HANDSHAKE_OVER )
8677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ( ret = mbedtls_ssl_send_alert_message( ssl,
8679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_ALERT_LEVEL_WARNING,
8680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY ) ) != 0 )
8681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_ssl_send_alert_message", ret );
8683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
8684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= write close notify" ) );
8688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
8690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_transform_free( mbedtls_ssl_transform *transform )
8693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transform == NULL )
8695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
8696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
8698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     deflateEnd( &transform->ctx_deflate );
8699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     inflateEnd( &transform->ctx_inflate );
8700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_free( &transform->cipher_ctx_enc );
8703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_free( &transform->cipher_ctx_dec );
8704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &transform->md_ctx_enc );
8706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &transform->md_ctx_dec );
8707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( transform, sizeof( mbedtls_ssl_transform ) );
8709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_key_cert_free( mbedtls_ssl_key_cert *key_cert )
8713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_key_cert *cur = key_cert, *next;
8715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     while( cur != NULL )
8717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         next = cur->next;
8719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( cur );
8720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cur = next;
8721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
8724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8726:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8727:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_buffering_free( mbedtls_ssl_context *ssl )
8728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned offset;
8730:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
8731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8732:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs == NULL )
8733:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
8734:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_free_buffered_record( ssl );
8736:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8737:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( offset = 0; offset < MBEDTLS_SSL_MAX_BUFFERED_HS; offset++ )
8738:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_buffering_free_slot( ssl, offset );
8739:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static void ssl_buffering_free_slot( mbedtls_ssl_context *ssl,
8742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                      uint8_t slot )
8743:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
8745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_hs_buffer * const hs_buf = &hs->buffering.hs[slot];
8746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( slot >= MBEDTLS_SSL_MAX_BUFFERED_HS )
8748:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
8749:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8750:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( hs_buf->is_valid == 1 )
8751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs->buffering.total_bytes_buffered -= hs_buf->data_len;
8753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( hs_buf->data );
8754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( hs_buf, 0, sizeof( mbedtls_ssl_hs_buffer ) );
8755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_DTLS */
8759:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_handshake_free( mbedtls_ssl_context *ssl )
8761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params *handshake = ssl->handshake;
8763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( handshake == NULL )
8765:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
8766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ASYNC_PRIVATE)
8768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->f_async_cancel != NULL && handshake->async_in_progress != 0 )
8769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8770:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->f_async_cancel( ssl );
8771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         handshake->async_in_progress = 0;
8772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8773:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_ASYNC_PRIVATE */
8774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
8776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
8777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free(    &handshake->fin_md5  );
8778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free(   &handshake->fin_sha1 );
8779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8780:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
8781:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
8782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_free(   &handshake->fin_sha256    );
8783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8784:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
8785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha512_free(   &handshake->fin_sha512    );
8786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
8788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
8790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_dhm_free( &handshake->dhm_ctx );
8791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8792:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECDH_C)
8793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ecdh_free( &handshake->ecdh_ctx );
8794:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
8796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ecjpake_free( &handshake->ecjpake_ctx );
8797:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
8798:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( handshake->ecjpake_cache );
8799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     handshake->ecjpake_cache = NULL;
8800:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     handshake->ecjpake_cache_len = 0;
8801:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8804:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
8805:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
8806:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* explicit void pointer cast for buggy MS compiler */
8807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( (void *) handshake->curves );
8808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8810:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
8811:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( handshake->psk != NULL )
8812:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8813:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( handshake->psk, handshake->psk_len );
8814:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( handshake->psk );
8815:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8818:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C) && \
8819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_SERVER_NAME_INDICATION)
8820:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
8821:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Free only the linked list wrapper, not the keys themselves
8822:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * since the belong to the SNI callback
8823:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
8824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( handshake->sni_key_cert != NULL )
8825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_key_cert *cur = handshake->sni_key_cert, *next;
8827:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         while( cur != NULL )
8829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
8830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             next = cur->next;
8831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_free( cur );
8832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             cur = next;
8833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
8834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C && MBEDTLS_SSL_SERVER_NAME_INDICATION */
8836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
8838:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( handshake->verify_cookie );
8839:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_flight_free( handshake->flight );
8840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_buffering_free( ssl );
8841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8842:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( handshake,
8844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               sizeof( mbedtls_ssl_handshake_params ) );
8845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_session_free( mbedtls_ssl_session *session )
8848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( session == NULL )
8850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
8851:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( session->peer_cert != NULL )
8854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_x509_crt_free( session->peer_cert );
8856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( session->peer_cert );
8857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8859:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS) && defined(MBEDTLS_SSL_CLI_C)
8861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( session->ticket );
8862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( session, sizeof( mbedtls_ssl_session ) );
8865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Free an SSL context
8869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_free( mbedtls_ssl_context *ssl )
8871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL )
8873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
8874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "=> free" ) );
8876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_buf != NULL )
8878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( ssl->out_buf, MBEDTLS_SSL_OUT_BUFFER_LEN );
8880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->out_buf );
8881:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_buf != NULL )
8884:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( ssl->in_buf, MBEDTLS_SSL_IN_BUFFER_LEN );
8886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->in_buf );
8887:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ZLIB_SUPPORT)
8890:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->compress_buf != NULL )
8891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( ssl->compress_buf, MBEDTLS_SSL_COMPRESS_BUFFER_LEN );
8893:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->compress_buf );
8894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8895:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8896:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->transform )
8898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform );
8900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform );
8901:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8902:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake )
8904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_handshake_free( ssl );
8906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform_negotiate );
8907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session_negotiate );
8908:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->handshake );
8910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform_negotiate );
8911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session_negotiate );
8912:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8913:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session )
8915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session );
8917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session );
8918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
8921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->hostname != NULL )
8922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( ssl->hostname, strlen( ssl->hostname ) );
8924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->hostname );
8925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8927:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8928:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_HW_RECORD_ACCEL)
8929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_ssl_hw_record_finish != NULL )
8930:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
8931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_MSG( 2, ( "going for mbedtls_ssl_hw_record_finish()" ) );
8932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_hw_record_finish( ssl );
8933:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
8934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8936:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
8937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( ssl->cli_id );
8938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_SSL_DEBUG_MSG( 2, ( "<= free" ) );
8941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8942:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Actually clear after last debug message */
8943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( ssl, sizeof( mbedtls_ssl_context ) );
8944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8945:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Initialze mbedtls_ssl_config
8948:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8949:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_config_init( mbedtls_ssl_config *conf )
8950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( conf, 0, sizeof( mbedtls_ssl_config ) );
8952:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
8953:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8954:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
8955:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_preset_default_hashes[] = {
8956:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
8957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA512,
8958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA384,
8959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8960:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
8961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA256,
8962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA224,
8963:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA1_C) && defined(MBEDTLS_TLS_DEFAULT_ALLOW_SHA1_IN_KEY_EXCHANGE)
8965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA1,
8966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8967:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_NONE
8968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** };
8969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8970:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_preset_suiteb_ciphersuites[] = {
8972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
8973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
8974:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     0
8975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** };
8976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
8978:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static int ssl_preset_suiteb_hashes[] = {
8979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA256,
8980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_SHA384,
8981:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_MD_NONE
8982:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** };
8983:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8984:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
8986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** static mbedtls_ecp_group_id ssl_preset_suiteb_curves[] = {
8987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_ECP_DP_SECP256R1,
8988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_ECP_DP_SECP384R1,
8989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     MBEDTLS_ECP_DP_NONE
8990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** };
8991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
8992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
8993:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
8994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Load default in mbedtls_ssl_config
8995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
8996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_config_defaults( mbedtls_ssl_config *conf,
8997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  int endpoint, int transport, int preset )
8998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
8999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
9000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
9001:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Use the functions here so that they are covered in tests,
9004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * but otherwise access member directly for efficiency */
9005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_conf_endpoint( conf, endpoint );
9006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_conf_transport( conf, transport );
9007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9008:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
9009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Things that are common to all presets
9010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
9011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CLI_C)
9012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( endpoint == MBEDTLS_SSL_IS_CLIENT )
9013:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->authmode = MBEDTLS_SSL_VERIFY_REQUIRED;
9015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
9016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->session_tickets = MBEDTLS_SSL_SESSION_TICKETS_ENABLED;
9017:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9020:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ARC4_C)
9022:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->arc4_disabled = MBEDTLS_SSL_ARC4_DISABLED;
9023:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9025:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_ENCRYPT_THEN_MAC)
9026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->encrypt_then_mac = MBEDTLS_SSL_ETM_ENABLED;
9027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9029:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_EXTENDED_MASTER_SECRET)
9030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->extended_ms = MBEDTLS_SSL_EXTENDED_MS_ENABLED;
9031:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9033:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
9034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->cbc_record_splitting = MBEDTLS_SSL_CBC_RECORD_SPLITTING_ENABLED;
9035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9037:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_HELLO_VERIFY) && defined(MBEDTLS_SSL_SRV_C)
9038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_cookie_write = ssl_cookie_write_dummy;
9039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_cookie_check = ssl_cookie_check_dummy;
9040:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9041:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9042:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_DTLS_ANTI_REPLAY)
9043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->anti_replay = MBEDTLS_SSL_ANTI_REPLAY_ENABLED;
9044:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9045:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SRV_C)
9047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->cert_req_ca_list = MBEDTLS_SSL_CERT_REQ_CA_LIST_ENABLED;
9048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9049:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->hs_timeout_min = MBEDTLS_SSL_DTLS_TIMEOUT_DFL_MIN;
9052:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->hs_timeout_max = MBEDTLS_SSL_DTLS_TIMEOUT_DFL_MAX;
9053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9054:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9055:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_RENEGOTIATION)
9056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->renego_max_records = MBEDTLS_SSL_RENEGO_MAX_RECORDS_DEFAULT;
9057:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( conf->renego_period,     0x00, 2 );
9058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( conf->renego_period + 2, 0xFF, 6 );
9059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9061:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
9062:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( endpoint == MBEDTLS_SSL_IS_SERVER )
9063:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
9064:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 const unsigned char dhm_p[] =
9065:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_DHM_RFC3526_MODP_2048_P_BIN;
9066:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 const unsigned char dhm_g[] =
9067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_DHM_RFC3526_MODP_2048_G_BIN;
9068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 if ( ( ret = mbedtls_ssl_conf_dh_param_bin( conf,
9070:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                dhm_p, sizeof( dhm_p ),
9071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                dhm_g, sizeof( dhm_g ) ) ) != 0 )
9072:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
9073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     return( ret );
9074:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
9075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
9076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9078:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
9079:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * Preset-specific defaults
9080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
9081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( preset )
9082:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9083:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
9084:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * NSA Suite B
9085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
9086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_PRESET_SUITEB:
9087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->min_major_ver = MBEDTLS_SSL_MAJOR_VERSION_3;
9088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->min_minor_ver = MBEDTLS_SSL_MINOR_VERSION_3; /* TLS 1.2 */
9089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_major_ver = MBEDTLS_SSL_MAX_MAJOR_VERSION;
9090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_minor_ver = MBEDTLS_SSL_MAX_MINOR_VERSION;
9091:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] =
9093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
9094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
9095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
9096:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl_preset_suiteb_ciphersuites;
9097:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9098:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->cert_profile = &mbedtls_x509_crt_profile_suiteb;
9100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9102:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->sig_hashes = ssl_preset_suiteb_hashes;
9104:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9105:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9106:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->curve_list = ssl_preset_suiteb_curves;
9108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /*
9112:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          * Default
9113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****          */
9114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->min_major_ver = ( MBEDTLS_SSL_MIN_MAJOR_VERSION >
9116:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION ) ?
9117:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_MAJOR_VERSION :
9118:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION;
9119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->min_minor_ver = ( MBEDTLS_SSL_MIN_MINOR_VERSION >
9120:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MINOR_VERSION ) ?
9121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_MINOR_VERSION :
9122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MINOR_VERSION;
9123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_major_ver = MBEDTLS_SSL_MAX_MAJOR_VERSION;
9124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_minor_ver = MBEDTLS_SSL_MAX_MINOR_VERSION;
9125:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9126:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
9128:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 conf->min_minor_ver = MBEDTLS_SSL_MINOR_VERSION_2;
9129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] =
9132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
9133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
9134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
9135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    mbedtls_ssl_list_ciphersuites();
9136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->cert_profile = &mbedtls_x509_crt_profile_default;
9139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9141:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->sig_hashes = ssl_preset_default_hashes;
9143:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9144:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->curve_list = mbedtls_ecp_grp_id_list();
9147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9148:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9149:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_CLI_C)
9150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->dhm_min_bitlen = 1024;
9151:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9152:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( 0 );
9155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9158:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Free mbedtls_ssl_config
9159:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9160:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_config_free( mbedtls_ssl_config *conf )
9161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9162:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
9163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_mpi_free( &conf->dhm_P );
9164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_mpi_free( &conf->dhm_G );
9165:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9166:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
9168:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( conf->psk != NULL )
9169:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( conf->psk, conf->psk_len );
9171:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( conf->psk );
9172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk = NULL;
9173:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_len = 0;
9174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9175:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( conf->psk_identity != NULL )
9177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_platform_zeroize( conf->psk_identity, conf->psk_identity_len );
9179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( conf->psk_identity );
9180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_identity = NULL;
9181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         conf->psk_identity_len = 0;
9182:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9184:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9185:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_key_cert_free( conf->key_cert );
9187:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_platform_zeroize( conf, sizeof( mbedtls_ssl_config ) );
9190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9191:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_PK_C) && \
9193:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ( defined(MBEDTLS_RSA_C) || defined(MBEDTLS_ECDSA_C) )
9194:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9195:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Convert between MBEDTLS_PK_XXX and SSL_SIG_XXX
9196:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9197:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** unsigned char mbedtls_ssl_sig_from_pk( mbedtls_pk_context *pk )
9198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_RSA_C)
9200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_pk_can_do( pk, MBEDTLS_PK_RSA ) )
9201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_SSL_SIG_RSA );
9202:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECDSA_C)
9204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_pk_can_do( pk, MBEDTLS_PK_ECDSA ) )
9205:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_SSL_SIG_ECDSA );
9206:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( MBEDTLS_SSL_SIG_ANON );
9208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9210:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** unsigned char mbedtls_ssl_sig_from_pk_alg( mbedtls_pk_type_t type )
9211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( type ) {
9213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_RSA:
9214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_SIG_RSA );
9215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
9216:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_ECKEY:
9217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_SIG_ECDSA );
9218:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_SIG_ANON );
9220:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** mbedtls_pk_type_t mbedtls_ssl_pk_alg_from_sig( unsigned char sig )
9224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( sig )
9226:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9227:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_RSA_C)
9228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_SIG_RSA:
9229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_PK_RSA );
9230:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECDSA_C)
9232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_SIG_ECDSA:
9233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_PK_ECDSA );
9234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9235:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_PK_NONE );
9237:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_PK_C && ( MBEDTLS_RSA_C || MBEDTLS_ECDSA_C ) */
9240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2) && \
9242:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Find an entry in a signature-hash set matching a given hash algorithm. */
9245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** mbedtls_md_type_t mbedtls_ssl_sig_hash_set_find( mbedtls_ssl_sig_hash_set_t *set,
9246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                                  mbedtls_pk_type_t sig_alg )
9247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( sig_alg )
9249:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_RSA:
9251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( set->rsa );
9252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
9253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( set->ecdsa );
9254:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_NONE );
9256:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Add a signature-hash-pair to a signature-hash set */
9260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_sig_hash_set_add( mbedtls_ssl_sig_hash_set_t *set,
9261:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    mbedtls_pk_type_t sig_alg,
9262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    mbedtls_md_type_t md_alg )
9263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( sig_alg )
9265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_RSA:
9267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( set->rsa == MBEDTLS_MD_NONE )
9268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 set->rsa = md_alg;
9269:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
9272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( set->ecdsa == MBEDTLS_MD_NONE )
9273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 set->ecdsa = md_alg;
9274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9281:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /* Allow exactly one hash algorithm for each signature. */
9282:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_sig_hash_set_const_hash( mbedtls_ssl_sig_hash_set_t *set,
9283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                           mbedtls_md_type_t md_alg )
9284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     set->rsa   = md_alg;
9286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     set->ecdsa = md_alg;
9287:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9289:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2) &&
9290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
9291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Convert from MBEDTLS_SSL_HASH_XXX to MBEDTLS_MD_XXX
9294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9295:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** mbedtls_md_type_t mbedtls_ssl_md_alg_from_hash( unsigned char hash )
9296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9297:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( hash )
9298:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_MD5_C)
9300:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_MD5:
9301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_MD5 );
9302:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA1_C)
9304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA1:
9305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_SHA1 );
9306:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA224:
9309:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_SHA224 );
9310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA256:
9311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_SHA256 );
9312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA384:
9315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_SHA384 );
9316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA512:
9317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_SHA512 );
9318:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9319:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_MD_NONE );
9321:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9323:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Convert from MBEDTLS_MD_XXX to MBEDTLS_SSL_HASH_XXX
9326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9327:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** unsigned char mbedtls_ssl_hash_from_md_alg( int md )
9328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( md )
9330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9331:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_MD5_C)
9332:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MD_MD5:
9333:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_MD5 );
9334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA1_C)
9336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MD_SHA1:
9337:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA1 );
9338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9340:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MD_SHA224:
9341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA224 );
9342:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MD_SHA256:
9343:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA256 );
9344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9346:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MD_SHA384:
9347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA384 );
9348:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_MD_SHA512:
9349:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_SHA512 );
9350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9351:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_SSL_HASH_NONE );
9353:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9355:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9356:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_ECP_C)
9357:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9358:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Check if a curve proposed by the peer is in our list.
9359:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Return 0 if we're willing to use it, -1 otherwise.
9360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_check_curve( const mbedtls_ssl_context *ssl, mbedtls_ecp_group_id grp_id )
9362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ecp_group_id *gid;
9364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->curve_list == NULL )
9366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
9367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( gid = ssl->conf->curve_list; *gid != MBEDTLS_ECP_DP_NONE; gid++ )
9369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( *gid == grp_id )
9370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
9371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9372:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( -1 );
9373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9374:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
9375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9376:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED)
9377:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Check if a hash proposed by the peer is in our list.
9379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Return 0 if we're willing to use it, -1 otherwise.
9380:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_check_sig_hash( const mbedtls_ssl_context *ssl,
9382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 mbedtls_md_type_t md )
9383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const int *cur;
9385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->conf->sig_hashes == NULL )
9387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
9388:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( cur = ssl->conf->sig_hashes; *cur != MBEDTLS_MD_NONE; cur++ )
9390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( *cur == (int) md )
9391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
9392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( -1 );
9394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
9396:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CRT_PARSE_C)
9398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_check_cert_usage( const mbedtls_x509_crt *cert,
9399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                           const mbedtls_ssl_ciphersuite_t *ciphersuite,
9400:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                           int cert_endpoint,
9401:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                           uint32_t *flags )
9402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
9404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
9405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int usage = 0;
9406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
9408:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const char *ext_oid;
9409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t ext_len;
9410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if !defined(MBEDTLS_X509_CHECK_KEY_USAGE) &&          \
9413:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     !defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
9414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cert);
9415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) cert_endpoint);
9416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) flags);
9417:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9418:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9419:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_KEY_USAGE)
9420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cert_endpoint == MBEDTLS_SSL_IS_SERVER )
9421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Server part of the key exchange */
9423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         switch( ciphersuite->key_exchange )
9424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
9425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_RSA:
9426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_RSA_PSK:
9427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 usage = MBEDTLS_X509_KU_KEY_ENCIPHERMENT;
9428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
9429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
9431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
9432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
9433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 usage = MBEDTLS_X509_KU_DIGITAL_SIGNATURE;
9434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
9435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
9437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
9438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 usage = MBEDTLS_X509_KU_KEY_AGREEMENT;
9439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
9440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9441:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             /* Don't use default: we want warnings when adding new values */
9442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_NONE:
9443:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_PSK:
9444:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_DHE_PSK:
9445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECDHE_PSK:
9446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             case MBEDTLS_KEY_EXCHANGE_ECJPAKE:
9447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 usage = 0;
9448:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
9449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9450:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
9451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         /* Client auth: we only implement rsa_sign and mbedtls_ecdsa_sign for now */
9453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         usage = MBEDTLS_X509_KU_DIGITAL_SIGNATURE;
9454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_x509_crt_check_key_usage( cert, usage ) != 0 )
9457:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *flags |= MBEDTLS_X509_BADCERT_KEY_USAGE;
9459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = -1;
9460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
9462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ciphersuite);
9463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CHECK_KEY_USAGE */
9464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE)
9466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( cert_endpoint == MBEDTLS_SSL_IS_SERVER )
9467:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9468:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ext_oid = MBEDTLS_OID_SERVER_AUTH;
9469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ext_len = MBEDTLS_OID_SIZE( MBEDTLS_OID_SERVER_AUTH );
9470:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
9472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9473:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ext_oid = MBEDTLS_OID_CLIENT_AUTH;
9474:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ext_len = MBEDTLS_OID_SIZE( MBEDTLS_OID_CLIENT_AUTH );
9475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mbedtls_x509_crt_check_extended_key_usage( cert, ext_oid, ext_len ) != 0 )
9478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *flags |= MBEDTLS_X509_BADCERT_EXT_KEY_USAGE;
9480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = -1;
9481:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9482:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CHECK_EXTENDED_KEY_USAGE */
9483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
9485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
9487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9488:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** /*
9489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * Convert version numbers to/from wire format
9490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * and, for DTLS, to/from TLS equivalent.
9491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  *
9492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * For TLS this is the identity.
9493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * For DTLS, use 1's complement (v -> 255 - v, and then map as follows:
9494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * 1.0 <-> 3.2      (DTLS 1.0 is based on TLS 1.1)
9495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  * 1.x <-> 3.x+1    for x != 0 (DTLS 1.2 based on TLS 1.2)
9496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****  */
9497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_write_version( int major, int minor, int transport,
9498:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         unsigned char ver[2] )
9499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
9502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( minor == MBEDTLS_SSL_MINOR_VERSION_2 )
9504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             --minor; /* DTLS 1.0 stored as TLS 1.1 internally */
9505:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[0] = (unsigned char)( 255 - ( major - 2 ) );
9507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char)( 255 - ( minor - 1 ) );
9508:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
9510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
9511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) transport);
9512:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9513:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[0] = (unsigned char) major;
 1542              		.loc 2 9514 0
 1543 0028 081090E5 		ldr	r1, [r0, #8]
 1544              	.LVL187:
9515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 1545              		.loc 2 9515 0
 1546 002c 0220C3E5 		strb	r2, [r3, #2]
 1547              	.LVL188:
 1548              	.LBE126:
 1549              	.LBE125:
3381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len[0] = (unsigned char)( len >> 8 );
 1550              		.loc 2 3381 0
 1551 0030 0820A0E3 		mov	r2, #8
 1552              	.LBB128:
 1553              	.LBB127:
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 1554              		.loc 2 9514 0
 1555 0034 0110C3E5 		strb	r1, [r3, #1]
 1556              	.LBE127:
 1557              	.LBE128:
3381:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len[0] = (unsigned char)( len >> 8 );
 1558              		.loc 2 3381 0
 1559 0038 A81080E2 		add	r1, r0, #168
 1560 003c 880090E5 		ldr	r0, [r0, #136]
 1561              	.LVL189:
 1562 0040 FEFFFFEB 		bl	memcpy
 1563              	.LVL190:
3382:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_len[1] = (unsigned char)( len      );
 1564              		.loc 2 3382 0
 1565 0044 903094E5 		ldr	r3, [r4, #144]
 1566 0048 2524A0E1 		lsr	r2, r5, #8
 1567 004c 0020C3E5 		strb	r2, [r3]
3383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1568              		.loc 2 3383 0
 1569 0050 903094E5 		ldr	r3, [r4, #144]
 1570 0054 0150C3E5 		strb	r5, [r3, #1]
3385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1571              		.loc 2 3385 0
 1572 0058 380094E5 		ldr	r0, [r4, #56]
 1573 005c 000050E3 		cmp	r0, #0
 1574 0060 8A00000A 		beq	.L129
 1575              	.LVL191:
 1576              	.LBB129:
 1577              	.LBB130:
1446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1578              		.loc 2 1446 0
 1579 0064 243094E5 		ldr	r3, [r4, #36]
 1580 0068 000053E3 		cmp	r3, #0
 1581 006c 0200001A 		bne	.L130
 1582              	.LVL192:
 1583              	.L157:
 1584              	.LBB131:
1712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1585              		.loc 2 1712 0
 1586 0070 80049FE5 		ldr	r0, .L168
 1587              	.LVL193:
 1588              	.L128:
 1589              	.LBE131:
 1590              	.LBE130:
 1591              	.LBE129:
 1592              	.LBE150:
3476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1593              		.loc 2 3476 0
 1594 0074 5CD08DE2 		add	sp, sp, #92
 1595              		.cfi_remember_state
 1596              		.cfi_def_cfa_offset 36
 1597              		@ sp needed
 1598 0078 F08FBDE8 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1599              	.LVL194:
 1600              	.L130:
 1601              		.cfi_restore_state
 1602              	.LBB151:
 1603              	.LBB148:
 1604              	.LBB146:
 1605              	.LBB133:
 1606              	.LBB134:
 1607              		.file 3 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/ciphe
   1:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
   2:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \file cipher.h
   3:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
   4:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief This file contains an abstraction interface for use with the cipher
   5:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * primitives provided by the library. It provides a common interface to all of
   6:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * the available cipher operations.
   7:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
   8:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \author Adriaan de Jong <dejong@fox-it.com>
   9:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
  10:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /*
  11:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  Copyright (C) 2006-2018, Arm Limited (or its affiliates), All Rights Reserved
  12:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  SPDX-License-Identifier: Apache-2.0
  13:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
  14:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
  15:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  not use this file except in compliance with the License.
  16:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  You may obtain a copy of the License at
  17:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
  18:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  http://www.apache.org/licenses/LICENSE-2.0
  19:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
  20:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  Unless required by applicable law or agreed to in writing, software
  21:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  22:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  23:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  See the License for the specific language governing permissions and
  24:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  limitations under the License.
  25:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
  26:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *  This file is part of Mbed TLS (https://tls.mbed.org)
  27:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
  28:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  29:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #ifndef MBEDTLS_CIPHER_H
  30:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_CIPHER_H
  31:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  32:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if !defined(MBEDTLS_CONFIG_FILE)
  33:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #include "config.h"
  34:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #else
  35:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #include MBEDTLS_CONFIG_FILE
  36:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
  37:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  38:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #include <stddef.h>
  39:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  40:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if defined(MBEDTLS_GCM_C) || defined(MBEDTLS_CCM_C) || defined(MBEDTLS_CHACHAPOLY_C)
  41:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_CIPHER_MODE_AEAD
  42:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
  43:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  44:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if defined(MBEDTLS_CIPHER_MODE_CBC)
  45:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_CIPHER_MODE_WITH_PADDING
  46:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
  47:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  48:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if defined(MBEDTLS_ARC4_C) || defined(MBEDTLS_CIPHER_NULL_CIPHER) || \
  49:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     defined(MBEDTLS_CHACHA20_C)
  50:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_CIPHER_MODE_STREAM
  51:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
  52:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  53:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if ( defined(__ARMCC_VERSION) || defined(_MSC_VER) ) && \
  54:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     !defined(inline) && !defined(__cplusplus)
  55:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define inline __inline
  56:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
  57:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  58:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_FEATURE_UNAVAILABLE  -0x6080  /**< The selected feature is not available
  59:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_BAD_INPUT_DATA       -0x6100  /**< Bad input parameters. */
  60:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_ALLOC_FAILED         -0x6180  /**< Failed to allocate memory. */
  61:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_INVALID_PADDING      -0x6200  /**< Input data contains invalid padding a
  62:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_FULL_BLOCK_EXPECTED  -0x6280  /**< Decryption of block requires a full b
  63:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_AUTH_FAILED          -0x6300  /**< Authentication failed (for AEAD modes
  64:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_INVALID_CONTEXT      -0x6380  /**< The context is invalid. For example, 
  65:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_ERR_CIPHER_HW_ACCEL_FAILED      -0x6400  /**< Cipher hardware accelerator failed. *
  66:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  67:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_CIPHER_VARIABLE_IV_LEN     0x01    /**< Cipher accepts IVs of variable length. */
  68:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_CIPHER_VARIABLE_KEY_LEN    0x02    /**< Cipher accepts keys of variable length. */
  69:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  70:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #ifdef __cplusplus
  71:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** extern "C" {
  72:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
  73:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  74:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
  75:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief     Supported cipher types.
  76:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
  77:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \warning   RC4 and DES are considered weak ciphers and their use
  78:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *            constitutes a security risk. Arm recommends considering stronger
  79:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *            ciphers instead.
  80:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
  81:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef enum {
  82:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_NONE = 0,  /**< Placeholder to mark the end of cipher ID lists. */
  83:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_NULL,      /**< The identity cipher, treated as a stream cipher. */
  84:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_AES,       /**< The AES cipher. */
  85:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_DES,       /**< The DES cipher. */
  86:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_3DES,      /**< The Triple DES cipher. */
  87:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_CAMELLIA,  /**< The Camellia cipher. */
  88:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_BLOWFISH,  /**< The Blowfish cipher. */
  89:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_ARC4,      /**< The RC4 cipher. */
  90:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_ARIA,      /**< The Aria cipher. */
  91:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ID_CHACHA20,  /**< The ChaCha20 cipher. */
  92:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_cipher_id_t;
  93:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
  94:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
  95:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief     Supported {cipher type, cipher mode} pairs.
  96:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
  97:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \warning   RC4 and DES are considered weak ciphers and their use
  98:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *            constitutes a security risk. Arm recommends considering stronger
  99:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *            ciphers instead.
 100:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 101:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef enum {
 102:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_NONE = 0,             /**< Placeholder to mark the end of cipher-pair lists. */
 103:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_NULL,                 /**< The identity stream cipher. */
 104:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_ECB,          /**< AES cipher with 128-bit ECB mode. */
 105:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_ECB,          /**< AES cipher with 192-bit ECB mode. */
 106:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_ECB,          /**< AES cipher with 256-bit ECB mode. */
 107:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_CBC,          /**< AES cipher with 128-bit CBC mode. */
 108:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_CBC,          /**< AES cipher with 192-bit CBC mode. */
 109:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_CBC,          /**< AES cipher with 256-bit CBC mode. */
 110:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_CFB128,       /**< AES cipher with 128-bit CFB128 mode. */
 111:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_CFB128,       /**< AES cipher with 192-bit CFB128 mode. */
 112:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_CFB128,       /**< AES cipher with 256-bit CFB128 mode. */
 113:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_CTR,          /**< AES cipher with 128-bit CTR mode. */
 114:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_CTR,          /**< AES cipher with 192-bit CTR mode. */
 115:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_CTR,          /**< AES cipher with 256-bit CTR mode. */
 116:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_GCM,          /**< AES cipher with 128-bit GCM mode. */
 117:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_GCM,          /**< AES cipher with 192-bit GCM mode. */
 118:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_GCM,          /**< AES cipher with 256-bit GCM mode. */
 119:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_ECB,     /**< Camellia cipher with 128-bit ECB mode. */
 120:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_ECB,     /**< Camellia cipher with 192-bit ECB mode. */
 121:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_ECB,     /**< Camellia cipher with 256-bit ECB mode. */
 122:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CBC,     /**< Camellia cipher with 128-bit CBC mode. */
 123:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CBC,     /**< Camellia cipher with 192-bit CBC mode. */
 124:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CBC,     /**< Camellia cipher with 256-bit CBC mode. */
 125:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CFB128,  /**< Camellia cipher with 128-bit CFB128 mode. */
 126:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CFB128,  /**< Camellia cipher with 192-bit CFB128 mode. */
 127:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CFB128,  /**< Camellia cipher with 256-bit CFB128 mode. */
 128:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CTR,     /**< Camellia cipher with 128-bit CTR mode. */
 129:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CTR,     /**< Camellia cipher with 192-bit CTR mode. */
 130:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CTR,     /**< Camellia cipher with 256-bit CTR mode. */
 131:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_GCM,     /**< Camellia cipher with 128-bit GCM mode. */
 132:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_GCM,     /**< Camellia cipher with 192-bit GCM mode. */
 133:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_GCM,     /**< Camellia cipher with 256-bit GCM mode. */
 134:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_DES_ECB,              /**< DES cipher with ECB mode. */
 135:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_DES_CBC,              /**< DES cipher with CBC mode. */
 136:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_DES_EDE_ECB,          /**< DES cipher with EDE ECB mode. */
 137:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_DES_EDE_CBC,          /**< DES cipher with EDE CBC mode. */
 138:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_DES_EDE3_ECB,         /**< DES cipher with EDE3 ECB mode. */
 139:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_DES_EDE3_CBC,         /**< DES cipher with EDE3 CBC mode. */
 140:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_ECB,         /**< Blowfish cipher with ECB mode. */
 141:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_CBC,         /**< Blowfish cipher with CBC mode. */
 142:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_CFB64,       /**< Blowfish cipher with CFB64 mode. */
 143:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_BLOWFISH_CTR,         /**< Blowfish cipher with CTR mode. */
 144:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARC4_128,             /**< RC4 cipher with 128-bit mode. */
 145:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_CCM,          /**< AES cipher with 128-bit CCM mode. */
 146:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_CCM,          /**< AES cipher with 192-bit CCM mode. */
 147:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_CCM,          /**< AES cipher with 256-bit CCM mode. */
 148:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_128_CCM,     /**< Camellia cipher with 128-bit CCM mode. */
 149:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_192_CCM,     /**< Camellia cipher with 192-bit CCM mode. */
 150:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CAMELLIA_256_CCM,     /**< Camellia cipher with 256-bit CCM mode. */
 151:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_128_ECB,         /**< Aria cipher with 128-bit key and ECB mode. */
 152:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_192_ECB,         /**< Aria cipher with 192-bit key and ECB mode. */
 153:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_256_ECB,         /**< Aria cipher with 256-bit key and ECB mode. */
 154:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CBC,         /**< Aria cipher with 128-bit key and CBC mode. */
 155:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CBC,         /**< Aria cipher with 192-bit key and CBC mode. */
 156:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CBC,         /**< Aria cipher with 256-bit key and CBC mode. */
 157:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CFB128,      /**< Aria cipher with 128-bit key and CFB-128 mode. */
 158:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CFB128,      /**< Aria cipher with 192-bit key and CFB-128 mode. */
 159:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CFB128,      /**< Aria cipher with 256-bit key and CFB-128 mode. */
 160:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CTR,         /**< Aria cipher with 128-bit key and CTR mode. */
 161:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CTR,         /**< Aria cipher with 192-bit key and CTR mode. */
 162:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CTR,         /**< Aria cipher with 256-bit key and CTR mode. */
 163:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_128_GCM,         /**< Aria cipher with 128-bit key and GCM mode. */
 164:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_192_GCM,         /**< Aria cipher with 192-bit key and GCM mode. */
 165:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_256_GCM,         /**< Aria cipher with 256-bit key and GCM mode. */
 166:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_128_CCM,         /**< Aria cipher with 128-bit key and CCM mode. */
 167:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_192_CCM,         /**< Aria cipher with 192-bit key and CCM mode. */
 168:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_ARIA_256_CCM,         /**< Aria cipher with 256-bit key and CCM mode. */
 169:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_OFB,          /**< AES 128-bit cipher in OFB mode. */
 170:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_192_OFB,          /**< AES 192-bit cipher in OFB mode. */
 171:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_OFB,          /**< AES 256-bit cipher in OFB mode. */
 172:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_128_XTS,          /**< AES 128-bit cipher in XTS block mode. */
 173:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_AES_256_XTS,          /**< AES 256-bit cipher in XTS block mode. */
 174:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CHACHA20,             /**< ChaCha20 stream cipher. */
 175:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_CIPHER_CHACHA20_POLY1305,    /**< ChaCha20-Poly1305 AEAD cipher. */
 176:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_cipher_type_t;
 177:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 178:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /** Supported cipher modes. */
 179:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef enum {
 180:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_NONE = 0,               /**< None. */
 181:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_ECB,                    /**< The ECB cipher mode. */
 182:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_CBC,                    /**< The CBC cipher mode. */
 183:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_CFB,                    /**< The CFB cipher mode. */
 184:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_OFB,                    /**< The OFB cipher mode. */
 185:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_CTR,                    /**< The CTR cipher mode. */
 186:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_GCM,                    /**< The GCM cipher mode. */
 187:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_STREAM,                 /**< The stream cipher mode. */
 188:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_CCM,                    /**< The CCM cipher mode. */
 189:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_XTS,                    /**< The XTS cipher mode. */
 190:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_MODE_CHACHAPOLY,             /**< The ChaCha-Poly cipher mode. */
 191:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_cipher_mode_t;
 192:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 193:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /** Supported cipher padding types. */
 194:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef enum {
 195:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_PADDING_PKCS7 = 0,     /**< PKCS7 padding (default).        */
 196:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_PADDING_ONE_AND_ZEROS, /**< ISO/IEC 7816-4 padding.         */
 197:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_PADDING_ZEROS_AND_LEN, /**< ANSI X.923 padding.             */
 198:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_PADDING_ZEROS,         /**< Zero padding (not reversible). */
 199:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_PADDING_NONE,          /**< Never pad (full blocks only).   */
 200:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_cipher_padding_t;
 201:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 202:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /** Type of operation. */
 203:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef enum {
 204:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_OPERATION_NONE = -1,
 205:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_DECRYPT = 0,
 206:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_ENCRYPT,
 207:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_operation_t;
 208:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 209:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** enum {
 210:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Undefined key length. */
 211:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_KEY_LENGTH_NONE = 0,
 212:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Key length, in bits (including parity), for DES keys. */
 213:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_KEY_LENGTH_DES  = 64,
 214:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Key length in bits, including parity, for DES in two-key EDE. */
 215:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_KEY_LENGTH_DES_EDE = 128,
 216:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Key length in bits, including parity, for DES in three-key EDE. */
 217:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     MBEDTLS_KEY_LENGTH_DES_EDE3 = 192,
 218:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** };
 219:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 220:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /** Maximum length of any IV, in Bytes. */
 221:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_MAX_IV_LENGTH      16
 222:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /** Maximum block size of any cipher, in Bytes. */
 223:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #define MBEDTLS_MAX_BLOCK_LENGTH   16
 224:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 225:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 226:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * Base cipher information (opaque struct).
 227:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 228:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef struct mbedtls_cipher_base_t mbedtls_cipher_base_t;
 229:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 230:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 231:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * CMAC context (opaque struct).
 232:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 233:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef struct mbedtls_cmac_context_t mbedtls_cmac_context_t;
 234:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 235:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 236:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * Cipher information. Allows calling cipher functions
 237:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * in a generic way.
 238:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 239:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef struct mbedtls_cipher_info_t
 240:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** {
 241:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Full cipher identifier. For example,
 242:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * MBEDTLS_CIPHER_AES_256_CBC.
 243:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      */
 244:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     mbedtls_cipher_type_t type;
 245:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 246:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** The cipher mode. For example, MBEDTLS_MODE_CBC. */
 247:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     mbedtls_cipher_mode_t mode;
 248:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 249:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** The cipher key length, in bits. This is the
 250:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * default length for variable sized ciphers.
 251:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * Includes parity bits for ciphers like DES.
 252:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      */
 253:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     unsigned int key_bitlen;
 254:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 255:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Name of the cipher. */
 256:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     const char * name;
 257:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 258:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** IV or nonce size, in Bytes.
 259:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * For ciphers that accept variable IV sizes,
 260:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * this is the recommended size.
 261:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      */
 262:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     unsigned int iv_size;
 263:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 264:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Bitflag comprised of MBEDTLS_CIPHER_VARIABLE_IV_LEN and
 265:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      *  MBEDTLS_CIPHER_VARIABLE_KEY_LEN indicating whether the
 266:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      *  cipher supports variable IV or variable key sizes, respectively.
 267:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      */
 268:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     int flags;
 269:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 270:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** The block size, in Bytes. */
 271:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     unsigned int block_size;
 272:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 273:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Struct for base cipher information and functions. */
 274:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     const mbedtls_cipher_base_t *base;
 275:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 276:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_cipher_info_t;
 277:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 278:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 279:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * Generic cipher context.
 280:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 281:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** typedef struct mbedtls_cipher_context_t
 282:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** {
 283:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Information about the associated cipher. */
 284:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     const mbedtls_cipher_info_t *cipher_info;
 285:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 286:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Key length to use. */
 287:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     int key_bitlen;
 288:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 289:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Operation that the key of the context has been
 290:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * initialized for.
 291:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      */
 292:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     mbedtls_operation_t operation;
 293:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 294:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if defined(MBEDTLS_CIPHER_MODE_WITH_PADDING)
 295:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Padding functions to use, if relevant for
 296:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * the specific cipher mode.
 297:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      */
 298:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     void (*add_padding)( unsigned char *output, size_t olen, size_t data_len );
 299:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     int (*get_padding)( unsigned char *input, size_t ilen, size_t *data_len );
 300:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
 301:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 302:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Buffer for input that has not been processed yet. */
 303:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     unsigned char unprocessed_data[MBEDTLS_MAX_BLOCK_LENGTH];
 304:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 305:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Number of Bytes that have not been processed yet. */
 306:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     size_t unprocessed_len;
 307:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 308:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** Current IV or NONCE_COUNTER for CTR-mode, data unit (or sector) number
 309:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****      * for XTS-mode. */
 310:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     unsigned char iv[MBEDTLS_MAX_IV_LENGTH];
 311:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 312:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** IV size in Bytes, for ciphers with variable-length IVs. */
 313:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     size_t iv_size;
 314:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 315:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** The cipher-specific context. */
 316:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     void *cipher_ctx;
 317:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 318:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #if defined(MBEDTLS_CMAC_C)
 319:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     /** CMAC-specific context. */
 320:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     mbedtls_cmac_context_t *cmac_ctx;
 321:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** #endif
 322:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** } mbedtls_cipher_context_t;
 323:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 324:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 325:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief This function retrieves the list of ciphers supported by the generic
 326:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * cipher module.
 327:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 328:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return      A statically-allocated array of ciphers. The last entry
 329:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *              is zero.
 330:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 331:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** const int *mbedtls_cipher_list( void );
 332:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 333:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 334:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief               This function retrieves the cipher-information
 335:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      structure associated with the given cipher name.
 336:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 337:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param cipher_name   Name of the cipher to search for.
 338:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 339:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              The cipher information structure associated with the
 340:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      given \p cipher_name.
 341:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              NULL if the associated cipher information is not found.
 342:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 343:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** const mbedtls_cipher_info_t *mbedtls_cipher_info_from_string( const char *cipher_name );
 344:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 345:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 346:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief               This function retrieves the cipher-information
 347:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      structure associated with the given cipher type.
 348:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 349:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param cipher_type   Type of the cipher to search for.
 350:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 351:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              The cipher information structure associated with the
 352:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      given \p cipher_type.
 353:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              NULL if the associated cipher information is not found.
 354:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 355:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** const mbedtls_cipher_info_t *mbedtls_cipher_info_from_type( const mbedtls_cipher_type_t cipher_type
 356:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 357:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 358:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief               This function retrieves the cipher-information
 359:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      structure associated with the given cipher ID,
 360:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      key size and mode.
 361:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 362:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param cipher_id     The ID of the cipher to search for. For example,
 363:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      #MBEDTLS_CIPHER_ID_AES.
 364:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param key_bitlen    The length of the key in bits.
 365:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param mode          The cipher mode. For example, #MBEDTLS_MODE_CBC.
 366:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 367:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              The cipher information structure associated with the
 368:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      given \p cipher_id.
 369:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              NULL if the associated cipher information is not found.
 370:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 371:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** const mbedtls_cipher_info_t *mbedtls_cipher_info_from_values( const mbedtls_cipher_id_t cipher_id,
 372:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****                                               int key_bitlen,
 373:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****                                               const mbedtls_cipher_mode_t mode );
 374:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 375:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 376:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief               This function initializes a \p cipher_context as NONE.
 377:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 378:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** void mbedtls_cipher_init( mbedtls_cipher_context_t *ctx );
 379:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 380:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 381:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief               This function frees and clears the cipher-specific
 382:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      context of \p ctx. Freeing \p ctx itself remains the
 383:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      responsibility of the caller.
 384:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 385:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** void mbedtls_cipher_free( mbedtls_cipher_context_t *ctx );
 386:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 387:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 388:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 389:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief               This function initializes and fills the cipher-context
 390:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      structure with the appropriate values. It also clears
 391:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      the structure.
 392:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 393:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param ctx           The context to initialize. May not be NULL.
 394:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param cipher_info   The cipher to use.
 395:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 396:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              \c 0 on success.
 397:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              #MBEDTLS_ERR_CIPHER_BAD_INPUT_DATA on
 398:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      parameter-verification failure.
 399:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return              #MBEDTLS_ERR_CIPHER_ALLOC_FAILED if allocation of the
 400:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *                      cipher-specific context fails.
 401:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 402:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \internal Currently, the function also clears the structure.
 403:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * In future versions, the caller will be required to call
 404:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * mbedtls_cipher_init() on the structure first.
 405:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 406:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** int mbedtls_cipher_setup( mbedtls_cipher_context_t *ctx, const mbedtls_cipher_info_t *cipher_info )
 407:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 408:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 409:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief        This function returns the block size of the given cipher.
 410:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 411:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param ctx    The context of the cipher. Must be initialized.
 412:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 413:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return       The size of the blocks of the cipher.
 414:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return       0 if \p ctx has not been initialized.
 415:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 416:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** static inline unsigned int mbedtls_cipher_get_block_size( const mbedtls_cipher_context_t *ctx )
 417:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** {
 418:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     if( NULL == ctx || NULL == ctx->cipher_info )
 419:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****         return 0;
 420:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 421:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     return ctx->cipher_info->block_size;
 422:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** }
 423:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 424:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** /**
 425:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \brief        This function returns the mode of operation for
 426:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *               the cipher. For example, MBEDTLS_MODE_CBC.
 427:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 428:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \param ctx    The context of the cipher. Must be initialized.
 429:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  *
 430:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return       The mode of operation.
 431:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  * \return       #MBEDTLS_MODE_NONE if \p ctx has not been initialized.
 432:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****  */
 433:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** static inline mbedtls_cipher_mode_t mbedtls_cipher_get_cipher_mode( const mbedtls_cipher_context_t 
 434:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** {
 435:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     if( NULL == ctx || NULL == ctx->cipher_info )
 1608              		.loc 3 435 0
 1609 007c 506090E5 		ldr	r6, [r0, #80]
 1610 0080 000056E3 		cmp	r6, #0
 1611 0084 9700000A 		beq	.L155
 436:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****         return MBEDTLS_MODE_NONE;
 437:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 438:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****     return ctx->cipher_info->mode;
 1612              		.loc 3 438 0
 1613 0088 0160D6E5 		ldrb	r6, [r6, #1]	@ zero_extendqisi2
 1614              	.LVL195:
 1615              	.LBE134:
 1616              	.LBE133:
1461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( mode == MBEDTLS_MODE_CBC
 1617              		.loc 2 1461 0
 1618 008c 070056E3 		cmp	r6, #7
 1619 0090 0400000A 		beq	.L133
 1620 0094 020056E3 		cmp	r6, #2
 1621 0098 9200001A 		bne	.L155
1464:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 1622              		.loc 2 1464 0
 1623 009c 683093E5 		ldr	r3, [r3, #104]
 1624 00a0 000053E3 		cmp	r3, #0
 1625 00a4 8F00001A 		bne	.L155
 1626              	.L133:
1485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1627              		.loc 2 1485 0
 1628 00a8 0C3094E5 		ldr	r3, [r4, #12]
 1629 00ac 000053E3 		cmp	r3, #0
 1630 00b0 EEFFFFDA 		ble	.L157
 1631              	.LBB135:
1489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_hdr, 3 );
 1632              		.loc 2 1489 0
 1633 00b4 0820A0E3 		mov	r2, #8
 1634 00b8 881094E5 		ldr	r1, [r4, #136]
 1635 00bc 380080E2 		add	r0, r0, #56
 1636              	.LBE135:
1511:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 1637              		.loc 2 1511 0
 1638 00c0 0170A0E3 		mov	r7, #1
 1639              	.LBB136:
1489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_hdr, 3 );
 1640              		.loc 2 1489 0
 1641 00c4 FEFFFFEB 		bl	mbedtls_md_hmac_update
 1642              	.LVL196:
1490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc, ssl->out_len, 2 );
 1643              		.loc 2 1490 0
 1644 00c8 380094E5 		ldr	r0, [r4, #56]
 1645 00cc 0320A0E3 		mov	r2, #3
 1646 00d0 8C1094E5 		ldr	r1, [r4, #140]
 1647 00d4 380080E2 		add	r0, r0, #56
 1648 00d8 FEFFFFEB 		bl	mbedtls_md_hmac_update
 1649              	.LVL197:
1491:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 1650              		.loc 2 1491 0
 1651 00dc 380094E5 		ldr	r0, [r4, #56]
 1652 00e0 0220A0E3 		mov	r2, #2
 1653 00e4 901094E5 		ldr	r1, [r4, #144]
 1654 00e8 380080E2 		add	r0, r0, #56
 1655 00ec FEFFFFEB 		bl	mbedtls_md_hmac_update
 1656              	.LVL198:
1492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->out_msg, ssl->out_msglen );
 1657              		.loc 2 1492 0
 1658 00f0 380094E5 		ldr	r0, [r4, #56]
 1659 00f4 A02094E5 		ldr	r2, [r4, #160]
 1660 00f8 981094E5 		ldr	r1, [r4, #152]
 1661 00fc 380080E2 		add	r0, r0, #56
 1662 0100 FEFFFFEB 		bl	mbedtls_md_hmac_update
 1663              	.LVL199:
1494:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_out->md_ctx_enc );
 1664              		.loc 2 1494 0
 1665 0104 380094E5 		ldr	r0, [r4, #56]
 1666 0108 38108DE2 		add	r1, sp, #56
 1667 010c 380080E2 		add	r0, r0, #56
 1668 0110 FEFFFFEB 		bl	mbedtls_md_hmac_finish
 1669              	.LVL200:
1495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1670              		.loc 2 1495 0
 1671 0114 380094E5 		ldr	r0, [r4, #56]
 1672 0118 380080E2 		add	r0, r0, #56
 1673 011c FEFFFFEB 		bl	mbedtls_md_hmac_reset
 1674              	.LVL201:
1497:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1675              		.loc 2 1497 0
 1676 0120 A03094E5 		ldr	r3, [r4, #160]
 1677 0124 38108DE2 		add	r1, sp, #56
 1678 0128 980094E5 		ldr	r0, [r4, #152]
 1679 012c 382094E5 		ldr	r2, [r4, #56]
 1680 0130 030080E0 		add	r0, r0, r3
 1681 0134 142092E5 		ldr	r2, [r2, #20]
 1682 0138 FEFFFFEB 		bl	memcpy
 1683              	.LVL202:
 1684              	.LBE136:
1510:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
 1685              		.loc 2 1510 0
 1686 013c 382094E5 		ldr	r2, [r4, #56]
 1687 0140 A03094E5 		ldr	r3, [r4, #160]
 1688 0144 142092E5 		ldr	r2, [r2, #20]
 1689 0148 023083E0 		add	r3, r3, r2
 1690 014c A03084E5 		str	r3, [r4, #160]
 1691              	.LVL203:
 1692              	.L132:
1550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mode == MBEDTLS_MODE_CHACHAPOLY )
 1693              		.loc 2 1550 0
 1694 0150 FD5006E2 		and	r5, r6, #253
 1695              	.LVL204:
 1696 0154 060056E3 		cmp	r6, #6
 1697 0158 08005513 		cmpne	r5, #8
 1698 015c 0150A003 		moveq	r5, #1
 1699 0160 0050A013 		movne	r5, #0
 1700 0164 7100001A 		bne	.L135
 1701              	.LBB137:
1558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         unsigned char taglen = transform->ciphersuite_info->flags &
 1702              		.loc 2 1558 0
 1703 0168 385094E5 		ldr	r5, [r4, #56]
 1704              	.LVL205:
1566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->out_msgtype;
 1705              		.loc 2 1566 0
 1706 016c 0820A0E3 		mov	r2, #8
 1707 0170 886094E5 		ldr	r6, [r4, #136]
 1708 0174 38008DE2 		add	r0, sp, #56
1559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 1709              		.loc 2 1559 0
 1710 0178 003095E5 		ldr	r3, [r5]
1566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->out_msgtype;
 1711              		.loc 2 1566 0
 1712 017c 0610A0E1 		mov	r1, r6
1561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1713              		.loc 2 1561 0
 1714 0180 0CB095E5 		ldr	fp, [r5, #12]
 1715 0184 10A095E5 		ldr	r10, [r5, #16]
1559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 1716              		.loc 2 1559 0
 1717 0188 1C30D3E5 		ldrb	r3, [r3, #28]	@ zero_extendqisi2
 1718 018c 020013E3 		tst	r3, #2
 1719 0190 1090A003 		moveq	r9, #16
 1720 0194 0890A013 		movne	r9, #8
 1721              	.LVL206:
1566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->out_msgtype;
 1722              		.loc 2 1566 0
 1723 0198 FEFFFFEB 		bl	memcpy
 1724              	.LVL207:
1567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 1725              		.loc 2 1567 0
 1726 019c 9C3094E5 		ldr	r3, [r4, #156]
1578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1727              		.loc 2 1578 0
 1728 01a0 0C005BE3 		cmp	fp, #12
 1729              	.LBB138:
 1730              	.LBB139:
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 1731              		.loc 2 9514 0
 1732 01a4 082094E5 		ldr	r2, [r4, #8]
 1733              	.LBE139:
 1734              	.LBE138:
1567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 1735              		.loc 2 1567 0
 1736 01a8 4030CDE5 		strb	r3, [sp, #64]
1568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->conf->transport, add_data + 9 );
 1737              		.loc 2 1568 0
 1738 01ac 0C3094E5 		ldr	r3, [r4, #12]
 1739              	.LVL208:
 1740              	.LBB141:
 1741              	.LBB140:
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 1742              		.loc 2 9514 0
 1743 01b0 4120CDE5 		strb	r2, [sp, #65]
 1744              	.LVL209:
 1745              		.loc 2 9515 0
 1746 01b4 4230CDE5 		strb	r3, [sp, #66]
 1747              	.LVL210:
 1748              	.LBE140:
 1749              	.LBE141:
1570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[12] = ssl->out_msglen & 0xFF;
 1750              		.loc 2 1570 0
 1751 01b8 A03094E5 		ldr	r3, [r4, #160]
1571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1752              		.loc 2 1571 0
 1753 01bc 4430CDE5 		strb	r3, [sp, #68]
1570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[12] = ssl->out_msglen & 0xFF;
 1754              		.loc 2 1570 0
 1755 01c0 2324A0E1 		lsr	r2, r3, #8
 1756 01c4 4320CDE5 		strb	r2, [sp, #67]
1578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1757              		.loc 2 1578 0
 1758 01c8 A8FFFF1A 		bne	.L157
 1759 01cc 04005AE3 		cmp	r10, #4
 1760 01d0 4600001A 		bne	.L138
1581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv + transform->fixed_ivlen, ssl->out_ctr, 8 );
 1761              		.loc 2 1581 0
 1762 01d4 0A20A0E1 		mov	r2, r10
 1763 01d8 181085E2 		add	r1, r5, #24
 1764 01dc 28008DE2 		add	r0, sp, #40
 1765 01e0 FEFFFFEB 		bl	memcpy
 1766              	.LVL211:
1582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( ssl->out_iv, ssl->out_ctr, 8 );
 1767              		.loc 2 1582 0
 1768 01e4 0820A0E3 		mov	r2, #8
 1769 01e8 0610A0E1 		mov	r1, r6
 1770 01ec 2C008DE2 		add	r0, sp, #44
 1771 01f0 FEFFFFEB 		bl	memcpy
 1772              	.LVL212:
1583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1773              		.loc 2 1583 0
 1774 01f4 0820A0E3 		mov	r2, #8
 1775 01f8 0610A0E1 		mov	r1, r6
 1776 01fc 940094E5 		ldr	r0, [r4, #148]
 1777 0200 FEFFFFEB 		bl	memcpy
 1778              	.LVL213:
 1779              	.L139:
1612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msglen += explicit_ivlen;
 1780              		.loc 2 1612 0
 1781 0204 A06094E5 		ldr	r6, [r4, #160]
1622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
 1782              		.loc 2 1622 0
 1783 0208 28108DE2 		add	r1, sp, #40
1611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         enc_msglen = ssl->out_msglen;
 1784              		.loc 2 1611 0
 1785 020c 983094E5 		ldr	r3, [r4, #152]
 1786              	.LVL214:
1622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
 1787              		.loc 2 1622 0
 1788 0210 500085E2 		add	r0, r5, #80
 1789 0214 18908DE5 		str	r9, [sp, #24]
1613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1790              		.loc 2 1613 0
 1791 0218 0C2086E2 		add	r2, r6, #12
 1792 021c 0AA042E0 		sub	r10, r2, r10
 1793              	.LVL215:
1622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
 1794              		.loc 2 1622 0
 1795 0220 062083E0 		add	r2, r3, r6
 1796 0224 14208DE5 		str	r2, [sp, #20]
 1797 0228 24208DE2 		add	r2, sp, #36
 1798 022c 0C308DE5 		str	r3, [sp, #12]
 1799 0230 48008DE9 		stmib	sp, {r3, r6}
 1800 0234 0D30A0E3 		mov	r3, #13
 1801              	.LVL216:
 1802 0238 00308DE5 		str	r3, [sp]
 1803 023c 38308DE2 		add	r3, sp, #56
 1804 0240 10208DE5 		str	r2, [sp, #16]
1613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1805              		.loc 2 1613 0
 1806 0244 A0A084E5 		str	r10, [r4, #160]
 1807              	.LVL217:
1622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
 1808              		.loc 2 1622 0
 1809 0248 0C2095E5 		ldr	r2, [r5, #12]
 1810 024c FEFFFFEB 		bl	mbedtls_cipher_auth_encrypt
 1811              	.LVL218:
 1812 0250 000050E3 		cmp	r0, #0
 1813 0254 86FFFF1A 		bne	.L128
1633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1814              		.loc 2 1633 0
 1815 0258 24309DE5 		ldr	r3, [sp, #36]
 1816 025c 030056E1 		cmp	r6, r3
 1817 0260 82FFFF1A 		bne	.L157
1639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
 1818              		.loc 2 1639 0
 1819 0264 A03094E5 		ldr	r3, [r4, #160]
 1820              	.LBE137:
1774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1821              		.loc 2 1774 0
 1822 0268 000057E3 		cmp	r7, #0
 1823              	.LBB143:
1639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         auth_done++;
 1824              		.loc 2 1639 0
 1825 026c 099083E0 		add	r9, r3, r9
 1826              	.LVL219:
 1827 0270 A09084E5 		str	r9, [r4, #160]
 1828              	.LVL220:
 1829              	.LBE143:
1774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1830              		.loc 2 1774 0
 1831 0274 7DFFFF1A 		bne	.L157
 1832              	.LVL221:
 1833              	.L142:
 1834              	.LBE146:
 1835              	.LBE148:
3393:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_len[0] = (unsigned char)( len >> 8 );
 1836              		.loc 2 3393 0
 1837 0278 A05094E5 		ldr	r5, [r4, #160]
 1838              	.LVL222:
3394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_len[1] = (unsigned char)( len      );
 1839              		.loc 2 3394 0
 1840 027c 903094E5 		ldr	r3, [r4, #144]
 1841 0280 2524A0E1 		lsr	r2, r5, #8
 1842 0284 0020C3E5 		strb	r2, [r3]
3395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1843              		.loc 2 3395 0
 1844 0288 903094E5 		ldr	r3, [r4, #144]
 1845 028c 0150C3E5 		strb	r5, [r3, #1]
 1846              	.L129:
 1847              	.LVL223:
3425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr  += protected_record_size;
 1848              		.loc 2 3425 0
 1849 0290 A43094E5 		ldr	r3, [r4, #164]
3398:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1850              		.loc 2 3398 0
 1851 0294 055085E2 		add	r5, r5, #5
 1852              	.LVL224:
3427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1853              		.loc 2 3427 0
 1854 0298 381094E5 		ldr	r1, [r4, #56]
 1855 029c 0400A0E1 		mov	r0, r4
3425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_hdr  += protected_record_size;
 1856              		.loc 2 3425 0
 1857 02a0 053083E0 		add	r3, r3, r5
 1858 02a4 A43084E5 		str	r3, [r4, #164]
3426:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_update_out_pointers( ssl, ssl->transform_out );
 1859              		.loc 2 3426 0
 1860 02a8 8C3094E5 		ldr	r3, [r4, #140]
 1861 02ac 055083E0 		add	r5, r3, r5
 1862              	.LVL225:
 1863 02b0 8C5084E5 		str	r5, [r4, #140]
3427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1864              		.loc 2 3427 0
 1865 02b4 FEFFFFEB 		bl	ssl_update_out_pointers
 1866              	.LVL226:
 1867 02b8 AF2084E2 		add	r2, r4, #175
 1868 02bc A71084E2 		add	r1, r4, #167
 1869              	.LVL227:
 1870              	.L150:
3430:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
 1871              		.loc 2 3430 0
 1872 02c0 0030D2E5 		ldrb	r3, [r2]	@ zero_extendqisi2
 1873 02c4 013083E2 		add	r3, r3, #1
 1874 02c8 7330EFE6 		uxtb	r3, r3
 1875 02cc 000053E3 		cmp	r3, #0
 1876 02d0 013042E4 		strb	r3, [r2], #-1
 1877 02d4 8100001A 		bne	.L149
3429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ++ssl->cur_out_ctr[i - 1] != 0 )
 1878              		.loc 2 3429 0 discriminator 1
 1879 02d8 020051E1 		cmp	r1, r2
 1880 02dc F7FFFF1A 		bne	.L150
3437:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1881              		.loc 2 3437 0
 1882 02e0 14029FE5 		ldr	r0, .L168+4
 1883              	.LVL228:
 1884 02e4 62FFFFEA 		b	.L128
 1885              	.LVL229:
 1886              	.L155:
 1887              	.LBB149:
 1888              	.LBB147:
1442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1889              		.loc 2 1442 0
 1890 02e8 0070A0E3 		mov	r7, #0
 1891 02ec 97FFFFEA 		b	.L132
 1892              	.LVL230:
 1893              	.L138:
 1894              	.LBB144:
1586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1895              		.loc 2 1586 0
 1896 02f0 0C005AE3 		cmp	r10, #12
 1897 02f4 5DFFFF1A 		bne	.L157
 1898              	.LBB142:
1591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1899              		.loc 2 1591 0
 1900 02f8 0A20A0E1 		mov	r2, r10
 1901 02fc 181085E2 		add	r1, r5, #24
 1902 0300 28008DE2 		add	r0, sp, #40
 1903 0304 FEFFFFEB 		bl	memcpy
 1904              	.LVL231:
 1905 0308 013046E2 		sub	r3, r6, #1
 1906 030c 2B208DE2 		add	r2, sp, #43
 1907 0310 076086E2 		add	r6, r6, #7
 1908              	.LVL232:
 1909              	.L140:
1594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1910              		.loc 2 1594 0
 1911 0314 0100F3E5 		ldrb	r0, [r3, #1]!	@ zero_extendqisi2
 1912 0318 0110D2E5 		ldrb	r1, [r2, #1]	@ zero_extendqisi2
1593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv[i+4] ^= ssl->out_ctr[i];
 1913              		.loc 2 1593 0
 1914 031c 030056E1 		cmp	r6, r3
1594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 1915              		.loc 2 1594 0
 1916 0320 001021E0 		eor	r1, r1, r0
 1917 0324 0110E2E5 		strb	r1, [r2, #1]!
 1918              	.LVL233:
1593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv[i+4] ^= ssl->out_ctr[i];
 1919              		.loc 2 1593 0
 1920 0328 F9FFFF1A 		bne	.L140
 1921 032c B4FFFFEA 		b	.L139
 1922              	.LVL234:
 1923              	.L135:
 1924              	.LBE142:
 1925              	.LBE144:
1648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 1926              		.loc 2 1648 0
 1927 0330 020056E3 		cmp	r6, #2
 1928 0334 4DFFFF1A 		bne	.L157
 1929              	.LBB145:
1654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  ssl->transform_out->ivlen;
 1930              		.loc 2 1654 0
 1931 0338 383094E5 		ldr	r3, [r4, #56]
1652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1932              		.loc 2 1652 0
 1933 033c 24508DE5 		str	r5, [sp, #36]
1654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  ssl->transform_out->ivlen;
 1934              		.loc 2 1654 0
 1935 0340 A09094E5 		ldr	r9, [r4, #160]
 1936 0344 0C6093E5 		ldr	r6, [r3, #12]
 1937 0348 010089E2 		add	r0, r9, #1
 1938 034c 0610A0E1 		mov	r1, r6
 1939 0350 FEFFFFEB 		bl	__aeabi_uidivmod
 1940              	.LVL235:
 1941 0354 011046E0 		sub	r1, r6, r1
 1942              	.LVL236:
1656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             padlen = 0;
 1943              		.loc 2 1656 0
 1944 0358 010056E1 		cmp	r6, r1
1660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1945              		.loc 2 1660 0
 1946 035c 98309405 		ldreq	r3, [r4, #152]
1657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1947              		.loc 2 1657 0
 1948 0360 0510A001 		moveq	r1, r5
 1949              	.LVL237:
1660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1950              		.loc 2 1660 0
 1951 0364 0950C307 		strbeq	r5, [r3, r9]
 1952              	.LVL238:
1656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             padlen = 0;
 1953              		.loc 2 1656 0
 1954 0368 0600000A 		beq	.L152
 1955              	.LVL239:
 1956              	.L144:
1660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1957              		.loc 2 1660 0
 1958 036c 983094E5 		ldr	r3, [r4, #152]
 1959 0370 A02094E5 		ldr	r2, [r4, #160]
 1960 0374 053083E0 		add	r3, r3, r5
1659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[ssl->out_msglen + i] = (unsigned char) padlen;
 1961              		.loc 2 1659 0
 1962 0378 015085E2 		add	r5, r5, #1
 1963              	.LVL240:
 1964 037c 050051E1 		cmp	r1, r5
1660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1965              		.loc 2 1660 0
 1966 0380 0210C3E7 		strb	r1, [r3, r2]
1659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msg[ssl->out_msglen + i] = (unsigned char) padlen;
 1967              		.loc 2 1659 0
 1968 0384 F8FFFF2A 		bcs	.L144
 1969              	.LVL241:
 1970              	.L152:
1662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1971              		.loc 2 1662 0
 1972 0388 A05094E5 		ldr	r5, [r4, #160]
1672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1973              		.loc 2 1672 0
 1974 038c 0C3094E5 		ldr	r3, [r4, #12]
1662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1975              		.loc 2 1662 0
 1976 0390 015085E2 		add	r5, r5, #1
1672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1977              		.loc 2 1672 0
 1978 0394 010053E3 		cmp	r3, #1
1662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1979              		.loc 2 1662 0
 1980 0398 015085E0 		add	r5, r5, r1
 1981 039c A05084E5 		str	r5, [r4, #160]
 1982              	.LVL242:
1665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 1983              		.loc 2 1665 0
 1984 03a0 983094D5 		ldrle	r3, [r4, #152]
1672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 1985              		.loc 2 1672 0
 1986 03a4 130000DA 		ble	.L146
1677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->transform_out->ivlen );
 1987              		.loc 2 1677 0
 1988 03a8 003094E5 		ldr	r3, [r4]
 1989 03ac 381094E5 		ldr	r1, [r4, #56]
 1990 03b0 185093E5 		ldr	r5, [r3, #24]
 1991              	.LVL243:
 1992 03b4 0C2091E5 		ldr	r2, [r1, #12]
 1993 03b8 181081E2 		add	r1, r1, #24
 1994 03bc 1C0093E5 		ldr	r0, [r3, #28]
 1995 03c0 35FF2FE1 		blx	r5
 1996              	.LVL244:
1679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( ret );
 1997              		.loc 2 1679 0
 1998 03c4 000050E3 		cmp	r0, #0
 1999 03c8 29FFFF1A 		bne	.L128
1682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_out->ivlen );
 2000              		.loc 2 1682 0
 2001 03cc 381094E5 		ldr	r1, [r4, #56]
 2002 03d0 940094E5 		ldr	r0, [r4, #148]
 2003              	.LVL245:
 2004 03d4 0C2091E5 		ldr	r2, [r1, #12]
 2005 03d8 181081E2 		add	r1, r1, #24
 2006 03dc FEFFFFEB 		bl	memcpy
 2007              	.LVL246:
1690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2008              		.loc 2 1690 0
 2009 03e0 382094E5 		ldr	r2, [r4, #56]
1689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->out_msglen += ssl->transform_out->ivlen;
 2010              		.loc 2 1689 0
 2011 03e4 A05094E5 		ldr	r5, [r4, #160]
1688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             enc_msglen = ssl->out_msglen;
 2012              		.loc 2 1688 0
 2013 03e8 983094E5 		ldr	r3, [r4, #152]
 2014              	.LVL247:
1690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2015              		.loc 2 1690 0
 2016 03ec 0C2092E5 		ldr	r2, [r2, #12]
 2017 03f0 052082E0 		add	r2, r2, r5
 2018 03f4 A02084E5 		str	r2, [r4, #160]
 2019              	.LVL248:
 2020              	.L146:
1699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_out->iv_enc,
 2021              		.loc 2 1699 0
 2022 03f8 380094E5 		ldr	r0, [r4, #56]
 2023 03fc 24208DE2 		add	r2, sp, #36
 2024 0400 08208DE5 		str	r2, [sp, #8]
 2025 0404 04308DE5 		str	r3, [sp, #4]
 2026 0408 00508DE5 		str	r5, [sp]
 2027 040c 181080E2 		add	r1, r0, #24
 2028 0410 0C2090E5 		ldr	r2, [r0, #12]
 2029 0414 500080E2 		add	r0, r0, #80
 2030 0418 FEFFFFEB 		bl	mbedtls_cipher_crypt
 2031              	.LVL249:
 2032 041c 000050E3 		cmp	r0, #0
 2033 0420 13FFFF1A 		bne	.L128
1709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2034              		.loc 2 1709 0
 2035 0424 24309DE5 		ldr	r3, [sp, #36]
 2036 0428 030055E1 		cmp	r5, r3
 2037 042c 0FFFFF1A 		bne	.L157
1728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2038              		.loc 2 1728 0
 2039 0430 000057E3 		cmp	r7, #0
 2040 0434 8FFFFF1A 		bne	.L142
 2041              	.LBB132:
1744:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->out_hdr, 3 );
 2042              		.loc 2 1744 0
 2043 0438 0820A0E3 		mov	r2, #8
 2044 043c 881094E5 		ldr	r1, [r4, #136]
 2045 0440 28008DE2 		add	r0, sp, #40
 2046              	.LVL250:
 2047 0444 FEFFFFEB 		bl	memcpy
 2048              	.LVL251:
1745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[11] = (unsigned char)( ( ssl->out_msglen >> 8 ) & 0xFF );
 2049              		.loc 2 1745 0
 2050 0448 0320A0E3 		mov	r2, #3
 2051 044c 8C1094E5 		ldr	r1, [r4, #140]
 2052 0450 30008DE2 		add	r0, sp, #48
 2053 0454 FEFFFFEB 		bl	memcpy
 2054              	.LVL252:
1746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->out_msglen      ) & 0xFF );
 2055              		.loc 2 1746 0
 2056 0458 A03094E5 		ldr	r3, [r4, #160]
1751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 2057              		.loc 2 1751 0
 2058 045c 28108DE2 		add	r1, sp, #40
 2059 0460 380094E5 		ldr	r0, [r4, #56]
1747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2060              		.loc 2 1747 0
 2061 0464 3430CDE5 		strb	r3, [sp, #52]
1746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->out_msglen      ) & 0xFF );
 2062              		.loc 2 1746 0
 2063 0468 2324A0E1 		lsr	r2, r3, #8
1751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 2064              		.loc 2 1751 0
 2065 046c 380080E2 		add	r0, r0, #56
1746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->out_msglen      ) & 0xFF );
 2066              		.loc 2 1746 0
 2067 0470 3320CDE5 		strb	r2, [sp, #51]
1751:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_out->md_ctx_enc,
 2068              		.loc 2 1751 0
 2069 0474 0D20A0E3 		mov	r2, #13
 2070 0478 FEFFFFEB 		bl	mbedtls_md_hmac_update
 2071              	.LVL253:
1752:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->out_iv, ssl->out_msglen );
 2072              		.loc 2 1752 0
 2073 047c 380094E5 		ldr	r0, [r4, #56]
 2074 0480 A02094E5 		ldr	r2, [r4, #160]
 2075 0484 941094E5 		ldr	r1, [r4, #148]
 2076 0488 380080E2 		add	r0, r0, #56
 2077 048c FEFFFFEB 		bl	mbedtls_md_hmac_update
 2078              	.LVL254:
1754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_out->md_ctx_enc );
 2079              		.loc 2 1754 0
 2080 0490 380094E5 		ldr	r0, [r4, #56]
 2081 0494 38108DE2 		add	r1, sp, #56
 2082 0498 380080E2 		add	r0, r0, #56
 2083 049c FEFFFFEB 		bl	mbedtls_md_hmac_finish
 2084              	.LVL255:
1755:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2085              		.loc 2 1755 0
 2086 04a0 380094E5 		ldr	r0, [r4, #56]
 2087 04a4 380080E2 		add	r0, r0, #56
 2088 04a8 FEFFFFEB 		bl	mbedtls_md_hmac_reset
 2089              	.LVL256:
1757:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     ssl->transform_out->maclen );
 2090              		.loc 2 1757 0
 2091 04ac A03094E5 		ldr	r3, [r4, #160]
 2092 04b0 38108DE2 		add	r1, sp, #56
 2093 04b4 940094E5 		ldr	r0, [r4, #148]
 2094 04b8 382094E5 		ldr	r2, [r4, #56]
 2095 04bc 030080E0 		add	r0, r0, r3
 2096 04c0 142092E5 		ldr	r2, [r2, #20]
 2097 04c4 FEFFFFEB 		bl	memcpy
 2098              	.LVL257:
1760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done++;
 2099              		.loc 2 1760 0
 2100 04c8 382094E5 		ldr	r2, [r4, #56]
 2101 04cc A03094E5 		ldr	r3, [r4, #160]
 2102 04d0 142092E5 		ldr	r2, [r2, #20]
 2103 04d4 023083E0 		add	r3, r3, r2
 2104 04d8 A03084E5 		str	r3, [r4, #160]
 2105              	.LVL258:
 2106 04dc 65FFFFEA 		b	.L142
 2107              	.LVL259:
 2108              	.L149:
 2109              	.LBE132:
 2110              	.LBE145:
 2111              	.LBE147:
 2112              	.LBE149:
 2113              	.LBE151:
3466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 2114              		.loc 2 3466 0
 2115 04e0 010058E3 		cmp	r8, #1
3475:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2116              		.loc 2 3475 0
 2117 04e4 0000A013 		movne	r0, #0
 2118              	.LVL260:
3466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 2119              		.loc 2 3466 0
 2120 04e8 E1FEFF1A 		bne	.L128
3466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ( ret = mbedtls_ssl_flush_output( ssl ) ) != 0 )
 2121              		.loc 2 3466 0 is_stmt 0 discriminator 1
 2122 04ec 0400A0E1 		mov	r0, r4
 2123 04f0 FEFFFFEB 		bl	mbedtls_ssl_flush_output
 2124              	.LVL261:
 2125 04f4 DEFEFFEA 		b	.L128
 2126              	.L169:
 2127              		.align	2
 2128              	.L168:
 2129 04f8 0094FFFF 		.word	-27648
 2130 04fc 8094FFFF 		.word	-27520
 2131              		.cfi_endproc
 2132              	.LFE36:
 2134              		.section	.text.mbedtls_ssl_write_handshake_msg,"ax",%progbits
 2135              		.align	2
 2136              		.global	mbedtls_ssl_write_handshake_msg
 2137              		.syntax unified
 2138              		.arm
 2139              		.fpu neon
 2141              	mbedtls_ssl_write_handshake_msg:
 2142              	.LFB35:
3178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2143              		.loc 2 3178 0 is_stmt 1
 2144              		.cfi_startproc
 2145              		@ args = 0, pretend = 0, frame = 0
 2146              		@ frame_needed = 0, uses_anonymous_args = 0
 2147              	.LVL262:
3188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
 2148              		.loc 2 3188 0
 2149 0000 9C2090E5 		ldr	r2, [r0, #156]
3180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const unsigned char hs_type = ssl->out_msg[0];
 2150              		.loc 2 3180 0
 2151 0004 A03090E5 		ldr	r3, [r0, #160]
 2152              	.LVL263:
3188:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msgtype != MBEDTLS_SSL_MSG_CHANGE_CIPHER_SPEC )
 2153              		.loc 2 3188 0
 2154 0008 0210C2E3 		bic	r1, r2, #2
 2155 000c 140051E3 		cmp	r1, #20
 2156 0010 2500001A 		bne	.L176
3181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2157              		.loc 2 3181 0 discriminator 1
 2158 0014 98C090E5 		ldr	ip, [r0, #152]
3178:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2159              		.loc 2 3178 0 discriminator 1
 2160 0018 10402DE9 		push	{r4, lr}
 2161              		.cfi_def_cfa_offset 8
 2162              		.cfi_offset 4, -8
 2163              		.cfi_offset 14, -4
3203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST &&
 2164              		.loc 2 3203 0 discriminator 1
 2165 001c 16E042E2 		sub	lr, r2, #22
 2166 0020 1EEF6FE1 		clz	lr, lr
 2167 0024 AEE2A0E1 		lsr	lr, lr, #5
3181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2168              		.loc 2 3181 0 discriminator 1
 2169 0028 0010DCE5 		ldrb	r1, [ip]	@ zero_extendqisi2
3203:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         hs_type != MBEDTLS_SSL_HS_HELLO_REQUEST &&
 2170              		.loc 2 3203 0 discriminator 1
 2171 002c 000051E3 		cmp	r1, #0
 2172 0030 00E0A003 		moveq	lr, #0
 2173 0034 00005EE3 		cmp	lr, #0
 2174 0038 0200000A 		beq	.L172
3204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake == NULL )
 2175              		.loc 2 3204 0
 2176 003c 30E090E5 		ldr	lr, [r0, #48]
 2177 0040 00005EE3 		cmp	lr, #0
 2178 0044 1A00000A 		beq	.L178
 2179              	.L172:
3229:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2180              		.loc 2 3229 0
 2181 0048 020A53E3 		cmp	r3, #8192
 2182 004c 1800008A 		bhi	.L178
3241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2183              		.loc 2 3241 0
 2184 0050 160052E3 		cmp	r2, #22
 2185 0054 0040A0E1 		mov	r4, r0
 2186 0058 0F00001A 		bne	.L174
 2187              	.LVL264:
3180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const unsigned char hs_type = ssl->out_msg[0];
 2188              		.loc 2 3180 0
 2189 005c 043043E2 		sub	r3, r3, #4
 2190              	.LVL265:
3291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->update_checksum( ssl, ssl->out_msg, ssl->out_msglen );
 2191              		.loc 2 3291 0
 2192 0060 000051E3 		cmp	r1, #0
3243:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[2] = (unsigned char)( hs_len >>  8 );
 2193              		.loc 2 3243 0
 2194 0064 2328A0E1 		lsr	r2, r3, #16
 2195 0068 0120CCE5 		strb	r2, [ip, #1]
 2196              	.LVL266:
3244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[3] = (unsigned char)( hs_len       );
 2197              		.loc 2 3244 0
 2198 006c 982090E5 		ldr	r2, [r0, #152]
 2199 0070 2304A0E1 		lsr	r0, r3, #8
 2200              	.LVL267:
 2201 0074 0200C2E5 		strb	r0, [r2, #2]
3245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2202              		.loc 2 3245 0
 2203 0078 982094E5 		ldr	r2, [r4, #152]
 2204 007c 0330C2E5 		strb	r3, [r2, #3]
3291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->update_checksum( ssl, ssl->out_msg, ssl->out_msglen );
 2205              		.loc 2 3291 0
 2206 0080 0500000A 		beq	.L174
3292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2207              		.loc 2 3292 0
 2208 0084 303094E5 		ldr	r3, [r4, #48]
 2209              	.LVL268:
 2210 0088 0400A0E1 		mov	r0, r4
 2211 008c A02094E5 		ldr	r2, [r4, #160]
 2212 0090 981094E5 		ldr	r1, [r4, #152]
 2213 0094 BC3193E5 		ldr	r3, [r3, #444]
 2214 0098 33FF2FE1 		blx	r3
 2215              	.LVL269:
 2216              	.L174:
3310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2217              		.loc 2 3310 0
 2218 009c 0400A0E1 		mov	r0, r4
 2219 00a0 0110A0E3 		mov	r1, #1
3320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2220              		.loc 2 3320 0
 2221 00a4 1040BDE8 		pop	{r4, lr}
 2222              		.cfi_restore 14
 2223              		.cfi_restore 4
 2224              		.cfi_def_cfa_offset 0
 2225              	.LVL270:
3310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2226              		.loc 2 3310 0
 2227 00a8 FEFFFFEA 		b	mbedtls_ssl_write_record
 2228              	.LVL271:
 2229              	.L176:
3199:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2230              		.loc 2 3199 0
 2231 00ac 08009FE5 		ldr	r0, .L189
 2232              	.LVL272:
 2233 00b0 1EFF2FE1 		bx	lr
 2234              	.LVL273:
 2235              	.L178:
 2236              		.cfi_def_cfa_offset 8
 2237              		.cfi_offset 4, -8
 2238              		.cfi_offset 14, -4
 2239 00b4 00009FE5 		ldr	r0, .L189
 2240              	.LVL274:
3320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2241              		.loc 2 3320 0
 2242 00b8 1080BDE8 		pop	{r4, pc}
 2243              	.L190:
 2244              		.align	2
 2245              	.L189:
 2246 00bc 0094FFFF 		.word	-27648
 2247              		.cfi_endproc
 2248              	.LFE35:
 2250              		.section	.text.mbedtls_ssl_prepare_handshake_record,"ax",%progbits
 2251              		.align	2
 2252              		.global	mbedtls_ssl_prepare_handshake_record
 2253              		.syntax unified
 2254              		.arm
 2255              		.fpu neon
 2257              	mbedtls_ssl_prepare_handshake_record:
 2258              	.LFB38:
3611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_msglen < mbedtls_ssl_hs_hdr_len( ssl ) )
 2259              		.loc 2 3611 0
 2260              		.cfi_startproc
 2261              		@ args = 0, pretend = 0, frame = 0
 2262              		@ frame_needed = 0, uses_anonymous_args = 0
 2263              		@ link register save eliminated.
 2264              	.LVL275:
3612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2265              		.loc 2 3612 0
 2266 0000 701090E5 		ldr	r1, [r0, #112]
 2267              	.LVL276:
 2268 0004 030051E3 		cmp	r1, #3
 2269 0008 0C00009A 		bls	.L193
 2270              	.LVL277:
 2271 000c 642090E5 		ldr	r2, [r0, #100]
 2272              	.LVL278:
 2273              	.LBB154:
 2274              	.LBB155:
3606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ssl->in_msg[3] );
 2275              		.loc 2 3606 0
 2276 0010 0230D2E5 		ldrb	r3, [r2, #2]	@ zero_extendqisi2
3605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ssl->in_msg[2] << 8  ) |
 2277              		.loc 2 3605 0
 2278 0014 01C0D2E5 		ldrb	ip, [r2, #1]	@ zero_extendqisi2
3607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2279              		.loc 2 3607 0
 2280 0018 0320D2E5 		ldrb	r2, [r2, #3]	@ zero_extendqisi2
3606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ssl->in_msg[3] );
 2281              		.loc 2 3606 0
 2282 001c 0334A0E1 		lsl	r3, r3, #8
3605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ssl->in_msg[2] << 8  ) |
 2283              		.loc 2 3605 0
 2284 0020 0C3883E1 		orr	r3, r3, ip, lsl #16
3606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****               ssl->in_msg[3] );
 2285              		.loc 2 3606 0
 2286 0024 023083E1 		orr	r3, r3, r2
 2287              	.LBE155:
 2288              	.LBE154:
3619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2289              		.loc 2 3619 0
 2290 0028 043083E2 		add	r3, r3, #4
3699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2291              		.loc 2 3699 0
 2292 002c 030051E1 		cmp	r1, r3
3619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2293              		.loc 2 3619 0
 2294 0030 783080E5 		str	r3, [r0, #120]
3699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2295              		.loc 2 3699 0
 2296 0034 0C009FE5 		ldr	r0, .L195
 2297              	.LVL279:
 2298 0038 0000A023 		movcs	r0, #0
 2299 003c 1EFF2FE1 		bx	lr
 2300              	.LVL280:
 2301              	.L193:
3616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2302              		.loc 2 3616 0
 2303 0040 04009FE5 		ldr	r0, .L195+4
 2304              	.LVL281:
3700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2305              		.loc 2 3700 0
 2306 0044 1EFF2FE1 		bx	lr
 2307              	.L196:
 2308              		.align	2
 2309              	.L195:
 2310 0048 808FFFFF 		.word	-28800
 2311 004c 008EFFFF 		.word	-29184
 2312              		.cfi_endproc
 2313              	.LFE38:
 2315              		.section	.text.mbedtls_ssl_update_handshake_status,"ax",%progbits
 2316              		.align	2
 2317              		.global	mbedtls_ssl_update_handshake_status
 2318              		.syntax unified
 2319              		.arm
 2320              		.fpu neon
 2322              	mbedtls_ssl_update_handshake_status:
 2323              	.LFB39:
3703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
 2324              		.loc 2 3703 0
 2325              		.cfi_startproc
 2326              		@ args = 0, pretend = 0, frame = 0
 2327              		@ frame_needed = 0, uses_anonymous_args = 0
 2328              	.LVL282:
3704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2329              		.loc 2 3704 0
 2330 0000 302090E5 		ldr	r2, [r0, #48]
 2331              	.LVL283:
3706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2332              		.loc 2 3706 0
 2333 0004 041090E5 		ldr	r1, [r0, #4]
 2334 0008 100051E3 		cmp	r1, #16
 2335 000c 00005213 		cmpne	r2, #0
 2336 0010 1EFF2F01 		bxeq	lr
3703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params * const hs = ssl->handshake;
 2337              		.loc 2 3703 0
 2338 0014 04E02DE5 		str	lr, [sp, #-4]!
 2339              		.cfi_def_cfa_offset 4
 2340              		.cfi_offset 14, -4
3708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2341              		.loc 2 3708 0
 2342 0018 BCE192E5 		ldr	lr, [r2, #444]
 2343 001c 641090E5 		ldr	r1, [r0, #100]
 2344 0020 0E30A0E1 		mov	r3, lr
 2345 0024 782090E5 		ldr	r2, [r0, #120]
 2346              	.LVL284:
3741:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2347              		.loc 2 3741 0
 2348 0028 04E09DE4 		ldr	lr, [sp], #4
 2349              		.cfi_restore 14
 2350              		.cfi_def_cfa_offset 0
3708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2351              		.loc 2 3708 0
 2352 002c 13FF2FE1 		bx	r3	@ indirect register sibling call
 2353              	.LVL285:
 2354              		.cfi_endproc
 2355              	.LFE39:
 2357              		.section	.text.mbedtls_ssl_handle_message_type,"ax",%progbits
 2358              		.align	2
 2359              		.global	mbedtls_ssl_handle_message_type
 2360              		.syntax unified
 2361              		.arm
 2362              		.fpu neon
 2364              	mbedtls_ssl_handle_message_type:
 2365              	.LFB46:
5107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2366              		.loc 2 5107 0
 2367              		.cfi_startproc
 2368              		@ args = 0, pretend = 0, frame = 0
 2369              		@ frame_needed = 0, uses_anonymous_args = 0
 2370              	.LVL286:
5113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2371              		.loc 2 5113 0
 2372 0000 6C3090E5 		ldr	r3, [r0, #108]
5107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2373              		.loc 2 5107 0
 2374 0004 10402DE9 		push	{r4, lr}
 2375              		.cfi_def_cfa_offset 8
 2376              		.cfi_offset 4, -8
 2377              		.cfi_offset 14, -4
5107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2378              		.loc 2 5107 0
 2379 0008 0040A0E1 		mov	r4, r0
5113:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2380              		.loc 2 5113 0
 2381 000c 160053E3 		cmp	r3, #22
 2382 0010 0B00000A 		beq	.L203
 2383              	.LVL287:
 2384              	.L207:
5121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2385              		.loc 2 5121 0
 2386 0014 6C3094E5 		ldr	r3, [r4, #108]
 2387 0018 140053E3 		cmp	r3, #20
 2388 001c 0C00001A 		bne	.L216
5123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2389              		.loc 2 5123 0
 2390 0020 703094E5 		ldr	r3, [r4, #112]
 2391 0024 010053E3 		cmp	r3, #1
 2392 0028 1C00001A 		bne	.L211
5130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2393              		.loc 2 5130 0
 2394 002c 643094E5 		ldr	r3, [r4, #100]
5127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2395              		.loc 2 5127 0
 2396 0030 88009FE5 		ldr	r0, .L219
5130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2397              		.loc 2 5130 0
 2398 0034 0030D3E5 		ldrb	r3, [r3]	@ zero_extendqisi2
5127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2399              		.loc 2 5127 0
 2400 0038 010053E3 		cmp	r3, #1
 2401              	.L218:
5221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2402              		.loc 2 5221 0
 2403 003c 0000A003 		moveq	r0, #0
 2404 0040 1080BDE8 		pop	{r4, pc}
 2405              	.LVL288:
 2406              	.L203:
5115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2407              		.loc 2 5115 0
 2408 0044 FEFFFFEB 		bl	mbedtls_ssl_prepare_handshake_record
 2409              	.LVL289:
 2410 0048 000050E3 		cmp	r0, #0
 2411 004c F0FFFF0A 		beq	.L207
 2412 0050 1080BDE8 		pop	{r4, pc}
 2413              	.LVL290:
 2414              	.L216:
5154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2415              		.loc 2 5154 0
 2416 0054 150053E3 		cmp	r3, #21
 2417 0058 0E00001A 		bne	.L210
5156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2418              		.loc 2 5156 0
 2419 005c 703094E5 		ldr	r3, [r4, #112]
 2420 0060 020053E3 		cmp	r3, #2
 2421 0064 0D00001A 		bne	.L211
 2422              	.LVL291:
 2423              	.LBB158:
 2424              	.LBB159:
5172:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2425              		.loc 2 5172 0
 2426 0068 643094E5 		ldr	r3, [r4, #100]
 2427 006c 0020D3E5 		ldrb	r2, [r3]	@ zero_extendqisi2
 2428 0070 020052E3 		cmp	r2, #2
 2429 0074 0B00000A 		beq	.L212
5179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY )
 2430              		.loc 2 5179 0
 2431 0078 010052E3 		cmp	r2, #1
 2432 007c 0B00001A 		bne	.L213
5180:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2433              		.loc 2 5180 0
 2434 0080 0130D3E5 		ldrb	r3, [r3, #1]	@ zero_extendqisi2
5179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msg[1] == MBEDTLS_SSL_ALERT_MSG_CLOSE_NOTIFY )
 2435              		.loc 2 5179 0
 2436 0084 000053E3 		cmp	r3, #0
 2437 0088 0A00000A 		beq	.L214
 2438              	.LBE159:
 2439              	.LBE158:
5221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2440              		.loc 2 5221 0
 2441 008c 640053E3 		cmp	r3, #100
 2442 0090 2C009FE5 		ldr	r0, .L219+4
 2443 0094 E8FFFFEA 		b	.L218
 2444              	.LVL292:
 2445              	.L210:
 2446 0098 0000A0E3 		mov	r0, #0
 2447 009c 1080BDE8 		pop	{r4, pc}
 2448              	.L211:
5127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2449              		.loc 2 5127 0
 2450 00a0 18009FE5 		ldr	r0, .L219
 2451 00a4 1080BDE8 		pop	{r4, pc}
 2452              	.LVL293:
 2453              	.L212:
 2454              	.LBB161:
 2455              	.LBB160:
5176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2456              		.loc 2 5176 0
 2457 00a8 18009FE5 		ldr	r0, .L219+8
 2458 00ac 1080BDE8 		pop	{r4, pc}
 2459              	.L213:
5209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2460              		.loc 2 5209 0
 2461 00b0 0C009FE5 		ldr	r0, .L219+4
 2462 00b4 1080BDE8 		pop	{r4, pc}
 2463              	.L214:
5183:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2464              		.loc 2 5183 0
 2465 00b8 0C009FE5 		ldr	r0, .L219+12
 2466              	.LBE160:
 2467              	.LBE161:
5222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2468              		.loc 2 5222 0
 2469 00bc 1080BDE8 		pop	{r4, pc}
 2470              	.L220:
 2471              		.align	2
 2472              	.L219:
 2473 00c0 008EFFFF 		.word	-29184
 2474 00c4 8099FFFF 		.word	-26240
 2475 00c8 8088FFFF 		.word	-30592
 2476 00cc 8087FFFF 		.word	-30848
 2477              		.cfi_endproc
 2478              	.LFE46:
 2480              		.section	.text.mbedtls_ssl_send_alert_message,"ax",%progbits
 2481              		.align	2
 2482              		.global	mbedtls_ssl_send_alert_message
 2483              		.syntax unified
 2484              		.arm
 2485              		.fpu neon
 2487              	mbedtls_ssl_send_alert_message:
 2488              	.LFB48:
5241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2489              		.loc 2 5241 0
 2490              		.cfi_startproc
 2491              		@ args = 0, pretend = 0, frame = 0
 2492              		@ frame_needed = 0, uses_anonymous_args = 0
 2493              		@ link register save eliminated.
 2494              	.LVL294:
5244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 2495              		.loc 2 5244 0
 2496 0000 003050E2 		subs	r3, r0, #0
 2497 0004 0C00000A 		beq	.L224
5244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 2498              		.loc 2 5244 0 is_stmt 0 discriminator 1
 2499 0008 00C093E5 		ldr	ip, [r3]
 2500 000c 00005CE3 		cmp	ip, #0
 2501 0010 0900000A 		beq	.L224
5250:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen = 2;
 2502              		.loc 2 5250 0 is_stmt 1
 2503 0014 15C0A0E3 		mov	ip, #21
 2504 0018 9CC083E5 		str	ip, [r3, #156]
5251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0] = level;
 2505              		.loc 2 5251 0
 2506 001c 02C0A0E3 		mov	ip, #2
 2507 0020 A0C083E5 		str	ip, [r3, #160]
5252:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[1] = message;
 2508              		.loc 2 5252 0
 2509 0024 98C093E5 		ldr	ip, [r3, #152]
 2510 0028 0010CCE5 		strb	r1, [ip]
5255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2511              		.loc 2 5255 0
 2512 002c 0110A0E3 		mov	r1, #1
 2513              	.LVL295:
5253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2514              		.loc 2 5253 0
 2515 0030 983093E5 		ldr	r3, [r3, #152]
 2516 0034 0120C3E5 		strb	r2, [r3, #1]
 2517              	.LVL296:
5255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2518              		.loc 2 5255 0
 2519 0038 FEFFFFEA 		b	mbedtls_ssl_write_record
 2520              	.LVL297:
 2521              	.L224:
5245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2522              		.loc 2 5245 0
 2523 003c 00009FE5 		ldr	r0, .L225
 2524              	.LVL298:
5263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2525              		.loc 2 5263 0
 2526 0040 1EFF2FE1 		bx	lr
 2527              	.L226:
 2528              		.align	2
 2529              	.L225:
 2530 0044 008FFFFF 		.word	-28928
 2531              		.cfi_endproc
 2532              	.LFE48:
 2534              		.section	.text.mbedtls_ssl_send_fatal_handshake_failure,"ax",%progbits
 2535              		.align	2
 2536              		.global	mbedtls_ssl_send_fatal_handshake_failure
 2537              		.syntax unified
 2538              		.arm
 2539              		.fpu neon
 2541              	mbedtls_ssl_send_fatal_handshake_failure:
 2542              	.LFB47:
5225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2543              		.loc 2 5225 0
 2544              		.cfi_startproc
 2545              		@ args = 0, pretend = 0, frame = 0
 2546              		@ frame_needed = 0, uses_anonymous_args = 0
 2547              		@ link register save eliminated.
 2548              	.LVL299:
5228:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 2549              		.loc 2 5228 0
 2550 0000 2820A0E3 		mov	r2, #40
 2551 0004 0210A0E3 		mov	r1, #2
 2552 0008 FEFFFFEA 		b	mbedtls_ssl_send_alert_message
 2553              	.LVL300:
 2554              		.cfi_endproc
 2555              	.LFE47:
 2557              		.section	.text.mbedtls_ssl_read_record,"ax",%progbits
 2558              		.align	2
 2559              		.global	mbedtls_ssl_read_record
 2560              		.syntax unified
 2561              		.arm
 2562              		.fpu neon
 2564              	mbedtls_ssl_read_record:
 2565              	.LFB42:
4305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2566              		.loc 2 4305 0
 2567              		.cfi_startproc
 2568              		@ args = 0, pretend = 0, frame = 64
 2569              		@ frame_needed = 0, uses_anonymous_args = 0
 2570              	.LVL301:
4310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2571              		.loc 2 4310 0
 2572 0000 803090E5 		ldr	r3, [r0, #128]
4305:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 2573              		.loc 2 4305 0
 2574 0004 F04F2DE9 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 2575              		.cfi_def_cfa_offset 36
 2576              		.cfi_offset 4, -36
 2577              		.cfi_offset 5, -32
 2578              		.cfi_offset 6, -28
 2579              		.cfi_offset 7, -24
 2580              		.cfi_offset 8, -20
 2581              		.cfi_offset 9, -16
 2582              		.cfi_offset 10, -12
 2583              		.cfi_offset 11, -8
 2584              		.cfi_offset 14, -4
 2585 0008 64D04DE2 		sub	sp, sp, #100
 2586              		.cfi_def_cfa_offset 136
4310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2587              		.loc 2 4310 0
 2588 000c 000053E3 		cmp	r3, #0
4379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2589              		.loc 2 4379 0
 2590 0010 0080A013 		movne	r8, #0
 2591 0014 80808015 		strne	r8, [r0, #128]
4310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2592              		.loc 2 4310 0
 2593 0018 F301001A 		bne	.L228
 2594              	.LBB197:
 2595              	.LBB198:
 2596              	.LBB199:
 2597              	.LBB200:
 2598              	.LBB201:
 2599              	.LBB202:
 2600              	.LBB203:
2056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2601              		.loc 2 2056 0
 2602 001c F8779FE5 		ldr	r7, .L322
 2603 0020 0040A0E1 		mov	r4, r0
 2604 0024 20108DE5 		str	r1, [sp, #32]
 2605              	.LVL302:
 2606              	.L281:
 2607              	.LBE203:
 2608              	.LBE202:
 2609              	.LBE201:
 2610              	.LBE200:
 2611              	.LBE199:
 2612              	.LBE198:
 2613              	.LBE197:
 2614              	.LBB289:
 2615              	.LBB290:
4753:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2616              		.loc 2 4753 0
 2617 0028 781094E5 		ldr	r1, [r4, #120]
 2618 002c 683094E5 		ldr	r3, [r4, #104]
 2619 0030 000051E3 		cmp	r1, #0
 2620 0034 2800000A 		beq	.L230
4758:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2621              		.loc 2 4758 0
 2622 0038 000053E3 		cmp	r3, #0
 2623 003c F401001A 		bne	.L292
4785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2624              		.loc 2 4785 0
 2625 0040 702094E5 		ldr	r2, [r4, #112]
 2626 0044 020051E1 		cmp	r1, r2
4796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2627              		.loc 2 4796 0
 2628 0048 70308425 		strcs	r3, [r4, #112]
4785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2629              		.loc 2 4785 0
 2630 004c 0400002A 		bcs	.L233
4788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      ssl->in_msglen );
 2631              		.loc 2 4788 0
 2632 0050 640094E5 		ldr	r0, [r4, #100]
4787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memmove( ssl->in_msg, ssl->in_msg + ssl->in_hslen,
 2633              		.loc 2 4787 0
 2634 0054 012042E0 		sub	r2, r2, r1
 2635 0058 702084E5 		str	r2, [r4, #112]
4788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                      ssl->in_msglen );
 2636              		.loc 2 4788 0
 2637 005c 011080E0 		add	r1, r0, r1
 2638 0060 FEFFFFEB 		bl	memmove
 2639              	.LVL303:
 2640              	.L233:
4799:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2641              		.loc 2 4799 0
 2642 0064 0030A0E3 		mov	r3, #0
 2643 0068 783084E5 		str	r3, [r4, #120]
 2644              	.L234:
 2645              	.LVL304:
 2646 006c 709094E5 		ldr	r9, [r4, #112]
 2647              	.LVL305:
 2648              	.LBE290:
 2649              	.LBE289:
 2650              	.LBB292:
 2651              	.LBB293:
4817:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 1 );
 2652              		.loc 2 4817 0
 2653 0070 000059E3 		cmp	r9, #0
 2654 0074 E201001A 		bne	.L282
 2655              	.LVL306:
 2656              	.LBE293:
 2657              	.LBE292:
 2658              	.LBB294:
 2659              	.LBB284:
4968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2660              		.loc 2 4968 0
 2661 0078 0510A0E3 		mov	r1, #5
 2662 007c 0400A0E1 		mov	r0, r4
 2663 0080 FEFFFFEB 		bl	mbedtls_ssl_fetch_input
 2664              	.LVL307:
 2665 0084 008050E2 		subs	r8, r0, #0
 2666 0088 F400001A 		bne	.L283
 2667              	.LVL308:
 2668              	.LBB269:
 2669              	.LBB270:
4046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen = ( ssl->in_len[0] << 8 ) | ssl->in_len[1];
 2670              		.loc 2 4046 0
 2671 008c 582094E5 		ldr	r2, [r4, #88]
4047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, ssl->in_hdr + 1 );
 2672              		.loc 2 4047 0
 2673 0090 5C0094E5 		ldr	r0, [r4, #92]
 2674              	.LVL309:
4046:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen = ( ssl->in_len[0] << 8 ) | ssl->in_len[1];
 2675              		.loc 2 4046 0
 2676 0094 0030D2E5 		ldrb	r3, [r2]	@ zero_extendqisi2
 2677 0098 6C3084E5 		str	r3, [r4, #108]
4058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
 2678              		.loc 2 4058 0
 2679 009c 143043E2 		sub	r3, r3, #20
4047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, ssl->in_hdr + 1 );
 2680              		.loc 2 4047 0
 2681 00a0 00C0D0E5 		ldrb	ip, [r0]	@ zero_extendqisi2
4056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_ALERT &&
 2682              		.loc 2 4056 0
 2683 00a4 030053E3 		cmp	r3, #3
4047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, ssl->in_hdr + 1 );
 2684              		.loc 2 4047 0
 2685 00a8 0110D0E5 		ldrb	r1, [r0, #1]	@ zero_extendqisi2
4048:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2686              		.loc 2 4048 0
 2687 00ac 000094E5 		ldr	r0, [r4]
 2688              	.LVL310:
4047:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_read_version( &major_ver, &minor_ver, ssl->conf->transport, ssl->in_hdr + 1 );
 2689              		.loc 2 4047 0
 2690 00b0 0C1481E1 		orr	r1, r1, ip, lsl #8
 2691 00b4 701084E5 		str	r1, [r4, #112]
 2692              	.LBB271:
 2693              	.LBB272:
9516:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9517:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** void mbedtls_ssl_read_version( int *major, int *minor, int transport,
9520:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                        const unsigned char ver[2] )
9521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
9523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transport == MBEDTLS_SSL_TRANSPORT_DATAGRAM )
9524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *major = 255 - ver[0] + 2;
9526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *minor = 255 - ver[1] + 1;
9527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( *minor == MBEDTLS_SSL_MINOR_VERSION_1 )
9529:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ++*minor; /* DTLS 1.0 stored as TLS 1.1 internally */
9530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
9532:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else
9533:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) transport);
9534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *major = ver[0];
 2694              		.loc 2 9536 0
 2695 00b8 01C0D2E5 		ldrb	ip, [r2, #1]	@ zero_extendqisi2
 2696              	.LVL311:
9537:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *minor = ver[1];
 2697              		.loc 2 9537 0
 2698 00bc 0220D2E5 		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2699              	.LVL312:
 2700              	.LBE272:
 2701              	.LBE271:
4056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_msgtype != MBEDTLS_SSL_MSG_ALERT &&
 2702              		.loc 2 4056 0
 2703 00c0 0800009A 		bls	.L235
4068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
 2704              		.loc 2 4068 0
 2705 00c4 0A20A0E3 		mov	r2, #10
 2706              	.LVL313:
 2707 00c8 0210A0E3 		mov	r1, #2
 2708 00cc 0400A0E1 		mov	r0, r4
 2709 00d0 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 2710              	.LVL314:
 2711              	.L236:
 2712              	.LBE270:
 2713              	.LBE269:
 2714              	.LBE284:
 2715              	.LBE294:
4384:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 2716              		.loc 2 4384 0
 2717 00d4 44879FE5 		ldr	r8, .L322+4
 2718 00d8 C30100EA 		b	.L228
 2719              	.LVL315:
 2720              	.L230:
 2721              	.LBB295:
 2722              	.LBB291:
4802:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2723              		.loc 2 4802 0
 2724 00dc 000053E3 		cmp	r3, #0
4809:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2725              		.loc 2 4809 0
 2726 00e0 70308405 		streq	r3, [r4, #112]
 2727 00e4 E0FFFFEA 		b	.L234
 2728              	.LVL316:
 2729              	.L235:
 2730              	.LBE291:
 2731              	.LBE295:
 2732              	.LBB296:
 2733              	.LBB285:
 2734              	.LBB275:
 2735              	.LBB273:
4075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2736              		.loc 2 4075 0
 2737 00e8 083094E5 		ldr	r3, [r4, #8]
 2738 00ec 03005CE1 		cmp	ip, r3
 2739 00f0 F7FFFF1A 		bne	.L236
4081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2740              		.loc 2 4081 0
 2741 00f4 5D30D0E5 		ldrb	r3, [r0, #93]	@ zero_extendqisi2
 2742 00f8 030052E1 		cmp	r2, r3
 2743 00fc F4FFFFCA 		bgt	.L236
4089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2744              		.loc 2 4089 0
 2745 0100 643094E5 		ldr	r3, [r4, #100]
 2746 0104 502094E5 		ldr	r2, [r4, #80]
 2747              	.LVL317:
 2748 0108 023043E0 		sub	r3, r3, r2
 2749 010c 213C63E2 		rsb	r3, r3, #8448
 2750 0110 3D3083E2 		add	r3, r3, #61
4088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                          - (size_t)( ssl->in_msg - ssl->in_buf ) )
 2751              		.loc 2 4088 0
 2752 0114 030051E1 		cmp	r1, r3
 2753 0118 EDFFFF8A 		bhi	.L236
4179:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2754              		.loc 2 4179 0
 2755 011c 343094E5 		ldr	r3, [r4, #52]
 2756 0120 000053E3 		cmp	r3, #0
 2757 0124 3F00001A 		bne	.L237
4181:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen > MBEDTLS_SSL_IN_CONTENT_LEN )
 2758              		.loc 2 4181 0
 2759 0128 013041E2 		sub	r3, r1, #1
 2760 012c 020A53E3 		cmp	r3, #8192
 2761 0130 E7FFFF2A 		bcs	.L236
 2762              	.L238:
 2763              	.LVL318:
 2764              	.LBE273:
 2765              	.LBE275:
5019:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  mbedtls_ssl_hdr_len( ssl ) + ssl->in_msglen ) ) != 0 )
 2766              		.loc 2 5019 0
 2767 0134 051081E2 		add	r1, r1, #5
 2768 0138 0400A0E1 		mov	r0, r4
 2769 013c FEFFFFEB 		bl	mbedtls_ssl_fetch_input
 2770              	.LVL319:
 2771 0140 008050E2 		subs	r8, r0, #0
 2772 0144 C500001A 		bne	.L283
 2773              	.LBB276:
 2774              	.LBB262:
4248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2775              		.loc 2 4248 0
 2776 0148 345094E5 		ldr	r5, [r4, #52]
 2777              	.LBE262:
 2778              	.LBE276:
5038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2779              		.loc 2 5038 0
 2780 014c 748084E5 		str	r8, [r4, #116]
 2781              	.LVL320:
 2782              	.LBB277:
 2783              	.LBB263:
4248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2784              		.loc 2 4248 0
 2785 0150 000055E3 		cmp	r5, #0
 2786 0154 AA01000A 		beq	.L282
 2787              	.LVL321:
 2788              	.LBB257:
 2789              	.LBB252:
1795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2790              		.loc 2 1795 0
 2791 0158 201094E5 		ldr	r1, [r4, #32]
 2792 015c 000051E3 		cmp	r1, #0
 2793 0160 AB01000A 		beq	.L292
 2794              	.LVL322:
 2795              	.LBB210:
 2796              	.LBB211:
 435:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****         return MBEDTLS_MODE_NONE;
 2797              		.loc 3 435 0
 2798 0164 903095E5 		ldr	r3, [r5, #144]
 2799              	.LBE211:
 2800              	.LBE210:
1803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2801              		.loc 2 1803 0
 2802 0168 706094E5 		ldr	r6, [r4, #112]
 2803 016c 082095E5 		ldr	r2, [r5, #8]
 2804              	.LBB213:
 2805              	.LBB212:
 435:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****         return MBEDTLS_MODE_NONE;
 2806              		.loc 3 435 0
 2807 0170 000053E3 		cmp	r3, #0
 2808              		.loc 3 438 0
 2809 0174 0130D315 		ldrbne	r3, [r3, #1]	@ zero_extendqisi2
 436:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** 
 2810              		.loc 3 436 0
 2811 0178 0830A001 		moveq	r3, r8
 2812              	.LVL323:
 2813              	.LBE212:
 2814              	.LBE213:
1803:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 2815              		.loc 2 1803 0
 2816 017c 020056E1 		cmp	r6, r2
 2817 0180 7200003A 		bcc	.L286
1840:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mode == MBEDTLS_MODE_CHACHAPOLY )
 2818              		.loc 2 1840 0
 2819 0184 FD2003E2 		and	r2, r3, #253
 2820 0188 060053E3 		cmp	r3, #6
 2821 018c 08005213 		cmpne	r2, #8
 2822 0190 0120A003 		moveq	r2, #1
 2823 0194 0020A013 		movne	r2, #0
 2824 0198 7200001A 		bne	.L243
 2825              	.LVL324:
 2826              	.LBB214:
1850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 2827              		.loc 2 1850 0
 2828 019c 003095E5 		ldr	r3, [r5]
1852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2829              		.loc 2 1852 0
 2830 01a0 109095E5 		ldr	r9, [r5, #16]
1850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 2831              		.loc 2 1850 0
 2832 01a4 1C30D3E5 		ldrb	r3, [r3, #28]	@ zero_extendqisi2
 2833 01a8 020013E3 		tst	r3, #2
1852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2834              		.loc 2 1852 0
 2835 01ac 0C3095E5 		ldr	r3, [r5, #12]
1850:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                MBEDTLS_CIPHERSUITE_SHORT_TAG ? 8 : 16;
 2836              		.loc 2 1850 0
 2837 01b0 10B0A003 		moveq	fp, #16
 2838 01b4 08B0A013 		movne	fp, #8
 2839              	.LVL325:
1852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2840              		.loc 2 1852 0
 2841 01b8 092043E0 		sub	r2, r3, r9
 2842              	.LVL326:
1857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2843              		.loc 2 1857 0
 2844 01bc 0B1082E0 		add	r1, r2, fp
 2845 01c0 010056E1 		cmp	r6, r1
 2846 01c4 3E00003A 		bcc	.L301
1873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->in_msgtype;
 2847              		.loc 2 1873 0
 2848 01c8 548094E5 		ldr	r8, [r4, #84]
1864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2849              		.loc 2 1864 0
 2850 01cc 026046E0 		sub	r6, r6, r2
 2851 01d0 0B6046E0 		sub	r6, r6, fp
 2852              	.LVL327:
1873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->in_msgtype;
 2853              		.loc 2 1873 0
 2854 01d4 0820A0E3 		mov	r2, #8
 2855              	.LVL328:
1868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2856              		.loc 2 1868 0
 2857 01d8 706084E5 		str	r6, [r4, #112]
1873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->in_msgtype;
 2858              		.loc 2 1873 0
 2859 01dc 40008DE2 		add	r0, sp, #64
 2860              	.LVL329:
 2861 01e0 0810A0E1 		mov	r1, r8
 2862 01e4 24308DE5 		str	r3, [sp, #36]
1866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msg_result = ssl->in_msg;
 2863              		.loc 2 1866 0
 2864 01e8 64A094E5 		ldr	r10, [r4, #100]
 2865              	.LVL330:
1873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[8]  = ssl->in_msgtype;
 2866              		.loc 2 1873 0
 2867 01ec FEFFFFEB 		bl	memcpy
 2868              	.LVL331:
1874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 2869              		.loc 2 1874 0
 2870 01f0 6C2094E5 		ldr	r2, [r4, #108]
1885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2871              		.loc 2 1885 0
 2872 01f4 24309DE5 		ldr	r3, [sp, #36]
 2873              	.LBB215:
 2874              	.LBB216:
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 2875              		.loc 2 9514 0
 2876 01f8 081094E5 		ldr	r1, [r4, #8]
 2877              	.LBE216:
 2878              	.LBE215:
1874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_write_version( ssl->major_ver, ssl->minor_ver,
 2879              		.loc 2 1874 0
 2880 01fc 4820CDE5 		strb	r2, [sp, #72]
1875:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                            ssl->conf->transport, add_data + 9 );
 2881              		.loc 2 1875 0
 2882 0200 0C2094E5 		ldr	r2, [r4, #12]
 2883              	.LVL332:
1885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2884              		.loc 2 1885 0
 2885 0204 0C0053E3 		cmp	r3, #12
 2886              	.LBB219:
 2887              	.LBB217:
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 2888              		.loc 2 9514 0
 2889 0208 4910CDE5 		strb	r1, [sp, #73]
 2890              	.LVL333:
 2891              	.LBE217:
 2892              	.LBE219:
1878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2893              		.loc 2 1878 0
 2894 020c 4C60CDE5 		strb	r6, [sp, #76]
 2895              	.LBB220:
 2896              	.LBB218:
9515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2897              		.loc 2 9515 0
 2898 0210 4A20CDE5 		strb	r2, [sp, #74]
 2899              	.LVL334:
 2900              	.LBE218:
 2901              	.LBE220:
1877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         add_data[12] = ssl->in_msglen & 0xFF;
 2902              		.loc 2 1877 0
 2903 0214 2624A0E1 		lsr	r2, r6, #8
 2904 0218 4B20CDE5 		strb	r2, [sp, #75]
1885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2905              		.loc 2 1885 0
 2906 021c 0B00000A 		beq	.L246
 2907              	.LVL335:
 2908              	.L299:
 2909              	.LBE214:
 2910              	.LBB222:
2292:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 2911              		.loc 2 2292 0
 2912 0220 0780A0E1 		mov	r8, r7
 2913 0224 8A0000EA 		b	.L265
 2914              	.LVL336:
 2915              	.L237:
 2916              	.LBE222:
 2917              	.LBE252:
 2918              	.LBE257:
 2919              	.LBE263:
 2920              	.LBE277:
 2921              	.LBB278:
 2922              	.LBB274:
4190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2923              		.loc 2 4190 0
 2924 0228 083093E5 		ldr	r3, [r3, #8]
 2925 022c 030051E1 		cmp	r1, r3
 2926 0230 A7FFFF3A 		bcc	.L236
4209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen +
 2927              		.loc 2 4209 0
 2928 0234 0C2094E5 		ldr	r2, [r4, #12]
 2929 0238 000052E3 		cmp	r2, #0
 2930 023c BCFFFFDA 		ble	.L238
4211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2931              		.loc 2 4211 0
 2932 0240 213C83E2 		add	r3, r3, #8448
4209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen > ssl->transform_in->minlen +
 2933              		.loc 2 4209 0
 2934 0244 030051E1 		cmp	r1, r3
 2935 0248 B9FFFF9A 		bls	.L238
 2936 024c A0FFFFEA 		b	.L236
 2937              	.LVL337:
 2938              	.L246:
 2939              	.LBE274:
 2940              	.LBE278:
 2941              	.LBB279:
 2942              	.LBB264:
 2943              	.LBB258:
 2944              	.LBB253:
 2945              	.LBB240:
1885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2946              		.loc 2 1885 0
 2947 0250 040059E3 		cmp	r9, #4
 2948 0254 1C00001A 		bne	.L248
1888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( iv + transform->fixed_ivlen, ssl->in_iv, 8 );
 2949              		.loc 2 1888 0
 2950 0258 0920A0E1 		mov	r2, r9
 2951 025c 281085E2 		add	r1, r5, #40
 2952 0260 30008DE2 		add	r0, sp, #48
 2953 0264 FEFFFFEB 		bl	memcpy
 2954              	.LVL338:
1889:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 2955              		.loc 2 1889 0
 2956 0268 0820A0E3 		mov	r2, #8
 2957 026c 601094E5 		ldr	r1, [r4, #96]
 2958 0270 34008DE2 		add	r0, sp, #52
 2959 0274 FEFFFFEB 		bl	memcpy
 2960              	.LVL339:
 2961              	.L249:
1920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2962              		.loc 2 1920 0
 2963 0278 06308AE0 		add	r3, r10, r6
1915:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          iv, transform->ivlen,
 2964              		.loc 2 1915 0
 2965 027c 18B08DE5 		str	fp, [sp, #24]
 2966 0280 14308DE5 		str	r3, [sp, #20]
 2967 0284 2C308DE2 		add	r3, sp, #44
 2968 0288 10308DE5 		str	r3, [sp, #16]
 2969 028c 0D30A0E3 		mov	r3, #13
 2970 0290 00308DE5 		str	r3, [sp]
 2971 0294 0C20A0E3 		mov	r2, #12
 2972 0298 0CA08DE5 		str	r10, [sp, #12]
 2973 029c 40308DE2 		add	r3, sp, #64
 2974 02a0 08608DE5 		str	r6, [sp, #8]
 2975 02a4 30108DE2 		add	r1, sp, #48
 2976 02a8 04A08DE5 		str	r10, [sp, #4]
 2977 02ac 900085E2 		add	r0, r5, #144
 2978 02b0 FEFFFFEB 		bl	mbedtls_cipher_auth_decrypt
 2979              	.LVL340:
 2980 02b4 008050E2 		subs	r8, r0, #0
 2981 02b8 1300000A 		beq	.L252
1924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( MBEDTLS_ERR_SSL_INVALID_MAC );
 2982              		.loc 2 1924 0
 2983 02bc 630C78E3 		cmn	r8, #25344
 2984 02c0 6300001A 		bne	.L265
 2985              	.LVL341:
 2986              	.L301:
 2987              	.LBE240:
 2988              	.LBB241:
2315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 2989              		.loc 2 2315 0
 2990 02c4 58859FE5 		ldr	r8, .L322+8
 2991 02c8 610000EA 		b	.L265
 2992              	.LVL342:
 2993              	.L248:
 2994              	.LBE241:
 2995              	.LBB242:
1892:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 2996              		.loc 2 1892 0
 2997 02cc 0C0059E3 		cmp	r9, #12
 2998 02d0 D2FFFF1A 		bne	.L299
 2999              	.LBB221:
1897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3000              		.loc 2 1897 0
 3001 02d4 0920A0E1 		mov	r2, r9
 3002 02d8 281085E2 		add	r1, r5, #40
 3003 02dc 30008DE2 		add	r0, sp, #48
 3004 02e0 FEFFFFEB 		bl	memcpy
 3005              	.LVL343:
 3006 02e4 013048E2 		sub	r3, r8, #1
 3007 02e8 33208DE2 		add	r2, sp, #51
 3008 02ec 078088E2 		add	r8, r8, #7
 3009              	.LVL344:
 3010              	.L251:
1900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3011              		.loc 2 1900 0
 3012 02f0 0100F3E5 		ldrb	r0, [r3, #1]!	@ zero_extendqisi2
 3013 02f4 0110D2E5 		ldrb	r1, [r2, #1]	@ zero_extendqisi2
1899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv[i+4] ^= ssl->in_ctr[i];
 3014              		.loc 2 1899 0
 3015 02f8 030058E1 		cmp	r8, r3
1900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3016              		.loc 2 1900 0
 3017 02fc 001021E0 		eor	r1, r1, r0
 3018 0300 0110E2E5 		strb	r1, [r2, #1]!
 3019              	.LVL345:
1899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 iv[i+4] ^= ssl->in_ctr[i];
 3020              		.loc 2 1899 0
 3021 0304 F9FFFF1A 		bne	.L251
 3022 0308 DAFFFFEA 		b	.L249
 3023              	.LVL346:
 3024              	.L252:
 3025              	.LBE221:
1931:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3026              		.loc 2 1931 0
 3027 030c 2C309DE5 		ldr	r3, [sp, #44]
 3028 0310 030056E1 		cmp	r6, r3
 3029 0314 C1FFFF1A 		bne	.L299
 3030              	.LVL347:
 3031              	.L253:
 3032              	.LBE242:
2326:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3033              		.loc 2 2326 0
 3034 0318 703094E5 		ldr	r3, [r4, #112]
 3035 031c 000053E3 		cmp	r3, #0
 3036 0320 2301001A 		bne	.L274
2329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             && ssl->in_msgtype != MBEDTLS_SSL_MSG_APPLICATION_DATA )
 3037              		.loc 2 2329 0
 3038 0324 0C3094E5 		ldr	r3, [r4, #12]
 3039 0328 030053E3 		cmp	r3, #3
 3040 032c 0200001A 		bne	.L275
2330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3041              		.loc 2 2330 0
 3042 0330 6C3094E5 		ldr	r3, [r4, #108]
 3043 0334 170053E3 		cmp	r3, #23
 3044 0338 65FFFF1A 		bne	.L236
 3045              	.L275:
2338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3046              		.loc 2 2338 0
 3047 033c 7C3094E5 		ldr	r3, [r4, #124]
 3048 0340 013083E2 		add	r3, r3, #1
2344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3049              		.loc 2 2344 0
 3050 0344 030053E3 		cmp	r3, #3
2338:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3051              		.loc 2 2338 0
 3052 0348 7C3084E5 		str	r3, [r4, #124]
2344:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3053              		.loc 2 2344 0
 3054 034c 1A0100DA 		ble	.L277
 3055              	.LVL348:
 3056              	.L286:
 3057              	.LBE253:
 3058              	.LBE258:
 3059              	.LBE264:
 3060              	.LBE279:
5094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 3061              		.loc 2 5094 0
 3062 0350 1420A0E3 		mov	r2, #20
 3063 0354 0210A0E3 		mov	r1, #2
 3064 0358 0400A0E1 		mov	r0, r4
 3065 035c C0849FE5 		ldr	r8, .L322+8
 3066 0360 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 3067              	.LVL349:
 3068 0364 200100EA 		b	.L228
 3069              	.LVL350:
 3070              	.L243:
 3071              	.LBB280:
 3072              	.LBB265:
 3073              	.LBB259:
 3074              	.LBB254:
1941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3075              		.loc 2 1941 0
 3076 0368 020053E3 		cmp	r3, #2
 3077 036c 2801001A 		bne	.L292
 3078              	.LVL351:
 3079              	.LBB243:
1951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3080              		.loc 2 1951 0
 3081 0370 2C208DE5 		str	r2, [sp, #44]
1957:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             minlen += ssl->transform_in->ivlen;
 3082              		.loc 2 1957 0
 3083 0374 0C2094E5 		ldr	r2, [r4, #12]
 3084 0378 0C3095E5 		ldr	r3, [r5, #12]
1958:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 3085              		.loc 2 1958 0
 3086 037c 010052E3 		cmp	r2, #1
 3087 0380 0390A0C1 		movgt	r9, r3
 3088              	.LVL352:
1961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen < minlen + ssl->transform_in->maclen + 1 )
 3089              		.loc 2 1961 0
 3090 0384 033089E0 		add	r3, r9, r3
 3091 0388 030056E1 		cmp	r6, r3
 3092 038c 2E00003A 		bcc	.L255
1962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3093              		.loc 2 1962 0
 3094 0390 142095E5 		ldr	r2, [r5, #20]
 3095 0394 013082E2 		add	r3, r2, #1
 3096 0398 099083E0 		add	r9, r3, r9
 3097              	.LVL353:
1961:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen < minlen + ssl->transform_in->maclen + 1 )
 3098              		.loc 2 1961 0
 3099 039c 090056E1 		cmp	r6, r9
 3100 03a0 2900003A 		bcc	.L255
 3101              	.LVL354:
1979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3102              		.loc 2 1979 0
 3103 03a4 689091E5 		ldr	r9, [r1, #104]
1972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dec_msg_result = ssl->in_msg;
 3104              		.loc 2 1972 0
 3105 03a8 64A094E5 		ldr	r10, [r4, #100]
 3106              	.LVL355:
1979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3107              		.loc 2 1979 0
 3108 03ac 010059E3 		cmp	r9, #1
 3109 03b0 3C00001A 		bne	.L256
 3110              	.LBB204:
1986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen -= ssl->transform_in->maclen;
 3111              		.loc 2 1986 0
 3112 03b4 026046E0 		sub	r6, r6, r2
 3113              	.LVL356:
1989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->in_hdr, 3 );
 3114              		.loc 2 1989 0
 3115 03b8 541094E5 		ldr	r1, [r4, #84]
 3116 03bc 0820A0E3 		mov	r2, #8
1987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3117              		.loc 2 1987 0
 3118 03c0 706084E5 		str	r6, [r4, #112]
1989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             memcpy( pseudo_hdr +  8, ssl->in_hdr, 3 );
 3119              		.loc 2 1989 0
 3120 03c4 30008DE2 		add	r0, sp, #48
 3121              	.LVL357:
 3122 03c8 FEFFFFEB 		bl	memcpy
 3123              	.LVL358:
1990:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[11] = (unsigned char)( ( ssl->in_msglen >> 8 ) & 0xFF );
 3124              		.loc 2 1990 0
 3125 03cc 0320A0E3 		mov	r2, #3
 3126 03d0 581094E5 		ldr	r1, [r4, #88]
 3127 03d4 38008DE2 		add	r0, sp, #56
 3128 03d8 FEFFFFEB 		bl	memcpy
 3129              	.LVL359:
1991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->in_msglen      ) & 0xFF );
 3130              		.loc 2 1991 0
 3131 03dc 2634A0E1 		lsr	r3, r6, #8
1996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec,
 3132              		.loc 2 1996 0
 3133 03e0 0D20A0E3 		mov	r2, #13
 3134 03e4 30108DE2 		add	r1, sp, #48
1992:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3135              		.loc 2 1992 0
 3136 03e8 3C60CDE5 		strb	r6, [sp, #60]
1996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec,
 3137              		.loc 2 1996 0
 3138 03ec 440085E2 		add	r0, r5, #68
1991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             pseudo_hdr[12] = (unsigned char)( ( ssl->in_msglen      ) & 0xFF );
 3139              		.loc 2 1991 0
 3140 03f0 3B30CDE5 		strb	r3, [sp, #59]
1996:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec,
 3141              		.loc 2 1996 0
 3142 03f4 FEFFFFEB 		bl	mbedtls_md_hmac_update
 3143              	.LVL360:
1997:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->in_iv, ssl->in_msglen );
 3144              		.loc 2 1997 0
 3145 03f8 340094E5 		ldr	r0, [r4, #52]
 3146 03fc 702094E5 		ldr	r2, [r4, #112]
 3147 0400 601094E5 		ldr	r1, [r4, #96]
 3148 0404 440080E2 		add	r0, r0, #68
 3149 0408 FEFFFFEB 		bl	mbedtls_md_hmac_update
 3150              	.LVL361:
1999:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_reset( &ssl->transform_in->md_ctx_dec );
 3151              		.loc 2 1999 0
 3152 040c 340094E5 		ldr	r0, [r4, #52]
 3153 0410 40108DE2 		add	r1, sp, #64
 3154 0414 440080E2 		add	r0, r0, #68
 3155 0418 FEFFFFEB 		bl	mbedtls_md_hmac_finish
 3156              	.LVL362:
2000:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3157              		.loc 2 2000 0
 3158 041c 340094E5 		ldr	r0, [r4, #52]
 3159 0420 440080E2 		add	r0, r0, #68
 3160 0424 FEFFFFEB 		bl	mbedtls_md_hmac_reset
 3161              	.LVL363:
2007:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                           ssl->transform_in->maclen ) != 0 )
 3162              		.loc 2 2007 0
 3163 0428 342094E5 		ldr	r2, [r4, #52]
 3164 042c 40108DE2 		add	r1, sp, #64
 3165 0430 600094E5 		ldr	r0, [r4, #96]
 3166 0434 703094E5 		ldr	r3, [r4, #112]
 3167 0438 142092E5 		ldr	r2, [r2, #20]
 3168 043c 030080E0 		add	r0, r0, r3
 3169 0440 FEFFFFEB 		bl	mbedtls_ssl_safer_memcmp
 3170              	.LVL364:
 3171 0444 000050E3 		cmp	r0, #0
 3172 0448 1500000A 		beq	.L257
 3173              	.LVL365:
 3174              	.L255:
 3175              	.LBE204:
1968:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3176              		.loc 2 1968 0
 3177 044c D0539FE5 		ldr	r5, .L322+8
 3178              	.LVL366:
 3179              	.L258:
 3180 0450 0580A0E1 		mov	r8, r5
 3181              	.LVL367:
 3182              	.L265:
 3183              	.LBE243:
 3184              	.LBE254:
 3185              	.LBE259:
 3186              	.LBE265:
 3187              	.LBE280:
5092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3188              		.loc 2 5092 0
 3189 0454 C8339FE5 		ldr	r3, .L322+8
 3190 0458 030058E1 		cmp	r8, r3
 3191 045c BBFFFF0A 		beq	.L286
 3192              	.LVL368:
 3193              	.L283:
 3194              	.LBE285:
 3195              	.LBE296:
4336:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         continue;
 3196              		.loc 2 4336 0
 3197 0460 C0339FE5 		ldr	r3, .L322+12
 3198 0464 030058E1 		cmp	r8, r3
 3199 0468 DF00001A 		bne	.L228
 3200              	.LVL369:
 3201              	.L287:
4361:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                  MBEDTLS_ERR_SSL_CONTINUE_PROCESSING == ret );
 3202              		.loc 2 4361 0
 3203 046c 663C88E2 		add	r3, r8, #26112
 3204 0470 803083E2 		add	r3, r3, #128
4362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3205              		.loc 2 4362 0
 3206 0474 013CD3E3 		bics	r3, r3, #256
 3207 0478 EAFEFF0A 		beq	.L281
4364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3208              		.loc 2 4364 0
 3209 047c 000058E3 		cmp	r8, #0
 3210 0480 D900001A 		bne	.L228
 3211              	.LVL370:
 3212              	.LBB297:
 3213              	.LBB298:
4370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             update_hs_digest == 1 )
 3214              		.loc 2 4370 0
 3215 0484 6C3094E5 		ldr	r3, [r4, #108]
 3216 0488 20209DE5 		ldr	r2, [sp, #32]
 3217 048c 160053E3 		cmp	r3, #22
 3218 0490 01005203 		cmpeq	r2, #1
 3219 0494 D400001A 		bne	.L228
4373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3220              		.loc 2 4373 0
 3221 0498 0400A0E1 		mov	r0, r4
 3222 049c FEFFFFEB 		bl	mbedtls_ssl_update_handshake_status
 3223              	.LVL371:
 3224 04a0 D10000EA 		b	.L228
 3225              	.LVL372:
 3226              	.L257:
 3227              	.LBE298:
 3228              	.LBE297:
 3229              	.LBB299:
 3230              	.LBB286:
 3231              	.LBB281:
 3232              	.LBB266:
 3233              	.LBB260:
 3234              	.LBB255:
 3235              	.LBB244:
 3236              	.LBB205:
2014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3237              		.loc 2 2014 0
 3238 04a4 0980A0E1 		mov	r8, r9
 3239              	.LVL373:
 3240              	.L256:
 3241              	.LBE205:
2021:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3242              		.loc 2 2021 0
 3243 04a8 345094E5 		ldr	r5, [r4, #52]
 3244 04ac 703094E5 		ldr	r3, [r4, #112]
 3245 04b0 0CB095E5 		ldr	fp, [r5, #12]
 3246 04b4 0300A0E1 		mov	r0, r3
 3247 04b8 24308DE5 		str	r3, [sp, #36]
 3248 04bc 0B10A0E1 		mov	r1, fp
 3249 04c0 FEFFFFEB 		bl	__aeabi_uidivmod
 3250              	.LVL374:
 3251 04c4 009051E2 		subs	r9, r1, #0
 3252 04c8 DFFFFF1A 		bne	.L255
2032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3253              		.loc 2 2032 0
 3254 04cc 0C2094E5 		ldr	r2, [r4, #12]
 3255 04d0 010052E3 		cmp	r2, #1
 3256 04d4 080000DA 		ble	.L259
 3257              	.LBB206:
2036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3258              		.loc 2 2036 0
 3259 04d8 24309DE5 		ldr	r3, [sp, #36]
2035:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msglen -= ssl->transform_in->ivlen;
 3260              		.loc 2 2035 0
 3261 04dc 0B6046E0 		sub	r6, r6, fp
 3262              	.LVL375:
2036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3263              		.loc 2 2036 0
 3264 04e0 0920A0E1 		mov	r2, r9
 3265 04e4 0B3043E0 		sub	r3, r3, fp
 3266 04e8 703084E5 		str	r3, [r4, #112]
 3267              	.LVL376:
 3268              	.L260:
 3269 04ec 7230EFE6 		uxtb	r3, r2
 3270 04f0 012082E2 		add	r2, r2, #1
 3271              	.LVL377:
2038:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ssl->transform_in->iv_dec[i] = ssl->in_iv[i];
 3272              		.loc 2 2038 0
 3273 04f4 03005BE1 		cmp	fp, r3
 3274 04f8 9B00008A 		bhi	.L261
 3275              	.LVL378:
 3276              	.L259:
 3277              	.LBE206:
2043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl->transform_in->iv_dec,
 3278              		.loc 2 2043 0
 3279 04fc 2C308DE2 		add	r3, sp, #44
 3280 0500 281085E2 		add	r1, r5, #40
 3281 0504 08308DE5 		str	r3, [sp, #8]
 3282 0508 900085E2 		add	r0, r5, #144
 3283 050c 40048DE8 		stm	sp, {r6, r10}
 3284 0510 0A30A0E1 		mov	r3, r10
 3285 0514 0B20A0E1 		mov	r2, fp
 3286 0518 FEFFFFEB 		bl	mbedtls_cipher_crypt
 3287              	.LVL379:
 3288 051c 005050E2 		subs	r5, r0, #0
 3289 0520 CAFFFF1A 		bne	.L258
2053:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3290              		.loc 2 2053 0
 3291 0524 2C309DE5 		ldr	r3, [sp, #44]
 3292 0528 030056E1 		cmp	r6, r3
 3293 052c 9300001A 		bne	.L295
2071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3294              		.loc 2 2071 0
 3295 0530 703094E5 		ldr	r3, [r4, #112]
2073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done == 0 )
 3296              		.loc 2 2073 0
 3297 0534 018028E2 		eor	r8, r8, #1
2071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3298              		.loc 2 2071 0
 3299 0538 64E094E5 		ldr	lr, [r4, #100]
2073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done == 0 )
 3300              		.loc 2 2073 0
 3301 053c 018008E2 		and	r8, r8, #1
 3302 0540 341094E5 		ldr	r1, [r4, #52]
2071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3303              		.loc 2 2071 0
 3304 0544 03208EE0 		add	r2, lr, r3
 3305 0548 01B052E5 		ldrb	fp, [r2, #-1]	@ zero_extendqisi2
2073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done == 0 )
 3306              		.loc 2 2073 0
 3307 054c 14C091E5 		ldr	ip, [r1, #20]
2071:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3308              		.loc 2 2071 0
 3309 0550 01208BE2 		add	r2, fp, #1
 3310              	.LVL380:
2073:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             auth_done == 0 )
 3311              		.loc 2 2073 0
 3312 0554 0C1082E0 		add	r1, r2, ip
 3313 0558 010053E1 		cmp	r3, r1
 3314 055c 0010A023 		movcs	r1, #0
 3315 0560 01100832 		andcc	r1, r8, #1
 3316 0564 000051E3 		cmp	r1, #0
2101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3317              		.loc 2 2101 0
 3318 0568 0C1094E5 		ldr	r1, [r4, #12]
 3319              	.LBE244:
1790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 3320              		.loc 2 1790 0
 3321 056c 0150A003 		moveq	r5, #1
 3322              	.LBB245:
2080:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct = 0;
 3323              		.loc 2 2080 0
 3324 0570 0520A011 		movne	r2, r5
 3325              	.LVL381:
2101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3326              		.loc 2 2101 0
 3327 0574 000051E3 		cmp	r1, #0
 3328 0578 800000DA 		ble	.L295
 3329              	.LVL382:
 3330              	.LBB207:
2108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t i;
 3331              		.loc 2 2108 0
 3332 057c 02B043E0 		sub	fp, r3, r2
2122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        ssl->transform_in->maclen );
 3333              		.loc 2 2122 0
 3334 0580 020A8CE2 		add	r0, ip, #8192
 3335              	.LVL383:
2121:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             correct &= ( padding_idx <= MBEDTLS_SSL_IN_CONTENT_LEN +
 3336              		.loc 2 2121 0
 3337 0584 020053E1 		cmp	r3, r2
 3338 0588 0050A033 		movcc	r5, #0
 3339 058c 01500522 		andcs	r5, r5, #1
 3340              	.LVL384:
2107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t padding_idx = ssl->in_msglen - padlen;
 3341              		.loc 2 2107 0
 3342 0590 0160A0E3 		mov	r6, #1
 3343              	.LVL385:
2122:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                        ssl->transform_in->maclen );
 3344              		.loc 2 2122 0
 3345 0594 00005BE1 		cmp	fp, r0
 3346 0598 0050A083 		movhi	r5, #0
 3347 059c 01500592 		andls	r5, r5, #1
 3348              	.LVL386:
2107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             size_t padding_idx = ssl->in_msglen - padlen;
 3349              		.loc 2 2107 0
 3350 05a0 0000A0E3 		mov	r0, #0
2131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 3351              		.loc 2 2131 0
 3352 05a4 95EB2BE0 		mla	fp, r5, fp, lr
 3353              	.LVL387:
2127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3354              		.loc 2 2127 0
 3355 05a8 0010A0E1 		mov	r1, r0
2131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 3356              		.loc 2 2131 0
 3357 05ac 01A042E2 		sub	r10, r2, #1
 3358              	.LVL388:
 3359              	.L263:
 3360 05b0 01E0DBE7 		ldrb	lr, [fp, r1]	@ zero_extendqisi2
2129:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 pad_count += real_count *
 3361              		.loc 2 2129 0
 3362 05b4 010052E1 		cmp	r2, r1
 3363 05b8 0060A093 		movls	r6, #0
 3364 05bc 01600682 		andhi	r6, r6, #1
 3365              	.LVL389:
2127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3366              		.loc 2 2127 0
 3367 05c0 011081E2 		add	r1, r1, #1
 3368              	.LVL390:
 3369 05c4 010C51E3 		cmp	r1, #256
2131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 3370              		.loc 2 2131 0
 3371 05c8 0AE04EE0 		sub	lr, lr, r10
 3372 05cc 1EEF6FE1 		clz	lr, lr
 3373 05d0 AEE2A0E1 		lsr	lr, lr, #5
2130:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ( ssl->in_msg[padding_idx + i] == padlen - 1 );
 3374              		.loc 2 2130 0
 3375 05d4 960E20E0 		mla	r0, r6, lr, r0
 3376              	.LVL391:
2127:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3377              		.loc 2 2127 0
 3378 05d8 F4FFFF1A 		bne	.L263
2134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3379              		.loc 2 2134 0
 3380 05dc 000052E1 		cmp	r2, r0
 3381 05e0 0050A013 		movne	r5, #0
 3382 05e4 01500502 		andeq	r5, r5, #1
 3383              	.LVL392:
 3384              	.LBE207:
 3385              	.LBE245:
2170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3386              		.loc 2 2170 0
 3387 05e8 000058E3 		cmp	r8, #0
 3388              	.LBB246:
 3389              	.LBB208:
2140:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3390              		.loc 2 2140 0
 3391 05ec 85B4A0E1 		lsl	fp, r5, #9
 3392 05f0 05B04BE0 		sub	fp, fp, r5
 3393 05f4 02B00BE0 		and	fp, fp, r2
 3394              	.LVL393:
 3395              	.LBE208:
2150:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 3396              		.loc 2 2150 0
 3397 05f8 0B3043E0 		sub	r3, r3, fp
 3398 05fc 703084E5 		str	r3, [r4, #112]
 3399              	.LBE246:
2170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3400              		.loc 2 2170 0
 3401 0600 44FFFF0A 		beq	.L253
 3402              	.LBB247:
2174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3403              		.loc 2 2174 0
 3404 0604 0CC043E0 		sub	ip, r3, ip
2176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len[1] = (unsigned char)( ssl->in_msglen      );
 3405              		.loc 2 2176 0
 3406 0608 5C3094E5 		ldr	r3, [r4, #92]
2174:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3407              		.loc 2 2174 0
 3408 060c 70C084E5 		str	ip, [r4, #112]
2176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len[1] = (unsigned char)( ssl->in_msglen      );
 3409              		.loc 2 2176 0
 3410 0610 2CC4A0E1 		lsr	ip, ip, #8
 3411 0614 00C0C3E5 		strb	ip, [r3]
2177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3412              		.loc 2 2177 0
 3413 0618 5C3094E5 		ldr	r3, [r4, #92]
 3414 061c 702094E5 		ldr	r2, [r4, #112]
 3415 0620 0120C3E5 		strb	r2, [r3, #1]
2192:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3416              		.loc 2 2192 0
 3417 0624 0C3094E5 		ldr	r3, [r4, #12]
 3418 0628 000053E3 		cmp	r3, #0
 3419 062c FBFEFFDA 		ble	.L299
 3420              	.LVL394:
 3421              	.LBB223:
2236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3422              		.loc 2 2236 0
 3423 0630 340094E5 		ldr	r0, [r4, #52]
 3424              	.LVL395:
2233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t min_len = ( max_len > 256 ) ? max_len - 256 : 0;
 3425              		.loc 2 2233 0
 3426 0634 703094E5 		ldr	r3, [r4, #112]
2236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3427              		.loc 2 2236 0
 3428 0638 002090E5 		ldr	r2, [r0]
2233:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             const size_t min_len = ( max_len > 256 ) ? max_len - 256 : 0;
 3429              		.loc 2 2233 0
 3430 063c 03608BE0 		add	r6, fp, r3
 3431              	.LVL396:
2234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3432              		.loc 2 2234 0
 3433 0640 010C56E3 		cmp	r6, #256
2236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 3434              		.loc 2 2236 0
 3435 0644 0910D2E5 		ldrb	r1, [r2, #9]	@ zero_extendqisi2
 3436              	.LVL397:
2234:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3437              		.loc 2 2234 0
 3438 0648 01AC4682 		subhi	r10, r6, #256
 3439 064c 00A0A093 		movls	r10, #0
 3440              	.LVL398:
 3441 0650 060051E3 		cmp	r1, #6
 3442 0654 F1FEFF8A 		bhi	.L299
 3443 0658 0120A0E3 		mov	r2, #1
 3444 065c 1221A0E1 		lsl	r2, r2, r1
 3445 0660 580012E3 		tst	r2, #88
 3446 0664 EDFEFF0A 		beq	.L299
2245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     break;
 3447              		.loc 2 2245 0
 3448 0668 158083E2 		add	r8, r3, #21
2244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 8 ) / 64;
 3449              		.loc 2 2244 0
 3450 066c 152086E2 		add	r2, r6, #21
2245:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     break;
 3451              		.loc 2 2245 0
 3452 0670 2883A0E1 		lsr	r8, r8, #6
2262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_hdr, 3 );
 3453              		.loc 2 2262 0
 3454 0674 541094E5 		ldr	r1, [r4, #84]
 3455 0678 440080E2 		add	r0, r0, #68
2244:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ( 13 + ssl->in_msglen          + 8 ) / 64;
 3456              		.loc 2 2244 0
 3457 067c 223368E0 		rsb	r3, r8, r2, lsr #6
 3458              	.LVL399:
2260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3459              		.loc 2 2260 0
 3460 0680 0584A0E1 		lsl	r8, r5, #8
2262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_hdr, 3 );
 3461              		.loc 2 2262 0
 3462 0684 0820A0E3 		mov	r2, #8
2260:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3463              		.loc 2 2260 0
 3464 0688 058048E0 		sub	r8, r8, r5
 3465 068c 038008E0 		and	r8, r8, r3
 3466              	.LVL400:
2262:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_hdr, 3 );
 3467              		.loc 2 2262 0
 3468 0690 FEFFFFEB 		bl	mbedtls_md_hmac_update
 3469              	.LVL401:
2263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_len, 2 );
 3470              		.loc 2 2263 0
 3471 0694 340094E5 		ldr	r0, [r4, #52]
 3472 0698 0320A0E3 		mov	r2, #3
 3473 069c 581094E5 		ldr	r1, [r4, #88]
 3474 06a0 440080E2 		add	r0, r0, #68
 3475 06a4 FEFFFFEB 		bl	mbedtls_md_hmac_update
 3476              	.LVL402:
2264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_update( &ssl->transform_in->md_ctx_dec, ssl->in_msg,
 3477              		.loc 2 2264 0
 3478 06a8 340094E5 		ldr	r0, [r4, #52]
 3479 06ac 0220A0E3 		mov	r2, #2
 3480 06b0 5C1094E5 		ldr	r1, [r4, #92]
 3481 06b4 440080E2 		add	r0, r0, #68
 3482 06b8 FEFFFFEB 		bl	mbedtls_md_hmac_update
 3483              	.LVL403:
2265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                              ssl->in_msglen );
 3484              		.loc 2 2265 0
 3485 06bc 340094E5 		ldr	r0, [r4, #52]
 3486 06c0 702094E5 		ldr	r2, [r4, #112]
 3487 06c4 641094E5 		ldr	r1, [r4, #100]
 3488 06c8 440080E2 		add	r0, r0, #68
 3489 06cc FEFFFFEB 		bl	mbedtls_md_hmac_update
 3490              	.LVL404:
2270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_md_hmac_finish( &ssl->transform_in->md_ctx_dec, mac_expect );
 3491              		.loc 2 2270 0
 3492 06d0 702094E5 		ldr	r2, [r4, #112]
 3493 06d4 643094E5 		ldr	r3, [r4, #100]
 3494 06d8 023083E0 		add	r3, r3, r2
 3495              	.LVL405:
 3496              	.LBB224:
 3497              	.LBB225:
1425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     volatile unsigned char force;
 3498              		.loc 2 1425 0
 3499 06dc 0020A0E3 		mov	r2, #0
 3500 06e0 0BB083E0 		add	fp, r3, fp
 3501              	.LVL406:
 3502              	.L268:
1428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         acc ^= *p;
 3503              		.loc 2 1428 0
 3504 06e4 0B0053E1 		cmp	r3, fp
 3505 06e8 2600001A 		bne	.L269
 3506              	.LBE225:
 3507              	.LBE224:
2271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3508              		.loc 2 2271 0
 3509 06ec 340094E5 		ldr	r0, [r4, #52]
2275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3510              		.loc 2 2275 0
 3511 06f0 018088E2 		add	r8, r8, #1
 3512              	.LVL407:
2271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3513              		.loc 2 2271 0
 3514 06f4 40108DE2 		add	r1, sp, #64
 3515              	.LBB228:
 3516              	.LBB226:
1431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     (void) force;
 3517              		.loc 2 1431 0
 3518 06f8 2A20CDE5 		strb	r2, [sp, #42]
1432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 3519              		.loc 2 1432 0
 3520 06fc 2A30DDE5 		ldrb	r3, [sp, #42]	@ zero_extendqisi2
 3521              	.LVL408:
 3522              	.LBE226:
 3523              	.LBE228:
2271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3524              		.loc 2 2271 0
 3525 0700 440080E2 		add	r0, r0, #68
 3526 0704 FEFFFFEB 		bl	mbedtls_md_hmac_finish
 3527              	.LVL409:
 3528              	.L270:
2275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3529              		.loc 2 2275 0
 3530 0708 080059E1 		cmp	r9, r8
 3531 070c 340094E5 		ldr	r0, [r4, #52]
 3532 0710 1F00003A 		bcc	.L271
2278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3533              		.loc 2 2278 0
 3534 0714 440080E2 		add	r0, r0, #68
 3535 0718 FEFFFFEB 		bl	mbedtls_md_hmac_reset
 3536              	.LVL410:
2285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3537              		.loc 2 2285 0
 3538 071c 342094E5 		ldr	r2, [r4, #52]
 3539              	.LBB229:
 3540              	.LBB230:
1425:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     volatile unsigned char force;
 3541              		.loc 2 1425 0
 3542 0720 0010A0E3 		mov	r1, #0
 3543              	.LBE230:
 3544              	.LBE229:
2284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
 3545              		.loc 2 2284 0
 3546 0724 643094E5 		ldr	r3, [r4, #100]
2285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3547              		.loc 2 2285 0
 3548 0728 142092E5 		ldr	r2, [r2, #20]
2284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  max_len - min_len + ssl->transform_in->maclen );
 3549              		.loc 2 2284 0
 3550 072c 0AA083E0 		add	r10, r3, r10
 3551              	.LVL411:
 3552 0730 026086E0 		add	r6, r6, r2
 3553              	.LVL412:
 3554 0734 066083E0 		add	r6, r3, r6
 3555              	.LVL413:
 3556              	.L272:
 3557              	.LBB234:
 3558              	.LBB231:
1428:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         acc ^= *p;
 3559              		.loc 2 1428 0
 3560 0738 06005AE1 		cmp	r10, r6
 3561 073c 1900001A 		bne	.L273
 3562              	.LBE231:
 3563              	.LBE234:
 3564              	.LBE223:
2301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3565              		.loc 2 2301 0
 3566 0740 700094E5 		ldr	r0, [r4, #112]
 3567              	.LBB238:
 3568              	.LBB235:
 3569              	.LBB232:
1431:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     (void) force;
 3570              		.loc 2 1431 0
 3571 0744 2B10CDE5 		strb	r1, [sp, #43]
1432:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 3572              		.loc 2 1432 0
 3573 0748 2B10DDE5 		ldrb	r1, [sp, #43]	@ zero_extendqisi2
 3574              	.LVL414:
 3575              	.LBE232:
 3576              	.LBE235:
 3577              	.LBE238:
2301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                       ssl->transform_in->maclen ) != 0 )
 3578              		.loc 2 2301 0
 3579 074c 40108DE2 		add	r1, sp, #64
 3580 0750 000083E0 		add	r0, r3, r0
 3581 0754 FEFFFFEB 		bl	mbedtls_ssl_safer_memcmp
 3582              	.LVL415:
 3583 0758 000050E3 		cmp	r0, #0
 3584 075c D8FEFF1A 		bne	.L301
 3585              	.LVL416:
2314:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_INVALID_MAC );
 3586              		.loc 2 2314 0
 3587 0760 000055E3 		cmp	r5, #0
 3588 0764 EBFEFF1A 		bne	.L253
 3589 0768 D5FEFFEA 		b	.L301
 3590              	.LVL417:
 3591              	.L261:
 3592              	.LBE247:
 3593              	.LBB248:
 3594              	.LBB209:
2039:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3595              		.loc 2 2039 0
 3596 076c 601094E5 		ldr	r1, [r4, #96]
 3597 0770 0310D1E7 		ldrb	r1, [r1, r3]	@ zero_extendqisi2
 3598 0774 033085E0 		add	r3, r5, r3
 3599              	.LVL418:
 3600 0778 2810C3E5 		strb	r1, [r3, #40]
 3601              	.LVL419:
 3602 077c 5AFFFFEA 		b	.L260
 3603              	.LVL420:
 3604              	.L295:
 3605              	.LBE209:
2056:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3606              		.loc 2 2056 0
 3607 0780 0750A0E1 		mov	r5, r7
 3608 0784 31FFFFEA 		b	.L258
 3609              	.LVL421:
 3610              	.L269:
 3611              	.LBE248:
 3612              	.LBB249:
 3613              	.LBB239:
 3614              	.LBB236:
 3615              	.LBB227:
1429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3616              		.loc 2 1429 0
 3617 0788 0110D3E4 		ldrb	r1, [r3], #1	@ zero_extendqisi2
 3618              	.LVL422:
 3619 078c 012022E0 		eor	r2, r2, r1
 3620              	.LVL423:
 3621 0790 D3FFFFEA 		b	.L268
 3622              	.LVL424:
 3623              	.L271:
 3624              	.LBE227:
 3625              	.LBE236:
2276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3626              		.loc 2 2276 0
 3627 0794 641094E5 		ldr	r1, [r4, #100]
 3628 0798 440080E2 		add	r0, r0, #68
 3629 079c FEFFFFEB 		bl	mbedtls_md_process
 3630              	.LVL425:
2275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_md_process( &ssl->transform_in->md_ctx_dec, ssl->in_msg );
 3631              		.loc 2 2275 0
 3632 07a0 019089E2 		add	r9, r9, #1
 3633              	.LVL426:
 3634 07a4 D7FFFFEA 		b	.L270
 3635              	.LVL427:
 3636              	.L273:
 3637              	.LBB237:
 3638              	.LBB233:
1429:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3639              		.loc 2 1429 0
 3640 07a8 0100DAE4 		ldrb	r0, [r10], #1	@ zero_extendqisi2
 3641              	.LVL428:
 3642 07ac 001021E0 		eor	r1, r1, r0
 3643              	.LVL429:
 3644 07b0 E0FFFFEA 		b	.L272
 3645              	.LVL430:
 3646              	.L274:
 3647              	.LBE233:
 3648              	.LBE237:
 3649              	.LBE239:
 3650              	.LBE249:
2352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3651              		.loc 2 2352 0
 3652 07b4 0030A0E3 		mov	r3, #0
 3653 07b8 7C3084E5 		str	r3, [r4, #124]
 3654              	.L277:
 3655              	.LVL431:
 3656              	.LBB250:
2315:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 3657              		.loc 2 2315 0
 3658 07bc 0720A0E3 		mov	r2, #7
 3659              	.LVL432:
 3660              	.L279:
 3661              	.LBE250:
 3662              	.LBB251:
2364:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
 3663              		.loc 2 2364 0
 3664 07c0 541094E5 		ldr	r1, [r4, #84]
 3665 07c4 0230D1E7 		ldrb	r3, [r1, r2]	@ zero_extendqisi2
 3666 07c8 013083E2 		add	r3, r3, #1
 3667 07cc 7330EFE6 		uxtb	r3, r3
 3668 07d0 000053E3 		cmp	r3, #0
 3669 07d4 0230C1E7 		strb	r3, [r1, r2]
 3670 07d8 012042E2 		sub	r2, r2, #1
 3671              	.LVL433:
 3672 07dc 0500001A 		bne	.L278
 3673              	.LVL434:
2363:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             if( ++ssl->in_ctr[i - 1] != 0 )
 3674              		.loc 2 2363 0
 3675 07e0 010072E3 		cmn	r2, #1
 3676 07e4 F5FFFF1A 		bne	.L279
 3677              	.LVL435:
2371:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3678              		.loc 2 2371 0
 3679 07e8 3C809FE5 		ldr	r8, .L322+16
 3680              	.LVL436:
 3681              	.L228:
 3682              	.LBE251:
 3683              	.LBE255:
 3684              	.LBE260:
 3685              	.LBE266:
 3686              	.LBE281:
 3687              	.LBE286:
 3688              	.LBE299:
4385:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3689              		.loc 2 4385 0
 3690 07ec 0800A0E1 		mov	r0, r8
 3691 07f0 64D08DE2 		add	sp, sp, #100
 3692              		.cfi_remember_state
 3693              		.cfi_def_cfa_offset 36
 3694              		@ sp needed
 3695 07f4 F08FBDE8 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3696              	.LVL437:
 3697              	.L278:
 3698              		.cfi_restore_state
 3699              	.LBB300:
 3700              	.LBB287:
 3701              	.LBB282:
 3702              	.LBB267:
4259:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3703              		.loc 2 4259 0
 3704 07f8 703094E5 		ldr	r3, [r4, #112]
 3705 07fc 020A53E3 		cmp	r3, #8192
 3706 0800 33FEFF8A 		bhi	.L236
 3707              	.LVL438:
 3708              	.L282:
 3709              	.LBE267:
 3710              	.LBE282:
 3711              	.LBE287:
 3712              	.LBE300:
4347:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3713              		.loc 2 4347 0
 3714 0804 0400A0E1 		mov	r0, r4
 3715 0808 FEFFFFEB 		bl	mbedtls_ssl_handle_message_type
 3716              	.LVL439:
 3717 080c 0080A0E1 		mov	r8, r0
 3718              	.LVL440:
 3719 0810 15FFFFEA 		b	.L287
 3720              	.LVL441:
 3721              	.L292:
 3722              	.LBB301:
 3723              	.LBB288:
 3724              	.LBB283:
 3725              	.LBB268:
 3726              	.LBB261:
 3727              	.LBB256:
1941:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3728              		.loc 2 1941 0
 3729 0814 00809FE5 		ldr	r8, .L322
 3730 0818 F3FFFFEA 		b	.L228
 3731              	.L323:
 3732              		.align	2
 3733              	.L322:
 3734 081c 0094FFFF 		.word	-27648
 3735 0820 008EFFFF 		.word	-29184
 3736 0824 808EFFFF 		.word	-29056
 3737 0828 809AFFFF 		.word	-25984
 3738 082c 8094FFFF 		.word	-27520
 3739              	.LBE256:
 3740              	.LBE261:
 3741              	.LBE268:
 3742              	.LBE283:
 3743              	.LBE288:
 3744              	.LBE301:
 3745              		.cfi_endproc
 3746              	.LFE42:
 3748              		.section	.text.mbedtls_ssl_write_certificate,"ax",%progbits
 3749              		.align	2
 3750              		.global	mbedtls_ssl_write_certificate
 3751              		.syntax unified
 3752              		.arm
 3753              		.fpu neon
 3755              	mbedtls_ssl_write_certificate:
 3756              	.LFB49:
5320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 3757              		.loc 2 5320 0
 3758              		.cfi_startproc
 3759              		@ args = 0, pretend = 0, frame = 0
 3760              		@ frame_needed = 0, uses_anonymous_args = 0
 3761              	.LVL442:
5324:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3762              		.loc 2 5324 0
 3763 0000 403090E5 		ldr	r3, [r0, #64]
5328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 3764              		.loc 2 5328 0
 3765 0004 003093E5 		ldr	r3, [r3]
 3766 0008 0A20D3E5 		ldrb	r2, [r3, #10]	@ zero_extendqisi2
5329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 3767              		.loc 2 5329 0
 3768 000c 0B0052E3 		cmp	r2, #11
 3769 0010 0800008A 		bhi	.L325
 3770 0014 963EA0E3 		mov	r3, #2400
 3771 0018 3332E0E1 		mvn	r3, r3, lsr r2
5330:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
 3772              		.loc 2 5330 0
 3773 001c 010013E3 		tst	r3, #1
 3774 0020 0400001A 		bne	.L325
 3775              	.L328:
5334:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
 3776              		.loc 2 5334 0
 3777 0024 043090E5 		ldr	r3, [r0, #4]
 3778 0028 013083E2 		add	r3, r3, #1
 3779 002c 043080E5 		str	r3, [r0, #4]
5335:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 3780              		.loc 2 5335 0
 3781 0030 0000A0E3 		mov	r0, #0
 3782              	.LVL443:
 3783 0034 1EFF2FE1 		bx	lr
 3784              	.LVL444:
 3785              	.L325:
5339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3786              		.loc 2 5339 0
 3787 0038 002090E5 		ldr	r2, [r0]
 3788 003c 6030D2E5 		ldrb	r3, [r2, #96]	@ zero_extendqisi2
 3789 0040 010013E3 		tst	r3, #1
 3790 0044 0200001A 		bne	.L327
5341:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3791              		.loc 2 5341 0
 3792 0048 B03090E5 		ldr	r3, [r0, #176]
 3793 004c 000053E3 		cmp	r3, #0
 3794 0050 F3FFFF0A 		beq	.L328
 3795              	.L327:
 3796              	.LBB304:
 3797              	.LBB305:
 653:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 3798              		.loc 1 653 0
 3799 0054 303090E5 		ldr	r3, [r0, #48]
 3800              	.LBE305:
 3801              	.LBE304:
5320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 3802              		.loc 2 5320 0
 3803 0058 F0412DE9 		push	{r4, r5, r6, r7, r8, lr}
 3804              		.cfi_def_cfa_offset 24
 3805              		.cfi_offset 4, -24
 3806              		.cfi_offset 5, -20
 3807              		.cfi_offset 6, -16
 3808              		.cfi_offset 7, -12
 3809              		.cfi_offset 8, -8
 3810              		.cfi_offset 14, -4
 3811 005c 0040A0E1 		mov	r4, r0
 3812              	.LVL445:
 3813              	.LBB309:
 3814              	.LBB306:
 653:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h ****         key_cert = ssl->handshake->key_cert;
 3815              		.loc 1 653 0
 3816 0060 000053E3 		cmp	r3, #0
 3817 0064 0200000A 		beq	.L329
 3818              	.LVL446:
 3819 0068 3C3193E5 		ldr	r3, [r3, #316]
 3820 006c 000053E3 		cmp	r3, #0
 3821 0070 0200001A 		bne	.L330
 3822              	.L329:
 656:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** 
 3823              		.loc 1 656 0
 3824 0074 403092E5 		ldr	r3, [r2, #64]
 3825              	.LVL447:
 658:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 3826              		.loc 1 658 0
 3827 0078 000053E3 		cmp	r3, #0
 3828 007c 3000000A 		beq	.L334
 3829              	.LVL448:
 3830              	.L330:
 3831 0080 006093E5 		ldr	r6, [r3]
 3832              	.LBE306:
 3833              	.LBE309:
5395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3834              		.loc 2 5395 0
 3835 0084 FD7F01E3 		movw	r7, #8189
 3836              	.LBB310:
 3837              	.LBB307:
 658:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 3838              		.loc 1 658 0
 3839 0088 0730A0E3 		mov	r3, #7
 3840              	.LVL449:
 3841              	.L332:
 3842              	.LBE307:
 3843              	.LBE310:
5392:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3844              		.loc 2 5392 0
 3845 008c 000056E3 		cmp	r6, #0
 3846 0090 1400001A 		bne	.L333
 3847              	.LVL450:
 3848              	.L331:
5410:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[5]  = (unsigned char)( ( i - 7 ) >>  8 );
 3849              		.loc 2 5410 0
 3850 0094 981094E5 		ldr	r1, [r4, #152]
 3851 0098 072043E2 		sub	r2, r3, #7
 3852 009c 2208A0E1 		lsr	r0, r2, #16
 3853 00a0 0400C1E5 		strb	r0, [r1, #4]
5411:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[6]  = (unsigned char)( ( i - 7 )       );
 3854              		.loc 2 5411 0
 3855 00a4 2204A0E1 		lsr	r0, r2, #8
 3856 00a8 981094E5 		ldr	r1, [r4, #152]
 3857 00ac 0500C1E5 		strb	r0, [r1, #5]
5424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3858              		.loc 2 5424 0
 3859 00b0 0400A0E1 		mov	r0, r4
5412:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3860              		.loc 2 5412 0
 3861 00b4 981094E5 		ldr	r1, [r4, #152]
 3862 00b8 0620C1E5 		strb	r2, [r1, #6]
5416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3863              		.loc 2 5416 0
 3864 00bc 0B20A0E3 		mov	r2, #11
5414:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 3865              		.loc 2 5414 0
 3866 00c0 A03084E5 		str	r3, [r4, #160]
5415:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_CERTIFICATE;
 3867              		.loc 2 5415 0
 3868 00c4 1630A0E3 		mov	r3, #22
 3869 00c8 9C3084E5 		str	r3, [r4, #156]
5416:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3870              		.loc 2 5416 0
 3871 00cc 983094E5 		ldr	r3, [r4, #152]
 3872 00d0 0020C3E5 		strb	r2, [r3]
5422:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3873              		.loc 2 5422 0
 3874 00d4 043094E5 		ldr	r3, [r4, #4]
 3875 00d8 013083E2 		add	r3, r3, #1
 3876 00dc 043084E5 		str	r3, [r4, #4]
5433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3877              		.loc 2 5433 0
 3878 00e0 F041BDE8 		pop	{r4, r5, r6, r7, r8, lr}
 3879              		.cfi_remember_state
 3880              		.cfi_restore 14
 3881              		.cfi_restore 8
 3882              		.cfi_restore 7
 3883              		.cfi_restore 6
 3884              		.cfi_restore 5
 3885              		.cfi_restore 4
 3886              		.cfi_def_cfa_offset 0
 3887              	.LVL451:
5424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3888              		.loc 2 5424 0
 3889 00e4 FEFFFFEA 		b	mbedtls_ssl_write_handshake_msg
 3890              	.LVL452:
 3891              	.L333:
 3892              		.cfi_restore_state
5394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( n > MBEDTLS_SSL_OUT_CONTENT_LEN - 3 - i )
 3893              		.loc 2 5394 0
 3894 00e8 045096E5 		ldr	r5, [r6, #4]
 3895              	.LVL453:
5395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 3896              		.loc 2 5395 0
 3897 00ec 032047E0 		sub	r2, r7, r3
 3898 00f0 020055E1 		cmp	r5, r2
 3899 00f4 1400008A 		bhi	.L335
5402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[i + 1] = (unsigned char)( n >>  8 );
 3900              		.loc 2 5402 0
 3901 00f8 982094E5 		ldr	r2, [r4, #152]
 3902 00fc 2518A0E1 		lsr	r1, r5, #16
5406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += n; crt = crt->next;
 3903              		.loc 2 5406 0
 3904 0100 038083E2 		add	r8, r3, #3
 3905              	.LVL454:
5402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[i + 1] = (unsigned char)( n >>  8 );
 3906              		.loc 2 5402 0
 3907 0104 0310C2E7 		strb	r1, [r2, r3]
5403:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msg[i + 2] = (unsigned char)( n       );
 3908              		.loc 2 5403 0
 3909 0108 2514A0E1 		lsr	r1, r5, #8
 3910 010c 982094E5 		ldr	r2, [r4, #152]
 3911 0110 032082E0 		add	r2, r2, r3
 3912 0114 0110C2E5 		strb	r1, [r2, #1]
5404:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3913              		.loc 2 5404 0
 3914 0118 982094E5 		ldr	r2, [r4, #152]
 3915 011c 032082E0 		add	r2, r2, r3
 3916 0120 0250C2E5 		strb	r5, [r2, #2]
5406:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += n; crt = crt->next;
 3917              		.loc 2 5406 0
 3918 0124 0520A0E1 		mov	r2, r5
 3919 0128 980094E5 		ldr	r0, [r4, #152]
 3920 012c 081096E5 		ldr	r1, [r6, #8]
 3921 0130 080080E0 		add	r0, r0, r8
 3922 0134 FEFFFFEB 		bl	memcpy
 3923              	.LVL455:
5407:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 3924              		.loc 2 5407 0
 3925 0138 083085E0 		add	r3, r5, r8
 3926              	.LVL456:
 3927 013c 306196E5 		ldr	r6, [r6, #304]
 3928              	.LVL457:
 3929 0140 D1FFFFEA 		b	.L332
 3930              	.LVL458:
 3931              	.L334:
 3932              	.LBB311:
 3933              	.LBB308:
 658:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\ssl_internal.h **** }
 3934              		.loc 1 658 0
 3935 0144 0730A0E3 		mov	r3, #7
 3936              	.LVL459:
 3937 0148 D1FFFFEA 		b	.L331
 3938              	.LVL460:
 3939              	.L335:
 3940              	.LBE308:
 3941              	.LBE311:
5399:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 3942              		.loc 2 5399 0
 3943 014c 00009FE5 		ldr	r0, .L345
5433:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3944              		.loc 2 5433 0
 3945 0150 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 3946              	.L346:
 3947              		.align	2
 3948              	.L345:
 3949 0154 008BFFFF 		.word	-29952
 3950              		.cfi_endproc
 3951              	.LFE49:
 3953              		.section	.text.mbedtls_ssl_write_change_cipher_spec,"ax",%progbits
 3954              		.align	2
 3955              		.global	mbedtls_ssl_write_change_cipher_spec
 3956              		.syntax unified
 3957              		.arm
 3958              		.fpu neon
 3960              	mbedtls_ssl_write_change_cipher_spec:
 3961              	.LFB51:
5826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 3962              		.loc 2 5826 0
 3963              		.cfi_startproc
 3964              		@ args = 0, pretend = 0, frame = 0
 3965              		@ frame_needed = 0, uses_anonymous_args = 0
 3966              		@ link register save eliminated.
 3967              	.LVL461:
5833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3968              		.loc 2 5833 0
 3969 0000 981090E5 		ldr	r1, [r0, #152]
5831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen  = 1;
 3970              		.loc 2 5831 0
 3971 0004 1420A0E3 		mov	r2, #20
 3972 0008 9C2080E5 		str	r2, [r0, #156]
5832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = 1;
 3973              		.loc 2 5832 0
 3974 000c 0120A0E3 		mov	r2, #1
 3975 0010 A02080E5 		str	r2, [r0, #160]
5833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3976              		.loc 2 5833 0
 3977 0014 0020C1E5 		strb	r2, [r1]
5835:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 3978              		.loc 2 5835 0
 3979 0018 042090E5 		ldr	r2, [r0, #4]
 3980 001c 012082E2 		add	r2, r2, #1
 3981 0020 042080E5 		str	r2, [r0, #4]
5837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 3982              		.loc 2 5837 0
 3983 0024 FEFFFFEA 		b	mbedtls_ssl_write_handshake_msg
 3984              	.LVL462:
 3985              		.cfi_endproc
 3986              	.LFE51:
 3988              		.section	.text.mbedtls_ssl_parse_change_cipher_spec,"ax",%progbits
 3989              		.align	2
 3990              		.global	mbedtls_ssl_parse_change_cipher_spec
 3991              		.syntax unified
 3992              		.arm
 3993              		.fpu neon
 3995              	mbedtls_ssl_parse_change_cipher_spec:
 3996              	.LFB52:
5849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 3997              		.loc 2 5849 0
 3998              		.cfi_startproc
 3999              		@ args = 0, pretend = 0, frame = 0
 4000              		@ frame_needed = 0, uses_anonymous_args = 0
 4001              	.LVL463:
 4002 0000 70402DE9 		push	{r4, r5, r6, lr}
 4003              		.cfi_def_cfa_offset 16
 4004              		.cfi_offset 4, -16
 4005              		.cfi_offset 5, -12
 4006              		.cfi_offset 6, -8
 4007              		.cfi_offset 14, -4
5854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4008              		.loc 2 5854 0
 4009 0004 0110A0E3 		mov	r1, #1
5849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 4010              		.loc 2 5849 0
 4011 0008 0040A0E1 		mov	r4, r0
5854:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4012              		.loc 2 5854 0
 4013 000c FEFFFFEB 		bl	mbedtls_ssl_read_record
 4014              	.LVL464:
 4015 0010 005050E2 		subs	r5, r0, #0
 4016 0014 0700001A 		bne	.L348
5860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4017              		.loc 2 5860 0
 4018 0018 6C3094E5 		ldr	r3, [r4, #108]
 4019 001c 140053E3 		cmp	r3, #20
 4020 0020 0600000A 		beq	.L350
5865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4021              		.loc 2 5865 0
 4022 0024 88509FE5 		ldr	r5, .L357
5863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
 4023              		.loc 2 5863 0
 4024 0028 0A20A0E3 		mov	r2, #10
 4025 002c 0210A0E3 		mov	r1, #2
 4026 0030 0400A0E1 		mov	r0, r4
 4027              	.LVL465:
 4028 0034 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 4029              	.LVL466:
 4030              	.L348:
5919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4031              		.loc 2 5919 0
 4032 0038 0500A0E1 		mov	r0, r5
 4033 003c 7080BDE8 		pop	{r4, r5, r6, pc}
 4034              	.LVL467:
 4035              	.L350:
5876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_in = ssl->session_negotiate;
 4036              		.loc 2 5876 0
 4037 0040 403094E5 		ldr	r3, [r4, #64]
5897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4038              		.loc 2 5897 0
 4039 0044 0820A0E3 		mov	r2, #8
 4040 0048 0510A0E1 		mov	r1, r5
 4041 004c 540094E5 		ldr	r0, [r4, #84]
 4042              	.LVL468:
5876:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_in = ssl->session_negotiate;
 4043              		.loc 2 5876 0
 4044 0050 343084E5 		str	r3, [r4, #52]
5877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4045              		.loc 2 5877 0
 4046 0054 2C3094E5 		ldr	r3, [r4, #44]
 4047 0058 203084E5 		str	r3, [r4, #32]
5897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4048              		.loc 2 5897 0
 4049 005c FEFFFFEB 		bl	memset
 4050              	.LVL469:
 4051              	.LBB314:
 4052              	.LBB315:
6766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 3;
 4053              		.loc 2 6766 0
 4054 0060 583094E5 		ldr	r3, [r4, #88]
 4055              	.LBE315:
 4056              	.LBE314:
5899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4057              		.loc 2 5899 0
 4058 0064 401094E5 		ldr	r1, [r4, #64]
 4059              	.LVL470:
 4060              	.LBB317:
 4061              	.LBB316:
6766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 3;
 4062              		.loc 2 6766 0
 4063 0068 082043E2 		sub	r2, r3, #8
6772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 4064              		.loc 2 6772 0
 4065 006c 000051E3 		cmp	r1, #0
6766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_len = ssl->in_hdr + 3;
 4066              		.loc 2 6766 0
 4067 0070 542084E5 		str	r2, [r4, #84]
6767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 5;
 4068              		.loc 2 6767 0
 4069 0074 032083E2 		add	r2, r3, #3
6768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4070              		.loc 2 6768 0
 4071 0078 053083E2 		add	r3, r3, #5
6767:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_iv  = ssl->in_hdr + 5;
 4072              		.loc 2 6767 0
 4073 007c 5C2084E5 		str	r2, [r4, #92]
6768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4074              		.loc 2 6768 0
 4075 0080 603084E5 		str	r3, [r4, #96]
6772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->minor_ver >= MBEDTLS_SSL_MINOR_VERSION_2 )
 4076              		.loc 2 6772 0
 4077 0084 0500000A 		beq	.L351
 4078 0088 0C2094E5 		ldr	r2, [r4, #12]
 4079 008c 010052E3 		cmp	r2, #1
6775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4080              		.loc 2 6775 0
 4081 0090 0C2091C5 		ldrgt	r2, [r1, #12]
 4082 0094 101091C5 		ldrgt	r1, [r1, #16]
 4083              	.LVL471:
 4084 0098 012042C0 		subgt	r2, r2, r1
 4085 009c 023083C0 		addgt	r3, r3, r2
 4086              	.L351:
6778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4087              		.loc 2 6778 0
 4088 00a0 643084E5 		str	r3, [r4, #100]
 4089              	.LVL472:
 4090              	.LBE316:
 4091              	.LBE317:
5914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4092              		.loc 2 5914 0
 4093 00a4 043094E5 		ldr	r3, [r4, #4]
 4094 00a8 013083E2 		add	r3, r3, #1
 4095 00ac 043084E5 		str	r3, [r4, #4]
5918:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4096              		.loc 2 5918 0
 4097 00b0 E0FFFFEA 		b	.L348
 4098              	.L358:
 4099              		.align	2
 4100              	.L357:
 4101 00b4 0089FFFF 		.word	-30464
 4102              		.cfi_endproc
 4103              	.LFE52:
 4105              		.section	.text.mbedtls_ssl_optimize_checksum,"ax",%progbits
 4106              		.align	2
 4107              		.global	mbedtls_ssl_optimize_checksum
 4108              		.syntax unified
 4109              		.arm
 4110              		.fpu neon
 4112              	mbedtls_ssl_optimize_checksum:
 4113              	.LFB53:
5923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ((void) ciphersuite_info);
 4114              		.loc 2 5923 0
 4115              		.cfi_startproc
 4116              		@ args = 0, pretend = 0, frame = 0
 4117              		@ frame_needed = 0, uses_anonymous_args = 0
 4118              		@ link register save eliminated.
 4119              	.LVL473:
5939:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->handshake->update_checksum = ssl_update_checksum_sha256;
 4120              		.loc 2 5939 0
 4121 0000 0930D1E5 		ldrb	r3, [r1, #9]	@ zero_extendqisi2
 4122 0004 070053E3 		cmp	r3, #7
5940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     else
 4123              		.loc 2 5940 0
 4124 0008 30309015 		ldrne	r3, [r0, #48]
 4125 000c 04209F15 		ldrne	r2, .L364
 4126 0010 BC218315 		strne	r2, [r3, #444]
 4127 0014 1EFF2FE1 		bx	lr
 4128              	.L365:
 4129              		.align	2
 4130              	.L364:
 4131 0018 00000000 		.word	ssl_update_checksum_sha256
 4132              		.cfi_endproc
 4133              	.LFE53:
 4135              		.section	.text.mbedtls_ssl_reset_checksum,"ax",%progbits
 4136              		.align	2
 4137              		.global	mbedtls_ssl_reset_checksum
 4138              		.syntax unified
 4139              		.arm
 4140              		.fpu neon
 4142              	mbedtls_ssl_reset_checksum:
 4143              	.LFB54:
5951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
 4144              		.loc 2 5951 0
 4145              		.cfi_startproc
 4146              		@ args = 0, pretend = 0, frame = 0
 4147              		@ frame_needed = 0, uses_anonymous_args = 0
 4148              		@ link register save eliminated.
 4149              	.LVL474:
5959:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 4150              		.loc 2 5959 0
 4151 0000 300090E5 		ldr	r0, [r0, #48]
 4152              	.LVL475:
 4153 0004 0010A0E3 		mov	r1, #0
 4154 0008 150E80E2 		add	r0, r0, #336
 4155 000c FEFFFFEA 		b	mbedtls_sha256_starts_ret
 4156              	.LVL476:
 4157              		.cfi_endproc
 4158              	.LFE54:
 4160              		.section	.text.mbedtls_ssl_write_finished,"ax",%progbits
 4161              		.align	2
 4162              		.global	mbedtls_ssl_write_finished
 4163              		.syntax unified
 4164              		.arm
 4165              		.fpu neon
 4167              	mbedtls_ssl_write_finished:
 4168              	.LFB60:
6345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, hash_len;
 4169              		.loc 2 6345 0
 4170              		.cfi_startproc
 4171              		@ args = 0, pretend = 0, frame = 0
 4172              		@ frame_needed = 0, uses_anonymous_args = 0
 4173              	.LVL477:
 4174 0000 10402DE9 		push	{r4, lr}
 4175              		.cfi_def_cfa_offset 8
 4176              		.cfi_offset 4, -8
 4177              		.cfi_offset 14, -4
6345:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret, hash_len;
 4178              		.loc 2 6345 0
 4179 0004 0040A0E1 		mov	r4, r0
6350:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4180              		.loc 2 6350 0
 4181 0008 401090E5 		ldr	r1, [r0, #64]
 4182 000c FEFFFFEB 		bl	ssl_update_out_pointers
 4183              	.LVL478:
6352:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4184              		.loc 2 6352 0
 4185 0010 003090E5 		ldr	r3, [r0]
 4186 0014 981090E5 		ldr	r1, [r0, #152]
 4187 0018 6020D3E5 		ldrb	r2, [r3, #96]	@ zero_extendqisi2
 4188 001c 303090E5 		ldr	r3, [r0, #48]
 4189 0020 041081E2 		add	r1, r1, #4
 4190 0024 012002E2 		and	r2, r2, #1
 4191 0028 C43193E5 		ldr	r3, [r3, #452]
 4192 002c 33FF2FE1 		blx	r3
 4193              	.LVL479:
6360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4194              		.loc 2 6360 0
 4195 0030 0C3094E5 		ldr	r3, [r4, #12]
6369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4196              		.loc 2 6369 0
 4197 0034 1420A0E3 		mov	r2, #20
6360:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4198              		.loc 2 6360 0
 4199 0038 000053E3 		cmp	r3, #0
 4200              	.LVL480:
6367:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msgtype = MBEDTLS_SSL_MSG_HANDSHAKE;
 4201              		.loc 2 6367 0
 4202 003c 1030A013 		movne	r3, #16
 4203 0040 2830A003 		moveq	r3, #40
 4204 0044 A03084E5 		str	r3, [r4, #160]
6368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg[0]  = MBEDTLS_SSL_HS_FINISHED;
 4205              		.loc 2 6368 0
 4206 0048 1630A0E3 		mov	r3, #22
 4207 004c 9C3084E5 		str	r3, [r4, #156]
6369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4208              		.loc 2 6369 0
 4209 0050 983094E5 		ldr	r3, [r4, #152]
 4210 0054 0020C3E5 		strb	r2, [r3]
6375:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4211              		.loc 2 6375 0
 4212 0058 303094E5 		ldr	r3, [r4, #48]
 4213 005c 543293E5 		ldr	r3, [r3, #596]
 4214 0060 000053E3 		cmp	r3, #0
 4215              	.LVL481:
 4216 0064 0F00000A 		beq	.L369
6378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
 4217              		.loc 2 6378 0
 4218 0068 003094E5 		ldr	r3, [r4]
 4219 006c 6030D3E5 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 4220 0070 010013E3 		tst	r3, #1
6379:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 4221              		.loc 2 6379 0
 4222 0074 0F30A003 		moveq	r3, #15
6378:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_HANDSHAKE_WRAPUP;
 4223              		.loc 2 6378 0
 4224 0078 0C00000A 		beq	.L373
 4225              	.L370:
6421:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4226              		.loc 2 6421 0
 4227 007c A80084E2 		add	r0, r4, #168
 4228 0080 0820A0E3 		mov	r2, #8
 4229 0084 0010A0E3 		mov	r1, #0
 4230 0088 FEFFFFEB 		bl	memset
 4231              	.LVL482:
6423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_out = ssl->session_negotiate;
 4232              		.loc 2 6423 0
 4233 008c 403094E5 		ldr	r3, [r4, #64]
6442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4234              		.loc 2 6442 0
 4235 0090 0400A0E1 		mov	r0, r4
6423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_out = ssl->session_negotiate;
 4236              		.loc 2 6423 0
 4237 0094 383084E5 		str	r3, [r4, #56]
6424:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4238              		.loc 2 6424 0
 4239 0098 2C3094E5 		ldr	r3, [r4, #44]
 4240 009c 243084E5 		str	r3, [r4, #36]
6460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4241              		.loc 2 6460 0
 4242 00a0 1040BDE8 		pop	{r4, lr}
 4243              		.cfi_remember_state
 4244              		.cfi_restore 14
 4245              		.cfi_restore 4
 4246              		.cfi_def_cfa_offset 0
 4247              	.LVL483:
6442:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4248              		.loc 2 6442 0
 4249 00a4 FEFFFFEA 		b	mbedtls_ssl_write_handshake_msg
 4250              	.LVL484:
 4251              	.L369:
 4252              		.cfi_restore_state
6387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4253              		.loc 2 6387 0
 4254 00a8 043094E5 		ldr	r3, [r4, #4]
 4255 00ac 013083E2 		add	r3, r3, #1
 4256              	.L373:
 4257 00b0 043084E5 		str	r3, [r4, #4]
 4258 00b4 F0FFFFEA 		b	.L370
 4259              		.cfi_endproc
 4260              	.LFE60:
 4262              		.section	.text.mbedtls_ssl_parse_finished,"ax",%progbits
 4263              		.align	2
 4264              		.global	mbedtls_ssl_parse_finished
 4265              		.syntax unified
 4266              		.arm
 4267              		.fpu neon
 4269              	mbedtls_ssl_parse_finished:
 4270              	.LFB61:
6469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 4271              		.loc 2 6469 0
 4272              		.cfi_startproc
 4273              		@ args = 0, pretend = 0, frame = 16
 4274              		@ frame_needed = 0, uses_anonymous_args = 0
 4275              	.LVL485:
 4276 0000 1F402DE9 		push	{r0, r1, r2, r3, r4, lr}
 4277              		.cfi_def_cfa_offset 24
 4278              		.cfi_offset 4, -8
 4279              		.cfi_offset 14, -4
6469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 4280              		.loc 2 6469 0
 4281 0004 0040A0E1 		mov	r4, r0
6476:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4282              		.loc 2 6476 0
 4283 0008 003090E5 		ldr	r3, [r0]
 4284 000c 04108DE2 		add	r1, sp, #4
 4285 0010 6020D3E5 		ldrb	r2, [r3, #96]	@ zero_extendqisi2
 4286 0014 303090E5 		ldr	r3, [r0, #48]
 4287 0018 0220E0E1 		mvn	r2, r2
 4288 001c C43193E5 		ldr	r3, [r3, #452]
 4289 0020 012002E2 		and	r2, r2, #1
 4290 0024 33FF2FE1 		blx	r3
 4291              	.LVL486:
6478:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4292              		.loc 2 6478 0
 4293 0028 0110A0E3 		mov	r1, #1
 4294 002c 0400A0E1 		mov	r0, r4
 4295 0030 FEFFFFEB 		bl	mbedtls_ssl_read_record
 4296              	.LVL487:
 4297 0034 000050E3 		cmp	r0, #0
 4298 0038 0700001A 		bne	.L374
6484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4299              		.loc 2 6484 0
 4300 003c 6C3094E5 		ldr	r3, [r4, #108]
 4301 0040 160053E3 		cmp	r3, #22
 4302 0044 0600000A 		beq	.L376
6487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
 4303              		.loc 2 6487 0
 4304 0048 0A20A0E3 		mov	r2, #10
 4305 004c 0210A0E3 		mov	r1, #2
 4306 0050 0400A0E1 		mov	r0, r4
 4307              	.LVL488:
 4308 0054 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 4309              	.LVL489:
6489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4310              		.loc 2 6489 0
 4311 0058 88009FE5 		ldr	r0, .L382
 4312              	.L374:
6545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4313              		.loc 2 6545 0
 4314 005c 10D08DE2 		add	sp, sp, #16
 4315              		.cfi_remember_state
 4316              		.cfi_def_cfa_offset 8
 4317              		@ sp needed
 4318 0060 1080BDE8 		pop	{r4, pc}
 4319              	.LVL490:
 4320              	.L376:
 4321              		.cfi_restore_state
6500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) + hash_len )
 4322              		.loc 2 6500 0
 4323 0064 640094E5 		ldr	r0, [r4, #100]
 4324              	.LVL491:
 4325 0068 0030D0E5 		ldrb	r3, [r0]	@ zero_extendqisi2
 4326 006c 140053E3 		cmp	r3, #20
 4327 0070 0200001A 		bne	.L377
 4328              	.LVL492:
6500:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) + hash_len )
 4329              		.loc 2 6500 0 is_stmt 0 discriminator 1
 4330 0074 783094E5 		ldr	r3, [r4, #120]
 4331 0078 100053E3 		cmp	r3, #16
 4332 007c 0500000A 		beq	.L378
 4333              	.LVL493:
 4334              	.L377:
6504:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
 4335              		.loc 2 6504 0 is_stmt 1
 4336 0080 3220A0E3 		mov	r2, #50
 4337 0084 0210A0E3 		mov	r1, #2
 4338 0088 0400A0E1 		mov	r0, r4
 4339 008c FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 4340              	.LVL494:
6506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4341              		.loc 2 6506 0
 4342 0090 54009FE5 		ldr	r0, .L382+4
 4343 0094 F0FFFFEA 		b	.L374
 4344              	.LVL495:
 4345              	.L378:
6509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                       buf, hash_len ) != 0 )
 4346              		.loc 2 6509 0
 4347 0098 0C20A0E3 		mov	r2, #12
 4348 009c 04108DE2 		add	r1, sp, #4
 4349 00a0 040080E2 		add	r0, r0, #4
 4350 00a4 FEFFFFEB 		bl	mbedtls_ssl_safer_memcmp
 4351              	.LVL496:
 4352 00a8 000050E3 		cmp	r0, #0
 4353 00ac F3FFFF1A 		bne	.L377
6523:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4354              		.loc 2 6523 0
 4355 00b0 303094E5 		ldr	r3, [r4, #48]
 4356 00b4 543293E5 		ldr	r3, [r3, #596]
 4357 00b8 000053E3 		cmp	r3, #0
 4358 00bc 0600000A 		beq	.L379
6526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC;
 4359              		.loc 2 6526 0
 4360 00c0 003094E5 		ldr	r3, [r4]
 4361 00c4 6030D3E5 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 4362 00c8 010013E3 		tst	r3, #1
6527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 4363              		.loc 2 6527 0
 4364 00cc 0A30A003 		moveq	r3, #10
6526:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->state = MBEDTLS_SSL_CLIENT_CHANGE_CIPHER_SPEC;
 4365              		.loc 2 6526 0
 4366 00d0 E1FFFF1A 		bne	.L374
 4367              	.L381:
6535:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4368              		.loc 2 6535 0
 4369 00d4 043084E5 		str	r3, [r4, #4]
 4370 00d8 DFFFFFEA 		b	.L374
 4371              	.L379:
 4372 00dc 043094E5 		ldr	r3, [r4, #4]
 4373 00e0 013083E2 		add	r3, r3, #1
 4374 00e4 FAFFFFEA 		b	.L381
 4375              	.L383:
 4376              		.align	2
 4377              	.L382:
 4378 00e8 0089FFFF 		.word	-30464
 4379 00ec 8081FFFF 		.word	-32384
 4380              		.cfi_endproc
 4381              	.LFE61:
 4383              		.section	.text.mbedtls_ssl_session_init,"ax",%progbits
 4384              		.align	2
 4385              		.global	mbedtls_ssl_session_init
 4386              		.syntax unified
 4387              		.arm
 4388              		.fpu neon
 4390              	mbedtls_ssl_session_init:
 4391              	.LFB64:
6607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( session, 0, sizeof(mbedtls_ssl_session) );
 4392              		.loc 2 6607 0
 4393              		.cfi_startproc
 4394              		@ args = 0, pretend = 0, frame = 0
 4395              		@ frame_needed = 0, uses_anonymous_args = 0
 4396              		@ link register save eliminated.
 4397              	.LVL497:
6608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4398              		.loc 2 6608 0
 4399 0000 6C20A0E3 		mov	r2, #108
 4400 0004 0010A0E3 		mov	r1, #0
 4401 0008 FEFFFFEA 		b	memset
 4402              	.LVL498:
 4403              		.cfi_endproc
 4404              	.LFE64:
 4406              		.section	.text.mbedtls_ssl_init,"ax",%progbits
 4407              		.align	2
 4408              		.global	mbedtls_ssl_init
 4409              		.syntax unified
 4410              		.arm
 4411              		.fpu neon
 4413              	mbedtls_ssl_init:
 4414              	.LFB68:
6785:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( ssl, 0, sizeof( mbedtls_ssl_context ) );
 4415              		.loc 2 6785 0
 4416              		.cfi_startproc
 4417              		@ args = 0, pretend = 0, frame = 0
 4418              		@ frame_needed = 0, uses_anonymous_args = 0
 4419              		@ link register save eliminated.
 4420              	.LVL499:
6786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4421              		.loc 2 6786 0
 4422 0000 C020A0E3 		mov	r2, #192
 4423 0004 0010A0E3 		mov	r1, #0
 4424 0008 FEFFFFEA 		b	memset
 4425              	.LVL500:
 4426              		.cfi_endproc
 4427              	.LFE68:
 4429              		.section	.text.mbedtls_ssl_conf_endpoint,"ax",%progbits
 4430              		.align	2
 4431              		.global	mbedtls_ssl_conf_endpoint
 4432              		.syntax unified
 4433              		.arm
 4434              		.fpu neon
 4436              	mbedtls_ssl_conf_endpoint:
 4437              	.LFB73:
7010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->endpoint   = endpoint;
 4438              		.loc 2 7010 0
 4439              		.cfi_startproc
 4440              		@ args = 0, pretend = 0, frame = 0
 4441              		@ frame_needed = 0, uses_anonymous_args = 0
 4442              		@ link register save eliminated.
 4443              	.LVL501:
7011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4444              		.loc 2 7011 0
 4445 0000 6030D0E5 		ldrb	r3, [r0, #96]	@ zero_extendqisi2
 4446 0004 1130C0E7 		bfi	r3, r1, #0, #1
 4447 0008 6030C0E5 		strb	r3, [r0, #96]
 4448 000c 1EFF2FE1 		bx	lr
 4449              		.cfi_endproc
 4450              	.LFE73:
 4452              		.section	.text.mbedtls_ssl_conf_transport,"ax",%progbits
 4453              		.align	2
 4454              		.global	mbedtls_ssl_conf_transport
 4455              		.syntax unified
 4456              		.arm
 4457              		.fpu neon
 4459              	mbedtls_ssl_conf_transport:
 4460              	.LFB74:
7015:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->transport = transport;
 4461              		.loc 2 7015 0
 4462              		.cfi_startproc
 4463              		@ args = 0, pretend = 0, frame = 0
 4464              		@ frame_needed = 0, uses_anonymous_args = 0
 4465              		@ link register save eliminated.
 4466              	.LVL502:
7016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4467              		.loc 2 7016 0
 4468 0000 6030D0E5 		ldrb	r3, [r0, #96]	@ zero_extendqisi2
 4469 0004 9130C1E7 		bfi	r3, r1, #1, #1
 4470 0008 6030C0E5 		strb	r3, [r0, #96]
 4471 000c 1EFF2FE1 		bx	lr
 4472              		.cfi_endproc
 4473              	.LFE74:
 4475              		.section	.text.mbedtls_ssl_conf_authmode,"ax",%progbits
 4476              		.align	2
 4477              		.global	mbedtls_ssl_conf_authmode
 4478              		.syntax unified
 4479              		.arm
 4480              		.fpu neon
 4482              	mbedtls_ssl_conf_authmode:
 4483              	.LFB75:
7050:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->authmode   = authmode;
 4484              		.loc 2 7050 0
 4485              		.cfi_startproc
 4486              		@ args = 0, pretend = 0, frame = 0
 4487              		@ frame_needed = 0, uses_anonymous_args = 0
 4488              		@ link register save eliminated.
 4489              	.LVL503:
7051:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4490              		.loc 2 7051 0
 4491 0000 6030D0E5 		ldrb	r3, [r0, #96]	@ zero_extendqisi2
 4492 0004 1131C3E7 		bfi	r3, r1, #2, #2
 4493 0008 6030C0E5 		strb	r3, [r0, #96]
 4494 000c 1EFF2FE1 		bx	lr
 4495              		.cfi_endproc
 4496              	.LFE75:
 4498              		.section	.text.mbedtls_ssl_conf_verify,"ax",%progbits
 4499              		.align	2
 4500              		.global	mbedtls_ssl_conf_verify
 4501              		.syntax unified
 4502              		.arm
 4503              		.fpu neon
 4505              	mbedtls_ssl_conf_verify:
 4506              	.LFB76:
7058:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_vrfy      = f_vrfy;
 4507              		.loc 2 7058 0
 4508              		.cfi_startproc
 4509              		@ args = 0, pretend = 0, frame = 0
 4510              		@ frame_needed = 0, uses_anonymous_args = 0
 4511              		@ link register save eliminated.
 4512              	.LVL504:
7059:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_vrfy      = p_vrfy;
 4513              		.loc 2 7059 0
 4514 0000 341080E5 		str	r1, [r0, #52]
7060:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4515              		.loc 2 7060 0
 4516 0004 382080E5 		str	r2, [r0, #56]
 4517 0008 1EFF2FE1 		bx	lr
 4518              		.cfi_endproc
 4519              	.LFE76:
 4521              		.section	.text.mbedtls_ssl_conf_rng,"ax",%progbits
 4522              		.align	2
 4523              		.global	mbedtls_ssl_conf_rng
 4524              		.syntax unified
 4525              		.arm
 4526              		.fpu neon
 4528              	mbedtls_ssl_conf_rng:
 4529              	.LFB77:
7067:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_rng      = f_rng;
 4530              		.loc 2 7067 0
 4531              		.cfi_startproc
 4532              		@ args = 0, pretend = 0, frame = 0
 4533              		@ frame_needed = 0, uses_anonymous_args = 0
 4534              		@ link register save eliminated.
 4535              	.LVL505:
7068:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_rng      = p_rng;
 4536              		.loc 2 7068 0
 4537 0000 181080E5 		str	r1, [r0, #24]
7069:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4538              		.loc 2 7069 0
 4539 0004 1C2080E5 		str	r2, [r0, #28]
 4540 0008 1EFF2FE1 		bx	lr
 4541              		.cfi_endproc
 4542              	.LFE77:
 4544              		.section	.text.mbedtls_ssl_conf_dbg,"ax",%progbits
 4545              		.align	2
 4546              		.global	mbedtls_ssl_conf_dbg
 4547              		.syntax unified
 4548              		.arm
 4549              		.fpu neon
 4551              	mbedtls_ssl_conf_dbg:
 4552              	.LFB78:
7075:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_dbg      = f_dbg;
 4553              		.loc 2 7075 0
 4554              		.cfi_startproc
 4555              		@ args = 0, pretend = 0, frame = 0
 4556              		@ frame_needed = 0, uses_anonymous_args = 0
 4557              		@ link register save eliminated.
 4558              	.LVL506:
7076:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_dbg      = p_dbg;
 4559              		.loc 2 7076 0
 4560 0000 101080E5 		str	r1, [r0, #16]
7077:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4561              		.loc 2 7077 0
 4562 0004 142080E5 		str	r2, [r0, #20]
 4563 0008 1EFF2FE1 		bx	lr
 4564              		.cfi_endproc
 4565              	.LFE78:
 4567              		.section	.text.mbedtls_ssl_set_bio,"ax",%progbits
 4568              		.align	2
 4569              		.global	mbedtls_ssl_set_bio
 4570              		.syntax unified
 4571              		.arm
 4572              		.fpu neon
 4574              	mbedtls_ssl_set_bio:
 4575              	.LFB79:
7085:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->p_bio          = p_bio;
 4576              		.loc 2 7085 0
 4577              		.cfi_startproc
 4578              		@ args = 4, pretend = 0, frame = 0
 4579              		@ frame_needed = 0, uses_anonymous_args = 0
 4580              		@ link register save eliminated.
 4581              	.LVL507:
7088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_recv_timeout = f_recv_timeout;
 4582              		.loc 2 7088 0
 4583 0000 143080E5 		str	r3, [r0, #20]
7089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4584              		.loc 2 7089 0
 4585 0004 00309DE5 		ldr	r3, [sp]
 4586              	.LVL508:
7086:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_send         = f_send;
 4587              		.loc 2 7086 0
 4588 0008 1C1080E5 		str	r1, [r0, #28]
7087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_recv         = f_recv;
 4589              		.loc 2 7087 0
 4590 000c 102080E5 		str	r2, [r0, #16]
7089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4591              		.loc 2 7089 0
 4592 0010 183080E5 		str	r3, [r0, #24]
 4593 0014 1EFF2FE1 		bx	lr
 4594              		.cfi_endproc
 4595              	.LFE79:
 4597              		.section	.text.mbedtls_ssl_conf_read_timeout,"ax",%progbits
 4598              		.align	2
 4599              		.global	mbedtls_ssl_conf_read_timeout
 4600              		.syntax unified
 4601              		.arm
 4602              		.fpu neon
 4604              	mbedtls_ssl_conf_read_timeout:
 4605              	.LFB80:
7100:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->read_timeout   = timeout;
 4606              		.loc 2 7100 0
 4607              		.cfi_startproc
 4608              		@ args = 0, pretend = 0, frame = 0
 4609              		@ frame_needed = 0, uses_anonymous_args = 0
 4610              		@ link register save eliminated.
 4611              	.LVL509:
7101:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4612              		.loc 2 7101 0
 4613 0000 581080E5 		str	r1, [r0, #88]
 4614 0004 1EFF2FE1 		bx	lr
 4615              		.cfi_endproc
 4616              	.LFE80:
 4618              		.section	.text.mbedtls_ssl_set_timer_cb,"ax",%progbits
 4619              		.align	2
 4620              		.global	mbedtls_ssl_set_timer_cb
 4621              		.syntax unified
 4622              		.arm
 4623              		.fpu neon
 4625              	mbedtls_ssl_set_timer_cb:
 4626              	.LFB81:
7108:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->p_timer        = p_timer;
 4627              		.loc 2 7108 0
 4628              		.cfi_startproc
 4629              		@ args = 0, pretend = 0, frame = 0
 4630              		@ frame_needed = 0, uses_anonymous_args = 0
 4631              		@ link register save eliminated.
 4632              	.LVL510:
7109:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_set_timer    = f_set_timer;
 4633              		.loc 2 7109 0
 4634 0000 441080E5 		str	r1, [r0, #68]
7114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4635              		.loc 2 7114 0
 4636 0004 0010A0E3 		mov	r1, #0
 4637              	.LVL511:
7110:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->f_get_timer    = f_get_timer;
 4638              		.loc 2 7110 0
 4639 0008 482080E5 		str	r2, [r0, #72]
7111:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4640              		.loc 2 7111 0
 4641 000c 4C3080E5 		str	r3, [r0, #76]
7114:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4642              		.loc 2 7114 0
 4643 0010 FEFFFFEA 		b	ssl_set_timer
 4644              	.LVL512:
 4645              		.cfi_endproc
 4646              	.LFE81:
 4648              		.section	.text.mbedtls_ssl_conf_ciphersuites,"ax",%progbits
 4649              		.align	2
 4650              		.global	mbedtls_ssl_conf_ciphersuites
 4651              		.syntax unified
 4652              		.arm
 4653              		.fpu neon
 4655              	mbedtls_ssl_conf_ciphersuites:
 4656              	.LFB83:
7153:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_0] = ciphersuites;
 4657              		.loc 2 7153 0
 4658              		.cfi_startproc
 4659              		@ args = 0, pretend = 0, frame = 0
 4660              		@ frame_needed = 0, uses_anonymous_args = 0
 4661              		@ link register save eliminated.
 4662              	.LVL513:
7154:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] = ciphersuites;
 4663              		.loc 2 7154 0
 4664 0000 001080E5 		str	r1, [r0]
7155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] = ciphersuites;
 4665              		.loc 2 7155 0
 4666 0004 041080E5 		str	r1, [r0, #4]
7156:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] = ciphersuites;
 4667              		.loc 2 7156 0
 4668 0008 081080E5 		str	r1, [r0, #8]
7157:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4669              		.loc 2 7157 0
 4670 000c 0C1080E5 		str	r1, [r0, #12]
 4671 0010 1EFF2FE1 		bx	lr
 4672              		.cfi_endproc
 4673              	.LFE83:
 4675              		.section	.text.mbedtls_ssl_conf_ciphersuites_for_version,"ax",%progbits
 4676              		.align	2
 4677              		.global	mbedtls_ssl_conf_ciphersuites_for_version
 4678              		.syntax unified
 4679              		.arm
 4680              		.fpu neon
 4682              	mbedtls_ssl_conf_ciphersuites_for_version:
 4683              	.LFB84:
7163:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( major != MBEDTLS_SSL_MAJOR_VERSION_3 )
 4684              		.loc 2 7163 0
 4685              		.cfi_startproc
 4686              		@ args = 0, pretend = 0, frame = 0
 4687              		@ frame_needed = 0, uses_anonymous_args = 0
 4688              		@ link register save eliminated.
 4689              	.LVL514:
7164:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
 4690              		.loc 2 7164 0
 4691 0000 030052E3 		cmp	r2, #3
 4692 0004 1EFF2F11 		bxne	lr
7167:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
 4693              		.loc 2 7167 0
 4694 0008 030053E3 		cmp	r3, #3
7170:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4695              		.loc 2 7170 0
 4696 000c 03118097 		strls	r1, [r0, r3, lsl #2]
 4697 0010 1EFF2FE1 		bx	lr
 4698              		.cfi_endproc
 4699              	.LFE84:
 4701              		.section	.text.mbedtls_ssl_conf_cert_profile,"ax",%progbits
 4702              		.align	2
 4703              		.global	mbedtls_ssl_conf_cert_profile
 4704              		.syntax unified
 4705              		.arm
 4706              		.fpu neon
 4708              	mbedtls_ssl_conf_cert_profile:
 4709              	.LFB85:
7176:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->cert_profile = profile;
 4710              		.loc 2 7176 0
 4711              		.cfi_startproc
 4712              		@ args = 0, pretend = 0, frame = 0
 4713              		@ frame_needed = 0, uses_anonymous_args = 0
 4714              		@ link register save eliminated.
 4715              	.LVL515:
7177:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4716              		.loc 2 7177 0
 4717 0000 3C1080E5 		str	r1, [r0, #60]
 4718 0004 1EFF2FE1 		bx	lr
 4719              		.cfi_endproc
 4720              	.LFE85:
 4722              		.section	.text.mbedtls_ssl_conf_own_cert,"ax",%progbits
 4723              		.align	2
 4724              		.global	mbedtls_ssl_conf_own_cert
 4725              		.syntax unified
 4726              		.arm
 4727              		.fpu neon
 4729              	mbedtls_ssl_conf_own_cert:
 4730              	.LFB87:
7214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_append_key_cert( &conf->key_cert, own_cert, pk_key ) );
 4731              		.loc 2 7214 0
 4732              		.cfi_startproc
 4733              		@ args = 0, pretend = 0, frame = 0
 4734              		@ frame_needed = 0, uses_anonymous_args = 0
 4735              		@ link register save eliminated.
 4736              	.LVL516:
7215:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4737              		.loc 2 7215 0
 4738 0000 400080E2 		add	r0, r0, #64
 4739              	.LVL517:
 4740 0004 FEFFFFEA 		b	ssl_append_key_cert
 4741              	.LVL518:
 4742              		.cfi_endproc
 4743              	.LFE87:
 4745              		.section	.text.mbedtls_ssl_conf_ca_chain,"ax",%progbits
 4746              		.align	2
 4747              		.global	mbedtls_ssl_conf_ca_chain
 4748              		.syntax unified
 4749              		.arm
 4750              		.fpu neon
 4752              	mbedtls_ssl_conf_ca_chain:
 4753              	.LFB88:
7221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ca_chain   = ca_chain;
 4754              		.loc 2 7221 0
 4755              		.cfi_startproc
 4756              		@ args = 0, pretend = 0, frame = 0
 4757              		@ frame_needed = 0, uses_anonymous_args = 0
 4758              		@ link register save eliminated.
 4759              	.LVL519:
7222:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->ca_crl     = ca_crl;
 4760              		.loc 2 7222 0
 4761 0000 441080E5 		str	r1, [r0, #68]
7223:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4762              		.loc 2 7223 0
 4763 0004 482080E5 		str	r2, [r0, #72]
 4764 0008 1EFF2FE1 		bx	lr
 4765              		.cfi_endproc
 4766              	.LFE88:
 4768              		.section	.text.mbedtls_ssl_set_hs_own_cert,"ax",%progbits
 4769              		.align	2
 4770              		.global	mbedtls_ssl_set_hs_own_cert
 4771              		.syntax unified
 4772              		.arm
 4773              		.fpu neon
 4775              	mbedtls_ssl_set_hs_own_cert:
 4776              	.LFB89:
7231:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_append_key_cert( &ssl->handshake->sni_key_cert,
 4777              		.loc 2 7231 0
 4778              		.cfi_startproc
 4779              		@ args = 0, pretend = 0, frame = 0
 4780              		@ frame_needed = 0, uses_anonymous_args = 0
 4781              		@ link register save eliminated.
 4782              	.LVL520:
7232:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  own_cert, pk_key ) );
 4783              		.loc 2 7232 0
 4784 0000 300090E5 		ldr	r0, [r0, #48]
 4785              	.LVL521:
 4786 0004 510F80E2 		add	r0, r0, #324
 4787 0008 FEFFFFEA 		b	ssl_append_key_cert
 4788              	.LVL522:
 4789              		.cfi_endproc
 4790              	.LFE89:
 4792              		.section	.text.mbedtls_ssl_set_hs_ca_chain,"ax",%progbits
 4793              		.align	2
 4794              		.global	mbedtls_ssl_set_hs_ca_chain
 4795              		.syntax unified
 4796              		.arm
 4797              		.fpu neon
 4799              	mbedtls_ssl_set_hs_ca_chain:
 4800              	.LFB90:
7239:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->sni_ca_chain   = ca_chain;
 4801              		.loc 2 7239 0
 4802              		.cfi_startproc
 4803              		@ args = 0, pretend = 0, frame = 0
 4804              		@ frame_needed = 0, uses_anonymous_args = 0
 4805              		@ link register save eliminated.
 4806              	.LVL523:
7240:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->sni_ca_crl     = ca_crl;
 4807              		.loc 2 7240 0
 4808 0000 303090E5 		ldr	r3, [r0, #48]
 4809 0004 481183E5 		str	r1, [r3, #328]
7241:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4810              		.loc 2 7241 0
 4811 0008 4C2183E5 		str	r2, [r3, #332]
 4812 000c 1EFF2FE1 		bx	lr
 4813              		.cfi_endproc
 4814              	.LFE90:
 4816              		.section	.text.mbedtls_ssl_set_hs_authmode,"ax",%progbits
 4817              		.align	2
 4818              		.global	mbedtls_ssl_set_hs_authmode
 4819              		.syntax unified
 4820              		.arm
 4821              		.fpu neon
 4823              	mbedtls_ssl_set_hs_authmode:
 4824              	.LFB91:
7246:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake->sni_authmode = authmode;
 4825              		.loc 2 7246 0
 4826              		.cfi_startproc
 4827              		@ args = 0, pretend = 0, frame = 0
 4828              		@ frame_needed = 0, uses_anonymous_args = 0
 4829              		@ link register save eliminated.
 4830              	.LVL524:
7247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4831              		.loc 2 7247 0
 4832 0000 303090E5 		ldr	r3, [r0, #48]
 4833 0004 401183E5 		str	r1, [r3, #320]
 4834 0008 1EFF2FE1 		bx	lr
 4835              		.cfi_endproc
 4836              	.LFE91:
 4838              		.section	.text.mbedtls_ssl_conf_sig_hashes,"ax",%progbits
 4839              		.align	2
 4840              		.global	mbedtls_ssl_conf_sig_hashes
 4841              		.syntax unified
 4842              		.arm
 4843              		.fpu neon
 4845              	mbedtls_ssl_conf_sig_hashes:
 4846              	.LFB92:
7434:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->sig_hashes = hashes;
 4847              		.loc 2 7434 0
 4848              		.cfi_startproc
 4849              		@ args = 0, pretend = 0, frame = 0
 4850              		@ frame_needed = 0, uses_anonymous_args = 0
 4851              		@ link register save eliminated.
 4852              	.LVL525:
7435:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4853              		.loc 2 7435 0
 4854 0000 4C1080E5 		str	r1, [r0, #76]
 4855 0004 1EFF2FE1 		bx	lr
 4856              		.cfi_endproc
 4857              	.LFE92:
 4859              		.section	.text.mbedtls_ssl_conf_curves,"ax",%progbits
 4860              		.align	2
 4861              		.global	mbedtls_ssl_conf_curves
 4862              		.syntax unified
 4863              		.arm
 4864              		.fpu neon
 4866              	mbedtls_ssl_conf_curves:
 4867              	.LFB93:
7445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->curve_list = curve_list;
 4868              		.loc 2 7445 0
 4869              		.cfi_startproc
 4870              		@ args = 0, pretend = 0, frame = 0
 4871              		@ frame_needed = 0, uses_anonymous_args = 0
 4872              		@ link register save eliminated.
 4873              	.LVL526:
7446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4874              		.loc 2 7446 0
 4875 0000 501080E5 		str	r1, [r0, #80]
 4876 0004 1EFF2FE1 		bx	lr
 4877              		.cfi_endproc
 4878              	.LFE93:
 4880              		.section	.text.mbedtls_ssl_set_hostname,"ax",%progbits
 4881              		.align	2
 4882              		.global	mbedtls_ssl_set_hostname
 4883              		.syntax unified
 4884              		.arm
 4885              		.fpu neon
 4887              	mbedtls_ssl_set_hostname:
 4888              	.LFB94:
7452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Initialize to suppress unnecessary compiler warning */
 4889              		.loc 2 7452 0
 4890              		.cfi_startproc
 4891              		@ args = 0, pretend = 0, frame = 0
 4892              		@ frame_needed = 0, uses_anonymous_args = 0
 4893              	.LVL527:
 4894 0000 F0412DE9 		push	{r4, r5, r6, r7, r8, lr}
 4895              		.cfi_def_cfa_offset 24
 4896              		.cfi_offset 4, -24
 4897              		.cfi_offset 5, -20
 4898              		.cfi_offset 6, -16
 4899              		.cfi_offset 7, -12
 4900              		.cfi_offset 8, -8
 4901              		.cfi_offset 14, -4
7458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4902              		.loc 2 7458 0
 4903 0004 004051E2 		subs	r4, r1, #0
7452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Initialize to suppress unnecessary compiler warning */
 4904              		.loc 2 7452 0
 4905 0008 0060A0E1 		mov	r6, r0
7458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4906              		.loc 2 7458 0
 4907 000c 0600000A 		beq	.L411
7460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4908              		.loc 2 7460 0
 4909 0010 0400A0E1 		mov	r0, r4
 4910              	.LVL528:
 4911 0014 FEFFFFEB 		bl	strlen
 4912              	.LVL529:
7462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 4913              		.loc 2 7462 0
 4914 0018 FF0050E3 		cmp	r0, #255
7460:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4915              		.loc 2 7460 0
 4916 001c 0050A0E1 		mov	r5, r0
 4917              	.LVL530:
7462:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 4918              		.loc 2 7462 0
 4919 0020 0200009A 		bls	.L407
7463:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4920              		.loc 2 7463 0
 4921 0024 7C009FE5 		ldr	r0, .L418
 4922              	.LVL531:
 4923 0028 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 4924              	.LVL532:
 4925              	.L411:
7454:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4926              		.loc 2 7454 0
 4927 002c 0450A0E1 		mov	r5, r4
 4928              	.LVL533:
 4929              	.L407:
7469:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4930              		.loc 2 7469 0
 4931 0030 B47096E5 		ldr	r7, [r6, #180]
 4932 0034 000057E3 		cmp	r7, #0
 4933 0038 0600000A 		beq	.L409
7471:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->hostname );
 4934              		.loc 2 7471 0
 4935 003c 0700A0E1 		mov	r0, r7
 4936 0040 FEFFFFEB 		bl	strlen
 4937              	.LVL534:
 4938 0044 0010A0E1 		mov	r1, r0
 4939 0048 0700A0E1 		mov	r0, r7
 4940 004c FEFFFFEB 		bl	mbedtls_platform_zeroize
 4941              	.LVL535:
7472:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4942              		.loc 2 7472 0
 4943 0050 B40096E5 		ldr	r0, [r6, #180]
 4944 0054 FEFFFFEB 		bl	mbedtls_free
 4945              	.LVL536:
 4946              	.L409:
7477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 4947              		.loc 2 7477 0
 4948 0058 000054E3 		cmp	r4, #0
 4949 005c 0200001A 		bne	.L410
7479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4950              		.loc 2 7479 0
 4951 0060 B44086E5 		str	r4, [r6, #180]
7492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 4952              		.loc 2 7492 0
 4953 0064 0400A0E1 		mov	r0, r4
 4954 0068 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 4955              	.L410:
7483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->hostname == NULL )
 4956              		.loc 2 7483 0
 4957 006c 011085E2 		add	r1, r5, #1
 4958 0070 0100A0E3 		mov	r0, #1
 4959 0074 FEFFFFEB 		bl	mbedtls_calloc
 4960              	.LVL537:
7484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 4961              		.loc 2 7484 0
 4962 0078 000050E3 		cmp	r0, #0
7483:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ssl->hostname == NULL )
 4963              		.loc 2 7483 0
 4964 007c B40086E5 		str	r0, [r6, #180]
7484:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 4965              		.loc 2 7484 0
 4966 0080 0600000A 		beq	.L413
7487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4967              		.loc 2 7487 0
 4968 0084 0520A0E1 		mov	r2, r5
 4969 0088 0410A0E1 		mov	r1, r4
 4970 008c FEFFFFEB 		bl	memcpy
 4971              	.LVL538:
7489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 4972              		.loc 2 7489 0
 4973 0090 B43096E5 		ldr	r3, [r6, #180]
 4974 0094 0000A0E3 		mov	r0, #0
 4975 0098 0500C3E7 		strb	r0, [r3, r5]
 4976 009c F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 4977              	.L413:
7485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 4978              		.loc 2 7485 0
 4979 00a0 04009FE5 		ldr	r0, .L418+4
7493:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 4980              		.loc 2 7493 0
 4981 00a4 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 4982              	.L419:
 4983              		.align	2
 4984              	.L418:
 4985 00a8 008FFFFF 		.word	-28928
 4986 00ac 0081FFFF 		.word	-32512
 4987              		.cfi_endproc
 4988              	.LFE94:
 4990              		.section	.text.mbedtls_ssl_conf_sni,"ax",%progbits
 4991              		.align	2
 4992              		.global	mbedtls_ssl_conf_sni
 4993              		.syntax unified
 4994              		.arm
 4995              		.fpu neon
 4997              	mbedtls_ssl_conf_sni:
 4998              	.LFB95:
7501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->f_sni = f_sni;
 4999              		.loc 2 7501 0
 5000              		.cfi_startproc
 5001              		@ args = 0, pretend = 0, frame = 0
 5002              		@ frame_needed = 0, uses_anonymous_args = 0
 5003              		@ link register save eliminated.
 5004              	.LVL539:
7502:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->p_sni = p_sni;
 5005              		.loc 2 7502 0
 5006 0000 2C1080E5 		str	r1, [r0, #44]
7503:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5007              		.loc 2 7503 0
 5008 0004 302080E5 		str	r2, [r0, #48]
 5009 0008 1EFF2FE1 		bx	lr
 5010              		.cfi_endproc
 5011              	.LFE95:
 5013              		.section	.text.mbedtls_ssl_conf_alpn_protocols,"ax",%progbits
 5014              		.align	2
 5015              		.global	mbedtls_ssl_conf_alpn_protocols
 5016              		.syntax unified
 5017              		.arm
 5018              		.fpu neon
 5020              	mbedtls_ssl_conf_alpn_protocols:
 5021              	.LFB96:
7509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t cur_len, tot_len;
 5022              		.loc 2 7509 0
 5023              		.cfi_startproc
 5024              		@ args = 0, pretend = 0, frame = 0
 5025              		@ frame_needed = 0, uses_anonymous_args = 0
 5026              	.LVL540:
 5027 0000 F0412DE9 		push	{r4, r5, r6, r7, r8, lr}
 5028              		.cfi_def_cfa_offset 24
 5029              		.cfi_offset 4, -24
 5030              		.cfi_offset 5, -20
 5031              		.cfi_offset 6, -16
 5032              		.cfi_offset 7, -12
 5033              		.cfi_offset 8, -8
 5034              		.cfi_offset 14, -4
7509:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t cur_len, tot_len;
 5035              		.loc 2 7509 0
 5036 0004 0070A0E1 		mov	r7, r0
 5037 0008 0150A0E1 		mov	r5, r1
 5038 000c 046041E2 		sub	r6, r1, #4
7518:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     for( p = protos; *p != NULL; p++ )
 5039              		.loc 2 7518 0
 5040 0010 0040A0E3 		mov	r4, #0
7524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5041              		.loc 2 7524 0
 5042 0014 FF8F0FE3 		movw	r8, #65535
 5043              	.LVL541:
 5044              	.L422:
7519:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5045              		.loc 2 7519 0 discriminator 1
 5046 0018 0400B6E5 		ldr	r0, [r6, #4]!
 5047              	.LVL542:
 5048 001c 000050E3 		cmp	r0, #0
 5049 0020 0100001A 		bne	.L424
7528:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5050              		.loc 2 7528 0
 5051 0024 545087E5 		str	r5, [r7, #84]
7530:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5052              		.loc 2 7530 0
 5053 0028 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 5054              	.L424:
7521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         tot_len += cur_len;
 5055              		.loc 2 7521 0
 5056 002c FEFFFFEB 		bl	strlen
 5057              	.LVL543:
7522:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5058              		.loc 2 7522 0
 5059 0030 004084E0 		add	r4, r4, r0
 5060              	.LVL544:
7524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5061              		.loc 2 7524 0
 5062 0034 010040E2 		sub	r0, r0, #1
 5063              	.LVL545:
 5064 0038 080054E1 		cmp	r4, r8
 5065 003c FE005093 		cmpls	r0, #254
 5066 0040 F4FFFF9A 		bls	.L422
7525:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5067              		.loc 2 7525 0
 5068 0044 00009FE5 		ldr	r0, .L427
 5069              	.LVL546:
7531:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5070              		.loc 2 7531 0
 5071 0048 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 5072              	.L428:
 5073              		.align	2
 5074              	.L427:
 5075 004c 008FFFFF 		.word	-28928
 5076              		.cfi_endproc
 5077              	.LFE96:
 5079              		.section	.text.mbedtls_ssl_get_alpn_protocol,"ax",%progbits
 5080              		.align	2
 5081              		.global	mbedtls_ssl_get_alpn_protocol
 5082              		.syntax unified
 5083              		.arm
 5084              		.fpu neon
 5086              	mbedtls_ssl_get_alpn_protocol:
 5087              	.LFB97:
7534:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl->alpn_chosen );
 5088              		.loc 2 7534 0
 5089              		.cfi_startproc
 5090              		@ args = 0, pretend = 0, frame = 0
 5091              		@ frame_needed = 0, uses_anonymous_args = 0
 5092              		@ link register save eliminated.
 5093              	.LVL547:
7536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_ALPN */
 5094              		.loc 2 7536 0
 5095 0000 B80090E5 		ldr	r0, [r0, #184]
 5096              	.LVL548:
 5097 0004 1EFF2FE1 		bx	lr
 5098              		.cfi_endproc
 5099              	.LFE97:
 5101              		.section	.text.mbedtls_ssl_conf_max_version,"ax",%progbits
 5102              		.align	2
 5103              		.global	mbedtls_ssl_conf_max_version
 5104              		.syntax unified
 5105              		.arm
 5106              		.fpu neon
 5108              	mbedtls_ssl_conf_max_version:
 5109              	.LFB98:
7540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->max_major_ver = major;
 5110              		.loc 2 7540 0
 5111              		.cfi_startproc
 5112              		@ args = 0, pretend = 0, frame = 0
 5113              		@ frame_needed = 0, uses_anonymous_args = 0
 5114              		@ link register save eliminated.
 5115              	.LVL549:
7541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->max_minor_ver = minor;
 5116              		.loc 2 7541 0
 5117 0000 5C10C0E5 		strb	r1, [r0, #92]
7542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5118              		.loc 2 7542 0
 5119 0004 5D20C0E5 		strb	r2, [r0, #93]
 5120 0008 1EFF2FE1 		bx	lr
 5121              		.cfi_endproc
 5122              	.LFE98:
 5124              		.section	.text.mbedtls_ssl_conf_min_version,"ax",%progbits
 5125              		.align	2
 5126              		.global	mbedtls_ssl_conf_min_version
 5127              		.syntax unified
 5128              		.arm
 5129              		.fpu neon
 5131              	mbedtls_ssl_conf_min_version:
 5132              	.LFB99:
7546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->min_major_ver = major;
 5133              		.loc 2 7546 0
 5134              		.cfi_startproc
 5135              		@ args = 0, pretend = 0, frame = 0
 5136              		@ frame_needed = 0, uses_anonymous_args = 0
 5137              		@ link register save eliminated.
 5138              	.LVL550:
7547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->min_minor_ver = minor;
 5139              		.loc 2 7547 0
 5140 0000 5E10C0E5 		strb	r1, [r0, #94]
7548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5141              		.loc 2 7548 0
 5142 0004 5F20C0E5 		strb	r2, [r0, #95]
 5143 0008 1EFF2FE1 		bx	lr
 5144              		.cfi_endproc
 5145              	.LFE99:
 5147              		.section	.text.mbedtls_ssl_conf_encrypt_then_mac,"ax",%progbits
 5148              		.align	2
 5149              		.global	mbedtls_ssl_conf_encrypt_then_mac
 5150              		.syntax unified
 5151              		.arm
 5152              		.fpu neon
 5154              	mbedtls_ssl_conf_encrypt_then_mac:
 5155              	.LFB100:
7568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->encrypt_then_mac = etm;
 5156              		.loc 2 7568 0
 5157              		.cfi_startproc
 5158              		@ args = 0, pretend = 0, frame = 0
 5159              		@ frame_needed = 0, uses_anonymous_args = 0
 5160              		@ link register save eliminated.
 5161              	.LVL551:
7569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5162              		.loc 2 7569 0
 5163 0000 6130D0E5 		ldrb	r3, [r0, #97]	@ zero_extendqisi2
 5164 0004 9130C1E7 		bfi	r3, r1, #1, #1
 5165              	.LVL552:
 5166 0008 6130C0E5 		strb	r3, [r0, #97]
 5167 000c 1EFF2FE1 		bx	lr
 5168              		.cfi_endproc
 5169              	.LFE100:
 5171              		.section	.text.mbedtls_ssl_conf_extended_master_secret,"ax",%progbits
 5172              		.align	2
 5173              		.global	mbedtls_ssl_conf_extended_master_secret
 5174              		.syntax unified
 5175              		.arm
 5176              		.fpu neon
 5178              	mbedtls_ssl_conf_extended_master_secret:
 5179              	.LFB101:
7575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->extended_ms = ems;
 5180              		.loc 2 7575 0
 5181              		.cfi_startproc
 5182              		@ args = 0, pretend = 0, frame = 0
 5183              		@ frame_needed = 0, uses_anonymous_args = 0
 5184              		@ link register save eliminated.
 5185              	.LVL553:
7576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5186              		.loc 2 7576 0
 5187 0000 6130D0E5 		ldrb	r3, [r0, #97]	@ zero_extendqisi2
 5188 0004 1131C2E7 		bfi	r3, r1, #2, #1
 5189              	.LVL554:
 5190 0008 6130C0E5 		strb	r3, [r0, #97]
 5191 000c 1EFF2FE1 		bx	lr
 5192              		.cfi_endproc
 5193              	.LFE101:
 5195              		.section	.text.mbedtls_ssl_conf_max_frag_len,"ax",%progbits
 5196              		.align	2
 5197              		.global	mbedtls_ssl_conf_max_frag_len
 5198              		.syntax unified
 5199              		.arm
 5200              		.fpu neon
 5202              	mbedtls_ssl_conf_max_frag_len:
 5203              	.LFB102:
7589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( mfl_code >= MBEDTLS_SSL_MAX_FRAG_LEN_INVALID ||
 5204              		.loc 2 7589 0
 5205              		.cfi_startproc
 5206              		@ args = 0, pretend = 0, frame = 0
 5207              		@ frame_needed = 0, uses_anonymous_args = 0
 5208              		@ link register save eliminated.
 5209              	.LVL555:
7590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( mfl_code ) > MBEDTLS_TLS_EXT_ADV_CONTENT_LEN )
 5210              		.loc 2 7590 0
 5211 0000 040051E3 		cmp	r1, #4
 5212 0004 0C00008A 		bhi	.L438
 5213              	.LVL556:
 5214 0008 013041E2 		sub	r3, r1, #1
 5215 000c 030053E3 		cmp	r3, #3
 5216 0010 0400008A 		bhi	.L436
 5217              	.LVL557:
 5218 0014 28209FE5 		ldr	r2, .L439
 5219 0018 8330A0E1 		lsl	r3, r3, #1
 5220 001c B33092E1 		ldrh	r3, [r2, r3]
 5221 0020 020A53E3 		cmp	r3, #8192
 5222 0024 0400008A 		bhi	.L438
 5223              	.L436:
7596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5224              		.loc 2 7596 0
 5225 0028 B036D0E1 		ldrh	r3, [r0, #96]
 5226 002c 1133C8E7 		bfi	r3, r1, #6, #3
 5227              	.LVL558:
 5228 0030 B036C0E1 		strh	r3, [r0, #96]	@ movhi
7598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5229              		.loc 2 7598 0
 5230 0034 0000A0E3 		mov	r0, #0
 5231              	.LVL559:
 5232 0038 1EFF2FE1 		bx	lr
 5233              	.LVL560:
 5234              	.L438:
7593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5235              		.loc 2 7593 0
 5236 003c 04009FE5 		ldr	r0, .L439+4
 5237              	.LVL561:
7599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
 5238              		.loc 2 7599 0
 5239 0040 1EFF2FE1 		bx	lr
 5240              	.L440:
 5241              		.align	2
 5242              	.L439:
 5243 0044 00000000 		.word	.LANCHOR0
 5244 0048 008FFFFF 		.word	-28928
 5245              		.cfi_endproc
 5246              	.LFE102:
 5248              		.section	.text.mbedtls_ssl_conf_legacy_renegotiation,"ax",%progbits
 5249              		.align	2
 5250              		.global	mbedtls_ssl_conf_legacy_renegotiation
 5251              		.syntax unified
 5252              		.arm
 5253              		.fpu neon
 5255              	mbedtls_ssl_conf_legacy_renegotiation:
 5256              	.LFB103:
7617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     conf->allow_legacy_renegotiation = allow_legacy;
 5257              		.loc 2 7617 0
 5258              		.cfi_startproc
 5259              		@ args = 0, pretend = 0, frame = 0
 5260              		@ frame_needed = 0, uses_anonymous_args = 0
 5261              		@ link register save eliminated.
 5262              	.LVL562:
7618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5263              		.loc 2 7618 0
 5264 0000 6030D0E5 		ldrb	r3, [r0, #96]	@ zero_extendqisi2
 5265 0004 1132C5E7 		bfi	r3, r1, #4, #2
 5266 0008 6030C0E5 		strb	r3, [r0, #96]
 5267 000c 1EFF2FE1 		bx	lr
 5268              		.cfi_endproc
 5269              	.LFE103:
 5271              		.section	.text.mbedtls_ssl_get_bytes_avail,"ax",%progbits
 5272              		.align	2
 5273              		.global	mbedtls_ssl_get_bytes_avail
 5274              		.syntax unified
 5275              		.arm
 5276              		.fpu neon
 5278              	mbedtls_ssl_get_bytes_avail:
 5279              	.LFB104:
7711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl->in_offt == NULL ? 0 : ssl->in_msglen );
 5280              		.loc 2 7711 0
 5281              		.cfi_startproc
 5282              		@ args = 0, pretend = 0, frame = 0
 5283              		@ frame_needed = 0, uses_anonymous_args = 0
 5284              		@ link register save eliminated.
 5285              	.LVL563:
7712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5286              		.loc 2 7712 0
 5287 0000 683090E5 		ldr	r3, [r0, #104]
 5288 0004 000053E3 		cmp	r3, #0
 5289 0008 70009015 		ldrne	r0, [r0, #112]
 5290              	.LVL564:
 5291 000c 0300A001 		moveq	r0, r3
7713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5292              		.loc 2 7713 0
 5293 0010 1EFF2FE1 		bx	lr
 5294              		.cfi_endproc
 5295              	.LFE104:
 5297              		.section	.text.mbedtls_ssl_check_pending,"ax",%progbits
 5298              		.align	2
 5299              		.global	mbedtls_ssl_check_pending
 5300              		.syntax unified
 5301              		.arm
 5302              		.fpu neon
 5304              	mbedtls_ssl_check_pending:
 5305              	.LFB105:
7716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
 5306              		.loc 2 7716 0
 5307              		.cfi_startproc
 5308              		@ args = 0, pretend = 0, frame = 0
 5309              		@ frame_needed = 0, uses_anonymous_args = 0
 5310              		@ link register save eliminated.
 5311              	.LVL565:
7722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5312              		.loc 2 7722 0
 5313 0000 803090E5 		ldr	r3, [r0, #128]
 5314 0004 010053E3 		cmp	r3, #1
 5315 0008 0900000A 		beq	.L449
7745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5316              		.loc 2 7745 0
 5317 000c 783090E5 		ldr	r3, [r0, #120]
 5318 0010 000053E3 		cmp	r3, #0
 5319 0014 0200000A 		beq	.L447
7745:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5320              		.loc 2 7745 0 is_stmt 0 discriminator 1
 5321 0018 702090E5 		ldr	r2, [r0, #112]
 5322 001c 020053E1 		cmp	r3, r2
 5323 0020 0300003A 		bcc	.L449
 5324              	.L447:
7754:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5325              		.loc 2 7754 0 is_stmt 1
 5326 0024 680090E5 		ldr	r0, [r0, #104]
 5327              	.LVL566:
 5328 0028 000090E2 		adds	r0, r0, #0
 5329 002c 0100A013 		movne	r0, #1
 5330 0030 1EFF2FE1 		bx	lr
 5331              	.LVL567:
 5332              	.L449:
7725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5333              		.loc 2 7725 0
 5334 0034 0100A0E3 		mov	r0, #1
 5335              	.LVL568:
7768:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5336              		.loc 2 7768 0
 5337 0038 1EFF2FE1 		bx	lr
 5338              		.cfi_endproc
 5339              	.LFE105:
 5341              		.section	.text.mbedtls_ssl_get_verify_result,"ax",%progbits
 5342              		.align	2
 5343              		.global	mbedtls_ssl_get_verify_result
 5344              		.syntax unified
 5345              		.arm
 5346              		.fpu neon
 5348              	mbedtls_ssl_get_verify_result:
 5349              	.LFB106:
7771:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session != NULL )
 5350              		.loc 2 7771 0
 5351              		.cfi_startproc
 5352              		@ args = 0, pretend = 0, frame = 0
 5353              		@ frame_needed = 0, uses_anonymous_args = 0
 5354              		@ link register save eliminated.
 5355              	.LVL569:
7772:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->session->verify_result );
 5356              		.loc 2 7772 0
 5357 0000 283090E5 		ldr	r3, [r0, #40]
 5358 0004 000053E3 		cmp	r3, #0
 5359 0008 0100000A 		beq	.L454
 5360              	.L457:
7776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5361              		.loc 2 7776 0
 5362 000c 600093E5 		ldr	r0, [r3, #96]
 5363              	.LVL570:
 5364 0010 1EFF2FE1 		bx	lr
 5365              	.LVL571:
 5366              	.L454:
7775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ssl->session_negotiate->verify_result );
 5367              		.loc 2 7775 0
 5368 0014 2C3090E5 		ldr	r3, [r0, #44]
 5369 0018 000053E3 		cmp	r3, #0
 5370 001c FAFFFF1A 		bne	.L457
7778:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5371              		.loc 2 7778 0
 5372 0020 0000E0E3 		mvn	r0, #0
 5373              	.LVL572:
7779:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5374              		.loc 2 7779 0
 5375 0024 1EFF2FE1 		bx	lr
 5376              		.cfi_endproc
 5377              	.LFE106:
 5379              		.section	.text.mbedtls_ssl_get_ciphersuite,"ax",%progbits
 5380              		.align	2
 5381              		.global	mbedtls_ssl_get_ciphersuite
 5382              		.syntax unified
 5383              		.arm
 5384              		.fpu neon
 5386              	mbedtls_ssl_get_ciphersuite:
 5387              	.LFB107:
7782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->session == NULL )
 5388              		.loc 2 7782 0
 5389              		.cfi_startproc
 5390              		@ args = 0, pretend = 0, frame = 0
 5391              		@ frame_needed = 0, uses_anonymous_args = 0
 5392              		@ link register save eliminated.
 5393              	.LVL573:
7783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
 5394              		.loc 2 7783 0
 5395 0000 000050E3 		cmp	r0, #0
 5396 0004 0400000A 		beq	.L458
7783:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
 5397              		.loc 2 7783 0 is_stmt 0 discriminator 1
 5398 0008 283090E5 		ldr	r3, [r0, #40]
 5399 000c 000053E3 		cmp	r3, #0
 5400 0010 0100000A 		beq	.L458
7786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5401              		.loc 2 7786 0 is_stmt 1
 5402 0014 000093E5 		ldr	r0, [r3]
 5403              	.LVL574:
 5404 0018 FEFFFFEA 		b	mbedtls_ssl_get_ciphersuite_name
 5405              	.LVL575:
 5406              	.L458:
7787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5407              		.loc 2 7787 0
 5408 001c 0000A0E3 		mov	r0, #0
 5409              	.LVL576:
 5410 0020 1EFF2FE1 		bx	lr
 5411              		.cfi_endproc
 5412              	.LFE107:
 5414              		.section	.text.mbedtls_ssl_get_version,"ax",%progbits
 5415              		.align	2
 5416              		.global	mbedtls_ssl_get_version
 5417              		.syntax unified
 5418              		.arm
 5419              		.fpu neon
 5421              	mbedtls_ssl_get_version:
 5422              	.LFB108:
7790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 5423              		.loc 2 7790 0
 5424              		.cfi_startproc
 5425              		@ args = 0, pretend = 0, frame = 0
 5426              		@ frame_needed = 0, uses_anonymous_args = 0
 5427              		@ link register save eliminated.
 5428              	.LVL577:
 5429 0000 0C3090E5 		ldr	r3, [r0, #12]
 5430 0004 030053E3 		cmp	r3, #3
 5431 0008 08209F95 		ldrls	r2, .L467
 5432 000c 03019297 		ldrls	r0, [r2, r3, lsl #2]
 5433              	.LVL578:
7808:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5434              		.loc 2 7808 0
 5435 0010 04009F85 		ldrhi	r0, .L467+4
7825:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5436              		.loc 2 7825 0
 5437 0014 1EFF2FE1 		bx	lr
 5438              	.L468:
 5439              		.align	2
 5440              	.L467:
 5441 0018 00000000 		.word	.LANCHOR1
 5442 001c 00000000 		.word	.LC5
 5443              		.cfi_endproc
 5444              	.LFE108:
 5446              		.section	.text.mbedtls_ssl_get_record_expansion,"ax",%progbits
 5447              		.align	2
 5448              		.global	mbedtls_ssl_get_record_expansion
 5449              		.syntax unified
 5450              		.arm
 5451              		.fpu neon
 5453              	mbedtls_ssl_get_record_expansion:
 5454              	.LFB109:
7828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t transform_expansion = 0;
 5455              		.loc 2 7828 0
 5456              		.cfi_startproc
 5457              		@ args = 0, pretend = 0, frame = 0
 5458              		@ frame_needed = 0, uses_anonymous_args = 0
 5459              		@ link register save eliminated.
 5460              	.LVL579:
7830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     unsigned block_size;
 5461              		.loc 2 7830 0
 5462 0000 383090E5 		ldr	r3, [r0, #56]
 5463              	.LVL580:
7833:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( (int) mbedtls_ssl_hdr_len( ssl ) );
 5464              		.loc 2 7833 0
 5465 0004 000053E3 		cmp	r3, #0
 5466 0008 1A00000A 		beq	.L475
 5467              	.LVL581:
 5468              	.LBB324:
 5469              	.LBB325:
 435:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h ****         return MBEDTLS_MODE_NONE;
 5470              		.loc 3 435 0
 5471 000c 501093E5 		ldr	r1, [r3, #80]
 5472 0010 000051E3 		cmp	r1, #0
 5473 0014 1900000A 		beq	.L477
 5474              	.LVL582:
 5475              	.LBE325:
 5476              	.LBE324:
7841:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5477              		.loc 2 7841 0
 5478 0018 0120D1E5 		ldrb	r2, [r1, #1]	@ zero_extendqisi2
 5479 001c 022042E2 		sub	r2, r2, #2
 5480 0020 080052E3 		cmp	r2, #8
 5481 0024 02F19F97 		ldrls	pc, [pc, r2, asl #2]
 5482 0028 140000EA 		b	.L477
 5483              	.L472:
 5484 002c 5C000000 		.word	.L471
 5485 0030 80000000 		.word	.L477
 5486 0034 80000000 		.word	.L477
 5487 0038 80000000 		.word	.L477
 5488 003c 50000000 		.word	.L473
 5489 0040 50000000 		.word	.L473
 5490 0044 50000000 		.word	.L473
 5491 0048 80000000 		.word	.L477
 5492 004c 50000000 		.word	.L473
 5493              	.L473:
7847:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
 5494              		.loc 2 7847 0
 5495 0050 083093E5 		ldr	r3, [r3, #8]
 5496              	.LVL583:
 5497              	.L474:
7877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5498              		.loc 2 7877 0
 5499 0054 050083E2 		add	r0, r3, #5
 5500              	.LVL584:
 5501 0058 1EFF2FE1 		bx	lr
 5502              	.LVL585:
 5503              	.L471:
 5504              	.LBB326:
 5505              	.LBB327:
 421:D:\Work\DeviceTester\amazon-freertos\lib\third_party\mbedtls\include/mbedtls\cipher.h **** }
 5506              		.loc 3 421 0
 5507 005c 142091E5 		ldr	r2, [r1, #20]
 5508              	.LVL586:
 5509              	.LBE327:
 5510              	.LBE326:
7861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5511              		.loc 2 7861 0
 5512 0060 143093E5 		ldr	r3, [r3, #20]
 5513              	.LVL587:
7866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 transform_expansion += block_size;
 5514              		.loc 2 7866 0
 5515 0064 0C1090E5 		ldr	r1, [r0, #12]
7861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5516              		.loc 2 7861 0
 5517 0068 033082E0 		add	r3, r2, r3
 5518              	.LVL588:
7866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 transform_expansion += block_size;
 5519              		.loc 2 7866 0
 5520 006c 010051E3 		cmp	r1, #1
7867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_1 || MBEDTLS_SSL_PROTO_TLS1_2 */
 5521              		.loc 2 7867 0
 5522 0070 023083C0 		addgt	r3, r3, r2
 5523              	.LVL589:
 5524 0074 F6FFFFEA 		b	.L474
 5525              	.LVL590:
 5526              	.L475:
7834:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5527              		.loc 2 7834 0
 5528 0078 0500A0E3 		mov	r0, #5
 5529              	.LVL591:
 5530 007c 1EFF2FE1 		bx	lr
 5531              	.LVL592:
 5532              	.L477:
7874:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5533              		.loc 2 7874 0
 5534 0080 00009FE5 		ldr	r0, .L478
 5535              	.LVL593:
7878:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5536              		.loc 2 7878 0
 5537 0084 1EFF2FE1 		bx	lr
 5538              	.L479:
 5539              		.align	2
 5540              	.L478:
 5541 0088 0094FFFF 		.word	-27648
 5542              		.cfi_endproc
 5543              	.LFE109:
 5545              		.section	.text.mbedtls_ssl_get_max_frag_len,"ax",%progbits
 5546              		.align	2
 5547              		.global	mbedtls_ssl_get_max_frag_len
 5548              		.syntax unified
 5549              		.arm
 5550              		.fpu neon
 5552              	mbedtls_ssl_get_max_frag_len:
 5553              	.LFB110:
7882:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t max_len;
 5554              		.loc 2 7882 0
 5555              		.cfi_startproc
 5556              		@ args = 0, pretend = 0, frame = 0
 5557              		@ frame_needed = 0, uses_anonymous_args = 0
 5558              		@ link register save eliminated.
 5559              	.LVL594:
7888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5560              		.loc 2 7888 0
 5561 0000 003090E5 		ldr	r3, [r0]
7891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_out->mfl_code ) < max_len )
 5562              		.loc 2 7891 0
 5563 0004 241090E5 		ldr	r1, [r0, #36]
7888:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5564              		.loc 2 7888 0
 5565 0008 B036D3E1 		ldrh	r3, [r3, #96]
 5566              	.LBB334:
 5567              	.LBB335:
 255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5568              		.loc 2 255 0
 5569 000c 5333E2E7 		ubfx	r3, r3, #6, #3
 5570 0010 013043E2 		sub	r3, r3, #1
 5571 0014 030053E3 		cmp	r3, #3
 5572 0018 70209F95 		ldrls	r2, .L495
 5573 001c 8330A091 		lslls	r3, r3, #1
 5574 0020 022AA083 		movhi	r2, #8192
 5575 0024 B3209291 		ldrhls	r2, [r2, r3]
 5576              	.LBE335:
 5577              	.LBE334:
7891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_out->mfl_code ) < max_len )
 5578              		.loc 2 7891 0
 5579 0028 000051E3 		cmp	r1, #0
 5580 002c 0230A0E1 		mov	r3, r2
 5581              	.LVL595:
 5582 0030 0800000A 		beq	.L482
 5583              	.LVL596:
 5584              	.LBB336:
 5585              	.LBB337:
 255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5586              		.loc 2 255 0 discriminator 1
 5587 0034 6430D1E5 		ldrb	r3, [r1, #100]	@ zero_extendqisi2
 5588              	.LVL597:
 5589 0038 013043E2 		sub	r3, r3, #1
 5590              	.LVL598:
 5591 003c 030053E3 		cmp	r3, #3
 5592 0040 48109F95 		ldrls	r1, .L495
 5593 0044 8330A091 		lslls	r3, r3, #1
 5594              	.LVL599:
 5595 0048 023AA083 		movhi	r3, #8192
 5596              	.LVL600:
 5597 004c B3309191 		ldrhls	r3, [r1, r3]
 5598 0050 030052E1 		cmp	r2, r3
 5599 0054 0230A031 		movcc	r3, r2
 5600              	.L482:
 5601              	.LVL601:
 5602              	.LBE337:
 5603              	.LBE336:
7898:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl_mfl_code_to_length( ssl->session_negotiate->mfl_code ) < max_len )
 5604              		.loc 2 7898 0
 5605 0058 2C2090E5 		ldr	r2, [r0, #44]
 5606 005c 000052E3 		cmp	r2, #0
 5607 0060 0800000A 		beq	.L480
 5608              	.LVL602:
 5609              	.LBB338:
 5610              	.LBB339:
 255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5611              		.loc 2 255 0 discriminator 1
 5612 0064 6420D2E5 		ldrb	r2, [r2, #100]	@ zero_extendqisi2
 5613              	.LVL603:
 5614 0068 012042E2 		sub	r2, r2, #1
 5615              	.LVL604:
 5616 006c 030052E3 		cmp	r2, #3
 5617 0070 18109F95 		ldrls	r1, .L495
 5618 0074 8220A091 		lslls	r2, r2, #1
 5619              	.LVL605:
 5620 0078 022AA083 		movhi	r2, #8192
 5621              	.LVL606:
 5622 007c B2209191 		ldrhls	r2, [r1, r2]
 5623 0080 020053E1 		cmp	r3, r2
 5624 0084 0230A021 		movcs	r3, r2
 5625              	.LVL607:
 5626              	.L480:
 5627              	.LBE339:
 5628              	.LBE338:
7905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_MAX_FRAGMENT_LENGTH */
 5629              		.loc 2 7905 0
 5630 0088 0300A0E1 		mov	r0, r3
 5631              	.LVL608:
 5632 008c 1EFF2FE1 		bx	lr
 5633              	.L496:
 5634              		.align	2
 5635              	.L495:
 5636 0090 00000000 		.word	.LANCHOR0
 5637              		.cfi_endproc
 5638              	.LFE110:
 5640              		.section	.text.mbedtls_ssl_get_max_out_record_payload,"ax",%progbits
 5641              		.align	2
 5642              		.global	mbedtls_ssl_get_max_out_record_payload
 5643              		.syntax unified
 5644              		.arm
 5645              		.fpu neon
 5647              	mbedtls_ssl_get_max_out_record_payload:
 5648              	.LFB111:
7929:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     size_t max_len = MBEDTLS_SSL_OUT_CONTENT_LEN;
 5649              		.loc 2 7929 0
 5650              		.cfi_startproc
 5651              		@ args = 0, pretend = 0, frame = 0
 5652              		@ frame_needed = 0, uses_anonymous_args = 0
 5653              	.LVL609:
 5654 0000 10402DE9 		push	{r4, lr}
 5655              		.cfi_def_cfa_offset 8
 5656              		.cfi_offset 4, -8
 5657              		.cfi_offset 14, -4
7938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5658              		.loc 2 7938 0
 5659 0004 FEFFFFEB 		bl	mbedtls_ssl_get_max_frag_len
 5660              	.LVL610:
7971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5661              		.loc 2 7971 0
 5662 0008 020A50E3 		cmp	r0, #8192
 5663 000c 020AA023 		movcs	r0, #8192
 5664              	.LVL611:
 5665 0010 1080BDE8 		pop	{r4, pc}
 5666              		.cfi_endproc
 5667              	.LFE111:
 5669              		.section	.text.mbedtls_ssl_get_peer_cert,"ax",%progbits
 5670              		.align	2
 5671              		.global	mbedtls_ssl_get_peer_cert
 5672              		.syntax unified
 5673              		.arm
 5674              		.fpu neon
 5676              	mbedtls_ssl_get_peer_cert:
 5677              	.LFB112:
7975:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL || ssl->session == NULL )
 5678              		.loc 2 7975 0
 5679              		.cfi_startproc
 5680              		@ args = 0, pretend = 0, frame = 0
 5681              		@ frame_needed = 0, uses_anonymous_args = 0
 5682              		@ link register save eliminated.
 5683              	.LVL612:
7976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
 5684              		.loc 2 7976 0
 5685 0000 000050E3 		cmp	r0, #0
 5686 0004 1EFF2F01 		bxeq	lr
7976:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( NULL );
 5687              		.loc 2 7976 0 is_stmt 0 discriminator 1
 5688 0008 280090E5 		ldr	r0, [r0, #40]
 5689              	.LVL613:
 5690 000c 000050E3 		cmp	r0, #0
7979:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5691              		.loc 2 7979 0 is_stmt 1 discriminator 1
 5692 0010 5C009015 		ldrne	r0, [r0, #92]
7980:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 5693              		.loc 2 7980 0 discriminator 1
 5694 0014 1EFF2FE1 		bx	lr
 5695              		.cfi_endproc
 5696              	.LFE112:
 5698              		.section	.text.mbedtls_ssl_handshake_step,"ax",%progbits
 5699              		.align	2
 5700              		.global	mbedtls_ssl_handshake_step
 5701              		.syntax unified
 5702              		.arm
 5703              		.fpu neon
 5705              	mbedtls_ssl_handshake_step:
 5706              	.LFB114:
8002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 5707              		.loc 2 8002 0
 5708              		.cfi_startproc
 5709              		@ args = 0, pretend = 0, frame = 0
 5710              		@ frame_needed = 0, uses_anonymous_args = 0
 5711              		@ link register save eliminated.
 5712              	.LVL614:
8005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5713              		.loc 2 8005 0
 5714 0000 003050E2 		subs	r3, r0, #0
 5715 0004 0600000A 		beq	.L508
8005:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5716              		.loc 2 8005 0 is_stmt 0 discriminator 1
 5717 0008 003093E5 		ldr	r3, [r3]
 5718 000c 000053E3 		cmp	r3, #0
 5719 0010 0300000A 		beq	.L508
8009:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = mbedtls_ssl_handshake_client_step( ssl );
 5720              		.loc 2 8009 0 is_stmt 1
 5721 0014 6030D3E5 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 5722 0018 010013E3 		tst	r3, #1
 5723 001c 0200001A 		bne	.L509
8010:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 5724              		.loc 2 8010 0
 5725 0020 FEFFFFEA 		b	mbedtls_ssl_handshake_client_step
 5726              	.LVL615:
 5727              	.L508:
8006:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5728              		.loc 2 8006 0
 5729 0024 08009FE5 		ldr	r0, .L510
 5730              	.LVL616:
 5731 0028 1EFF2FE1 		bx	lr
 5732              	.LVL617:
 5733              	.L509:
8003:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5734              		.loc 2 8003 0
 5735 002c 04009FE5 		ldr	r0, .L510+4
 5736              	.LVL618:
8018:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5737              		.loc 2 8018 0
 5738 0030 1EFF2FE1 		bx	lr
 5739              	.L511:
 5740              		.align	2
 5741              	.L510:
 5742 0034 008FFFFF 		.word	-28928
 5743 0038 808FFFFF 		.word	-28800
 5744              		.cfi_endproc
 5745              	.LFE114:
 5747              		.section	.text.mbedtls_ssl_handshake,"ax",%progbits
 5748              		.align	2
 5749              		.global	mbedtls_ssl_handshake
 5750              		.syntax unified
 5751              		.arm
 5752              		.fpu neon
 5754              	mbedtls_ssl_handshake:
 5755              	.LFB115:
8024:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 5756              		.loc 2 8024 0
 5757              		.cfi_startproc
 5758              		@ args = 0, pretend = 0, frame = 0
 5759              		@ frame_needed = 0, uses_anonymous_args = 0
 5760              	.LVL619:
 5761 0000 10402DE9 		push	{r4, lr}
 5762              		.cfi_def_cfa_offset 8
 5763              		.cfi_offset 4, -8
 5764              		.cfi_offset 14, -4
8027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5765              		.loc 2 8027 0
 5766 0004 004050E2 		subs	r4, r0, #0
 5767 0008 0200000A 		beq	.L517
8027:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5768              		.loc 2 8027 0 is_stmt 0 discriminator 1
 5769 000c 003094E5 		ldr	r3, [r4]
 5770 0010 000053E3 		cmp	r3, #0
 5771 0014 0500001A 		bne	.L514
 5772              	.L517:
8028:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5773              		.loc 2 8028 0 is_stmt 1
 5774 0018 24009FE5 		ldr	r0, .L519
 5775              	.LVL620:
8043:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5776              		.loc 2 8043 0
 5777 001c 1080BDE8 		pop	{r4, pc}
 5778              	.L515:
8034:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5779              		.loc 2 8034 0
 5780 0020 0400A0E1 		mov	r0, r4
 5781 0024 FEFFFFEB 		bl	mbedtls_ssl_handshake_step
 5782              	.LVL621:
8036:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
 5783              		.loc 2 8036 0
 5784 0028 000050E3 		cmp	r0, #0
 5785 002c 1080BD18 		popne	{r4, pc}
 5786              	.LVL622:
 5787              	.L514:
8032:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5788              		.loc 2 8032 0
 5789 0030 043094E5 		ldr	r3, [r4, #4]
 5790 0034 100053E3 		cmp	r3, #16
 5791 0038 F8FFFF1A 		bne	.L515
 5792 003c 0000A0E3 		mov	r0, #0
 5793 0040 1080BDE8 		pop	{r4, pc}
 5794              	.L520:
 5795              		.align	2
 5796              	.L519:
 5797 0044 008FFFFF 		.word	-28928
 5798              		.cfi_endproc
 5799              	.LFE115:
 5801              		.section	.text.mbedtls_ssl_read,"ax",%progbits
 5802              		.align	2
 5803              		.global	mbedtls_ssl_read
 5804              		.syntax unified
 5805              		.arm
 5806              		.fpu neon
 5808              	mbedtls_ssl_read:
 5809              	.LFB116:
8209:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 5810              		.loc 2 8209 0
 5811              		.cfi_startproc
 5812              		@ args = 0, pretend = 0, frame = 0
 5813              		@ frame_needed = 0, uses_anonymous_args = 0
 5814              	.LVL623:
 5815 0000 70402DE9 		push	{r4, r5, r6, lr}
 5816              		.cfi_def_cfa_offset 16
 5817              		.cfi_offset 4, -16
 5818              		.cfi_offset 5, -12
 5819              		.cfi_offset 6, -8
 5820              		.cfi_offset 14, -4
8213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5821              		.loc 2 8213 0
 5822 0004 004050E2 		subs	r4, r0, #0
 5823 0008 6300000A 		beq	.L540
8213:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 5824              		.loc 2 8213 0 is_stmt 0 discriminator 1
 5825 000c 003094E5 		ldr	r3, [r4]
 5826 0010 000053E3 		cmp	r3, #0
 5827 0014 6000000A 		beq	.L540
8255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5828              		.loc 2 8255 0 is_stmt 1
 5829 0018 043094E5 		ldr	r3, [r4, #4]
 5830 001c 0250A0E1 		mov	r5, r2
 5831 0020 0160A0E1 		mov	r6, r1
 5832 0024 100053E3 		cmp	r3, #16
 5833 0028 4700000A 		beq	.L524
8257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( ret != MBEDTLS_ERR_SSL_WAITING_SERVER_HELLO_RENEGO &&
 5834              		.loc 2 8257 0
 5835 002c FEFFFFEB 		bl	mbedtls_ssl_handshake
 5836              	.LVL624:
8258:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ret != 0 )
 5837              		.loc 2 8258 0
 5838 0030 000050E3 		cmp	r0, #0
 5839 0034 6B0C7013 		cmnne	r0, #27392
 5840 0038 4300000A 		beq	.L524
 5841 003c 7080BDE8 		pop	{r4, r5, r6, pc}
 5842              	.LVL625:
 5843              	.L536:
8270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->f_get_timer( ssl->p_timer ) == -1 )
 5844              		.loc 2 8270 0
 5845 0040 4C3094E5 		ldr	r3, [r4, #76]
 5846 0044 000053E3 		cmp	r3, #0
 5847 0048 0700000A 		beq	.L527
8271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 5848              		.loc 2 8271 0 discriminator 1
 5849 004c 440094E5 		ldr	r0, [r4, #68]
 5850 0050 33FF2FE1 		blx	r3
 5851              	.LVL626:
8270:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->f_get_timer( ssl->p_timer ) == -1 )
 5852              		.loc 2 8270 0 discriminator 1
 5853 0054 010070E3 		cmn	r0, #1
 5854 0058 0300001A 		bne	.L527
8273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 5855              		.loc 2 8273 0
 5856 005c 003094E5 		ldr	r3, [r4]
 5857 0060 0400A0E1 		mov	r0, r4
 5858 0064 581093E5 		ldr	r1, [r3, #88]
 5859 0068 FEFFFFEB 		bl	ssl_set_timer
 5860              	.LVL627:
 5861              	.L527:
8276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 5862              		.loc 2 8276 0
 5863 006c 0110A0E3 		mov	r1, #1
 5864 0070 0400A0E1 		mov	r0, r4
 5865 0074 FEFFFFEB 		bl	mbedtls_ssl_read_record
 5866              	.LVL628:
 5867 0078 000050E3 		cmp	r0, #0
 5868 007c 0300000A 		beq	.L529
 5869              	.L551:
8278:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 return( 0 );
 5870              		.loc 2 8278 0
 5871 0080 34319FE5 		ldr	r3, .L552
 5872 0084 030050E1 		cmp	r0, r3
8279:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5873              		.loc 2 8279 0
 5874 0088 0000A003 		moveq	r0, #0
 5875              	.LVL629:
 5876 008c 7080BDE8 		pop	{r4, r5, r6, pc}
 5877              	.LVL630:
 5878              	.L529:
8285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA )
 5879              		.loc 2 8285 0
 5880 0090 703094E5 		ldr	r3, [r4, #112]
 5881 0094 000053E3 		cmp	r3, #0
 5882 0098 0700001A 		bne	.L530
8285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->in_msgtype == MBEDTLS_SSL_MSG_APPLICATION_DATA )
 5883              		.loc 2 8285 0 is_stmt 0 discriminator 1
 5884 009c 6C3094E5 		ldr	r3, [r4, #108]
 5885 00a0 170053E3 		cmp	r3, #23
 5886 00a4 0400001A 		bne	.L530
8291:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 5887              		.loc 2 8291 0 is_stmt 1
 5888 00a8 0110A0E3 		mov	r1, #1
 5889 00ac 0400A0E1 		mov	r0, r4
 5890              	.LVL631:
 5891 00b0 FEFFFFEB 		bl	mbedtls_ssl_read_record
 5892              	.LVL632:
 5893 00b4 000050E3 		cmp	r0, #0
 5894 00b8 F0FFFF1A 		bne	.L551
 5895              	.L530:
8301:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 5896              		.loc 2 8301 0
 5897 00bc 6C3094E5 		ldr	r3, [r4, #108]
 5898 00c0 160053E3 		cmp	r3, #22
 5899 00c4 1400001A 		bne	.L532
8312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ( ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_REQUEST ||
 5900              		.loc 2 8312 0
 5901 00c8 003094E5 		ldr	r3, [r4]
 5902 00cc 6030D3E5 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 5903 00d0 010013E3 		tst	r3, #1
 5904 00d4 0600001A 		bne	.L533
8313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) ) )
 5905              		.loc 2 8313 0 discriminator 1
 5906 00d8 643094E5 		ldr	r3, [r4, #100]
8312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ( ssl->in_msg[0] != MBEDTLS_SSL_HS_HELLO_REQUEST ||
 5907              		.loc 2 8312 0 discriminator 1
 5908 00dc 0030D3E5 		ldrb	r3, [r3]	@ zero_extendqisi2
 5909 00e0 000053E3 		cmp	r3, #0
 5910 00e4 3200001A 		bne	.L545
 5911              	.LVL633:
8313:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   ssl->in_hslen  != mbedtls_ssl_hs_hdr_len( ssl ) ) )
 5912              		.loc 2 8313 0
 5913 00e8 783094E5 		ldr	r3, [r4, #120]
 5914 00ec 040053E3 		cmp	r3, #4
 5915 00f0 2F00001A 		bne	.L545
 5916              	.LVL634:
 5917              	.L533:
8395:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 {
 5918              		.loc 2 8395 0
 5919 00f4 0C3094E5 		ldr	r3, [r4, #12]
 5920 00f8 000053E3 		cmp	r3, #0
 5921 00fc 280000DA 		ble	.L543
8397:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_ALERT_LEVEL_WARNING,
 5922              		.loc 2 8397 0
 5923 0100 6420A0E3 		mov	r2, #100
 5924 0104 0110A0E3 		mov	r1, #1
 5925 0108 0400A0E1 		mov	r0, r4
 5926              	.LVL635:
 5927 010c FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 5928              	.LVL636:
 5929 0110 000050E3 		cmp	r0, #0
 5930 0114 0C00000A 		beq	.L524
 5931 0118 7080BDE8 		pop	{r4, r5, r6, pc}
 5932              	.L532:
8449:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 5933              		.loc 2 8449 0
 5934 011c 150053E3 		cmp	r3, #21
 5935 0120 2100000A 		beq	.L544
8455:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 5936              		.loc 2 8455 0
 5937 0124 170053E3 		cmp	r3, #23
 5938 0128 2100001A 		bne	.L545
8461:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5939              		.loc 2 8461 0
 5940 012c 643094E5 		ldr	r3, [r4, #100]
 5941 0130 683084E5 		str	r3, [r4, #104]
8465:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl_set_timer( ssl, 0 );
 5942              		.loc 2 8465 0
 5943 0134 043094E5 		ldr	r3, [r4, #4]
 5944 0138 100053E3 		cmp	r3, #16
 5945 013c 0200001A 		bne	.L524
8466:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5946              		.loc 2 8466 0
 5947 0140 0010A0E3 		mov	r1, #0
 5948 0144 0400A0E1 		mov	r0, r4
 5949              	.LVL637:
 5950 0148 FEFFFFEB 		bl	ssl_set_timer
 5951              	.LVL638:
 5952              	.L524:
8267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5953              		.loc 2 8267 0
 5954 014c 681094E5 		ldr	r1, [r4, #104]
 5955 0150 000051E3 		cmp	r1, #0
 5956 0154 B9FFFF0A 		beq	.L536
8486:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ? len : ssl->in_msglen;
 5957              		.loc 2 8486 0
 5958 0158 700094E5 		ldr	r0, [r4, #112]
 5959 015c 000055E1 		cmp	r5, r0
 5960 0160 0050A021 		movcs	r5, r0
 5961              	.LVL639:
8489:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen -= n;
 5962              		.loc 2 8489 0
 5963 0164 0600A0E1 		mov	r0, r6
 5964 0168 0520A0E1 		mov	r2, r5
 5965 016c FEFFFFEB 		bl	memcpy
 5966              	.LVL640:
8490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5967              		.loc 2 8490 0
 5968 0170 703094E5 		ldr	r3, [r4, #112]
8506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5969              		.loc 2 8506 0
 5970 0174 0500A0E1 		mov	r0, r5
8490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5971              		.loc 2 8490 0
 5972 0178 053043E0 		sub	r3, r3, r5
8492:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 5973              		.loc 2 8492 0
 5974 017c 000053E3 		cmp	r3, #0
8490:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5975              		.loc 2 8490 0
 5976 0180 703084E5 		str	r3, [r4, #112]
8501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5977              		.loc 2 8501 0
 5978 0184 68309415 		ldrne	r3, [r4, #104]
8495:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->keep_current_message = 0;
 5979              		.loc 2 8495 0
 5980 0188 68308405 		streq	r3, [r4, #104]
8496:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5981              		.loc 2 8496 0
 5982 018c 80308405 		streq	r3, [r4, #128]
8501:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 5983              		.loc 2 8501 0
 5984 0190 05308310 		addne	r3, r3, r5
 5985 0194 68308415 		strne	r3, [r4, #104]
8506:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 5986              		.loc 2 8506 0
 5987 0198 7080BDE8 		pop	{r4, r5, r6, pc}
 5988              	.LVL641:
 5989              	.L540:
8214:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 5990              		.loc 2 8214 0
 5991 019c 1C009FE5 		ldr	r0, .L552+4
 5992              	.LVL642:
 5993 01a0 7080BDE8 		pop	{r4, r5, r6, pc}
 5994              	.LVL643:
 5995              	.L543:
8409:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 }
 5996              		.loc 2 8409 0
 5997 01a4 18009FE5 		ldr	r0, .L552+8
 5998              	.LVL644:
 5999 01a8 7080BDE8 		pop	{r4, r5, r6, pc}
 6000              	.LVL645:
 6001              	.L544:
8452:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 6002              		.loc 2 8452 0
 6003 01ac 14009FE5 		ldr	r0, .L552+12
 6004              	.LVL646:
 6005 01b0 7080BDE8 		pop	{r4, r5, r6, pc}
 6006              	.LVL647:
 6007              	.L545:
8325:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 6008              		.loc 2 8325 0
 6009 01b4 10009FE5 		ldr	r0, .L552+16
 6010              	.LVL648:
8507:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6011              		.loc 2 8507 0
 6012 01b8 7080BDE8 		pop	{r4, r5, r6, pc}
 6013              	.L553:
 6014              		.align	2
 6015              	.L552:
 6016 01bc 808DFFFF 		.word	-29312
 6017 01c0 008FFFFF 		.word	-28928
 6018 01c4 0094FFFF 		.word	-27648
 6019 01c8 0097FFFF 		.word	-26880
 6020 01cc 0089FFFF 		.word	-30464
 6021              		.cfi_endproc
 6022              	.LFE116:
 6024              		.section	.text.mbedtls_ssl_write,"ax",%progbits
 6025              		.align	2
 6026              		.global	mbedtls_ssl_write
 6027              		.syntax unified
 6028              		.arm
 6029              		.fpu neon
 6031              	mbedtls_ssl_write:
 6032              	.LFB118:
8625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6033              		.loc 2 8625 0
 6034              		.cfi_startproc
 6035              		@ args = 0, pretend = 0, frame = 0
 6036              		@ frame_needed = 0, uses_anonymous_args = 0
 6037              	.LVL649:
 6038 0000 70402DE9 		push	{r4, r5, r6, lr}
 6039              		.cfi_def_cfa_offset 16
 6040              		.cfi_offset 4, -16
 6041              		.cfi_offset 5, -12
 6042              		.cfi_offset 6, -8
 6043              		.cfi_offset 14, -4
8630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 6044              		.loc 2 8630 0
 6045 0004 004050E2 		subs	r4, r0, #0
 6046 0008 2800000A 		beq	.L562
8630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 6047              		.loc 2 8630 0 is_stmt 0 discriminator 1
 6048 000c 003094E5 		ldr	r3, [r4]
 6049 0010 000053E3 		cmp	r3, #0
 6050 0014 2500000A 		beq	.L562
8641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6051              		.loc 2 8641 0 is_stmt 1
 6052 0018 043094E5 		ldr	r3, [r4, #4]
 6053 001c 0250A0E1 		mov	r5, r2
 6054 0020 0160A0E1 		mov	r6, r1
 6055 0024 100053E3 		cmp	r3, #16
 6056 0028 0400001A 		bne	.L556
 6057              	.LVL650:
 6058              	.L558:
 6059              	.LBB342:
 6060              	.LBB343:
8524:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const size_t max_len = (size_t) ret;
 6061              		.loc 2 8524 0
 6062 002c 0400A0E1 		mov	r0, r4
 6063 0030 FEFFFFEB 		bl	mbedtls_ssl_get_max_out_record_payload
 6064              	.LVL651:
8527:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6065              		.loc 2 8527 0
 6066 0034 000050E3 		cmp	r0, #0
 6067 0038 040000AA 		bge	.L566
 6068 003c 7080BDE8 		pop	{r4, r5, r6, pc}
 6069              	.LVL652:
 6070              	.L556:
 6071              	.LBE343:
 6072              	.LBE342:
8643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 6073              		.loc 2 8643 0
 6074 0040 FEFFFFEB 		bl	mbedtls_ssl_handshake
 6075              	.LVL653:
 6076 0044 000050E3 		cmp	r0, #0
 6077 0048 F7FFFF0A 		beq	.L558
 6078 004c 7080BDE8 		pop	{r4, r5, r6, pc}
 6079              	.LVL654:
 6080              	.L566:
 6081              	.LBB345:
 6082              	.LBB344:
8548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6083              		.loc 2 8548 0
 6084 0050 A43094E5 		ldr	r3, [r4, #164]
 6085 0054 000055E1 		cmp	r5, r0
 6086 0058 0050A021 		movcs	r5, r0
 6087              	.LVL655:
 6088 005c 000053E3 		cmp	r3, #0
 6089 0060 0500000A 		beq	.L559
8556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 6090              		.loc 2 8556 0
 6091 0064 0400A0E1 		mov	r0, r4
 6092              	.LVL656:
 6093 0068 FEFFFFEB 		bl	mbedtls_ssl_flush_output
 6094              	.LVL657:
 6095 006c 000050E3 		cmp	r0, #0
 6096 0070 7080BD18 		popne	{r4, r5, r6, pc}
 6097              	.L560:
8580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6098              		.loc 2 8580 0
 6099 0074 0500A0E1 		mov	r0, r5
 6100              	.LVL658:
 6101 0078 7080BDE8 		pop	{r4, r5, r6, pc}
 6102              	.LVL659:
 6103              	.L559:
8570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->out_msg, buf, len );
 6104              		.loc 2 8570 0
 6105 007c 1730A0E3 		mov	r3, #23
8571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6106              		.loc 2 8571 0
 6107 0080 0520A0E1 		mov	r2, r5
8570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memcpy( ssl->out_msg, buf, len );
 6108              		.loc 2 8570 0
 6109 0084 9C3084E5 		str	r3, [r4, #156]
8571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6110              		.loc 2 8571 0
 6111 0088 0610A0E1 		mov	r1, r6
8569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->out_msgtype = MBEDTLS_SSL_MSG_APPLICATION_DATA;
 6112              		.loc 2 8569 0
 6113 008c A05084E5 		str	r5, [r4, #160]
8571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6114              		.loc 2 8571 0
 6115 0090 980094E5 		ldr	r0, [r4, #152]
 6116              	.LVL660:
 6117 0094 FEFFFFEB 		bl	memcpy
 6118              	.LVL661:
8573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 6119              		.loc 2 8573 0
 6120 0098 0110A0E3 		mov	r1, #1
 6121 009c 0400A0E1 		mov	r0, r4
 6122 00a0 FEFFFFEB 		bl	mbedtls_ssl_write_record
 6123              	.LVL662:
 6124 00a4 000050E3 		cmp	r0, #0
 6125 00a8 F1FFFF0A 		beq	.L560
 6126 00ac 7080BDE8 		pop	{r4, r5, r6, pc}
 6127              	.LVL663:
 6128              	.L562:
 6129              	.LBE344:
 6130              	.LBE345:
8631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6131              		.loc 2 8631 0
 6132 00b0 00009FE5 		ldr	r0, .L568
 6133              	.LVL664:
8659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6134              		.loc 2 8659 0
 6135 00b4 7080BDE8 		pop	{r4, r5, r6, pc}
 6136              	.L569:
 6137              		.align	2
 6138              	.L568:
 6139 00b8 008FFFFF 		.word	-28928
 6140              		.cfi_endproc
 6141              	.LFE118:
 6143              		.section	.text.mbedtls_ssl_close_notify,"ax",%progbits
 6144              		.align	2
 6145              		.global	mbedtls_ssl_close_notify
 6146              		.syntax unified
 6147              		.arm
 6148              		.fpu neon
 6150              	mbedtls_ssl_close_notify:
 6151              	.LFB119:
8665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6152              		.loc 2 8665 0
 6153              		.cfi_startproc
 6154              		@ args = 0, pretend = 0, frame = 0
 6155              		@ frame_needed = 0, uses_anonymous_args = 0
 6156              		@ link register save eliminated.
 6157              	.LVL665:
8668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 6158              		.loc 2 8668 0
 6159 0000 003050E2 		subs	r3, r0, #0
 6160 0004 0B00000A 		beq	.L574
8668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_ERR_SSL_BAD_INPUT_DATA );
 6161              		.loc 2 8668 0 is_stmt 0 discriminator 1
 6162 0008 002093E5 		ldr	r2, [r3]
 6163 000c 000052E3 		cmp	r2, #0
 6164 0010 0800000A 		beq	.L574
8673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( mbedtls_ssl_flush_output( ssl ) );
 6165              		.loc 2 8673 0 is_stmt 1
 6166 0014 A42093E5 		ldr	r2, [r3, #164]
 6167 0018 000052E3 		cmp	r2, #0
 6168 001c 0000000A 		beq	.L572
8674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6169              		.loc 2 8674 0
 6170 0020 FEFFFFEA 		b	mbedtls_ssl_flush_output
 6171              	.LVL666:
 6172              	.L572:
8676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6173              		.loc 2 8676 0
 6174 0024 043093E5 		ldr	r3, [r3, #4]
 6175 0028 100053E3 		cmp	r3, #16
 6176 002c 0300001A 		bne	.L575
8678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                         MBEDTLS_SSL_ALERT_LEVEL_WARNING,
 6177              		.loc 2 8678 0
 6178 0030 0110A0E3 		mov	r1, #1
 6179 0034 FEFFFFEA 		b	mbedtls_ssl_send_alert_message
 6180              	.LVL667:
 6181              	.L574:
8669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6182              		.loc 2 8669 0
 6183 0038 08009FE5 		ldr	r0, .L576
 6184              	.LVL668:
 6185 003c 1EFF2FE1 		bx	lr
 6186              	.LVL669:
 6187              	.L575:
8689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6188              		.loc 2 8689 0
 6189 0040 0200A0E1 		mov	r0, r2
 6190              	.LVL670:
8690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6191              		.loc 2 8690 0
 6192 0044 1EFF2FE1 		bx	lr
 6193              	.L577:
 6194              		.align	2
 6195              	.L576:
 6196 0048 008FFFFF 		.word	-28928
 6197              		.cfi_endproc
 6198              	.LFE119:
 6200              		.section	.text.mbedtls_ssl_transform_free,"ax",%progbits
 6201              		.align	2
 6202              		.global	mbedtls_ssl_transform_free
 6203              		.syntax unified
 6204              		.arm
 6205              		.fpu neon
 6207              	mbedtls_ssl_transform_free:
 6208              	.LFB120:
8693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( transform == NULL )
 6209              		.loc 2 8693 0
 6210              		.cfi_startproc
 6211              		@ args = 0, pretend = 0, frame = 0
 6212              		@ frame_needed = 0, uses_anonymous_args = 0
 6213              	.LVL671:
 6214 0000 10402DE9 		push	{r4, lr}
 6215              		.cfi_def_cfa_offset 8
 6216              		.cfi_offset 4, -8
 6217              		.cfi_offset 14, -4
8694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
 6218              		.loc 2 8694 0
 6219 0004 004050E2 		subs	r4, r0, #0
 6220 0008 1080BD08 		popeq	{r4, pc}
8702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_free( &transform->cipher_ctx_dec );
 6221              		.loc 2 8702 0
 6222 000c 500084E2 		add	r0, r4, #80
 6223              	.LVL672:
 6224 0010 FEFFFFEB 		bl	mbedtls_cipher_free
 6225              	.LVL673:
8703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6226              		.loc 2 8703 0
 6227 0014 900084E2 		add	r0, r4, #144
 6228 0018 FEFFFFEB 		bl	mbedtls_cipher_free
 6229              	.LVL674:
8705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &transform->md_ctx_dec );
 6230              		.loc 2 8705 0
 6231 001c 380084E2 		add	r0, r4, #56
 6232 0020 FEFFFFEB 		bl	mbedtls_md_free
 6233              	.LVL675:
8706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6234              		.loc 2 8706 0
 6235 0024 440084E2 		add	r0, r4, #68
 6236 0028 FEFFFFEB 		bl	mbedtls_md_free
 6237              	.LVL676:
8708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6238              		.loc 2 8708 0
 6239 002c 0400A0E1 		mov	r0, r4
 6240 0030 D010A0E3 		mov	r1, #208
8709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6241              		.loc 2 8709 0
 6242 0034 1040BDE8 		pop	{r4, lr}
 6243              		.cfi_restore 14
 6244              		.cfi_restore 4
 6245              		.cfi_def_cfa_offset 0
 6246              	.LVL677:
8708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6247              		.loc 2 8708 0
 6248 0038 FEFFFFEA 		b	mbedtls_platform_zeroize
 6249              	.LVL678:
 6250              		.cfi_endproc
 6251              	.LFE120:
 6253              		.section	.text.mbedtls_ssl_handshake_free,"ax",%progbits
 6254              		.align	2
 6255              		.global	mbedtls_ssl_handshake_free
 6256              		.syntax unified
 6257              		.arm
 6258              		.fpu neon
 6260              	mbedtls_ssl_handshake_free:
 6261              	.LFB122:
8761:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_handshake_params *handshake = ssl->handshake;
 6262              		.loc 2 8761 0
 6263              		.cfi_startproc
 6264              		@ args = 0, pretend = 0, frame = 0
 6265              		@ frame_needed = 0, uses_anonymous_args = 0
 6266              	.LVL679:
 6267 0000 70402DE9 		push	{r4, r5, r6, lr}
 6268              		.cfi_def_cfa_offset 16
 6269              		.cfi_offset 4, -16
 6270              		.cfi_offset 5, -12
 6271              		.cfi_offset 6, -8
 6272              		.cfi_offset 14, -4
8762:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6273              		.loc 2 8762 0
 6274 0004 304090E5 		ldr	r4, [r0, #48]
 6275              	.LVL680:
8764:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
 6276              		.loc 2 8764 0
 6277 0008 000054E3 		cmp	r4, #0
 6278 000c 7080BD08 		popeq	{r4, r5, r6, pc}
8782:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6279              		.loc 2 8782 0
 6280 0010 150E84E2 		add	r0, r4, #336
 6281              	.LVL681:
 6282 0014 FEFFFFEB 		bl	mbedtls_sha256_free
 6283              	.LVL682:
8793:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6284              		.loc 2 8793 0
 6285 0018 040084E2 		add	r0, r4, #4
 6286 001c FEFFFFEB 		bl	mbedtls_ecdh_free
 6287              	.LVL683:
8807:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6288              		.loc 2 8807 0
 6289 0020 380194E5 		ldr	r0, [r4, #312]
 6290 0024 FEFFFFEB 		bl	mbedtls_free
 6291              	.LVL684:
8824:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6292              		.loc 2 8824 0
 6293 0028 440194E5 		ldr	r0, [r4, #324]
 6294 002c 000050E3 		cmp	r0, #0
 6295              	.L589:
 6296 0030 0300001A 		bne	.L584
8843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               sizeof( mbedtls_ssl_handshake_params ) );
 6297              		.loc 2 8843 0
 6298 0034 0400A0E1 		mov	r0, r4
 6299 0038 9A1FA0E3 		mov	r1, #616
8845:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6300              		.loc 2 8845 0
 6301 003c 7040BDE8 		pop	{r4, r5, r6, lr}
 6302              		.cfi_remember_state
 6303              		.cfi_restore 14
 6304              		.cfi_restore 6
 6305              		.cfi_restore 5
 6306              		.cfi_restore 4
 6307              		.cfi_def_cfa_offset 0
 6308              	.LVL685:
8843:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                               sizeof( mbedtls_ssl_handshake_params ) );
 6309              		.loc 2 8843 0
 6310 0040 FEFFFFEA 		b	mbedtls_platform_zeroize
 6311              	.LVL686:
 6312              	.L584:
 6313              		.cfi_restore_state
 6314              	.LBB346:
8830:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_free( cur );
 6315              		.loc 2 8830 0
 6316 0044 085090E5 		ldr	r5, [r0, #8]
 6317              	.LVL687:
8831:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             cur = next;
 6318              		.loc 2 8831 0
 6319 0048 FEFFFFEB 		bl	mbedtls_free
 6320              	.LVL688:
8828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 6321              		.loc 2 8828 0
 6322 004c 000055E2 		subs	r0, r5, #0
 6323 0050 F6FFFFEA 		b	.L589
 6324              	.LBE346:
 6325              		.cfi_endproc
 6326              	.LFE122:
 6328              		.section	.text.mbedtls_ssl_session_free,"ax",%progbits
 6329              		.align	2
 6330              		.global	mbedtls_ssl_session_free
 6331              		.syntax unified
 6332              		.arm
 6333              		.fpu neon
 6335              	mbedtls_ssl_session_free:
 6336              	.LFB123:
8848:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( session == NULL )
 6337              		.loc 2 8848 0
 6338              		.cfi_startproc
 6339              		@ args = 0, pretend = 0, frame = 0
 6340              		@ frame_needed = 0, uses_anonymous_args = 0
 6341              	.LVL689:
 6342 0000 10402DE9 		push	{r4, lr}
 6343              		.cfi_def_cfa_offset 8
 6344              		.cfi_offset 4, -8
 6345              		.cfi_offset 14, -4
8849:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
 6346              		.loc 2 8849 0
 6347 0004 004050E2 		subs	r4, r0, #0
 6348 0008 1080BD08 		popeq	{r4, pc}
8853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6349              		.loc 2 8853 0
 6350 000c 5C0094E5 		ldr	r0, [r4, #92]
 6351              	.LVL690:
 6352 0010 000050E3 		cmp	r0, #0
 6353 0014 0200000A 		beq	.L592
8855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( session->peer_cert );
 6354              		.loc 2 8855 0
 6355 0018 FEFFFFEB 		bl	mbedtls_x509_crt_free
 6356              	.LVL691:
8856:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6357              		.loc 2 8856 0
 6358 001c 5C0094E5 		ldr	r0, [r4, #92]
 6359 0020 FEFFFFEB 		bl	mbedtls_free
 6360              	.LVL692:
 6361              	.L592:
8864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6362              		.loc 2 8864 0
 6363 0024 0400A0E1 		mov	r0, r4
 6364 0028 6C10A0E3 		mov	r1, #108
8865:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6365              		.loc 2 8865 0
 6366 002c 1040BDE8 		pop	{r4, lr}
 6367              		.cfi_restore 14
 6368              		.cfi_restore 4
 6369              		.cfi_def_cfa_offset 0
 6370              	.LVL693:
8864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6371              		.loc 2 8864 0
 6372 0030 FEFFFFEA 		b	mbedtls_platform_zeroize
 6373              	.LVL694:
 6374              		.cfi_endproc
 6375              	.LFE123:
 6377              		.section	.text.mbedtls_ssl_handshake_wrapup,"ax",%progbits
 6378              		.align	2
 6379              		.global	mbedtls_ssl_handshake_wrapup
 6380              		.syntax unified
 6381              		.arm
 6382              		.fpu neon
 6384              	mbedtls_ssl_handshake_wrapup:
 6385              	.LFB59:
6283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int resume = ssl->handshake->resume;
 6386              		.loc 2 6283 0
 6387              		.cfi_startproc
 6388              		@ args = 0, pretend = 0, frame = 0
 6389              		@ frame_needed = 0, uses_anonymous_args = 0
 6390              	.LVL695:
 6391 0000 70402DE9 		push	{r4, r5, r6, lr}
 6392              		.cfi_def_cfa_offset 16
 6393              		.cfi_offset 4, -16
 6394              		.cfi_offset 5, -12
 6395              		.cfi_offset 6, -8
 6396              		.cfi_offset 14, -4
6283:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int resume = ssl->handshake->resume;
 6397              		.loc 2 6283 0
 6398 0004 0040A0E1 		mov	r4, r0
6284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6399              		.loc 2 6284 0
 6400 0008 303090E5 		ldr	r3, [r0, #48]
6299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6401              		.loc 2 6299 0
 6402 000c 280090E5 		ldr	r0, [r0, #40]
 6403              	.LVL696:
6284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6404              		.loc 2 6284 0
 6405 0010 545293E5 		ldr	r5, [r3, #596]
 6406              	.LVL697:
6299:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6407              		.loc 2 6299 0
 6408 0014 000050E3 		cmp	r0, #0
 6409 0018 0500000A 		beq	.L598
6304:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6410              		.loc 2 6304 0
 6411 001c 682090E5 		ldr	r2, [r0, #104]
6303:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                   ssl->session->encrypt_then_mac;
 6412              		.loc 2 6303 0
 6413 0020 2C3094E5 		ldr	r3, [r4, #44]
 6414 0024 682083E5 		str	r2, [r3, #104]
6307:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session );
 6415              		.loc 2 6307 0
 6416 0028 FEFFFFEB 		bl	mbedtls_ssl_session_free
 6417              	.LVL698:
6308:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6418              		.loc 2 6308 0
 6419 002c 280094E5 		ldr	r0, [r4, #40]
 6420 0030 FEFFFFEB 		bl	mbedtls_free
 6421              	.LVL699:
 6422              	.L598:
6316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session->id_len != 0 &&
 6423              		.loc 2 6316 0
 6424 0034 000094E5 		ldr	r0, [r4]
6311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6425              		.loc 2 6311 0
 6426 0038 0030A0E3 		mov	r3, #0
6310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_negotiate = NULL;
 6427              		.loc 2 6310 0
 6428 003c 2C1094E5 		ldr	r1, [r4, #44]
6311:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6429              		.loc 2 6311 0
 6430 0040 2C3084E5 		str	r3, [r4, #44]
6316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session->id_len != 0 &&
 6431              		.loc 2 6316 0
 6432 0044 242090E5 		ldr	r2, [r0, #36]
6310:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_negotiate = NULL;
 6433              		.loc 2 6310 0
 6434 0048 281084E5 		str	r1, [r4, #40]
6316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session->id_len != 0 &&
 6435              		.loc 2 6316 0
 6436 004c 030052E1 		cmp	r2, r3
 6437 0050 0800000A 		beq	.L599
6316:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session->id_len != 0 &&
 6438              		.loc 2 6316 0 is_stmt 0 discriminator 1
 6439 0054 083091E5 		ldr	r3, [r1, #8]
6317:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         resume == 0 )
 6440              		.loc 2 6317 0 is_stmt 1 discriminator 1
 6441 0058 003093E2 		adds	r3, r3, #0
 6442 005c 0130A013 		movne	r3, #1
 6443 0060 000055E3 		cmp	r5, #0
 6444 0064 0030A013 		movne	r3, #0
 6445 0068 000053E3 		cmp	r3, #0
 6446 006c 0100000A 		beq	.L599
6320:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "cache did not store session" ) );
 6447              		.loc 2 6320 0
 6448 0070 280090E5 		ldr	r0, [r0, #40]
 6449 0074 32FF2FE1 		blx	r2
 6450              	.LVL700:
 6451              	.L599:
 6452              	.LBB349:
 6453              	.LBB350:
6264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( ssl->handshake );
 6454              		.loc 2 6264 0
 6455 0078 0400A0E1 		mov	r0, r4
 6456 007c FEFFFFEB 		bl	mbedtls_ssl_handshake_free
 6457              	.LVL701:
6265:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->handshake = NULL;
 6458              		.loc 2 6265 0
 6459 0080 300094E5 		ldr	r0, [r4, #48]
 6460 0084 FEFFFFEB 		bl	mbedtls_free
 6461              	.LVL702:
6271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6462              		.loc 2 6271 0
 6463 0088 3C0094E5 		ldr	r0, [r4, #60]
6266:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6464              		.loc 2 6266 0
 6465 008c 0030A0E3 		mov	r3, #0
 6466 0090 303084E5 		str	r3, [r4, #48]
6271:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6467              		.loc 2 6271 0
 6468 0094 030050E1 		cmp	r0, r3
 6469 0098 0200000A 		beq	.L600
6273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform );
 6470              		.loc 2 6273 0
 6471 009c FEFFFFEB 		bl	mbedtls_ssl_transform_free
 6472              	.LVL703:
6274:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6473              		.loc 2 6274 0
 6474 00a0 3C0094E5 		ldr	r0, [r4, #60]
 6475 00a4 FEFFFFEB 		bl	mbedtls_free
 6476              	.LVL704:
 6477              	.L600:
6276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_negotiate = NULL;
 6478              		.loc 2 6276 0
 6479 00a8 403094E5 		ldr	r3, [r4, #64]
 6480 00ac 3C3084E5 		str	r3, [r4, #60]
6277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6481              		.loc 2 6277 0
 6482 00b0 0030A0E3 		mov	r3, #0
 6483 00b4 403084E5 		str	r3, [r4, #64]
 6484              	.LVL705:
 6485              	.LBE350:
 6486              	.LBE349:
6339:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6487              		.loc 2 6339 0
 6488 00b8 043094E5 		ldr	r3, [r4, #4]
 6489 00bc 013083E2 		add	r3, r3, #1
 6490 00c0 043084E5 		str	r3, [r4, #4]
 6491 00c4 7080BDE8 		pop	{r4, r5, r6, pc}
 6492              		.cfi_endproc
 6493              	.LFE59:
 6495              		.section	.text.ssl_session_copy,"ax",%progbits
 6496              		.align	2
 6497              		.syntax unified
 6498              		.arm
 6499              		.fpu neon
 6501              	ssl_session_copy:
 6502              	.LFB25:
 275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session_free( dst );
 6503              		.loc 2 275 0
 6504              		.cfi_startproc
 6505              		@ args = 0, pretend = 0, frame = 0
 6506              		@ frame_needed = 0, uses_anonymous_args = 0
 6507              	.LVL706:
 6508 0000 70402DE9 		push	{r4, r5, r6, lr}
 6509              		.cfi_def_cfa_offset 16
 6510              		.cfi_offset 4, -16
 6511              		.cfi_offset 5, -12
 6512              		.cfi_offset 6, -8
 6513              		.cfi_offset 14, -4
 275:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_ssl_session_free( dst );
 6514              		.loc 2 275 0
 6515 0004 0160A0E1 		mov	r6, r1
 6516 0008 0050A0E1 		mov	r5, r0
 276:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memcpy( dst, src, sizeof( mbedtls_ssl_session ) );
 6517              		.loc 2 276 0
 6518 000c FEFFFFEB 		bl	mbedtls_ssl_session_free
 6519              	.LVL707:
 277:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6520              		.loc 2 277 0
 6521 0010 6C20A0E3 		mov	r2, #108
 6522 0014 0610A0E1 		mov	r1, r6
 6523 0018 0500A0E1 		mov	r0, r5
 6524 001c FEFFFFEB 		bl	memcpy
 6525              	.LVL708:
 280:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6526              		.loc 2 280 0
 6527 0020 5C4096E5 		ldr	r4, [r6, #92]
 6528 0024 000054E3 		cmp	r4, #0
 6529 0028 1200000A 		beq	.L614
 6530              	.LBB351:
 284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( dst->peer_cert == NULL )
 6531              		.loc 2 284 0
 6532 002c 4D1FA0E3 		mov	r1, #308
 6533 0030 0100A0E3 		mov	r0, #1
 6534 0034 FEFFFFEB 		bl	mbedtls_calloc
 6535              	.LVL709:
 285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 6536              		.loc 2 285 0
 6537 0038 000050E3 		cmp	r0, #0
 284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( dst->peer_cert == NULL )
 6538              		.loc 2 284 0
 6539 003c 5C0085E5 		str	r0, [r5, #92]
 286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6540              		.loc 2 286 0
 6541 0040 38409F05 		ldreq	r4, .L622
 285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( MBEDTLS_ERR_SSL_ALLOC_FAILED );
 6542              		.loc 2 285 0
 6543 0044 0B00000A 		beq	.L614
 288:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6544              		.loc 2 288 0
 6545 0048 FEFFFFEB 		bl	mbedtls_x509_crt_init
 6546              	.LVL710:
 290:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         src->peer_cert->raw.len ) ) != 0 )
 6547              		.loc 2 290 0
 6548 004c 5C3096E5 		ldr	r3, [r6, #92]
 6549 0050 5C0095E5 		ldr	r0, [r5, #92]
 6550 0054 042093E5 		ldr	r2, [r3, #4]
 6551 0058 081093E5 		ldr	r1, [r3, #8]
 6552 005c FEFFFFEB 		bl	mbedtls_x509_crt_parse_der
 6553              	.LVL711:
 6554 0060 004050E2 		subs	r4, r0, #0
 6555 0064 0300000A 		beq	.L614
 293:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             dst->peer_cert = NULL;
 6556              		.loc 2 293 0
 6557 0068 5C0095E5 		ldr	r0, [r5, #92]
 6558              	.LVL712:
 6559 006c FEFFFFEB 		bl	mbedtls_free
 6560              	.LVL713:
 294:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( ret );
 6561              		.loc 2 294 0
 6562 0070 0030A0E3 		mov	r3, #0
 6563 0074 5C3085E5 		str	r3, [r5, #92]
 6564              	.LVL714:
 6565              	.L614:
 6566              	.LBE351:
 312:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
 6567              		.loc 2 312 0
 6568 0078 0400A0E1 		mov	r0, r4
 6569 007c 7080BDE8 		pop	{r4, r5, r6, pc}
 6570              	.L623:
 6571              		.align	2
 6572              	.L622:
 6573 0080 0081FFFF 		.word	-32512
 6574              		.cfi_endproc
 6575              	.LFE25:
 6577              		.section	.text.mbedtls_ssl_set_session,"ax",%progbits
 6578              		.align	2
 6579              		.global	mbedtls_ssl_set_session
 6580              		.syntax unified
 6581              		.arm
 6582              		.fpu neon
 6584              	mbedtls_ssl_set_session:
 6585              	.LFB82:
7131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6586              		.loc 2 7131 0
 6587              		.cfi_startproc
 6588              		@ args = 0, pretend = 0, frame = 0
 6589              		@ frame_needed = 0, uses_anonymous_args = 0
 6590              	.LVL715:
7134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         session == NULL ||
 6591              		.loc 2 7134 0
 6592 0000 000051E3 		cmp	r1, #0
 6593 0004 00005013 		cmpne	r0, #0
 6594 0008 0F00000A 		beq	.L628
7136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 6595              		.loc 2 7136 0
 6596 000c 2C3090E5 		ldr	r3, [r0, #44]
7135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate == NULL ||
 6597              		.loc 2 7135 0
 6598 0010 000053E3 		cmp	r3, #0
 6599 0014 0C00000A 		beq	.L628
7137:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6600              		.loc 2 7137 0
 6601 0018 002090E5 		ldr	r2, [r0]
 6602 001c 6020D2E5 		ldrb	r2, [r2, #96]	@ zero_extendqisi2
7136:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 6603              		.loc 2 7136 0
 6604 0020 010012E3 		tst	r2, #1
 6605 0024 0800001A 		bne	.L628
7131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6606              		.loc 2 7131 0
 6607 0028 10402DE9 		push	{r4, lr}
 6608              		.cfi_def_cfa_offset 8
 6609              		.cfi_offset 4, -8
 6610              		.cfi_offset 14, -4
 6611 002c 0040A0E1 		mov	r4, r0
7142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 6612              		.loc 2 7142 0
 6613 0030 0300A0E1 		mov	r0, r3
 6614              	.LVL716:
 6615 0034 FEFFFFEB 		bl	ssl_session_copy
 6616              	.LVL717:
 6617 0038 000050E3 		cmp	r0, #0
7145:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6618              		.loc 2 7145 0
 6619 003c 30309405 		ldreq	r3, [r4, #48]
 6620 0040 0120A003 		moveq	r2, #1
 6621 0044 54228305 		streq	r2, [r3, #596]
7147:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6622              		.loc 2 7147 0
 6623 0048 1080BDE8 		pop	{r4, pc}
 6624              	.LVL718:
 6625              	.L628:
 6626              		.cfi_def_cfa_offset 0
 6627              		.cfi_restore 4
 6628              		.cfi_restore 14
7139:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6629              		.loc 2 7139 0
 6630 004c 00009FE5 		ldr	r0, .L633
 6631              	.LVL719:
 6632 0050 1EFF2FE1 		bx	lr
 6633              	.L634:
 6634              		.align	2
 6635              	.L633:
 6636 0054 008FFFFF 		.word	-28928
 6637              		.cfi_endproc
 6638              	.LFE82:
 6640              		.section	.text.mbedtls_ssl_get_session,"ax",%progbits
 6641              		.align	2
 6642              		.global	mbedtls_ssl_get_session
 6643              		.syntax unified
 6644              		.arm
 6645              		.fpu neon
 6647              	mbedtls_ssl_get_session:
 6648              	.LFB113:
7985:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL ||
 6649              		.loc 2 7985 0
 6650              		.cfi_startproc
 6651              		@ args = 0, pretend = 0, frame = 0
 6652              		@ frame_needed = 0, uses_anonymous_args = 0
 6653              		@ link register save eliminated.
 6654              	.LVL720:
7986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dst == NULL ||
 6655              		.loc 2 7986 0
 6656 0000 0030A0E1 		mov	r3, r0
7987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session == NULL ||
 6657              		.loc 2 7987 0
 6658 0004 0100A0E1 		mov	r0, r1
 6659              	.LVL721:
7986:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         dst == NULL ||
 6660              		.loc 2 7986 0
 6661 0008 000051E3 		cmp	r1, #0
 6662 000c 00005313 		cmpne	r3, #0
 6663 0010 0700000A 		beq	.L639
7988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 6664              		.loc 2 7988 0
 6665 0014 281093E5 		ldr	r1, [r3, #40]
 6666              	.LVL722:
7987:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session == NULL ||
 6667              		.loc 2 7987 0
 6668 0018 000051E3 		cmp	r1, #0
 6669 001c 0400000A 		beq	.L639
7989:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6670              		.loc 2 7989 0
 6671 0020 003093E5 		ldr	r3, [r3]
 6672              	.LVL723:
 6673 0024 6030D3E5 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
7988:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->conf->endpoint != MBEDTLS_SSL_IS_CLIENT )
 6674              		.loc 2 7988 0
 6675 0028 010013E3 		tst	r3, #1
 6676 002c 0000001A 		bne	.L639
7994:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6677              		.loc 2 7994 0
 6678 0030 FEFFFFEA 		b	ssl_session_copy
 6679              	.LVL724:
 6680              	.L639:
7991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6681              		.loc 2 7991 0
 6682 0034 00009FE5 		ldr	r0, .L640
 6683              	.LVL725:
7995:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_CLI_C */
 6684              		.loc 2 7995 0
 6685 0038 1EFF2FE1 		bx	lr
 6686              	.L641:
 6687              		.align	2
 6688              	.L640:
 6689 003c 008FFFFF 		.word	-28928
 6690              		.cfi_endproc
 6691              	.LFE113:
 6693              		.section	.text.ssl_handshake_init,"ax",%progbits
 6694              		.align	2
 6695              		.syntax unified
 6696              		.arm
 6697              		.fpu neon
 6699              	ssl_handshake_init:
 6700              	.LFB65:
6612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Clear old handshake information if present */
 6701              		.loc 2 6612 0
 6702              		.cfi_startproc
 6703              		@ args = 0, pretend = 0, frame = 0
 6704              		@ frame_needed = 0, uses_anonymous_args = 0
 6705              	.LVL726:
 6706 0000 70402DE9 		push	{r4, r5, r6, lr}
 6707              		.cfi_def_cfa_offset 16
 6708              		.cfi_offset 4, -16
 6709              		.cfi_offset 5, -12
 6710              		.cfi_offset 6, -8
 6711              		.cfi_offset 14, -4
6612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /* Clear old handshake information if present */
 6712              		.loc 2 6612 0
 6713 0004 0040A0E1 		mov	r4, r0
6614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform_negotiate );
 6714              		.loc 2 6614 0
 6715 0008 400090E5 		ldr	r0, [r0, #64]
 6716              	.LVL727:
 6717 000c 000050E3 		cmp	r0, #0
 6718 0010 0000000A 		beq	.L643
6615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->session_negotiate )
 6719              		.loc 2 6615 0
 6720 0014 FEFFFFEB 		bl	mbedtls_ssl_transform_free
 6721              	.LVL728:
 6722              	.L643:
6616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session_negotiate );
 6723              		.loc 2 6616 0
 6724 0018 2C0094E5 		ldr	r0, [r4, #44]
 6725 001c 000050E3 		cmp	r0, #0
 6726 0020 0000000A 		beq	.L644
6617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->handshake )
 6727              		.loc 2 6617 0
 6728 0024 FEFFFFEB 		bl	mbedtls_ssl_session_free
 6729              	.LVL729:
 6730              	.L644:
6618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_handshake_free( ssl );
 6731              		.loc 2 6618 0
 6732 0028 303094E5 		ldr	r3, [r4, #48]
 6733 002c 000053E3 		cmp	r3, #0
 6734 0030 0100000A 		beq	.L645
6619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6735              		.loc 2 6619 0
 6736 0034 0400A0E1 		mov	r0, r4
 6737 0038 FEFFFFEB 		bl	mbedtls_ssl_handshake_free
 6738              	.LVL730:
 6739              	.L645:
6625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6740              		.loc 2 6625 0
 6741 003c 403094E5 		ldr	r3, [r4, #64]
 6742 0040 000053E3 		cmp	r3, #0
 6743 0044 0300001A 		bne	.L646
6627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6744              		.loc 2 6627 0
 6745 0048 D010A0E3 		mov	r1, #208
 6746 004c 0100A0E3 		mov	r0, #1
 6747 0050 FEFFFFEB 		bl	mbedtls_calloc
 6748              	.LVL731:
 6749 0054 400084E5 		str	r0, [r4, #64]
 6750              	.L646:
6630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6751              		.loc 2 6630 0
 6752 0058 2C3094E5 		ldr	r3, [r4, #44]
 6753 005c 000053E3 		cmp	r3, #0
 6754 0060 0300001A 		bne	.L647
6632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6755              		.loc 2 6632 0
 6756 0064 6C10A0E3 		mov	r1, #108
 6757 0068 0100A0E3 		mov	r0, #1
 6758 006c FEFFFFEB 		bl	mbedtls_calloc
 6759              	.LVL732:
 6760 0070 2C0084E5 		str	r0, [r4, #44]
 6761              	.L647:
6635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6762              		.loc 2 6635 0
 6763 0074 303094E5 		ldr	r3, [r4, #48]
 6764 0078 000053E3 		cmp	r3, #0
 6765 007c 0300001A 		bne	.L648
6637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6766              		.loc 2 6637 0
 6767 0080 9A1FA0E3 		mov	r1, #616
 6768 0084 0100A0E3 		mov	r0, #1
 6769 0088 FEFFFFEB 		bl	mbedtls_calloc
 6770              	.LVL733:
 6771 008c 300084E5 		str	r0, [r4, #48]
 6772              	.L648:
6641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate == NULL ||
 6773              		.loc 2 6641 0
 6774 0090 300094E5 		ldr	r0, [r4, #48]
 6775 0094 000050E3 		cmp	r0, #0
 6776 0098 0500000A 		beq	.L649
6641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate == NULL ||
 6777              		.loc 2 6641 0 is_stmt 0 discriminator 1
 6778 009c 403094E5 		ldr	r3, [r4, #64]
 6779 00a0 000053E3 		cmp	r3, #0
 6780 00a4 0200000A 		beq	.L649
6643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6781              		.loc 2 6643 0 is_stmt 1
 6782 00a8 2C3094E5 		ldr	r3, [r4, #44]
6642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate == NULL )
 6783              		.loc 2 6642 0
 6784 00ac 000053E3 		cmp	r3, #0
 6785 00b0 0A00001A 		bne	.L650
 6786              	.L649:
6647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform_negotiate );
 6787              		.loc 2 6647 0
 6788 00b4 FEFFFFEB 		bl	mbedtls_free
 6789              	.LVL734:
6648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session_negotiate );
 6790              		.loc 2 6648 0
 6791 00b8 400094E5 		ldr	r0, [r4, #64]
 6792 00bc FEFFFFEB 		bl	mbedtls_free
 6793              	.LVL735:
6649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6794              		.loc 2 6649 0
 6795 00c0 2C0094E5 		ldr	r0, [r4, #44]
 6796 00c4 FEFFFFEB 		bl	mbedtls_free
 6797              	.LVL736:
6651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate = NULL;
 6798              		.loc 2 6651 0
 6799 00c8 0030A0E3 		mov	r3, #0
6655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6800              		.loc 2 6655 0
 6801 00cc A0009FE5 		ldr	r0, .L668
6651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform_negotiate = NULL;
 6802              		.loc 2 6651 0
 6803 00d0 303084E5 		str	r3, [r4, #48]
6652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session_negotiate = NULL;
 6804              		.loc 2 6652 0
 6805 00d4 403084E5 		str	r3, [r4, #64]
6653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6806              		.loc 2 6653 0
 6807 00d8 2C3084E5 		str	r3, [r4, #44]
6655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 6808              		.loc 2 6655 0
 6809 00dc 7080BDE8 		pop	{r4, r5, r6, pc}
 6810              	.L650:
6659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_transform_init( ssl->transform_negotiate );
 6811              		.loc 2 6659 0
 6812 00e0 0300A0E1 		mov	r0, r3
 6813 00e4 FEFFFFEB 		bl	mbedtls_ssl_session_init
 6814              	.LVL737:
6660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_handshake_params_init( ssl->handshake );
 6815              		.loc 2 6660 0
 6816 00e8 405094E5 		ldr	r5, [r4, #64]
 6817              	.LVL738:
 6818              	.LBB359:
 6819              	.LBB360:
6597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6820              		.loc 2 6597 0
 6821 00ec D020A0E3 		mov	r2, #208
 6822 00f0 0010A0E3 		mov	r1, #0
 6823 00f4 0500A0E1 		mov	r0, r5
 6824 00f8 FEFFFFEB 		bl	memset
 6825              	.LVL739:
6599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_cipher_init( &transform->cipher_ctx_dec );
 6826              		.loc 2 6599 0
 6827 00fc 500085E2 		add	r0, r5, #80
 6828 0100 FEFFFFEB 		bl	mbedtls_cipher_init
 6829              	.LVL740:
6600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6830              		.loc 2 6600 0
 6831 0104 900085E2 		add	r0, r5, #144
 6832 0108 FEFFFFEB 		bl	mbedtls_cipher_init
 6833              	.LVL741:
6602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_init( &transform->md_ctx_dec );
 6834              		.loc 2 6602 0
 6835 010c 380085E2 		add	r0, r5, #56
 6836 0110 FEFFFFEB 		bl	mbedtls_md_init
 6837              	.LVL742:
6603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6838              		.loc 2 6603 0
 6839 0114 440085E2 		add	r0, r5, #68
 6840 0118 FEFFFFEB 		bl	mbedtls_md_init
 6841              	.LVL743:
 6842              	.LBE360:
 6843              	.LBE359:
6661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6844              		.loc 2 6661 0
 6845 011c 304094E5 		ldr	r4, [r4, #48]
 6846              	.LVL744:
 6847              	.LBB361:
 6848              	.LBB362:
6549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6849              		.loc 2 6549 0
 6850 0120 9A2FA0E3 		mov	r2, #616
 6851 0124 0010A0E3 		mov	r1, #0
6560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_starts_ret( &handshake->fin_sha256, 0 );
 6852              		.loc 2 6560 0
 6853 0128 155E84E2 		add	r5, r4, #336
6549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6854              		.loc 2 6549 0
 6855 012c 0400A0E1 		mov	r0, r4
 6856 0130 FEFFFFEB 		bl	memset
 6857              	.LVL745:
6560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha256_starts_ret( &handshake->fin_sha256, 0 );
 6858              		.loc 2 6560 0
 6859 0134 0500A0E1 		mov	r0, r5
 6860 0138 FEFFFFEB 		bl	mbedtls_sha256_init
 6861              	.LVL746:
6561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6862              		.loc 2 6561 0
 6863 013c 0010A0E3 		mov	r1, #0
 6864 0140 0500A0E1 		mov	r0, r5
 6865 0144 FEFFFFEB 		bl	mbedtls_sha256_starts_ret
 6866              	.LVL747:
6569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6867              		.loc 2 6569 0
 6868 0148 28309FE5 		ldr	r3, .L668+4
 6869              	.LBB363:
 6870              	.LBB364:
 6871              	.LBB365:
9285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     set->ecdsa = md_alg;
 6872              		.loc 2 9285 0
 6873 014c 0050A0E3 		mov	r5, #0
 6874              	.LBE365:
 6875              	.LBE364:
 6876              	.LBE363:
6580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6877              		.loc 2 6580 0
 6878 0150 040084E2 		add	r0, r4, #4
 6879              	.LBB368:
 6880              	.LBB367:
 6881              	.LBB366:
9285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     set->ecdsa = md_alg;
 6882              		.loc 2 9285 0
 6883 0154 0050C4E5 		strb	r5, [r4]
9286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6884              		.loc 2 9286 0
 6885 0158 0150C4E5 		strb	r5, [r4, #1]
 6886              	.LBE366:
 6887              	.LBE367:
 6888              	.LBE368:
6569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6889              		.loc 2 6569 0
 6890 015c BC3184E5 		str	r3, [r4, #444]
 6891              	.LVL748:
6580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6892              		.loc 2 6580 0
 6893 0160 FEFFFFEB 		bl	mbedtls_ecdh_init
 6894              	.LVL749:
6591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6895              		.loc 2 6591 0
 6896 0164 0330A0E3 		mov	r3, #3
 6897              	.LBE362:
 6898              	.LBE361:
6677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 6899              		.loc 2 6677 0
 6900 0168 0500A0E1 		mov	r0, r5
 6901              	.LBB370:
 6902              	.LBB369:
6591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 6903              		.loc 2 6591 0
 6904 016c 403184E5 		str	r3, [r4, #320]
 6905              	.LBE369:
 6906              	.LBE370:
6678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6907              		.loc 2 6678 0
 6908 0170 7080BDE8 		pop	{r4, r5, r6, pc}
 6909              	.L669:
 6910              		.align	2
 6911              	.L668:
 6912 0174 0081FFFF 		.word	-32512
 6913 0178 00000000 		.word	ssl_update_checksum_start
 6914              		.cfi_endproc
 6915              	.LFE65:
 6917              		.section	.text.mbedtls_ssl_setup,"ax",%progbits
 6918              		.align	2
 6919              		.global	mbedtls_ssl_setup
 6920              		.syntax unified
 6921              		.arm
 6922              		.fpu neon
 6924              	mbedtls_ssl_setup:
 6925              	.LFB70:
6816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6926              		.loc 2 6816 0
 6927              		.cfi_startproc
 6928              		@ args = 0, pretend = 0, frame = 0
 6929              		@ frame_needed = 0, uses_anonymous_args = 0
 6930              	.LVL750:
6826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6931              		.loc 2 6826 0
 6932 0000 0030A0E3 		mov	r3, #0
6816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6933              		.loc 2 6816 0
 6934 0004 70402DE9 		push	{r4, r5, r6, lr}
 6935              		.cfi_def_cfa_offset 16
 6936              		.cfi_offset 4, -16
 6937              		.cfi_offset 5, -12
 6938              		.cfi_offset 6, -8
 6939              		.cfi_offset 14, -4
6819:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6940              		.loc 2 6819 0
 6941 0008 001080E5 		str	r1, [r0]
6816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret;
 6942              		.loc 2 6816 0
 6943 000c 0040A0E1 		mov	r4, r0
6828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_buf == NULL )
 6944              		.loc 2 6828 0
 6945 0010 3D1102E3 		movw	r1, #8509
 6946              	.LVL751:
6826:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6947              		.loc 2 6826 0
 6948 0014 843080E5 		str	r3, [r0, #132]
6828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_buf == NULL )
 6949              		.loc 2 6828 0
 6950 0018 0100A0E3 		mov	r0, #1
 6951              	.LVL752:
 6952 001c FEFFFFEB 		bl	mbedtls_calloc
 6953              	.LVL753:
6829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6954              		.loc 2 6829 0
 6955 0020 000050E3 		cmp	r0, #0
6828:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->in_buf == NULL )
 6956              		.loc 2 6828 0
 6957 0024 500084E5 		str	r0, [r4, #80]
6829:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 6958              		.loc 2 6829 0
 6959 0028 1300001A 		bne	.L671
 6960              	.L673:
6832:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto error;
 6961              		.loc 2 6832 0
 6962 002c 80509FE5 		ldr	r5, .L682
 6963              	.L672:
 6964              	.LVL754:
6852:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_free( ssl->out_buf );
 6965              		.loc 2 6852 0
 6966 0030 500094E5 		ldr	r0, [r4, #80]
 6967 0034 FEFFFFEB 		bl	mbedtls_free
 6968              	.LVL755:
6853:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6969              		.loc 2 6853 0
 6970 0038 840094E5 		ldr	r0, [r4, #132]
 6971 003c FEFFFFEB 		bl	mbedtls_free
 6972              	.LVL756:
6855:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6973              		.loc 2 6855 0
 6974 0040 0030A0E3 		mov	r3, #0
 6975 0044 003084E5 		str	r3, [r4]
6857:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_buf = NULL;
 6976              		.loc 2 6857 0
 6977 0048 503084E5 		str	r3, [r4, #80]
6858:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6978              		.loc 2 6858 0
 6979 004c 843084E5 		str	r3, [r4, #132]
6860:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_ctr = NULL;
 6980              		.loc 2 6860 0
 6981 0050 583084E5 		str	r3, [r4, #88]
6861:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_len = NULL;
 6982              		.loc 2 6861 0
 6983 0054 543084E5 		str	r3, [r4, #84]
6862:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_iv = NULL;
 6984              		.loc 2 6862 0
 6985 0058 5C3084E5 		str	r3, [r4, #92]
6863:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msg = NULL;
 6986              		.loc 2 6863 0
 6987 005c 603084E5 		str	r3, [r4, #96]
6864:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6988              		.loc 2 6864 0
 6989 0060 643084E5 		str	r3, [r4, #100]
6866:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_ctr = NULL;
 6990              		.loc 2 6866 0
 6991 0064 8C3084E5 		str	r3, [r4, #140]
6867:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_len = NULL;
 6992              		.loc 2 6867 0
 6993 0068 883084E5 		str	r3, [r4, #136]
6868:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_iv = NULL;
 6994              		.loc 2 6868 0
 6995 006c 903084E5 		str	r3, [r4, #144]
6869:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msg = NULL;
 6996              		.loc 2 6869 0
 6997 0070 943084E5 		str	r3, [r4, #148]
6870:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 6998              		.loc 2 6870 0
 6999 0074 983084E5 		str	r3, [r4, #152]
6872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7000              		.loc 2 6872 0
 7001 0078 0B0000EA 		b	.L670
 7002              	.LVL757:
 7003              	.L671:
6836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_buf == NULL )
 7004              		.loc 2 6836 0
 7005 007c 3D1102E3 		movw	r1, #8509
 7006 0080 0100A0E3 		mov	r0, #1
 7007 0084 FEFFFFEB 		bl	mbedtls_calloc
 7008              	.LVL758:
6837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7009              		.loc 2 6837 0
 7010 0088 000050E3 		cmp	r0, #0
6836:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->out_buf == NULL )
 7011              		.loc 2 6836 0
 7012 008c 840084E5 		str	r0, [r4, #132]
6837:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7013              		.loc 2 6837 0
 7014 0090 E5FFFF0A 		beq	.L673
6844:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7015              		.loc 2 6844 0
 7016 0094 0400A0E1 		mov	r0, r4
 7017 0098 FEFFFFEB 		bl	ssl_reset_in_out_pointers
 7018              	.LVL759:
6846:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto error;
 7019              		.loc 2 6846 0
 7020 009c 0400A0E1 		mov	r0, r4
 7021 00a0 FEFFFFEB 		bl	ssl_handshake_init
 7022              	.LVL760:
 7023 00a4 005050E2 		subs	r5, r0, #0
 7024 00a8 E0FFFF1A 		bne	.L672
 7025              	.LVL761:
 7026              	.L670:
6873:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7027              		.loc 2 6873 0
 7028 00ac 0500A0E1 		mov	r0, r5
 7029 00b0 7080BDE8 		pop	{r4, r5, r6, pc}
 7030              	.L683:
 7031              		.align	2
 7032              	.L682:
 7033 00b4 0081FFFF 		.word	-32512
 7034              		.cfi_endproc
 7035              	.LFE70:
 7037              		.section	.text.mbedtls_ssl_session_reset,"ax",%progbits
 7038              		.align	2
 7039              		.global	mbedtls_ssl_session_reset
 7040              		.syntax unified
 7041              		.arm
 7042              		.fpu neon
 7044              	mbedtls_ssl_session_reset:
 7045              	.LFB72:
7002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_session_reset_int( ssl, 0 ) );
 7046              		.loc 2 7002 0
 7047              		.cfi_startproc
 7048              		@ args = 0, pretend = 0, frame = 0
 7049              		@ frame_needed = 0, uses_anonymous_args = 0
 7050              	.LVL762:
 7051 0000 70402DE9 		push	{r4, r5, r6, lr}
 7052              		.cfi_def_cfa_offset 16
 7053              		.cfi_offset 4, -16
 7054              		.cfi_offset 5, -12
 7055              		.cfi_offset 6, -8
 7056              		.cfi_offset 14, -4
 7057              	.LBB373:
 7058              	.LBB374:
6891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7059              		.loc 2 6891 0
 7060 0004 0050A0E3 		mov	r5, #0
 7061              	.LBE374:
 7062              	.LBE373:
7002:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ssl_session_reset_int( ssl, 0 ) );
 7063              		.loc 2 7002 0
 7064 0008 0040A0E1 		mov	r4, r0
 7065              	.LBB377:
 7066              	.LBB375:
6894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7067              		.loc 2 6894 0
 7068 000c 0510A0E1 		mov	r1, r5
6891:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7069              		.loc 2 6891 0
 7070 0010 045080E5 		str	r5, [r0, #4]
6894:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7071              		.loc 2 6894 0
 7072 0014 FEFFFFEB 		bl	ssl_set_timer
 7073              	.LVL763:
6907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7074              		.loc 2 6907 0
 7075 0018 0400A0E1 		mov	r0, r4
6904:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7076              		.loc 2 6904 0
 7077 001c BC5084E5 		str	r5, [r4, #188]
6906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl_reset_in_out_pointers( ssl );
 7078              		.loc 2 6906 0
 7079 0020 685084E5 		str	r5, [r4, #104]
6907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7080              		.loc 2 6907 0
 7081 0024 FEFFFFEB 		bl	ssl_reset_in_out_pointers
 7082              	.LVL764:
6932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7083              		.loc 2 6932 0
 7084 0028 0820A0E3 		mov	r2, #8
 7085 002c 0510A0E1 		mov	r1, r5
6909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->in_msglen = 0;
 7086              		.loc 2 6909 0
 7087 0030 6C5084E5 		str	r5, [r4, #108]
6932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7088              		.loc 2 6932 0
 7089 0034 A80084E2 		add	r0, r4, #168
6910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 7090              		.loc 2 6910 0
 7091 0038 705084E5 		str	r5, [r4, #112]
6919:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->nb_zero = 0;
 7092              		.loc 2 6919 0
 7093 003c 785084E5 		str	r5, [r4, #120]
6920:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7094              		.loc 2 6920 0
 7095 0040 7C5084E5 		str	r5, [r4, #124]
6922:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7096              		.loc 2 6922 0
 7097 0044 805084E5 		str	r5, [r4, #128]
6924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_msglen = 0;
 7098              		.loc 2 6924 0
 7099 0048 9C5084E5 		str	r5, [r4, #156]
6925:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->out_left = 0;
 7100              		.loc 2 6925 0
 7101 004c A05084E5 		str	r5, [r4, #160]
6926:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_CBC_RECORD_SPLITTING)
 7102              		.loc 2 6926 0
 7103 0050 A45084E5 		str	r5, [r4, #164]
6932:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7104              		.loc 2 6932 0
 7105 0054 FEFFFFEB 		bl	memset
 7106              	.LVL765:
6940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7107              		.loc 2 6940 0
 7108 0058 3D2102E3 		movw	r2, #8509
 7109 005c 0510A0E1 		mov	r1, r5
6934:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->transform_out = NULL;
 7110              		.loc 2 6934 0
 7111 0060 345084E5 		str	r5, [r4, #52]
6935:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7112              		.loc 2 6935 0
 7113 0064 385084E5 		str	r5, [r4, #56]
6937:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     ssl->session_out = NULL;
 7114              		.loc 2 6937 0
 7115 0068 205084E5 		str	r5, [r4, #32]
6938:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7116              		.loc 2 6938 0
 7117 006c 245084E5 		str	r5, [r4, #36]
6940:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7118              		.loc 2 6940 0
 7119 0070 840094E5 		ldr	r0, [r4, #132]
 7120 0074 FEFFFFEB 		bl	memset
 7121              	.LVL766:
6946:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         memset( ssl->in_buf, 0, MBEDTLS_SSL_IN_BUFFER_LEN );
 7122              		.loc 2 6946 0
 7123 0078 745084E5 		str	r5, [r4, #116]
6947:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7124              		.loc 2 6947 0
 7125 007c 3D2102E3 		movw	r2, #8509
 7126 0080 0510A0E1 		mov	r1, r5
 7127 0084 500094E5 		ldr	r0, [r4, #80]
 7128 0088 FEFFFFEB 		bl	memset
 7129              	.LVL767:
6962:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7130              		.loc 2 6962 0
 7131 008c 3C0094E5 		ldr	r0, [r4, #60]
 7132 0090 050050E1 		cmp	r0, r5
 7133 0094 0300000A 		beq	.L685
6964:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform );
 7134              		.loc 2 6964 0
 7135 0098 FEFFFFEB 		bl	mbedtls_ssl_transform_free
 7136              	.LVL768:
6965:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->transform = NULL;
 7137              		.loc 2 6965 0
 7138 009c 3C0094E5 		ldr	r0, [r4, #60]
 7139 00a0 FEFFFFEB 		bl	mbedtls_free
 7140              	.LVL769:
6966:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7141              		.loc 2 6966 0
 7142 00a4 3C5084E5 		str	r5, [r4, #60]
 7143              	.L685:
6969:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7144              		.loc 2 6969 0
 7145 00a8 280094E5 		ldr	r0, [r4, #40]
 7146 00ac 000050E3 		cmp	r0, #0
 7147 00b0 0400000A 		beq	.L686
6971:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session );
 7148              		.loc 2 6971 0
 7149 00b4 FEFFFFEB 		bl	mbedtls_ssl_session_free
 7150              	.LVL770:
6972:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->session = NULL;
 7151              		.loc 2 6972 0
 7152 00b8 280094E5 		ldr	r0, [r4, #40]
 7153 00bc FEFFFFEB 		bl	mbedtls_free
 7154              	.LVL771:
6973:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7155              		.loc 2 6973 0
 7156 00c0 0030A0E3 		mov	r3, #0
 7157 00c4 283084E5 		str	r3, [r4, #40]
 7158              	.L686:
6977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7159              		.loc 2 6977 0
 7160 00c8 0030A0E3 		mov	r3, #0
6991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 7161              		.loc 2 6991 0
 7162 00cc 0400A0E1 		mov	r0, r4
6977:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7163              		.loc 2 6977 0
 7164 00d0 B83084E5 		str	r3, [r4, #184]
 7165              	.LBE375:
 7166              	.LBE377:
7004:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7167              		.loc 2 7004 0
 7168 00d4 7040BDE8 		pop	{r4, r5, r6, lr}
 7169              		.cfi_restore 14
 7170              		.cfi_restore 6
 7171              		.cfi_restore 5
 7172              		.cfi_restore 4
 7173              		.cfi_def_cfa_offset 0
 7174              	.LVL772:
 7175              	.LBB378:
 7176              	.LBB376:
6991:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( ret );
 7177              		.loc 2 6991 0
 7178 00d8 FEFFFFEA 		b	ssl_handshake_init
 7179              	.LVL773:
 7180              	.LBE376:
 7181              	.LBE378:
 7182              		.cfi_endproc
 7183              	.LFE72:
 7185              		.section	.text.mbedtls_ssl_free,"ax",%progbits
 7186              		.align	2
 7187              		.global	mbedtls_ssl_free
 7188              		.syntax unified
 7189              		.arm
 7190              		.fpu neon
 7192              	mbedtls_ssl_free:
 7193              	.LFB124:
8871:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl == NULL )
 7194              		.loc 2 8871 0
 7195              		.cfi_startproc
 7196              		@ args = 0, pretend = 0, frame = 0
 7197              		@ frame_needed = 0, uses_anonymous_args = 0
 7198              	.LVL774:
 7199 0000 70402DE9 		push	{r4, r5, r6, lr}
 7200              		.cfi_def_cfa_offset 16
 7201              		.cfi_offset 4, -16
 7202              		.cfi_offset 5, -12
 7203              		.cfi_offset 6, -8
 7204              		.cfi_offset 14, -4
8872:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return;
 7205              		.loc 2 8872 0
 7206 0004 004050E2 		subs	r4, r0, #0
 7207 0008 7080BD08 		popeq	{r4, r5, r6, pc}
8877:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7208              		.loc 2 8877 0
 7209 000c 840094E5 		ldr	r0, [r4, #132]
 7210              	.LVL775:
 7211 0010 000050E3 		cmp	r0, #0
 7212 0014 0300000A 		beq	.L696
8879:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->out_buf );
 7213              		.loc 2 8879 0
 7214 0018 3D1102E3 		movw	r1, #8509
 7215 001c FEFFFFEB 		bl	mbedtls_platform_zeroize
 7216              	.LVL776:
8880:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7217              		.loc 2 8880 0
 7218 0020 840094E5 		ldr	r0, [r4, #132]
 7219 0024 FEFFFFEB 		bl	mbedtls_free
 7220              	.LVL777:
 7221              	.L696:
8883:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7222              		.loc 2 8883 0
 7223 0028 500094E5 		ldr	r0, [r4, #80]
 7224 002c 000050E3 		cmp	r0, #0
 7225 0030 0300000A 		beq	.L697
8885:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->in_buf );
 7226              		.loc 2 8885 0
 7227 0034 3D1102E3 		movw	r1, #8509
 7228 0038 FEFFFFEB 		bl	mbedtls_platform_zeroize
 7229              	.LVL778:
8886:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7230              		.loc 2 8886 0
 7231 003c 500094E5 		ldr	r0, [r4, #80]
 7232 0040 FEFFFFEB 		bl	mbedtls_free
 7233              	.LVL779:
 7234              	.L697:
8897:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7235              		.loc 2 8897 0
 7236 0044 3C0094E5 		ldr	r0, [r4, #60]
 7237 0048 000050E3 		cmp	r0, #0
 7238 004c 0200000A 		beq	.L698
8899:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform );
 7239              		.loc 2 8899 0
 7240 0050 FEFFFFEB 		bl	mbedtls_ssl_transform_free
 7241              	.LVL780:
8900:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7242              		.loc 2 8900 0
 7243 0054 3C0094E5 		ldr	r0, [r4, #60]
 7244 0058 FEFFFFEB 		bl	mbedtls_free
 7245              	.LVL781:
 7246              	.L698:
8903:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7247              		.loc 2 8903 0
 7248 005c 303094E5 		ldr	r3, [r4, #48]
 7249 0060 000053E3 		cmp	r3, #0
 7250 0064 0B00000A 		beq	.L699
8905:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_transform_free( ssl->transform_negotiate );
 7251              		.loc 2 8905 0
 7252 0068 0400A0E1 		mov	r0, r4
 7253 006c FEFFFFEB 		bl	mbedtls_ssl_handshake_free
 7254              	.LVL782:
8906:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_session_free( ssl->session_negotiate );
 7255              		.loc 2 8906 0
 7256 0070 400094E5 		ldr	r0, [r4, #64]
 7257 0074 FEFFFFEB 		bl	mbedtls_ssl_transform_free
 7258              	.LVL783:
8907:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7259              		.loc 2 8907 0
 7260 0078 2C0094E5 		ldr	r0, [r4, #44]
 7261 007c FEFFFFEB 		bl	mbedtls_ssl_session_free
 7262              	.LVL784:
8909:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->transform_negotiate );
 7263              		.loc 2 8909 0
 7264 0080 300094E5 		ldr	r0, [r4, #48]
 7265 0084 FEFFFFEB 		bl	mbedtls_free
 7266              	.LVL785:
8910:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session_negotiate );
 7267              		.loc 2 8910 0
 7268 0088 400094E5 		ldr	r0, [r4, #64]
 7269 008c FEFFFFEB 		bl	mbedtls_free
 7270              	.LVL786:
8911:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7271              		.loc 2 8911 0
 7272 0090 2C0094E5 		ldr	r0, [r4, #44]
 7273 0094 FEFFFFEB 		bl	mbedtls_free
 7274              	.LVL787:
 7275              	.L699:
8914:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7276              		.loc 2 8914 0
 7277 0098 280094E5 		ldr	r0, [r4, #40]
 7278 009c 000050E3 		cmp	r0, #0
 7279 00a0 0200000A 		beq	.L700
8916:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session );
 7280              		.loc 2 8916 0
 7281 00a4 FEFFFFEB 		bl	mbedtls_ssl_session_free
 7282              	.LVL788:
8917:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7283              		.loc 2 8917 0
 7284 00a8 280094E5 		ldr	r0, [r4, #40]
 7285 00ac FEFFFFEB 		bl	mbedtls_free
 7286              	.LVL789:
 7287              	.L700:
8921:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7288              		.loc 2 8921 0
 7289 00b0 B45094E5 		ldr	r5, [r4, #180]
 7290 00b4 000055E3 		cmp	r5, #0
 7291 00b8 0600000A 		beq	.L701
8923:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->hostname );
 7292              		.loc 2 8923 0
 7293 00bc 0500A0E1 		mov	r0, r5
 7294 00c0 FEFFFFEB 		bl	strlen
 7295              	.LVL790:
 7296 00c4 0010A0E1 		mov	r1, r0
 7297 00c8 0500A0E1 		mov	r0, r5
 7298 00cc FEFFFFEB 		bl	mbedtls_platform_zeroize
 7299              	.LVL791:
8924:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7300              		.loc 2 8924 0
 7301 00d0 B40094E5 		ldr	r0, [r4, #180]
 7302 00d4 FEFFFFEB 		bl	mbedtls_free
 7303              	.LVL792:
 7304              	.L701:
8943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7305              		.loc 2 8943 0
 7306 00d8 0400A0E1 		mov	r0, r4
 7307 00dc C010A0E3 		mov	r1, #192
8944:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7308              		.loc 2 8944 0
 7309 00e0 7040BDE8 		pop	{r4, r5, r6, lr}
 7310              		.cfi_restore 14
 7311              		.cfi_restore 6
 7312              		.cfi_restore 5
 7313              		.cfi_restore 4
 7314              		.cfi_def_cfa_offset 0
 7315              	.LVL793:
8943:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7316              		.loc 2 8943 0
 7317 00e4 FEFFFFEA 		b	mbedtls_platform_zeroize
 7318              	.LVL794:
 7319              		.cfi_endproc
 7320              	.LFE124:
 7322              		.section	.text.mbedtls_ssl_config_init,"ax",%progbits
 7323              		.align	2
 7324              		.global	mbedtls_ssl_config_init
 7325              		.syntax unified
 7326              		.arm
 7327              		.fpu neon
 7329              	mbedtls_ssl_config_init:
 7330              	.LFB125:
8950:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     memset( conf, 0, sizeof( mbedtls_ssl_config ) );
 7331              		.loc 2 8950 0
 7332              		.cfi_startproc
 7333              		@ args = 0, pretend = 0, frame = 0
 7334              		@ frame_needed = 0, uses_anonymous_args = 0
 7335              		@ link register save eliminated.
 7336              	.LVL795:
8951:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7337              		.loc 2 8951 0
 7338 0000 6420A0E3 		mov	r2, #100
 7339 0004 0010A0E3 		mov	r1, #0
 7340 0008 FEFFFFEA 		b	memset
 7341              	.LVL796:
 7342              		.cfi_endproc
 7343              	.LFE125:
 7345              		.section	.text.mbedtls_ssl_config_defaults,"ax",%progbits
 7346              		.align	2
 7347              		.global	mbedtls_ssl_config_defaults
 7348              		.syntax unified
 7349              		.arm
 7350              		.fpu neon
 7352              	mbedtls_ssl_config_defaults:
 7353              	.LFB126:
8998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
 7354              		.loc 2 8998 0
 7355              		.cfi_startproc
 7356              		@ args = 0, pretend = 0, frame = 0
 7357              		@ frame_needed = 0, uses_anonymous_args = 0
 7358              	.LVL797:
 7359              	.LBB379:
 7360              	.LBB380:
7011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7361              		.loc 2 7011 0
 7362 0000 60C0D0E5 		ldrb	ip, [r0, #96]	@ zero_extendqisi2
 7363              	.LBE380:
 7364              	.LBE379:
9012:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7365              		.loc 2 9012 0
 7366 0004 000051E3 		cmp	r1, #0
 7367              	.LBB382:
 7368              	.LBB381:
7011:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7369              		.loc 2 7011 0
 7370 0008 11C0C0E7 		bfi	ip, r1, #0, #1
 7371              	.LBE381:
 7372              	.LBE382:
9014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 7373              		.loc 2 9014 0
 7374 000c 0210A003 		moveq	r1, #2
 7375              	.LVL798:
 7376              	.LBB383:
 7377              	.LBB384:
7016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7378              		.loc 2 7016 0
 7379 0010 92C0C1E7 		bfi	ip, r2, #1, #1
 7380              	.LBE384:
 7381              	.LBE383:
9014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 7382              		.loc 2 9014 0
 7383 0014 7C20EF06 		uxtbeq	r2, ip
 7384              	.LVL799:
 7385              	.LBB386:
 7386              	.LBB385:
7016:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7387              		.loc 2 7016 0
 7388 0018 60C0C0E5 		strb	ip, [r0, #96]
 7389              	.LVL800:
 7390              	.LBE385:
 7391              	.LBE386:
9014:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_SESSION_TICKETS)
 7392              		.loc 2 9014 0
 7393 001c 1121C307 		bfieq	r2, r1, #2, #2
 7394 0020 6020C005 		strbeq	r2, [r0, #96]
9081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7395              		.loc 2 9081 0
 7396 0024 020053E3 		cmp	r3, #2
9026:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7397              		.loc 2 9026 0
 7398 0028 6120D0E5 		ldrb	r2, [r0, #97]	@ zero_extendqisi2
 7399 002c 0330A0E3 		mov	r3, #3
 7400              	.LVL801:
9030:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7401              		.loc 2 9030 0
 7402 0030 062082E3 		orr	r2, r2, #6
 7403 0034 6120C0E5 		strb	r2, [r0, #97]
9081:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7404              		.loc 2 9081 0
 7405 0038 1000001A 		bne	.L727
9087:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->min_minor_ver = MBEDTLS_SSL_MINOR_VERSION_3; /* TLS 1.2 */
 7406              		.loc 2 9087 0
 7407 003c 5E30C0E5 		strb	r3, [r0, #94]
9088:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_major_ver = MBEDTLS_SSL_MAX_MAJOR_VERSION;
 7408              		.loc 2 9088 0
 7409 0040 5F30C0E5 		strb	r3, [r0, #95]
9089:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_minor_ver = MBEDTLS_SSL_MAX_MINOR_VERSION;
 7410              		.loc 2 9089 0
 7411 0044 5C30C0E5 		strb	r3, [r0, #92]
9090:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7412              		.loc 2 9090 0
 7413 0048 5D30C0E5 		strb	r3, [r0, #93]
9095:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    ssl_preset_suiteb_ciphersuites;
 7414              		.loc 2 9095 0
 7415 004c 78309FE5 		ldr	r3, .L731
 7416 0050 0C3080E5 		str	r3, [r0, #12]
9094:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
 7417              		.loc 2 9094 0
 7418 0054 083080E5 		str	r3, [r0, #8]
9093:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
 7419              		.loc 2 9093 0
 7420 0058 043080E5 		str	r3, [r0, #4]
9092:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
 7421              		.loc 2 9092 0
 7422 005c 003080E5 		str	r3, [r0]
9099:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7423              		.loc 2 9099 0
 7424 0060 68309FE5 		ldr	r3, .L731+4
 7425 0064 3C3080E5 		str	r3, [r0, #60]
9103:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7426              		.loc 2 9103 0
 7427 0068 64309FE5 		ldr	r3, .L731+8
 7428 006c 4C3080E5 		str	r3, [r0, #76]
9107:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7429              		.loc 2 9107 0
 7430 0070 60309FE5 		ldr	r3, .L731+12
 7431 0074 503080E5 		str	r3, [r0, #80]
9155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7432              		.loc 2 9155 0
 7433 0078 0000A0E3 		mov	r0, #0
 7434              	.LVL802:
 7435 007c 1EFF2FE1 		bx	lr
 7436              	.LVL803:
 7437              	.L727:
8998:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C) && defined(MBEDTLS_SSL_SRV_C)
 7438              		.loc 2 8998 0
 7439 0080 10402DE9 		push	{r4, lr}
 7440              		.cfi_def_cfa_offset 8
 7441              		.cfi_offset 4, -8
 7442              		.cfi_offset 14, -4
 7443 0084 0040A0E1 		mov	r4, r0
9115:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MAJOR_VERSION ) ?
 7444              		.loc 2 9115 0
 7445 0088 5E30C0E5 		strb	r3, [r0, #94]
9119:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                     MBEDTLS_SSL_MIN_VALID_MINOR_VERSION ) ?
 7446              		.loc 2 9119 0
 7447 008c 5F30C0E5 		strb	r3, [r0, #95]
9123:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->max_minor_ver = MBEDTLS_SSL_MAX_MINOR_VERSION;
 7448              		.loc 2 9123 0
 7449 0090 5C30C0E5 		strb	r3, [r0, #92]
9124:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7450              		.loc 2 9124 0
 7451 0094 5D30C0E5 		strb	r3, [r0, #93]
9135:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7452              		.loc 2 9135 0
 7453 0098 FEFFFFEB 		bl	mbedtls_ssl_list_ciphersuites
 7454              	.LVL804:
9138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7455              		.loc 2 9138 0
 7456 009c 38309FE5 		ldr	r3, .L731+16
9134:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                    mbedtls_ssl_list_ciphersuites();
 7457              		.loc 2 9134 0
 7458 00a0 0C0084E5 		str	r0, [r4, #12]
9133:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_3] =
 7459              		.loc 2 9133 0
 7460 00a4 080084E5 		str	r0, [r4, #8]
9138:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7461              		.loc 2 9138 0
 7462 00a8 3C3084E5 		str	r3, [r4, #60]
9142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7463              		.loc 2 9142 0
 7464 00ac 2C309FE5 		ldr	r3, .L731+20
9132:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_2] =
 7465              		.loc 2 9132 0
 7466 00b0 040084E5 		str	r0, [r4, #4]
9131:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             conf->ciphersuite_list[MBEDTLS_SSL_MINOR_VERSION_1] =
 7467              		.loc 2 9131 0
 7468 00b4 000084E5 		str	r0, [r4]
9142:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7469              		.loc 2 9142 0
 7470 00b8 4C3084E5 		str	r3, [r4, #76]
9146:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7471              		.loc 2 9146 0
 7472 00bc FEFFFFEB 		bl	mbedtls_ecp_grp_id_list
 7473              	.LVL805:
 7474 00c0 500084E5 		str	r0, [r4, #80]
9155:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7475              		.loc 2 9155 0
 7476 00c4 0000A0E3 		mov	r0, #0
 7477 00c8 1080BDE8 		pop	{r4, pc}
 7478              	.L732:
 7479              		.align	2
 7480              	.L731:
 7481 00cc 00000000 		.word	.LANCHOR2
 7482 00d0 00000000 		.word	mbedtls_x509_crt_profile_suiteb
 7483 00d4 00000000 		.word	.LANCHOR3
 7484 00d8 00000000 		.word	.LANCHOR4
 7485 00dc 00000000 		.word	mbedtls_x509_crt_profile_default
 7486 00e0 00000000 		.word	.LANCHOR5
 7487              		.cfi_endproc
 7488              	.LFE126:
 7490              		.section	.text.mbedtls_ssl_config_free,"ax",%progbits
 7491              		.align	2
 7492              		.global	mbedtls_ssl_config_free
 7493              		.syntax unified
 7494              		.arm
 7495              		.fpu neon
 7497              	mbedtls_ssl_config_free:
 7498              	.LFB127:
9161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
 7499              		.loc 2 9161 0
 7500              		.cfi_startproc
 7501              		@ args = 0, pretend = 0, frame = 0
 7502              		@ frame_needed = 0, uses_anonymous_args = 0
 7503              	.LVL806:
 7504 0000 70402DE9 		push	{r4, r5, r6, lr}
 7505              		.cfi_def_cfa_offset 16
 7506              		.cfi_offset 4, -16
 7507              		.cfi_offset 5, -12
 7508              		.cfi_offset 6, -8
 7509              		.cfi_offset 14, -4
9161:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_DHM_C)
 7510              		.loc 2 9161 0
 7511 0004 0040A0E1 		mov	r4, r0
9186:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7512              		.loc 2 9186 0
 7513 0008 400090E5 		ldr	r0, [r0, #64]
 7514              	.LVL807:
 7515              	.L734:
 7516              	.LBB389:
 7517              	.LBB390:
8716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7518              		.loc 2 8716 0
 7519 000c 000050E3 		cmp	r0, #0
 7520 0010 0300001A 		bne	.L735
 7521              	.LVL808:
 7522              	.LBE390:
 7523              	.LBE389:
9189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7524              		.loc 2 9189 0
 7525 0014 0400A0E1 		mov	r0, r4
 7526 0018 6410A0E3 		mov	r1, #100
9190:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7527              		.loc 2 9190 0
 7528 001c 7040BDE8 		pop	{r4, r5, r6, lr}
 7529              		.cfi_remember_state
 7530              		.cfi_restore 14
 7531              		.cfi_restore 6
 7532              		.cfi_restore 5
 7533              		.cfi_restore 4
 7534              		.cfi_def_cfa_offset 0
 7535              	.LVL809:
9189:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7536              		.loc 2 9189 0
 7537 0020 FEFFFFEA 		b	mbedtls_platform_zeroize
 7538              	.LVL810:
 7539              	.L735:
 7540              		.cfi_restore_state
 7541              	.LBB392:
 7542              	.LBB391:
8718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( cur );
 7543              		.loc 2 8718 0
 7544 0024 085090E5 		ldr	r5, [r0, #8]
 7545              	.LVL811:
8719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         cur = next;
 7546              		.loc 2 8719 0
 7547 0028 FEFFFFEB 		bl	mbedtls_free
 7548              	.LVL812:
8720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7549              		.loc 2 8720 0
 7550 002c 0500A0E1 		mov	r0, r5
 7551 0030 F5FFFFEA 		b	.L734
 7552              	.LBE391:
 7553              	.LBE392:
 7554              		.cfi_endproc
 7555              	.LFE127:
 7557              		.section	.text.mbedtls_ssl_sig_from_pk,"ax",%progbits
 7558              		.align	2
 7559              		.global	mbedtls_ssl_sig_from_pk
 7560              		.syntax unified
 7561              		.arm
 7562              		.fpu neon
 7564              	mbedtls_ssl_sig_from_pk:
 7565              	.LFB128:
9198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_RSA_C)
 7566              		.loc 2 9198 0
 7567              		.cfi_startproc
 7568              		@ args = 0, pretend = 0, frame = 0
 7569              		@ frame_needed = 0, uses_anonymous_args = 0
 7570              	.LVL813:
 7571 0000 10402DE9 		push	{r4, lr}
 7572              		.cfi_def_cfa_offset 8
 7573              		.cfi_offset 4, -8
 7574              		.cfi_offset 14, -4
9200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_SSL_SIG_RSA );
 7575              		.loc 2 9200 0
 7576 0004 0110A0E3 		mov	r1, #1
9198:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_RSA_C)
 7577              		.loc 2 9198 0
 7578 0008 0040A0E1 		mov	r4, r0
9200:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_SSL_SIG_RSA );
 7579              		.loc 2 9200 0
 7580 000c FEFFFFEB 		bl	mbedtls_pk_can_do
 7581              	.LVL814:
 7582 0010 000050E3 		cmp	r0, #0
 7583 0014 0600001A 		bne	.L739
9204:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( MBEDTLS_SSL_SIG_ECDSA );
 7584              		.loc 2 9204 0
 7585 0018 0410A0E3 		mov	r1, #4
 7586 001c 0400A0E1 		mov	r0, r4
 7587 0020 FEFFFFEB 		bl	mbedtls_pk_can_do
 7588              	.LVL815:
 7589 0024 000050E3 		cmp	r0, #0
9207:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7590              		.loc 2 9207 0
 7591 0028 0300A013 		movne	r0, #3
 7592 002c 0000A003 		moveq	r0, #0
 7593 0030 1080BDE8 		pop	{r4, pc}
 7594              	.L739:
9201:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7595              		.loc 2 9201 0
 7596 0034 0100A0E3 		mov	r0, #1
9208:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7597              		.loc 2 9208 0
 7598 0038 1080BDE8 		pop	{r4, pc}
 7599              		.cfi_endproc
 7600              	.LFE128:
 7602              		.section	.text.mbedtls_ssl_sig_from_pk_alg,"ax",%progbits
 7603              		.align	2
 7604              		.global	mbedtls_ssl_sig_from_pk_alg
 7605              		.syntax unified
 7606              		.arm
 7607              		.fpu neon
 7609              	mbedtls_ssl_sig_from_pk_alg:
 7610              	.LFB129:
9211:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( type ) {
 7611              		.loc 2 9211 0
 7612              		.cfi_startproc
 7613              		@ args = 0, pretend = 0, frame = 0
 7614              		@ frame_needed = 0, uses_anonymous_args = 0
 7615              		@ link register save eliminated.
 7616              	.LVL816:
9212:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_RSA:
 7617              		.loc 2 9212 0
 7618 0000 020050E3 		cmp	r0, #2
 7619 0004 0500000A 		beq	.L744
 7620 0008 040050E3 		cmp	r0, #4
 7621 000c 0300000A 		beq	.L744
9219:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7622              		.loc 2 9219 0
 7623 0010 010040E2 		sub	r0, r0, #1
 7624              	.LVL817:
 7625 0014 100F6FE1 		clz	r0, r0
 7626 0018 A002A0E1 		lsr	r0, r0, #5
 7627 001c 1EFF2FE1 		bx	lr
 7628              	.LVL818:
 7629              	.L744:
9217:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
 7630              		.loc 2 9217 0
 7631 0020 0300A0E3 		mov	r0, #3
 7632              	.LVL819:
9221:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7633              		.loc 2 9221 0
 7634 0024 1EFF2FE1 		bx	lr
 7635              		.cfi_endproc
 7636              	.LFE129:
 7638              		.section	.text.mbedtls_ssl_pk_alg_from_sig,"ax",%progbits
 7639              		.align	2
 7640              		.global	mbedtls_ssl_pk_alg_from_sig
 7641              		.syntax unified
 7642              		.arm
 7643              		.fpu neon
 7645              	mbedtls_ssl_pk_alg_from_sig:
 7646              	.LFB130:
9224:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( sig )
 7647              		.loc 2 9224 0
 7648              		.cfi_startproc
 7649              		@ args = 0, pretend = 0, frame = 0
 7650              		@ frame_needed = 0, uses_anonymous_args = 0
 7651              		@ link register save eliminated.
 7652              	.LVL820:
9225:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7653              		.loc 2 9225 0
 7654 0000 010050E3 		cmp	r0, #1
 7655 0004 1EFF2F01 		bxeq	lr
 7656 0008 030050E3 		cmp	r0, #3
9236:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7657              		.loc 2 9236 0
 7658 000c 0400A003 		moveq	r0, #4
 7659              	.LVL821:
 7660 0010 0000A013 		movne	r0, #0
9238:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_PK_C && ( MBEDTLS_RSA_C || MBEDTLS_ECDSA_C ) */
 7661              		.loc 2 9238 0
 7662 0014 1EFF2FE1 		bx	lr
 7663              		.cfi_endproc
 7664              	.LFE130:
 7666              		.section	.text.mbedtls_ssl_sig_hash_set_find,"ax",%progbits
 7667              		.align	2
 7668              		.global	mbedtls_ssl_sig_hash_set_find
 7669              		.syntax unified
 7670              		.arm
 7671              		.fpu neon
 7673              	mbedtls_ssl_sig_hash_set_find:
 7674              	.LFB131:
9247:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( sig_alg )
 7675              		.loc 2 9247 0
 7676              		.cfi_startproc
 7677              		@ args = 0, pretend = 0, frame = 0
 7678              		@ frame_needed = 0, uses_anonymous_args = 0
 7679              		@ link register save eliminated.
 7680              	.LVL822:
9248:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7681              		.loc 2 9248 0
 7682 0000 010051E3 		cmp	r1, #1
 7683 0004 0300000A 		beq	.L760
 7684 0008 040051E3 		cmp	r1, #4
 7685 000c 0300000A 		beq	.L761
9255:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7686              		.loc 2 9255 0
 7687 0010 0000A0E3 		mov	r0, #0
 7688              	.LVL823:
9257:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7689              		.loc 2 9257 0
 7690 0014 1EFF2FE1 		bx	lr
 7691              	.LVL824:
 7692              	.L760:
9251:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_PK_ECDSA:
 7693              		.loc 2 9251 0
 7694 0018 0000D0E5 		ldrb	r0, [r0]	@ zero_extendqisi2
 7695              	.LVL825:
 7696 001c 1EFF2FE1 		bx	lr
 7697              	.LVL826:
 7698              	.L761:
9253:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
 7699              		.loc 2 9253 0
 7700 0020 0100D0E5 		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 7701              	.LVL827:
 7702 0024 1EFF2FE1 		bx	lr
 7703              		.cfi_endproc
 7704              	.LFE131:
 7706              		.section	.text.mbedtls_ssl_sig_hash_set_add,"ax",%progbits
 7707              		.align	2
 7708              		.global	mbedtls_ssl_sig_hash_set_add
 7709              		.syntax unified
 7710              		.arm
 7711              		.fpu neon
 7713              	mbedtls_ssl_sig_hash_set_add:
 7714              	.LFB132:
9263:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( sig_alg )
 7715              		.loc 2 9263 0
 7716              		.cfi_startproc
 7717              		@ args = 0, pretend = 0, frame = 0
 7718              		@ frame_needed = 0, uses_anonymous_args = 0
 7719              		@ link register save eliminated.
 7720              	.LVL828:
9264:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7721              		.loc 2 9264 0
 7722 0000 010051E3 		cmp	r1, #1
 7723 0004 0200000A 		beq	.L766
 7724 0008 040051E3 		cmp	r1, #4
 7725 000c 0400000A 		beq	.L767
 7726 0010 1EFF2FE1 		bx	lr
 7727              	.L766:
9267:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 set->rsa = md_alg;
 7728              		.loc 2 9267 0
 7729 0014 0030D0E5 		ldrb	r3, [r0]	@ zero_extendqisi2
 7730 0018 000053E3 		cmp	r3, #0
9268:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
 7731              		.loc 2 9268 0
 7732 001c 0020C005 		strbeq	r2, [r0]
 7733 0020 1EFF2FE1 		bx	lr
 7734              	.L767:
9272:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 set->ecdsa = md_alg;
 7735              		.loc 2 9272 0
 7736 0024 0130D0E5 		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 7737 0028 000053E3 		cmp	r3, #0
9273:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
 7738              		.loc 2 9273 0
 7739 002c 0120C005 		strbeq	r2, [r0, #1]
 7740 0030 1EFF2FE1 		bx	lr
 7741              		.cfi_endproc
 7742              	.LFE132:
 7744              		.section	.text.mbedtls_ssl_sig_hash_set_const_hash,"ax",%progbits
 7745              		.align	2
 7746              		.global	mbedtls_ssl_sig_hash_set_const_hash
 7747              		.syntax unified
 7748              		.arm
 7749              		.fpu neon
 7751              	mbedtls_ssl_sig_hash_set_const_hash:
 7752              	.LFB133:
9284:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     set->rsa   = md_alg;
 7753              		.loc 2 9284 0
 7754              		.cfi_startproc
 7755              		@ args = 0, pretend = 0, frame = 0
 7756              		@ frame_needed = 0, uses_anonymous_args = 0
 7757              		@ link register save eliminated.
 7758              	.LVL829:
9285:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     set->ecdsa = md_alg;
 7759              		.loc 2 9285 0
 7760 0000 0010C0E5 		strb	r1, [r0]
9286:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 7761              		.loc 2 9286 0
 7762 0004 0110C0E5 		strb	r1, [r0, #1]
 7763 0008 1EFF2FE1 		bx	lr
 7764              		.cfi_endproc
 7765              	.LFE133:
 7767              		.section	.text.mbedtls_ssl_md_alg_from_hash,"ax",%progbits
 7768              		.align	2
 7769              		.global	mbedtls_ssl_md_alg_from_hash
 7770              		.syntax unified
 7771              		.arm
 7772              		.fpu neon
 7774              	mbedtls_ssl_md_alg_from_hash:
 7775              	.LFB134:
9296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( hash )
 7776              		.loc 2 9296 0
 7777              		.cfi_startproc
 7778              		@ args = 0, pretend = 0, frame = 0
 7779              		@ frame_needed = 0, uses_anonymous_args = 0
 7780              		@ link register save eliminated.
 7781              	.LVL830:
 7782 0000 020040E2 		sub	r0, r0, #2
 7783              	.LVL831:
 7784 0004 7000EFE6 		uxtb	r0, r0
 7785 0008 020050E3 		cmp	r0, #2
 7786 000c 08309F95 		ldrls	r3, .L772
 7787 0010 0000D397 		ldrbls	r0, [r3, r0]	@ zero_extendqisi2
9296:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( hash )
 7788              		.loc 2 9296 0
 7789 0014 0000A083 		movhi	r0, #0
9322:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7790              		.loc 2 9322 0
 7791 0018 1EFF2FE1 		bx	lr
 7792              	.L773:
 7793              		.align	2
 7794              	.L772:
 7795 001c 00000000 		.word	.LANCHOR6
 7796              		.cfi_endproc
 7797              	.LFE134:
 7799              		.section	.text.mbedtls_ssl_hash_from_md_alg,"ax",%progbits
 7800              		.align	2
 7801              		.global	mbedtls_ssl_hash_from_md_alg
 7802              		.syntax unified
 7803              		.arm
 7804              		.fpu neon
 7806              	mbedtls_ssl_hash_from_md_alg:
 7807              	.LFB135:
9328:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( md )
 7808              		.loc 2 9328 0
 7809              		.cfi_startproc
 7810              		@ args = 0, pretend = 0, frame = 0
 7811              		@ frame_needed = 0, uses_anonymous_args = 0
 7812              		@ link register save eliminated.
 7813              	.LVL832:
 7814 0000 040040E2 		sub	r0, r0, #4
 7815              	.LVL833:
 7816 0004 020050E3 		cmp	r0, #2
 7817 0008 08309F95 		ldrls	r3, .L777
 7818 000c 0000D397 		ldrbls	r0, [r3, r0]	@ zero_extendqisi2
 7819              	.LVL834:
9329:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7820              		.loc 2 9329 0
 7821 0010 0000A083 		movhi	r0, #0
9354:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7822              		.loc 2 9354 0
 7823 0014 1EFF2FE1 		bx	lr
 7824              	.L778:
 7825              		.align	2
 7826              	.L777:
 7827 0018 00000000 		.word	.LANCHOR7
 7828              		.cfi_endproc
 7829              	.LFE135:
 7831              		.section	.text.mbedtls_ssl_check_curve,"ax",%progbits
 7832              		.align	2
 7833              		.global	mbedtls_ssl_check_curve
 7834              		.syntax unified
 7835              		.arm
 7836              		.fpu neon
 7838              	mbedtls_ssl_check_curve:
 7839              	.LFB136:
9362:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_ecp_group_id *gid;
 7840              		.loc 2 9362 0
 7841              		.cfi_startproc
 7842              		@ args = 0, pretend = 0, frame = 0
 7843              		@ frame_needed = 0, uses_anonymous_args = 0
 7844              		@ link register save eliminated.
 7845              	.LVL835:
9365:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
 7846              		.loc 2 9365 0
 7847 0000 003090E5 		ldr	r3, [r0]
 7848 0004 503093E5 		ldr	r3, [r3, #80]
 7849 0008 000053E3 		cmp	r3, #0
 7850 000c 01304312 		subne	r3, r3, #1
 7851 0010 0300001A 		bne	.L781
 7852              	.L783:
9366:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7853              		.loc 2 9366 0
 7854 0014 0000E0E3 		mvn	r0, #0
 7855              	.LVL836:
 7856 0018 1EFF2FE1 		bx	lr
 7857              	.LVL837:
 7858              	.L782:
9369:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
 7859              		.loc 2 9369 0
 7860 001c 010052E1 		cmp	r2, r1
 7861 0020 0300000A 		beq	.L784
 7862              	.LVL838:
 7863              	.L781:
9368:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( *gid == grp_id )
 7864              		.loc 2 9368 0 discriminator 1
 7865 0024 0120F3E5 		ldrb	r2, [r3, #1]!	@ zero_extendqisi2
 7866              	.LVL839:
 7867 0028 000052E3 		cmp	r2, #0
 7868 002c FAFFFF1A 		bne	.L782
 7869 0030 F7FFFFEA 		b	.L783
 7870              	.L784:
9370:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7871              		.loc 2 9370 0
 7872 0034 0000A0E3 		mov	r0, #0
 7873              	.LVL840:
9373:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_ECP_C */
 7874              		.loc 2 9373 0
 7875 0038 1EFF2FE1 		bx	lr
 7876              		.cfi_endproc
 7877              	.LFE136:
 7879              		.section	.text.mbedtls_ssl_check_sig_hash,"ax",%progbits
 7880              		.align	2
 7881              		.global	mbedtls_ssl_check_sig_hash
 7882              		.syntax unified
 7883              		.arm
 7884              		.fpu neon
 7886              	mbedtls_ssl_check_sig_hash:
 7887              	.LFB137:
9383:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const int *cur;
 7888              		.loc 2 9383 0
 7889              		.cfi_startproc
 7890              		@ args = 0, pretend = 0, frame = 0
 7891              		@ frame_needed = 0, uses_anonymous_args = 0
 7892              		@ link register save eliminated.
 7893              	.LVL841:
9386:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( -1 );
 7894              		.loc 2 9386 0
 7895 0000 003090E5 		ldr	r3, [r0]
 7896 0004 4C3093E5 		ldr	r3, [r3, #76]
 7897 0008 000053E3 		cmp	r3, #0
 7898 000c 04304312 		subne	r3, r3, #4
 7899 0010 0300001A 		bne	.L787
 7900              	.L789:
9387:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7901              		.loc 2 9387 0
 7902 0014 0000E0E3 		mvn	r0, #0
 7903              	.LVL842:
 7904 0018 1EFF2FE1 		bx	lr
 7905              	.LVL843:
 7906              	.L788:
9390:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return( 0 );
 7907              		.loc 2 9390 0
 7908 001c 010052E1 		cmp	r2, r1
 7909 0020 0300000A 		beq	.L790
 7910              	.LVL844:
 7911              	.L787:
9389:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         if( *cur == (int) md )
 7912              		.loc 2 9389 0 discriminator 1
 7913 0024 0420B3E5 		ldr	r2, [r3, #4]!
 7914              	.LVL845:
 7915 0028 000052E3 		cmp	r2, #0
 7916 002c FAFFFF1A 		bne	.L788
 7917 0030 F7FFFFEA 		b	.L789
 7918              	.L790:
9391:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 7919              		.loc 2 9391 0
 7920 0034 0000A0E3 		mov	r0, #0
 7921              	.LVL846:
9394:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_KEY_EXCHANGE__WITH_CERT__ENABLED */
 7922              		.loc 2 9394 0
 7923 0038 1EFF2FE1 		bx	lr
 7924              		.cfi_endproc
 7925              	.LFE137:
 7927              		.section	.text.mbedtls_ssl_check_cert_usage,"ax",%progbits
 7928              		.align	2
 7929              		.global	mbedtls_ssl_check_cert_usage
 7930              		.syntax unified
 7931              		.arm
 7932              		.fpu neon
 7934              	mbedtls_ssl_check_cert_usage:
 7935              	.LFB138:
9402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 7936              		.loc 2 9402 0
 7937              		.cfi_startproc
 7938              		@ args = 0, pretend = 0, frame = 0
 7939              		@ frame_needed = 0, uses_anonymous_args = 0
 7940              	.LVL847:
9420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7941              		.loc 2 9420 0
 7942 0000 010052E3 		cmp	r2, #1
9402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 7943              		.loc 2 9402 0
 7944 0004 F0412DE9 		push	{r4, r5, r6, r7, r8, lr}
 7945              		.cfi_def_cfa_offset 24
 7946              		.cfi_offset 4, -24
 7947              		.cfi_offset 5, -20
 7948              		.cfi_offset 6, -16
 7949              		.cfi_offset 7, -12
 7950              		.cfi_offset 8, -8
 7951              		.cfi_offset 14, -4
9453:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7952              		.loc 2 9453 0
 7953 0008 8010A013 		movne	r1, #128
 7954              	.LVL848:
9402:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 7955              		.loc 2 9402 0
 7956 000c 0070A0E1 		mov	r7, r0
 7957 0010 0260A0E1 		mov	r6, r2
 7958 0014 0340A0E1 		mov	r4, r3
9420:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7959              		.loc 2 9420 0
 7960 0018 0D00001A 		bne	.L792
9423:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 7961              		.loc 2 9423 0
 7962 001c 0A20D1E5 		ldrb	r2, [r1, #10]	@ zero_extendqisi2
 7963              	.LVL849:
 7964 0020 0A0052E3 		cmp	r2, #10
9405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7965              		.loc 2 9405 0
 7966 0024 0010A083 		movhi	r1, #0
 7967 0028 0900008A 		bhi	.L792
 7968 002c 1622A0E1 		lsl	r2, r6, r2
 7969 0030 820012E3 		tst	r2, #130
9427:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
 7970              		.loc 2 9427 0
 7971 0034 2010A013 		movne	r1, #32
 7972 0038 0500001A 		bne	.L792
 7973 003c 060C12E3 		tst	r2, #1536
9438:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 break;
 7974              		.loc 2 9438 0
 7975 0040 0810A013 		movne	r1, #8
 7976 0044 0200001A 		bne	.L792
9405:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
 7977              		.loc 2 9405 0
 7978 0048 1C0012E3 		tst	r2, #28
 7979 004c 8010A013 		movne	r1, #128
 7980 0050 0010A003 		moveq	r1, #0
 7981              	.L792:
 7982              	.LVL850:
9456:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7983              		.loc 2 9456 0
 7984 0054 0700A0E1 		mov	r0, r7
 7985              	.LVL851:
 7986 0058 FEFFFFEB 		bl	mbedtls_x509_crt_check_key_usage
 7987              	.LVL852:
 7988 005c 005050E2 		subs	r5, r0, #0
9477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7989              		.loc 2 9477 0
 7990 0060 40109FE5 		ldr	r1, .L809
9458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = -1;
 7991              		.loc 2 9458 0
 7992 0064 00309415 		ldrne	r3, [r4]
9459:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 7993              		.loc 2 9459 0
 7994 0068 0050E013 		mvnne	r5, #0
9477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 7995              		.loc 2 9477 0
 7996 006c 0820A0E3 		mov	r2, #8
 7997 0070 0700A0E1 		mov	r0, r7
9458:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = -1;
 7998              		.loc 2 9458 0
 7999 0074 023B8313 		orrne	r3, r3, #2048
 8000 0078 00308415 		strne	r3, [r4]
 8001              	.LVL853:
9477:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8002              		.loc 2 9477 0
 8003 007c 010056E3 		cmp	r6, #1
 8004 0080 24309FE5 		ldr	r3, .L809+4
 8005 0084 0310A011 		movne	r1, r3
 8006 0088 FEFFFFEB 		bl	mbedtls_x509_crt_check_extended_key_usage
 8007              	.LVL854:
 8008 008c 000050E3 		cmp	r0, #0
9479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = -1;
 8009              		.loc 2 9479 0
 8010 0090 00309415 		ldrne	r3, [r4]
9480:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8011              		.loc 2 9480 0
 8012 0094 0050E013 		mvnne	r5, #0
 8013              	.LVL855:
9485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 8014              		.loc 2 9485 0
 8015 0098 0500A0E1 		mov	r0, r5
9479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ret = -1;
 8016              		.loc 2 9479 0
 8017 009c 013A8313 		orrne	r3, r3, #4096
 8018 00a0 00308415 		strne	r3, [r4]
 8019              	.LVL856:
9485:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_X509_CRT_PARSE_C */
 8020              		.loc 2 9485 0
 8021 00a4 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 8022              	.L810:
 8023              		.align	2
 8024              	.L809:
 8025 00a8 00000000 		.word	.LC6
 8026 00ac 09000000 		.word	.LC7
 8027              		.cfi_endproc
 8028              	.LFE138:
 8030              		.section	.text.mbedtls_ssl_parse_certificate,"ax",%progbits
 8031              		.align	2
 8032              		.global	mbedtls_ssl_parse_certificate
 8033              		.syntax unified
 8034              		.arm
 8035              		.fpu neon
 8037              	mbedtls_ssl_parse_certificate:
 8038              	.LFB50:
5436:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = MBEDTLS_ERR_SSL_FEATURE_UNAVAILABLE;
 8039              		.loc 2 5436 0
 8040              		.cfi_startproc
 8041              		@ args = 0, pretend = 0, frame = 0
 8042              		@ frame_needed = 0, uses_anonymous_args = 0
 8043              	.LVL857:
 8044 0000 FF472DE9 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, lr}
 8045              		.cfi_def_cfa_offset 48
 8046              		.cfi_offset 4, -32
 8047              		.cfi_offset 5, -28
 8048              		.cfi_offset 6, -24
 8049              		.cfi_offset 7, -20
 8050              		.cfi_offset 8, -16
 8051              		.cfi_offset 9, -12
 8052              		.cfi_offset 10, -8
 8053              		.cfi_offset 14, -4
5439:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int authmode = ssl->conf->authmode;
 8054              		.loc 2 5439 0
 8055 0004 403090E5 		ldr	r3, [r0, #64]
 8056 0008 008093E5 		ldr	r8, [r3]
 8057              	.LVL858:
5445:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_DHE_PSK ||
 8058              		.loc 2 5445 0
 8059 000c 0A30D8E5 		ldrb	r3, [r8, #10]	@ zero_extendqisi2
5446:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECDHE_PSK ||
 8060              		.loc 2 5446 0
 8061 0010 0B0053E3 		cmp	r3, #11
 8062 0014 0600008A 		bhi	.L812
 8063 0018 964EA0E3 		mov	r4, #2400
 8064 001c 3443E0E1 		mvn	r4, r4, lsr r3
5447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
 8065              		.loc 2 5447 0
 8066 0020 014014E2 		ands	r4, r4, #1
5451:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return( 0 );
 8067              		.loc 2 5451 0
 8068 0024 04309005 		ldreq	r3, [r0, #4]
 8069 0028 01308302 		addeq	r3, r3, #1
 8070 002c 04308005 		streq	r3, [r0, #4]
5447:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ciphersuite_info->key_exchange == MBEDTLS_KEY_EXCHANGE_ECJPAKE )
 8071              		.loc 2 5447 0
 8072 0030 1200000A 		beq	.L811
 8073              	.L812:
5440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint8_t alert;
 8074              		.loc 2 5440 0
 8075 0034 003090E5 		ldr	r3, [r0]
5479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8076              		.loc 2 5479 0
 8077 0038 0110A0E3 		mov	r1, #1
 8078 003c 0060A0E1 		mov	r6, r0
5440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint8_t alert;
 8079              		.loc 2 5440 0
 8080 0040 6070D3E5 		ldrb	r7, [r3, #96]	@ zero_extendqisi2
5479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8081              		.loc 2 5479 0
 8082 0044 FEFFFFEB 		bl	mbedtls_ssl_read_record
 8083              	.LVL859:
 8084 0048 004050E2 		subs	r4, r0, #0
5440:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     uint8_t alert;
 8085              		.loc 2 5440 0
 8086 004c 5771E1E7 		ubfx	r7, r7, #2, #2
5479:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8087              		.loc 2 5479 0
 8088 0050 0A00001A 		bne	.L811
5487:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8089              		.loc 2 5487 0
 8090 0054 043096E5 		ldr	r3, [r6, #4]
 8091 0058 013083E2 		add	r3, r3, #1
 8092 005c 043086E5 		str	r3, [r6, #4]
5542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8093              		.loc 2 5542 0
 8094 0060 6C3096E5 		ldr	r3, [r6, #108]
 8095 0064 160053E3 		cmp	r3, #22
 8096 0068 0700000A 		beq	.L814
5547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8097              		.loc 2 5547 0
 8098 006c EC429FE5 		ldr	r4, .L866
5545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_UNEXPECTED_MESSAGE );
 8099              		.loc 2 5545 0
 8100 0070 0A20A0E3 		mov	r2, #10
 8101 0074 0210A0E3 		mov	r1, #2
 8102 0078 0600A0E1 		mov	r0, r6
 8103              	.LVL860:
 8104 007c FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 8105              	.LVL861:
 8106              	.L811:
5816:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* !MBEDTLS_KEY_EXCHANGE_RSA_ENABLED
 8107              		.loc 2 5816 0
 8108 0080 0400A0E1 		mov	r0, r4
 8109 0084 10D08DE2 		add	sp, sp, #16
 8110              		.cfi_remember_state
 8111              		.cfi_def_cfa_offset 32
 8112              		@ sp needed
 8113 0088 F087BDE8 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 8114              	.LVL862:
 8115              	.L814:
 8116              		.cfi_restore_state
5550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen < mbedtls_ssl_hs_hdr_len( ssl ) + 3 + 3 )
 8117              		.loc 2 5550 0
 8118 008c 642096E5 		ldr	r2, [r6, #100]
 8119 0090 0030D2E5 		ldrb	r3, [r2]	@ zero_extendqisi2
 8120 0094 0B0053E3 		cmp	r3, #11
 8121 0098 0200001A 		bne	.L816
5551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8122              		.loc 2 5551 0 discriminator 1
 8123 009c 781096E5 		ldr	r1, [r6, #120]
 8124              	.LVL863:
5550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen < mbedtls_ssl_hs_hdr_len( ssl ) + 3 + 3 )
 8125              		.loc 2 5550 0 discriminator 1
 8126 00a0 090051E3 		cmp	r1, #9
 8127 00a4 0500008A 		bhi	.L864
 8128              	.LVL864:
 8129              	.L816:
5554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
 8130              		.loc 2 5554 0
 8131 00a8 3220A0E3 		mov	r2, #50
 8132 00ac 0210A0E3 		mov	r1, #2
 8133 00b0 0600A0E1 		mov	r0, r6
5556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8134              		.loc 2 5556 0
 8135 00b4 A8429FE5 		ldr	r4, .L866+4
5554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR );
 8136              		.loc 2 5554 0
 8137 00b8 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 8138              	.LVL865:
5556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8139              		.loc 2 5556 0
 8140 00bc EFFFFFEA 		b	.L811
 8141              	.LVL866:
 8142              	.L864:
5564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8143              		.loc 2 5564 0
 8144 00c0 0500D2E5 		ldrb	r0, [r2, #5]	@ zero_extendqisi2
 8145              	.LVL867:
 8146 00c4 0630D2E5 		ldrb	r3, [r2, #6]	@ zero_extendqisi2
5566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen != n + 3 + mbedtls_ssl_hs_hdr_len( ssl ) )
 8147              		.loc 2 5566 0
 8148 00c8 0420D2E5 		ldrb	r2, [r2, #4]	@ zero_extendqisi2
 8149 00cc 000052E3 		cmp	r2, #0
5564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8150              		.loc 2 5564 0
 8151 00d0 003483E1 		orr	r3, r3, r0, lsl #8
 8152              	.LVL868:
5566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen != n + 3 + mbedtls_ssl_hs_hdr_len( ssl ) )
 8153              		.loc 2 5566 0
 8154 00d4 F3FFFF1A 		bne	.L816
 8155              	.LVL869:
5567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8156              		.loc 2 5567 0 discriminator 1
 8157 00d8 073083E2 		add	r3, r3, #7
 8158              	.LVL870:
5566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ssl->in_hslen != n + 3 + mbedtls_ssl_hs_hdr_len( ssl ) )
 8159              		.loc 2 5566 0 discriminator 1
 8160 00dc 030051E1 		cmp	r1, r3
 8161 00e0 F0FFFF1A 		bne	.L816
5576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8162              		.loc 2 5576 0
 8163 00e4 2C3096E5 		ldr	r3, [r6, #44]
 8164              	.LVL871:
 8165 00e8 5C0093E5 		ldr	r0, [r3, #92]
 8166              	.LVL872:
 8167 00ec 000050E3 		cmp	r0, #0
 8168 00f0 0300000A 		beq	.L819
5578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_free( ssl->session_negotiate->peer_cert );
 8169              		.loc 2 5578 0
 8170 00f4 FEFFFFEB 		bl	mbedtls_x509_crt_free
 8171              	.LVL873:
5579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8172              		.loc 2 5579 0
 8173 00f8 2C3096E5 		ldr	r3, [r6, #44]
 8174 00fc 5C0093E5 		ldr	r0, [r3, #92]
 8175 0100 FEFFFFEB 		bl	mbedtls_free
 8176              	.LVL874:
 8177              	.L819:
5582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                     sizeof( mbedtls_x509_crt ) ) ) == NULL )
 8178              		.loc 2 5582 0
 8179 0104 2C4096E5 		ldr	r4, [r6, #44]
 8180              	.LVL875:
 8181 0108 4D1FA0E3 		mov	r1, #308
 8182 010c 0100A0E3 		mov	r0, #1
 8183 0110 FEFFFFEB 		bl	mbedtls_calloc
 8184              	.LVL876:
 8185 0114 000050E3 		cmp	r0, #0
 8186 0118 5C0084E5 		str	r0, [r4, #92]
 8187 011c 0500001A 		bne	.L820
5587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
 8188              		.loc 2 5587 0
 8189 0120 5020A0E3 		mov	r2, #80
 8190 0124 0210A0E3 		mov	r1, #2
 8191 0128 0600A0E1 		mov	r0, r6
5589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8192              		.loc 2 5589 0
 8193 012c 34429FE5 		ldr	r4, .L866+8
5587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
 8194              		.loc 2 5587 0
 8195 0130 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 8196              	.LVL877:
5589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8197              		.loc 2 5589 0
 8198 0134 D1FFFFEA 		b	.L811
 8199              	.L820:
5592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8200              		.loc 2 5592 0
 8201 0138 2C3096E5 		ldr	r3, [r6, #44]
5596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8202              		.loc 2 5596 0
 8203 013c 0040A0E3 		mov	r4, #0
5626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8204              		.loc 2 5626 0
 8205 0140 24929FE5 		ldr	r9, .L866+12
5594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8206              		.loc 2 5594 0
 8207 0144 0750A0E3 		mov	r5, #7
5592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8208              		.loc 2 5592 0
 8209 0148 5C0093E5 		ldr	r0, [r3, #92]
 8210 014c FEFFFFEB 		bl	mbedtls_x509_crt_init
 8211              	.LVL878:
 8212              	.L857:
5596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8213              		.loc 2 5596 0
 8214 0150 783096E5 		ldr	r3, [r6, #120]
 8215 0154 030055E1 		cmp	r5, r3
 8216 0158 5A00003A 		bcc	.L826
5685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
 8217              		.loc 2 5685 0
 8218 015c 000057E3 		cmp	r7, #0
 8219 0160 C6FFFF0A 		beq	.L811
 8220              	.LBB393:
5691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8221              		.loc 2 5691 0
 8222 0164 302096E5 		ldr	r2, [r6, #48]
 8223 0168 003096E5 		ldr	r3, [r6]
5707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ca_chain, ca_crl,
 8224              		.loc 2 5707 0
 8225 016c 2C0096E5 		ldr	r0, [r6, #44]
5691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8226              		.loc 2 5691 0
 8227 0170 485192E5 		ldr	r5, [r2, #328]
 8228              	.LVL879:
5706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 8229              		.loc 2 5706 0
 8230 0174 381093E5 		ldr	r1, [r3, #56]
5691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8231              		.loc 2 5691 0
 8232 0178 000055E3 		cmp	r5, #0
5699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ca_crl   = ssl->conf->ca_crl;
 8233              		.loc 2 5699 0
 8234 017c 44509305 		ldreq	r5, [r3, #68]
 8235              	.LVL880:
5700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 8236              		.loc 2 5700 0
 8237 0180 48209305 		ldreq	r2, [r3, #72]
 8238              	.LVL881:
5694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 8239              		.loc 2 5694 0
 8240 0184 4C219215 		ldrne	r2, [r2, #332]
 8241              	.LVL882:
5706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 8242              		.loc 2 5706 0
 8243 0188 0C108DE5 		str	r1, [sp, #12]
 8244 018c 341093E5 		ldr	r1, [r3, #52]
 8245 0190 08108DE5 		str	r1, [sp, #8]
 8246 0194 601080E2 		add	r1, r0, #96
 8247 0198 04108DE5 		str	r1, [sp, #4]
 8248 019c B41096E5 		ldr	r1, [r6, #180]
 8249 01a0 00108DE5 		str	r1, [sp]
 8250 01a4 0510A0E1 		mov	r1, r5
 8251 01a8 3C3093E5 		ldr	r3, [r3, #60]
 8252 01ac 5C0090E5 		ldr	r0, [r0, #92]
 8253 01b0 FEFFFFEB 		bl	mbedtls_x509_crt_verify_with_profile
 8254              	.LVL883:
 8255              	.LBB394:
5725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8256              		.loc 2 5725 0
 8257 01b4 2C3096E5 		ldr	r3, [r6, #44]
 8258              	.LBE394:
5706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                 ssl->session_negotiate->peer_cert,
 8259              		.loc 2 5706 0
 8260 01b8 0040A0E1 		mov	r4, r0
 8261              	.LVL884:
 8262              	.LBB395:
5728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_check_curve( ssl, mbedtls_pk_ec( *pk )->grp.id ) != 0 )
 8263              		.loc 2 5728 0
 8264 01bc 0210A0E3 		mov	r1, #2
5725:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8265              		.loc 2 5725 0
 8266 01c0 5CA093E5 		ldr	r10, [r3, #92]
 8267              	.LVL885:
5728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_check_curve( ssl, mbedtls_pk_ec( *pk )->grp.id ) != 0 )
 8268              		.loc 2 5728 0
 8269 01c4 BC008AE2 		add	r0, r10, #188
 8270              	.LVL886:
 8271 01c8 FEFFFFEB 		bl	mbedtls_pk_can_do
 8272              	.LVL887:
 8273 01cc 000050E3 		cmp	r0, #0
 8274 01d0 2C9096E5 		ldr	r9, [r6, #44]
 8275 01d4 0B00000A 		beq	.L829
5729:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             {
 8276              		.loc 2 5729 0 discriminator 1
 8277 01d8 C0309AE5 		ldr	r3, [r10, #192]
 8278 01dc 0600A0E1 		mov	r0, r6
 8279 01e0 0010D3E5 		ldrb	r1, [r3]	@ zero_extendqisi2
 8280 01e4 FEFFFFEB 		bl	mbedtls_ssl_check_curve
 8281              	.LVL888:
5728:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 mbedtls_ssl_check_curve( ssl, mbedtls_pk_ec( *pk )->grp.id ) != 0 )
 8282              		.loc 2 5728 0 discriminator 1
 8283 01e8 000050E3 		cmp	r0, #0
 8284 01ec 0500000A 		beq	.L829
5731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8285              		.loc 2 5731 0
 8286 01f0 603099E5 		ldr	r3, [r9, #96]
5735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 8287              		.loc 2 5735 0
 8288 01f4 000054E3 		cmp	r4, #0
5731:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
 8289              		.loc 2 5731 0
 8290 01f8 013883E3 		orr	r3, r3, #65536
 8291 01fc 603089E5 		str	r3, [r9, #96]
5735:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             }
 8292              		.loc 2 5735 0
 8293 0200 5C319FE5 		ldr	r3, .L866+4
 8294 0204 0340A001 		moveq	r4, r3
 8295              	.LVL889:
 8296              	.L829:
 8297              	.LBE395:
5742:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  &ssl->session_negotiate->verify_result ) != 0 )
 8298              		.loc 2 5742 0
 8299 0208 003096E5 		ldr	r3, [r6]
5740:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                  ciphersuite_info,
 8300              		.loc 2 5740 0
 8301 020c 0810A0E1 		mov	r1, r8
 8302 0210 5C0099E5 		ldr	r0, [r9, #92]
 8303 0214 6020D3E5 		ldrb	r2, [r3, #96]	@ zero_extendqisi2
 8304 0218 603089E2 		add	r3, r9, #96
 8305 021c 0220E0E1 		mvn	r2, r2
 8306 0220 012002E2 		and	r2, r2, #1
 8307 0224 FEFFFFEB 		bl	mbedtls_ssl_check_cert_usage
 8308              	.LVL890:
5746:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 ret = MBEDTLS_ERR_SSL_BAD_HS_CERTIFICATE;
 8309              		.loc 2 5746 0
 8310 0228 143F6FE1 		clz	r3, r4
 8311 022c 000050E3 		cmp	r0, #0
 8312 0230 A332A0E1 		lsr	r3, r3, #5
 8313 0234 0030A003 		moveq	r3, #0
 8314 0238 0300A0E1 		mov	r0, r3
5747:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 8315              		.loc 2 5747 0
 8316 023c 20319FE5 		ldr	r3, .L866+4
 8317 0240 000050E3 		cmp	r0, #0
 8318 0244 0340A011 		movne	r4, r3
 8319              	.LVL891:
5756:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ( ret == MBEDTLS_ERR_X509_CERT_VERIFY_FAILED ||
 8320              		.loc 2 5756 0
 8321 0248 010057E3 		cmp	r7, #1
 8322 024c 0200001A 		bne	.L831
5760:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 8323              		.loc 2 5760 0 discriminator 1
 8324 0250 270C74E3 		cmn	r4, #9984
 8325 0254 03005411 		cmpne	r4, r3
 8326 0258 0040A003 		moveq	r4, #0
 8327              	.LVL892:
 8328              	.L831:
5763:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8329              		.loc 2 5763 0
 8330 025c 000055E3 		cmp	r5, #0
 8331 0260 02005703 		cmpeq	r7, #2
 8332 0264 3900000A 		beq	.L837
5769:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8333              		.loc 2 5769 0
 8334 0268 000054E3 		cmp	r4, #0
 8335 026c 83FFFF0A 		beq	.L811
 8336              	.LVL893:
 8337              	.L832:
5774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED;
 8338              		.loc 2 5774 0
 8339 0270 2C3096E5 		ldr	r3, [r6, #44]
 8340 0274 603093E5 		ldr	r3, [r3, #96]
 8341 0278 010C13E3 		tst	r3, #256
5775:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_CN_MISMATCH )
 8342              		.loc 2 5775 0
 8343 027c 3120A013 		movne	r2, #49
5774:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_ACCESS_DENIED;
 8344              		.loc 2 5774 0
 8345 0280 0C00001A 		bne	.L833
5776:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_BAD_CERT;
 8346              		.loc 2 5776 0
 8347 0284 040013E3 		tst	r3, #4
 8348 0288 2900001A 		bne	.L839
5786:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_UNSUPPORTED_CERT;
 8349              		.loc 2 5786 0
 8350 028c 6E0B13E3 		tst	r3, #112640
 8351 0290 3000001A 		bne	.L840
5788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_EXPIRED;
 8352              		.loc 2 5788 0
 8353 0294 010013E3 		tst	r3, #1
5789:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_REVOKED )
 8354              		.loc 2 5789 0
 8355 0298 2D20A013 		movne	r2, #45
5788:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_EXPIRED;
 8356              		.loc 2 5788 0
 8357 029c 0500001A 		bne	.L833
5790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_REVOKED;
 8358              		.loc 2 5790 0
 8359 02a0 020013E3 		tst	r3, #2
5791:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_NOT_TRUSTED )
 8360              		.loc 2 5791 0
 8361 02a4 2C20A013 		movne	r2, #44
5790:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                 alert = MBEDTLS_SSL_ALERT_MSG_CERT_REVOKED;
 8362              		.loc 2 5790 0
 8363 02a8 0200001A 		bne	.L833
5795:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 8364              		.loc 2 5795 0
 8365 02ac 080013E3 		tst	r3, #8
 8366 02b0 3020A013 		movne	r2, #48
 8367 02b4 2E20A003 		moveq	r2, #46
 8368              	.LVL894:
 8369              	.L833:
5796:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             alert );
 8370              		.loc 2 5796 0
 8371 02b8 0210A0E3 		mov	r1, #2
 8372 02bc 0600A0E1 		mov	r0, r6
 8373 02c0 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 8374              	.LVL895:
 8375 02c4 6DFFFFEA 		b	.L811
 8376              	.LVL896:
 8377              	.L826:
 8378              	.LBE393:
5598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             MBEDTLS_SSL_DEBUG_MSG( 1, ( "bad certificate message" ) );
 8379              		.loc 2 5598 0
 8380 02c8 031085E2 		add	r1, r5, #3
 8381 02cc 010053E1 		cmp	r3, r1
 8382 02d0 74FFFF3A 		bcc	.L816
5604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8383              		.loc 2 5604 0
 8384 02d4 640096E5 		ldr	r0, [r6, #100]
 8385 02d8 0520D0E7 		ldrb	r2, [r0, r5]	@ zero_extendqisi2
 8386 02dc 000052E3 		cmp	r2, #0
 8387 02e0 70FFFF1A 		bne	.L816
5612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             | (unsigned int) ssl->in_msg[i + 2];
 8388              		.loc 2 5612 0
 8389 02e4 055080E0 		add	r5, r0, r5
 8390              	.LVL897:
 8391 02e8 01C0D5E5 		ldrb	ip, [r5, #1]	@ zero_extendqisi2
5613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         i += 3;
 8392              		.loc 2 5613 0
 8393 02ec 0220D5E5 		ldrb	r2, [r5, #2]	@ zero_extendqisi2
5612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             | (unsigned int) ssl->in_msg[i + 2];
 8394              		.loc 2 5612 0
 8395 02f0 0C2482E1 		orr	r2, r2, ip, lsl #8
 8396              	.LVL898:
5616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8397              		.loc 2 5616 0
 8398 02f4 7F0052E3 		cmp	r2, #127
 8399 02f8 6AFFFF9A 		bls	.L816
5616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8400              		.loc 2 5616 0 is_stmt 0 discriminator 1
 8401 02fc 025081E0 		add	r5, r1, r2
 8402 0300 050053E1 		cmp	r3, r5
 8403 0304 67FFFF3A 		bcc	.L816
5624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->in_msg + i, n );
 8404              		.loc 2 5624 0 is_stmt 1
 8405 0308 2C3096E5 		ldr	r3, [r6, #44]
 8406 030c 011080E0 		add	r1, r0, r1
 8407              	.LVL899:
 8408 0310 5C0093E5 		ldr	r0, [r3, #92]
 8409 0314 FEFFFFEB 		bl	mbedtls_x509_crt_parse_der
 8410              	.LVL900:
5626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8411              		.loc 2 5626 0
 8412 0318 090050E1 		cmp	r0, r9
5624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                   ssl->in_msg + i, n );
 8413              		.loc 2 5624 0
 8414 031c 0040A0E1 		mov	r4, r0
 8415              	.LVL901:
5626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8416              		.loc 2 5626 0
 8417 0320 8AFFFF0A 		beq	.L857
 8418 0324 040000CA 		bgt	.L823
 8419              	.L824:
 8420 0328 A20D70E3 		cmn	r0, #10368
5635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             goto crt_parse_der_failed;
 8421              		.loc 2 5635 0
 8422 032c 5020A003 		moveq	r2, #80
5626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8423              		.loc 2 5626 0
 8424 0330 E0FFFF0A 		beq	.L833
 8425              	.LVL902:
 8426              	.L839:
 8427              	.LBB396:
5777:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_KEY_USAGE )
 8428              		.loc 2 5777 0
 8429 0334 2A20A0E3 		mov	r2, #42
 8430 0338 DEFFFFEA 		b	.L833
 8431              	.LVL903:
 8432              	.L823:
 8433              	.LBE396:
5626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         {
 8434              		.loc 2 5626 0
 8435 033c 960D70E3 		cmn	r0, #9600
 8436 0340 0400000A 		beq	.L840
 8437 0344 000050E3 		cmp	r0, #0
 8438 0348 80FFFF0A 		beq	.L857
 8439 034c F8FFFFEA 		b	.L839
 8440              	.LVL904:
 8441              	.L837:
 8442              	.LBB397:
5766:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         }
 8443              		.loc 2 5766 0
 8444 0350 18409FE5 		ldr	r4, .L866+16
 8445              	.LVL905:
 8446 0354 C5FFFFEA 		b	.L832
 8447              	.LVL906:
 8448              	.L840:
5787:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             else if( ssl->session_negotiate->verify_result & MBEDTLS_X509_BADCERT_EXPIRED )
 8449              		.loc 2 5787 0
 8450 0358 2B20A0E3 		mov	r2, #43
 8451 035c D5FFFFEA 		b	.L833
 8452              	.L867:
 8453              		.align	2
 8454              	.L866:
 8455 0360 0089FFFF 		.word	-30464
 8456 0364 0086FFFF 		.word	-31232
 8457 0368 0081FFFF 		.word	-32512
 8458 036c D2D9FFFF 		.word	-9774
 8459 0370 8089FFFF 		.word	-30336
 8460              	.LBE397:
 8461              		.cfi_endproc
 8462              	.LFE50:
 8464              		.section	.text.mbedtls_ssl_write_version,"ax",%progbits
 8465              		.align	2
 8466              		.global	mbedtls_ssl_write_version
 8467              		.syntax unified
 8468              		.arm
 8469              		.fpu neon
 8471              	mbedtls_ssl_write_version:
 8472              	.LFB139:
9499:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 8473              		.loc 2 9499 0
 8474              		.cfi_startproc
 8475              		@ args = 0, pretend = 0, frame = 0
 8476              		@ frame_needed = 0, uses_anonymous_args = 0
 8477              		@ link register save eliminated.
 8478              	.LVL907:
9514:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         ver[1] = (unsigned char) minor;
 8479              		.loc 2 9514 0
 8480 0000 0000C3E5 		strb	r0, [r3]
9515:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8481              		.loc 2 9515 0
 8482 0004 0110C3E5 		strb	r1, [r3, #1]
 8483 0008 1EFF2FE1 		bx	lr
 8484              		.cfi_endproc
 8485              	.LFE139:
 8487              		.section	.text.mbedtls_ssl_read_version,"ax",%progbits
 8488              		.align	2
 8489              		.global	mbedtls_ssl_read_version
 8490              		.syntax unified
 8491              		.arm
 8492              		.fpu neon
 8494              	mbedtls_ssl_read_version:
 8495              	.LFB140:
9521:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_DTLS)
 8496              		.loc 2 9521 0
 8497              		.cfi_startproc
 8498              		@ args = 0, pretend = 0, frame = 0
 8499              		@ frame_needed = 0, uses_anonymous_args = 0
 8500              		@ link register save eliminated.
 8501              	.LVL908:
9536:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         *minor = ver[1];
 8502              		.loc 2 9536 0
 8503 0000 0020D3E5 		ldrb	r2, [r3]	@ zero_extendqisi2
 8504              	.LVL909:
 8505 0004 002080E5 		str	r2, [r0]
 8506              		.loc 2 9537 0
 8507 0008 0130D3E5 		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 8508              	.LVL910:
 8509 000c 003081E5 		str	r3, [r1]
 8510 0010 1EFF2FE1 		bx	lr
 8511              		.cfi_endproc
 8512              	.LFE140:
 8514              		.section	.text.mbedtls_ssl_set_calc_verify_md,"ax",%progbits
 8515              		.align	2
 8516              		.global	mbedtls_ssl_set_calc_verify_md
 8517              		.syntax unified
 8518              		.arm
 8519              		.fpu neon
 8521              	mbedtls_ssl_set_calc_verify_md:
 8522              	.LFB141:
9538:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9539:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9540:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9541:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_set_calc_verify_md( mbedtls_ssl_context *ssl, int md )
9542:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 8523              		.loc 2 9542 0
 8524              		.cfi_startproc
 8525              		@ args = 0, pretend = 0, frame = 0
 8526              		@ frame_needed = 0, uses_anonymous_args = 0
 8527              		@ link register save eliminated.
 8528              	.LVL911:
9543:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1_2)
9544:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ssl->minor_ver != MBEDTLS_SSL_MINOR_VERSION_3 )
 8529              		.loc 2 9544 0
 8530 0000 0C3090E5 		ldr	r3, [r0, #12]
 8531 0004 030053E3 		cmp	r3, #3
 8532 0008 0600001A 		bne	.L875
9545:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
9546:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9547:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     switch( md )
 8533              		.loc 2 9547 0
 8534 000c 040051E3 		cmp	r1, #4
 8535 0010 0400001A 		bne	.L875
9548:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9549:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1)
9550:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_MD5_C)
9551:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_MD5:
9552:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
9553:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9554:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA1_C)
9555:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA1:
9556:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->calc_verify = ssl_calc_verify_tls;
9557:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9558:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9559:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1 || MBEDTLS_SSL_PROTO_TLS1_1 */
9560:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA512_C)
9561:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA384:
9562:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->calc_verify = ssl_calc_verify_tls_sha384;
9563:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9564:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9565:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SHA256_C)
9566:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         case MBEDTLS_SSL_HASH_SHA256:
9567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             ssl->handshake->calc_verify = ssl_calc_verify_tls_sha256;
 8536              		.loc 2 9567 0
 8537 0014 303090E5 		ldr	r3, [r0, #48]
9568:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
9569:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif
9570:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         default:
9571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
9572:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9573:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9574:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return 0;
 8538              		.loc 2 9574 0
 8539 0018 0000A0E3 		mov	r0, #0
 8540              	.LVL912:
9567:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****             break;
 8541              		.loc 2 9567 0
 8542 001c 0C209FE5 		ldr	r2, .L876
 8543 0020 C02183E5 		str	r2, [r3, #448]
 8544              		.loc 2 9574 0
 8545 0024 1EFF2FE1 		bx	lr
 8546              	.LVL913:
 8547              	.L875:
9571:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
 8548              		.loc 2 9571 0
 8549 0028 04009FE5 		ldr	r0, .L876+4
 8550              	.LVL914:
9575:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #else /* !MBEDTLS_SSL_PROTO_TLS1_2 */
9576:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     (void) ssl;
9577:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     (void) md;
9578:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9579:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH;
9580:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_TLS1_2 */
9581:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 8551              		.loc 2 9581 0
 8552 002c 1EFF2FE1 		bx	lr
 8553              	.L877:
 8554              		.align	2
 8555              	.L876:
 8556 0030 00000000 		.word	ssl_calc_verify_tls_sha256
 8557 0034 009AFFFF 		.word	-26112
 8558              		.cfi_endproc
 8559              	.LFE141:
 8561              		.section	.text.mbedtls_ssl_get_key_exchange_md_tls1_2,"ax",%progbits
 8562              		.align	2
 8563              		.global	mbedtls_ssl_get_key_exchange_md_tls1_2
 8564              		.syntax unified
 8565              		.arm
 8566              		.fpu neon
 8568              	mbedtls_ssl_get_key_exchange_md_tls1_2:
 8569              	.LFB142:
9582:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9583:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_SSL3) || defined(MBEDTLS_SSL_PROTO_TLS1) || \
9584:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_1)
9585:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_get_key_exchange_md_ssl_tls( mbedtls_ssl_context *ssl,
9586:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         unsigned char *output,
9587:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         unsigned char *data, size_t data_len )
9588:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
9589:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
9590:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_context mbedtls_md5;
9591:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_context mbedtls_sha1;
9592:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9593:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_init( &mbedtls_md5 );
9594:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_init( &mbedtls_sha1 );
9595:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9596:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
9597:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * digitally-signed struct {
9598:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     opaque md5_hash[16];
9599:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     opaque sha_hash[20];
9600:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * };
9601:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *
9602:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * md5_hash
9603:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     MD5(ClientHello.random + ServerHello.random
9604:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *                            + ServerParams);
9605:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * sha_hash
9606:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     SHA(ClientHello.random + ServerHello.random
9607:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *                            + ServerParams);
9608:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
9609:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md5_starts_ret( &mbedtls_md5 ) ) != 0 )
9610:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9611:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_starts_ret", ret );
9612:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9613:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9614:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md5_update_ret( &mbedtls_md5,
9615:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         ssl->handshake->randbytes, 64 ) ) != 0 )
9616:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9617:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_update_ret", ret );
9618:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9619:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9620:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md5_update_ret( &mbedtls_md5, data, data_len ) ) != 0 )
9621:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9622:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_update_ret", ret );
9623:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9624:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9625:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md5_finish_ret( &mbedtls_md5, output ) ) != 0 )
9626:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9627:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md5_finish_ret", ret );
9628:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9629:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9630:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9631:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_sha1_starts_ret( &mbedtls_sha1 ) ) != 0 )
9632:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9633:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_starts_ret", ret );
9634:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9635:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9636:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_sha1_update_ret( &mbedtls_sha1,
9637:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          ssl->handshake->randbytes, 64 ) ) != 0 )
9638:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9639:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_update_ret", ret );
9640:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9641:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9642:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_sha1_update_ret( &mbedtls_sha1, data,
9643:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          data_len ) ) != 0 )
9644:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9645:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_update_ret", ret );
9646:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9647:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9648:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_sha1_finish_ret( &mbedtls_sha1,
9649:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                          output + 16 ) ) != 0 )
9650:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9651:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_sha1_finish_ret", ret );
9652:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9653:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9654:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9655:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** exit:
9656:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md5_free( &mbedtls_md5 );
9657:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_sha1_free( &mbedtls_sha1 );
9658:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9659:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != 0 )
9660:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
9661:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
9662:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9663:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
9664:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9665:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
9666:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #endif /* MBEDTLS_SSL_PROTO_SSL3 || MBEDTLS_SSL_PROTO_TLS1 || \
9667:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****           MBEDTLS_SSL_PROTO_TLS1_1 */
9668:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9669:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** #if defined(MBEDTLS_SSL_PROTO_TLS1) || defined(MBEDTLS_SSL_PROTO_TLS1_1) || \
9670:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     defined(MBEDTLS_SSL_PROTO_TLS1_2)
9671:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** int mbedtls_ssl_get_key_exchange_md_tls1_2( mbedtls_ssl_context *ssl,
9672:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             unsigned char *hash, size_t *hashlen,
9673:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             unsigned char *data, size_t data_len,
9674:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                             mbedtls_md_type_t md_alg )
9675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** {
 8570              		.loc 2 9675 0
 8571              		.cfi_startproc
 8572              		@ args = 8, pretend = 0, frame = 16
 8573              		@ frame_needed = 0, uses_anonymous_args = 0
 8574              	.LVL915:
 8575 0000 FF412DE9 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 8576              		.cfi_def_cfa_offset 40
 8577              		.cfi_offset 4, -24
 8578              		.cfi_offset 5, -20
 8579              		.cfi_offset 6, -16
 8580              		.cfi_offset 7, -12
 8581              		.cfi_offset 8, -8
 8582              		.cfi_offset 14, -4
 8583              		.loc 2 9675 0
 8584 0004 0050A0E1 		mov	r5, r0
9676:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
9677:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_context_t ctx;
9678:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     const mbedtls_md_info_t *md_info = mbedtls_md_info_from_type( md_alg );
 8585              		.loc 2 9678 0
 8586 0008 2C00DDE5 		ldrb	r0, [sp, #44]	@ zero_extendqisi2
 8587              	.LVL916:
9675:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     int ret = 0;
 8588              		.loc 2 9675 0
 8589 000c 0280A0E1 		mov	r8, r2
 8590 0010 0160A0E1 		mov	r6, r1
 8591 0014 0370A0E1 		mov	r7, r3
 8592              		.loc 2 9678 0
 8593 0018 FEFFFFEB 		bl	mbedtls_md_info_from_type
 8594              	.LVL917:
 8595 001c 0040A0E1 		mov	r4, r0
 8596              	.LVL918:
9679:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     *hashlen = mbedtls_md_get_size( md_info );
 8597              		.loc 2 9679 0
 8598 0020 FEFFFFEB 		bl	mbedtls_md_get_size
 8599              	.LVL919:
 8600 0024 000088E5 		str	r0, [r8]
9680:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9681:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_init( &ctx );
 8601              		.loc 2 9681 0
 8602 0028 04008DE2 		add	r0, sp, #4
 8603 002c FEFFFFEB 		bl	mbedtls_md_init
 8604              	.LVL920:
9682:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9683:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     /*
9684:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * digitally-signed struct {
9685:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     opaque client_random[32];
9686:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     opaque server_random[32];
9687:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      *     ServerDHParams params;
9688:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      * };
9689:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****      */
9690:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_setup( &ctx, md_info, 0 ) ) != 0 )
 8605              		.loc 2 9690 0
 8606 0030 0410A0E1 		mov	r1, r4
 8607 0034 0020A0E3 		mov	r2, #0
 8608 0038 04008DE2 		add	r0, sp, #4
 8609 003c FEFFFFEB 		bl	mbedtls_md_setup
 8610              	.LVL921:
 8611 0040 004050E2 		subs	r4, r0, #0
 8612              	.LVL922:
 8613 0044 1400001A 		bne	.L879
9691:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9692:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_setup", ret );
9693:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9694:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9695:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_starts( &ctx ) ) != 0 )
 8614              		.loc 2 9695 0
 8615 0048 04008DE2 		add	r0, sp, #4
 8616              	.LVL923:
 8617 004c FEFFFFEB 		bl	mbedtls_md_starts
 8618              	.LVL924:
 8619 0050 004050E2 		subs	r4, r0, #0
 8620 0054 1000001A 		bne	.L879
9696:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9697:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_starts", ret );
9698:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9699:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9700:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_update( &ctx, ssl->handshake->randbytes, 64 ) ) != 0 )
 8621              		.loc 2 9700 0
 8622 0058 301095E5 		ldr	r1, [r5, #48]
 8623 005c 4020A0E3 		mov	r2, #64
 8624 0060 04008DE2 		add	r0, sp, #4
 8625              	.LVL925:
 8626 0064 1D1E81E2 		add	r1, r1, #464
 8627 0068 FEFFFFEB 		bl	mbedtls_md_update
 8628              	.LVL926:
 8629 006c 004050E2 		subs	r4, r0, #0
 8630 0070 0900001A 		bne	.L879
9701:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9702:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_update", ret );
9703:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9704:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9705:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_update( &ctx, data, data_len ) ) != 0 )
 8631              		.loc 2 9705 0
 8632 0074 28209DE5 		ldr	r2, [sp, #40]
 8633 0078 0710A0E1 		mov	r1, r7
 8634 007c 04008DE2 		add	r0, sp, #4
 8635              	.LVL927:
 8636 0080 FEFFFFEB 		bl	mbedtls_md_update
 8637              	.LVL928:
 8638 0084 004050E2 		subs	r4, r0, #0
 8639 0088 0300001A 		bne	.L879
9706:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9707:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_update", ret );
9708:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9709:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9710:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ( ret = mbedtls_md_finish( &ctx, hash ) ) != 0 )
 8640              		.loc 2 9710 0
 8641 008c 0610A0E1 		mov	r1, r6
 8642 0090 04008DE2 		add	r0, sp, #4
 8643              	.LVL929:
 8644 0094 FEFFFFEB 		bl	mbedtls_md_finish
 8645              	.LVL930:
 8646 0098 0040A0E1 		mov	r4, r0
 8647              	.LVL931:
 8648              	.L879:
9711:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     {
9712:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         MBEDTLS_SSL_DEBUG_RET( 1, "mbedtls_md_finish", ret );
9713:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         goto exit;
9714:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     }
9715:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9716:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** exit:
9717:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     mbedtls_md_free( &ctx );
 8649              		.loc 2 9717 0
 8650 009c 04008DE2 		add	r0, sp, #4
 8651              	.LVL932:
 8652 00a0 FEFFFFEB 		bl	mbedtls_md_free
 8653              	.LVL933:
9718:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9719:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     if( ret != 0 )
 8654              		.loc 2 9719 0
 8655 00a4 000054E3 		cmp	r4, #0
 8656 00a8 0300000A 		beq	.L878
9720:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****         mbedtls_ssl_send_alert_message( ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,
 8657              		.loc 2 9720 0
 8658 00ac 5020A0E3 		mov	r2, #80
 8659 00b0 0210A0E3 		mov	r1, #2
 8660 00b4 0500A0E1 		mov	r0, r5
 8661 00b8 FEFFFFEB 		bl	mbedtls_ssl_send_alert_message
 8662              	.LVL934:
 8663              	.L878:
9721:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****                                         MBEDTLS_SSL_ALERT_MSG_INTERNAL_ERROR );
9722:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** 
9723:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c ****     return( ret );
9724:D:/Work/DeviceTester/amazon-freertos/lib/third_party/mbedtls/library\ssl_tls.c **** }
 8664              		.loc 2 9724 0
 8665 00bc 0400A0E1 		mov	r0, r4
 8666 00c0 10D08DE2 		add	sp, sp, #16
 8667              		.cfi_def_cfa_offset 24
 8668              		@ sp needed
 8669 00c4 F081BDE8 		pop	{r4, r5, r6, r7, r8, pc}
 8670              		.cfi_endproc
 8671              	.LFE142:
 8673              		.section	.data.ssl_preset_default_hashes,"aw",%progbits
 8674              		.align	2
 8675              		.set	.LANCHOR5,. + 0
 8678              	ssl_preset_default_hashes:
 8679 0000 06000000 		.word	6
 8680 0004 05000000 		.word	5
 8681 0008 00000000 		.word	0
 8682              		.section	.data.ssl_preset_suiteb_ciphersuites,"aw",%progbits
 8683              		.align	2
 8684              		.set	.LANCHOR2,. + 0
 8687              	ssl_preset_suiteb_ciphersuites:
 8688 0000 2BC00000 		.word	49195
 8689 0004 2CC00000 		.word	49196
 8690 0008 00000000 		.word	0
 8691              		.section	.data.ssl_preset_suiteb_curves,"aw",%progbits
 8692              		.set	.LANCHOR4,. + 0
 8695              	ssl_preset_suiteb_curves:
 8696 0000 03       		.byte	3
 8697 0001 04       		.byte	4
 8698 0002 00       		.byte	0
 8699              		.section	.data.ssl_preset_suiteb_hashes,"aw",%progbits
 8700              		.align	2
 8701              		.set	.LANCHOR3,. + 0
 8704              	ssl_preset_suiteb_hashes:
 8705 0000 06000000 		.word	6
 8706 0004 07000000 		.word	7
 8707 0008 00000000 		.word	0
 8708              		.section	.rodata.CSWTCH.106,"a",%progbits
 8709              		.align	2
 8710              		.set	.LANCHOR1,. + 0
 8713              	CSWTCH.106:
 8714 0000 00000000 		.word	.LC8
 8715 0004 08000000 		.word	.LC9
 8716 0008 10000000 		.word	.LC10
 8717 000c 18000000 		.word	.LC11
 8718              		.section	.rodata.CSWTCH.138,"a",%progbits
 8719              		.set	.LANCHOR6,. + 0
 8722              	CSWTCH.138:
 8723 0000 04       		.byte	4
 8724 0001 05       		.byte	5
 8725 0002 06       		.byte	6
 8726              		.section	.rodata.CSWTCH.140,"a",%progbits
 8727              		.set	.LANCHOR7,. + 0
 8730              	CSWTCH.140:
 8731 0000 02       		.byte	2
 8732 0001 03       		.byte	3
 8733 0002 04       		.byte	4
 8734              		.section	.rodata.CSWTCH.43,"a",%progbits
 8735              		.align	1
 8736              		.set	.LANCHOR0,. + 0
 8739              	CSWTCH.43:
 8740 0000 0002     		.short	512
 8741 0002 0004     		.short	1024
 8742 0004 0008     		.short	2048
 8743 0006 0010     		.short	4096
 8744              		.section	.rodata.mbedtls_ssl_check_cert_usage.str1.1,"aMS",%progbits,1
 8745              	.LC6:
 8746 0000 2B060105 		.ascii	"+\006\001\005\005\007\003\001\000"
 8746      05070301 
 8746      00
 8747              	.LC7:
 8748 0009 2B060105 		.ascii	"+\006\001\005\005\007\003\002\000"
 8748      05070302 
 8748      00
 8749              		.section	.rodata.mbedtls_ssl_derive_keys.str1.1,"aMS",%progbits,1
 8750              	.LC2:
 8751 0000 65787465 		.ascii	"extended master secret\000"
 8751      6E646564 
 8751      206D6173 
 8751      74657220 
 8751      73656372 
 8752              	.LC3:
 8753 0017 6D617374 		.ascii	"master secret\000"
 8753      65722073 
 8753      65637265 
 8753      7400
 8754              	.LC4:
 8755 0025 6B657920 		.ascii	"key expansion\000"
 8755      65787061 
 8755      6E73696F 
 8755      6E00
 8756              		.section	.rodata.mbedtls_ssl_get_version.str1.1,"aMS",%progbits,1
 8757              	.LC5:
 8758 0000 756E6B6E 		.ascii	"unknown\000"
 8758      6F776E00 
 8759              		.section	.rodata.ssl_calc_finished_tls_sha256.str1.1,"aMS",%progbits,1
 8760              	.LC0:
 8761 0000 636C6965 		.ascii	"client finished\000"
 8761      6E742066 
 8761      696E6973 
 8761      68656400 
 8762              	.LC1:
 8763 0010 73657276 		.ascii	"server finished\000"
 8763      65722066 
 8763      696E6973 
 8763      68656400 
 8764              		.section	.rodata.str1.1,"aMS",%progbits,1
 8765              	.LC8:
 8766 0000 53534C76 		.ascii	"SSLv3.0\000"
 8766      332E3000 
 8767              	.LC9:
 8768 0008 544C5376 		.ascii	"TLSv1.0\000"
 8768      312E3000 
 8769              	.LC10:
 8770 0010 544C5376 		.ascii	"TLSv1.1\000"
 8770      312E3100 
 8771              	.LC11:
 8772 0018 544C5376 		.ascii	"TLSv1.2\000"
 8772      312E3200 
 8773              		.text
 8774              	.Letext0:
 8775              		.file 4 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 8776              		.file 5 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\lib\\gcc\\arm-none-eab
 8777              		.file 6 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 8778              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 8779              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 8780              		.file 9 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\include
 8781              		.file 10 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 8782              		.file 11 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 8783              		.file 12 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/bign
 8784              		.file 13 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/ecp.
 8785              		.file 14 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/md.h
 8786              		.file 15 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 8787              		.file 16 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
 8788              		.file 17 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\unity\\src/unity_internals.h"
 8789              		.file 18 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\include/queue.h"
 8790              		.file 19 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\include/semphr.h"
 8791              		.file 20 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\include\\private/threading_alt.h"
 8792              		.file 21 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/thre
 8793              		.file 22 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/pk.h
 8794              		.file 23 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/ssl_
 8795              		.file 24 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/asn1
 8796              		.file 25 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/x509
 8797              		.file 26 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/x509
 8798              		.file 27 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/x509
 8799              		.file 28 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/ecdh
 8800              		.file 29 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/ssl.
 8801              		.file 30 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/sha2
 8802              		.file 31 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/plat
 8803              		.file 32 "D:\\Work\\DeviceTester\\amazon-freertos\\lib\\third_party\\mbedtls\\include/mbedtls/plat
 8804              		.file 33 "c:\\program files (x86)\\gnu tools arm embedded\\6 2017-q2-update\\arm-none-eabi\\includ
DEFINED SYMBOLS
                            *ABS*:00000000 ssl_tls.c
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:17     .text.mbedtls_ssl_safer_memcmp:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:22     .text.mbedtls_ssl_safer_memcmp:00000000 mbedtls_ssl_safer_memcmp
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:79     .text.ssl_set_timer:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:84     .text.ssl_set_timer:00000000 ssl_set_timer
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:111    .text.ssl_update_out_pointers:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:116    .text.ssl_update_out_pointers:00000000 ssl_update_out_pointers
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:158    .text.ssl_calc_finished_tls_sha256:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:163    .text.ssl_calc_finished_tls_sha256:00000000 ssl_calc_finished_tls_sha256
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:251    .text.ssl_calc_finished_tls_sha256:000000a0 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:257    .text.ssl_calc_verify_tls_sha256:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:262    .text.ssl_calc_verify_tls_sha256:00000000 ssl_calc_verify_tls_sha256
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:310    .text.ssl_append_key_cert:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:315    .text.ssl_append_key_cert:00000000 ssl_append_key_cert
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:387    .text.ssl_append_key_cert:0000006c $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:392    .text.ssl_update_checksum_sha256:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:397    .text.ssl_update_checksum_sha256:00000000 ssl_update_checksum_sha256
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:415    .text.ssl_update_checksum_start:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:420    .text.ssl_update_checksum_start:00000000 ssl_update_checksum_start
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:432    .text.tls_prf_sha256:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:437    .text.tls_prf_sha256:00000000 tls_prf_sha256
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:668    .text.tls_prf_sha256:000001ac $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:676    .text.ssl_reset_in_out_pointers:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:681    .text.ssl_reset_in_out_pointers:00000000 ssl_reset_in_out_pointers
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:733    .text.mbedtls_ssl_derive_keys:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:739    .text.mbedtls_ssl_derive_keys:00000000 mbedtls_ssl_derive_keys
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1200   .text.mbedtls_ssl_derive_keys:00000404 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1212   .text.mbedtls_ssl_fetch_input:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1218   .text.mbedtls_ssl_fetch_input:00000000 mbedtls_ssl_fetch_input
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1375   .text.mbedtls_ssl_fetch_input:00000100 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1385   .text.mbedtls_ssl_flush_output:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1391   .text.mbedtls_ssl_flush_output:00000000 mbedtls_ssl_flush_output
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1488   .text.mbedtls_ssl_flush_output:00000094 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1494   .text.mbedtls_ssl_write_record:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:1500   .text.mbedtls_ssl_write_record:00000000 mbedtls_ssl_write_record
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2129   .text.mbedtls_ssl_write_record:000004f8 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2135   .text.mbedtls_ssl_write_handshake_msg:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2141   .text.mbedtls_ssl_write_handshake_msg:00000000 mbedtls_ssl_write_handshake_msg
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2246   .text.mbedtls_ssl_write_handshake_msg:000000bc $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2251   .text.mbedtls_ssl_prepare_handshake_record:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2257   .text.mbedtls_ssl_prepare_handshake_record:00000000 mbedtls_ssl_prepare_handshake_record
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2310   .text.mbedtls_ssl_prepare_handshake_record:00000048 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2316   .text.mbedtls_ssl_update_handshake_status:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2322   .text.mbedtls_ssl_update_handshake_status:00000000 mbedtls_ssl_update_handshake_status
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2358   .text.mbedtls_ssl_handle_message_type:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2364   .text.mbedtls_ssl_handle_message_type:00000000 mbedtls_ssl_handle_message_type
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2473   .text.mbedtls_ssl_handle_message_type:000000c0 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2481   .text.mbedtls_ssl_send_alert_message:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2487   .text.mbedtls_ssl_send_alert_message:00000000 mbedtls_ssl_send_alert_message
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2530   .text.mbedtls_ssl_send_alert_message:00000044 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2535   .text.mbedtls_ssl_send_fatal_handshake_failure:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2541   .text.mbedtls_ssl_send_fatal_handshake_failure:00000000 mbedtls_ssl_send_fatal_handshake_failure
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2558   .text.mbedtls_ssl_read_record:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:2564   .text.mbedtls_ssl_read_record:00000000 mbedtls_ssl_read_record
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3734   .text.mbedtls_ssl_read_record:0000081c $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3749   .text.mbedtls_ssl_write_certificate:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3755   .text.mbedtls_ssl_write_certificate:00000000 mbedtls_ssl_write_certificate
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3949   .text.mbedtls_ssl_write_certificate:00000154 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3954   .text.mbedtls_ssl_write_change_cipher_spec:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3960   .text.mbedtls_ssl_write_change_cipher_spec:00000000 mbedtls_ssl_write_change_cipher_spec
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3989   .text.mbedtls_ssl_parse_change_cipher_spec:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:3995   .text.mbedtls_ssl_parse_change_cipher_spec:00000000 mbedtls_ssl_parse_change_cipher_spec
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4101   .text.mbedtls_ssl_parse_change_cipher_spec:000000b4 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4106   .text.mbedtls_ssl_optimize_checksum:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4112   .text.mbedtls_ssl_optimize_checksum:00000000 mbedtls_ssl_optimize_checksum
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4131   .text.mbedtls_ssl_optimize_checksum:00000018 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4136   .text.mbedtls_ssl_reset_checksum:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4142   .text.mbedtls_ssl_reset_checksum:00000000 mbedtls_ssl_reset_checksum
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4161   .text.mbedtls_ssl_write_finished:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4167   .text.mbedtls_ssl_write_finished:00000000 mbedtls_ssl_write_finished
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4263   .text.mbedtls_ssl_parse_finished:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4269   .text.mbedtls_ssl_parse_finished:00000000 mbedtls_ssl_parse_finished
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4378   .text.mbedtls_ssl_parse_finished:000000e8 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4384   .text.mbedtls_ssl_session_init:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4390   .text.mbedtls_ssl_session_init:00000000 mbedtls_ssl_session_init
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4407   .text.mbedtls_ssl_init:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4413   .text.mbedtls_ssl_init:00000000 mbedtls_ssl_init
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4430   .text.mbedtls_ssl_conf_endpoint:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4436   .text.mbedtls_ssl_conf_endpoint:00000000 mbedtls_ssl_conf_endpoint
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4453   .text.mbedtls_ssl_conf_transport:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4459   .text.mbedtls_ssl_conf_transport:00000000 mbedtls_ssl_conf_transport
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4476   .text.mbedtls_ssl_conf_authmode:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4482   .text.mbedtls_ssl_conf_authmode:00000000 mbedtls_ssl_conf_authmode
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4499   .text.mbedtls_ssl_conf_verify:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4505   .text.mbedtls_ssl_conf_verify:00000000 mbedtls_ssl_conf_verify
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4522   .text.mbedtls_ssl_conf_rng:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4528   .text.mbedtls_ssl_conf_rng:00000000 mbedtls_ssl_conf_rng
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4545   .text.mbedtls_ssl_conf_dbg:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4551   .text.mbedtls_ssl_conf_dbg:00000000 mbedtls_ssl_conf_dbg
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4568   .text.mbedtls_ssl_set_bio:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4574   .text.mbedtls_ssl_set_bio:00000000 mbedtls_ssl_set_bio
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4598   .text.mbedtls_ssl_conf_read_timeout:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4604   .text.mbedtls_ssl_conf_read_timeout:00000000 mbedtls_ssl_conf_read_timeout
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4619   .text.mbedtls_ssl_set_timer_cb:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4625   .text.mbedtls_ssl_set_timer_cb:00000000 mbedtls_ssl_set_timer_cb
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4649   .text.mbedtls_ssl_conf_ciphersuites:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4655   .text.mbedtls_ssl_conf_ciphersuites:00000000 mbedtls_ssl_conf_ciphersuites
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4676   .text.mbedtls_ssl_conf_ciphersuites_for_version:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4682   .text.mbedtls_ssl_conf_ciphersuites_for_version:00000000 mbedtls_ssl_conf_ciphersuites_for_version
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4702   .text.mbedtls_ssl_conf_cert_profile:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4708   .text.mbedtls_ssl_conf_cert_profile:00000000 mbedtls_ssl_conf_cert_profile
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4723   .text.mbedtls_ssl_conf_own_cert:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4729   .text.mbedtls_ssl_conf_own_cert:00000000 mbedtls_ssl_conf_own_cert
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4746   .text.mbedtls_ssl_conf_ca_chain:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4752   .text.mbedtls_ssl_conf_ca_chain:00000000 mbedtls_ssl_conf_ca_chain
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4769   .text.mbedtls_ssl_set_hs_own_cert:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4775   .text.mbedtls_ssl_set_hs_own_cert:00000000 mbedtls_ssl_set_hs_own_cert
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4793   .text.mbedtls_ssl_set_hs_ca_chain:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4799   .text.mbedtls_ssl_set_hs_ca_chain:00000000 mbedtls_ssl_set_hs_ca_chain
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4817   .text.mbedtls_ssl_set_hs_authmode:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4823   .text.mbedtls_ssl_set_hs_authmode:00000000 mbedtls_ssl_set_hs_authmode
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4839   .text.mbedtls_ssl_conf_sig_hashes:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4845   .text.mbedtls_ssl_conf_sig_hashes:00000000 mbedtls_ssl_conf_sig_hashes
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4860   .text.mbedtls_ssl_conf_curves:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4866   .text.mbedtls_ssl_conf_curves:00000000 mbedtls_ssl_conf_curves
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4881   .text.mbedtls_ssl_set_hostname:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4887   .text.mbedtls_ssl_set_hostname:00000000 mbedtls_ssl_set_hostname
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4985   .text.mbedtls_ssl_set_hostname:000000a8 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4991   .text.mbedtls_ssl_conf_sni:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:4997   .text.mbedtls_ssl_conf_sni:00000000 mbedtls_ssl_conf_sni
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5014   .text.mbedtls_ssl_conf_alpn_protocols:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5020   .text.mbedtls_ssl_conf_alpn_protocols:00000000 mbedtls_ssl_conf_alpn_protocols
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5075   .text.mbedtls_ssl_conf_alpn_protocols:0000004c $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5080   .text.mbedtls_ssl_get_alpn_protocol:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5086   .text.mbedtls_ssl_get_alpn_protocol:00000000 mbedtls_ssl_get_alpn_protocol
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5102   .text.mbedtls_ssl_conf_max_version:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5108   .text.mbedtls_ssl_conf_max_version:00000000 mbedtls_ssl_conf_max_version
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5125   .text.mbedtls_ssl_conf_min_version:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5131   .text.mbedtls_ssl_conf_min_version:00000000 mbedtls_ssl_conf_min_version
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5148   .text.mbedtls_ssl_conf_encrypt_then_mac:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5154   .text.mbedtls_ssl_conf_encrypt_then_mac:00000000 mbedtls_ssl_conf_encrypt_then_mac
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5172   .text.mbedtls_ssl_conf_extended_master_secret:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5178   .text.mbedtls_ssl_conf_extended_master_secret:00000000 mbedtls_ssl_conf_extended_master_secret
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5196   .text.mbedtls_ssl_conf_max_frag_len:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5202   .text.mbedtls_ssl_conf_max_frag_len:00000000 mbedtls_ssl_conf_max_frag_len
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5243   .text.mbedtls_ssl_conf_max_frag_len:00000044 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5249   .text.mbedtls_ssl_conf_legacy_renegotiation:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5255   .text.mbedtls_ssl_conf_legacy_renegotiation:00000000 mbedtls_ssl_conf_legacy_renegotiation
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5272   .text.mbedtls_ssl_get_bytes_avail:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5278   .text.mbedtls_ssl_get_bytes_avail:00000000 mbedtls_ssl_get_bytes_avail
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5298   .text.mbedtls_ssl_check_pending:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5304   .text.mbedtls_ssl_check_pending:00000000 mbedtls_ssl_check_pending
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5342   .text.mbedtls_ssl_get_verify_result:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5348   .text.mbedtls_ssl_get_verify_result:00000000 mbedtls_ssl_get_verify_result
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5380   .text.mbedtls_ssl_get_ciphersuite:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5386   .text.mbedtls_ssl_get_ciphersuite:00000000 mbedtls_ssl_get_ciphersuite
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5415   .text.mbedtls_ssl_get_version:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5421   .text.mbedtls_ssl_get_version:00000000 mbedtls_ssl_get_version
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5441   .text.mbedtls_ssl_get_version:00000018 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5447   .text.mbedtls_ssl_get_record_expansion:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5453   .text.mbedtls_ssl_get_record_expansion:00000000 mbedtls_ssl_get_record_expansion
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5484   .text.mbedtls_ssl_get_record_expansion:0000002c $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5495   .text.mbedtls_ssl_get_record_expansion:00000050 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5541   .text.mbedtls_ssl_get_record_expansion:00000088 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5546   .text.mbedtls_ssl_get_max_frag_len:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5552   .text.mbedtls_ssl_get_max_frag_len:00000000 mbedtls_ssl_get_max_frag_len
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5636   .text.mbedtls_ssl_get_max_frag_len:00000090 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5641   .text.mbedtls_ssl_get_max_out_record_payload:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5647   .text.mbedtls_ssl_get_max_out_record_payload:00000000 mbedtls_ssl_get_max_out_record_payload
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5670   .text.mbedtls_ssl_get_peer_cert:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5676   .text.mbedtls_ssl_get_peer_cert:00000000 mbedtls_ssl_get_peer_cert
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5699   .text.mbedtls_ssl_handshake_step:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5705   .text.mbedtls_ssl_handshake_step:00000000 mbedtls_ssl_handshake_step
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5742   .text.mbedtls_ssl_handshake_step:00000034 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5748   .text.mbedtls_ssl_handshake:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5754   .text.mbedtls_ssl_handshake:00000000 mbedtls_ssl_handshake
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5797   .text.mbedtls_ssl_handshake:00000044 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5802   .text.mbedtls_ssl_read:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:5808   .text.mbedtls_ssl_read:00000000 mbedtls_ssl_read
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6016   .text.mbedtls_ssl_read:000001bc $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6025   .text.mbedtls_ssl_write:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6031   .text.mbedtls_ssl_write:00000000 mbedtls_ssl_write
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6139   .text.mbedtls_ssl_write:000000b8 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6144   .text.mbedtls_ssl_close_notify:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6150   .text.mbedtls_ssl_close_notify:00000000 mbedtls_ssl_close_notify
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6196   .text.mbedtls_ssl_close_notify:00000048 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6201   .text.mbedtls_ssl_transform_free:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6207   .text.mbedtls_ssl_transform_free:00000000 mbedtls_ssl_transform_free
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6254   .text.mbedtls_ssl_handshake_free:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6260   .text.mbedtls_ssl_handshake_free:00000000 mbedtls_ssl_handshake_free
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6329   .text.mbedtls_ssl_session_free:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6335   .text.mbedtls_ssl_session_free:00000000 mbedtls_ssl_session_free
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6378   .text.mbedtls_ssl_handshake_wrapup:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6384   .text.mbedtls_ssl_handshake_wrapup:00000000 mbedtls_ssl_handshake_wrapup
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6496   .text.ssl_session_copy:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6501   .text.ssl_session_copy:00000000 ssl_session_copy
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6573   .text.ssl_session_copy:00000080 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6578   .text.mbedtls_ssl_set_session:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6584   .text.mbedtls_ssl_set_session:00000000 mbedtls_ssl_set_session
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6636   .text.mbedtls_ssl_set_session:00000054 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6641   .text.mbedtls_ssl_get_session:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6647   .text.mbedtls_ssl_get_session:00000000 mbedtls_ssl_get_session
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6689   .text.mbedtls_ssl_get_session:0000003c $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6694   .text.ssl_handshake_init:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6699   .text.ssl_handshake_init:00000000 ssl_handshake_init
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6912   .text.ssl_handshake_init:00000174 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6918   .text.mbedtls_ssl_setup:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:6924   .text.mbedtls_ssl_setup:00000000 mbedtls_ssl_setup
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7033   .text.mbedtls_ssl_setup:000000b4 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7038   .text.mbedtls_ssl_session_reset:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7044   .text.mbedtls_ssl_session_reset:00000000 mbedtls_ssl_session_reset
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7186   .text.mbedtls_ssl_free:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7192   .text.mbedtls_ssl_free:00000000 mbedtls_ssl_free
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7323   .text.mbedtls_ssl_config_init:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7329   .text.mbedtls_ssl_config_init:00000000 mbedtls_ssl_config_init
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7346   .text.mbedtls_ssl_config_defaults:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7352   .text.mbedtls_ssl_config_defaults:00000000 mbedtls_ssl_config_defaults
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7481   .text.mbedtls_ssl_config_defaults:000000cc $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7491   .text.mbedtls_ssl_config_free:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7497   .text.mbedtls_ssl_config_free:00000000 mbedtls_ssl_config_free
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7558   .text.mbedtls_ssl_sig_from_pk:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7564   .text.mbedtls_ssl_sig_from_pk:00000000 mbedtls_ssl_sig_from_pk
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7603   .text.mbedtls_ssl_sig_from_pk_alg:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7609   .text.mbedtls_ssl_sig_from_pk_alg:00000000 mbedtls_ssl_sig_from_pk_alg
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7639   .text.mbedtls_ssl_pk_alg_from_sig:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7645   .text.mbedtls_ssl_pk_alg_from_sig:00000000 mbedtls_ssl_pk_alg_from_sig
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7667   .text.mbedtls_ssl_sig_hash_set_find:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7673   .text.mbedtls_ssl_sig_hash_set_find:00000000 mbedtls_ssl_sig_hash_set_find
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7707   .text.mbedtls_ssl_sig_hash_set_add:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7713   .text.mbedtls_ssl_sig_hash_set_add:00000000 mbedtls_ssl_sig_hash_set_add
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7745   .text.mbedtls_ssl_sig_hash_set_const_hash:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7751   .text.mbedtls_ssl_sig_hash_set_const_hash:00000000 mbedtls_ssl_sig_hash_set_const_hash
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7768   .text.mbedtls_ssl_md_alg_from_hash:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7774   .text.mbedtls_ssl_md_alg_from_hash:00000000 mbedtls_ssl_md_alg_from_hash
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7795   .text.mbedtls_ssl_md_alg_from_hash:0000001c $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7800   .text.mbedtls_ssl_hash_from_md_alg:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7806   .text.mbedtls_ssl_hash_from_md_alg:00000000 mbedtls_ssl_hash_from_md_alg
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7827   .text.mbedtls_ssl_hash_from_md_alg:00000018 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7832   .text.mbedtls_ssl_check_curve:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7838   .text.mbedtls_ssl_check_curve:00000000 mbedtls_ssl_check_curve
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7880   .text.mbedtls_ssl_check_sig_hash:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7886   .text.mbedtls_ssl_check_sig_hash:00000000 mbedtls_ssl_check_sig_hash
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7928   .text.mbedtls_ssl_check_cert_usage:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:7934   .text.mbedtls_ssl_check_cert_usage:00000000 mbedtls_ssl_check_cert_usage
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8025   .text.mbedtls_ssl_check_cert_usage:000000a8 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8031   .text.mbedtls_ssl_parse_certificate:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8037   .text.mbedtls_ssl_parse_certificate:00000000 mbedtls_ssl_parse_certificate
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8455   .text.mbedtls_ssl_parse_certificate:00000360 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8465   .text.mbedtls_ssl_write_version:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8471   .text.mbedtls_ssl_write_version:00000000 mbedtls_ssl_write_version
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8488   .text.mbedtls_ssl_read_version:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8494   .text.mbedtls_ssl_read_version:00000000 mbedtls_ssl_read_version
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8515   .text.mbedtls_ssl_set_calc_verify_md:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8521   .text.mbedtls_ssl_set_calc_verify_md:00000000 mbedtls_ssl_set_calc_verify_md
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8556   .text.mbedtls_ssl_set_calc_verify_md:00000030 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8562   .text.mbedtls_ssl_get_key_exchange_md_tls1_2:00000000 $a
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8568   .text.mbedtls_ssl_get_key_exchange_md_tls1_2:00000000 mbedtls_ssl_get_key_exchange_md_tls1_2
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8674   .data.ssl_preset_default_hashes:00000000 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8678   .data.ssl_preset_default_hashes:00000000 ssl_preset_default_hashes
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8683   .data.ssl_preset_suiteb_ciphersuites:00000000 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8687   .data.ssl_preset_suiteb_ciphersuites:00000000 ssl_preset_suiteb_ciphersuites
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8695   .data.ssl_preset_suiteb_curves:00000000 ssl_preset_suiteb_curves
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8700   .data.ssl_preset_suiteb_hashes:00000000 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8704   .data.ssl_preset_suiteb_hashes:00000000 ssl_preset_suiteb_hashes
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8709   .rodata.CSWTCH.106:00000000 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8713   .rodata.CSWTCH.106:00000000 CSWTCH.106
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8722   .rodata.CSWTCH.138:00000000 CSWTCH.138
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8730   .rodata.CSWTCH.140:00000000 CSWTCH.140
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8735   .rodata.CSWTCH.43:00000000 $d
C:\Users\a5089698\AppData\Local\Temp\ccieRHX1.s:8739   .rodata.CSWTCH.43:00000000 CSWTCH.43
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
mbedtls_sha256_init
mbedtls_sha256_clone
mbedtls_sha256_finish_ret
mbedtls_sha256_free
mbedtls_platform_zeroize
mbedtls_calloc
mbedtls_sha256_update_ret
__aeabi_uidivmod
mbedtls_md_init
mbedtls_md_info_from_type
mbedtls_md_get_size
strlen
memcpy
mbedtls_md_setup
mbedtls_md_hmac_starts
mbedtls_md_hmac_update
mbedtls_md_hmac_finish
mbedtls_md_free
mbedtls_md_hmac_reset
mbedtls_cipher_info_from_type
mbedtls_cipher_setup
mbedtls_cipher_setkey
mbedtls_cipher_set_padding_mode
mbedtls_cipher_auth_encrypt
mbedtls_cipher_crypt
memmove
mbedtls_cipher_auth_decrypt
mbedtls_md_process
memset
mbedtls_sha256_starts_ret
mbedtls_free
mbedtls_ssl_get_ciphersuite_name
mbedtls_ssl_handshake_client_step
mbedtls_cipher_free
mbedtls_ecdh_free
mbedtls_x509_crt_free
mbedtls_x509_crt_init
mbedtls_x509_crt_parse_der
mbedtls_cipher_init
mbedtls_ecdh_init
mbedtls_ssl_list_ciphersuites
mbedtls_ecp_grp_id_list
mbedtls_x509_crt_profile_suiteb
mbedtls_x509_crt_profile_default
mbedtls_pk_can_do
mbedtls_x509_crt_check_key_usage
mbedtls_x509_crt_check_extended_key_usage
mbedtls_x509_crt_verify_with_profile
mbedtls_md_starts
mbedtls_md_update
mbedtls_md_finish
